WEBVTT

00:00:18.366 --> 00:00:19.506 A:middle
&gt;&gt; Hello and welcome to the

00:00:19.506 --> 00:00:20.796 A:middle
Enabling Your App for CarPlay

00:00:20.796 --> 00:00:21.176 A:middle
session.

00:00:21.706 --> 00:00:22.916 A:middle
My name is Albert and I'm an

00:00:22.916 --> 00:00:24.196 A:middle
engineer on the CarPlay team.

00:00:25.196 --> 00:00:26.356 A:middle
Today we'll be going through an

00:00:26.356 --> 00:00:27.976 A:middle
overview of how apps behave in

00:00:27.976 --> 00:00:29.576 A:middle
CarPlay, how to get your app

00:00:29.576 --> 00:00:30.596 A:middle
integrated on the CarPlay

00:00:30.596 --> 00:00:32.546 A:middle
platform and best practices and

00:00:32.546 --> 00:00:33.516 A:middle
pitfalls to avoid.

00:00:34.866 --> 00:00:36.276 A:middle
Let's look at how apps run in

00:00:36.276 --> 00:00:36.706 A:middle
CarPlay.

00:00:37.246 --> 00:00:39.736 A:middle
When CarPlay is active some

00:00:39.736 --> 00:00:41.276 A:middle
information will be available

00:00:41.276 --> 00:00:42.446 A:middle
and accessible from the CarPlay

00:00:42.446 --> 00:00:42.806 A:middle
screen.

00:00:43.476 --> 00:00:44.916 A:middle
If an app has posted now playing

00:00:44.916 --> 00:00:46.486 A:middle
metadata and playback controls

00:00:46.486 --> 00:00:48.146 A:middle
for audio content this

00:00:48.146 --> 00:00:49.306 A:middle
information will also be

00:00:49.306 --> 00:00:50.696 A:middle
accessible from the Now Playing

00:00:50.696 --> 00:00:52.536 A:middle
app on the CarPlay Home screen.

00:00:53.366 --> 00:00:54.906 A:middle
Audio will be played through a

00:00:54.906 --> 00:00:56.856 A:middle
car speaker system and some

00:00:56.856 --> 00:00:58.216 A:middle
SiriKit intents will be

00:00:58.216 --> 00:00:59.266 A:middle
supported in CarPlay.

00:01:00.276 --> 00:01:01.826 A:middle
If we user triggers of SiriKit

00:01:01.826 --> 00:01:03.116 A:middle
intent that is not supported

00:01:03.116 --> 00:01:04.936 A:middle
while in CarPlay Siri will

00:01:04.936 --> 00:01:06.456 A:middle
notify the user that it is not

00:01:06.456 --> 00:01:09.876 A:middle
available in the car.

00:01:09.876 --> 00:01:11.206 A:middle
Even though your app may not

00:01:11.206 --> 00:01:13.226 A:middle
support CarPlay users may use

00:01:13.226 --> 00:01:14.946 A:middle
your app while in CarPlay before

00:01:14.946 --> 00:01:15.826 A:middle
they begin driving.

00:01:16.746 --> 00:01:17.876 A:middle
To ensure a great user

00:01:17.876 --> 00:01:19.336 A:middle
experience for all apps in

00:01:19.336 --> 00:01:21.506 A:middle
CarPlay make sure that your app

00:01:21.606 --> 00:01:22.876 A:middle
doesn't play audio unless

00:01:22.876 --> 00:01:24.706 A:middle
requested since your app could

00:01:24.706 --> 00:01:26.526 A:middle
override currently playing audio

00:01:26.526 --> 00:01:29.256 A:middle
the user intended to play.

00:01:29.466 --> 00:01:31.146 A:middle
In some instances, your app will

00:01:31.146 --> 00:01:32.646 A:middle
want to interact with other

00:01:32.646 --> 00:01:33.986 A:middle
audio streams appropriately.

00:01:34.726 --> 00:01:36.056 A:middle
For spoken audio apps such as

00:01:36.056 --> 00:01:38.526 A:middle
Audiobooks use this protocol so

00:01:38.526 --> 00:01:40.186 A:middle
your audio will pause when other

00:01:40.186 --> 00:01:41.266 A:middle
audio streams are active.

00:01:42.226 --> 00:01:43.526 A:middle
For navigation apps where

00:01:43.526 --> 00:01:44.866 A:middle
guidance instructions are given

00:01:44.866 --> 00:01:47.146 A:middle
intermittently use these two

00:01:47.146 --> 00:01:48.796 A:middle
protocols, the latter of which

00:01:48.796 --> 00:01:50.536 A:middle
will pause audio streams marked

00:01:50.536 --> 00:01:51.956 A:middle
as spoken audio before

00:01:51.956 --> 00:01:53.246 A:middle
initiating your audio session.

00:01:53.796 --> 00:01:56.336 A:middle
Because guidance voices will mix

00:01:56.336 --> 00:01:58.176 A:middle
with other audio streams set

00:01:58.176 --> 00:01:59.976 A:middle
your audio session to mixable so

00:01:59.976 --> 00:02:01.436 A:middle
that it can interact with other

00:02:01.436 --> 00:02:02.146 A:middle
audio streams.

00:02:02.686 --> 00:02:05.816 A:middle
For apps that have deeper

00:02:05.816 --> 00:02:07.646 A:middle
CarPlay integration the app icon

00:02:07.646 --> 00:02:09.026 A:middle
will appear on the CarPlay Home

00:02:09.026 --> 00:02:09.386 A:middle
screen.

00:02:10.066 --> 00:02:11.096 A:middle
Apps that are launched in

00:02:11.096 --> 00:02:12.506 A:middle
CarPlay will launch in the

00:02:12.506 --> 00:02:14.236 A:middle
foreground on both the CarPlay

00:02:14.236 --> 00:02:15.246 A:middle
and iPhone screen.

00:02:16.216 --> 00:02:17.466 A:middle
For apps that are not integrated

00:02:17.466 --> 00:02:19.326 A:middle
with CarPlay only the iPhone

00:02:19.326 --> 00:02:20.596 A:middle
screen will have the app in the

00:02:20.596 --> 00:02:22.586 A:middle
foreground and CarPlay will only

00:02:22.586 --> 00:02:23.606 A:middle
display the Home screen.

00:02:24.146 --> 00:02:27.306 A:middle
There are certain categories of

00:02:27.306 --> 00:02:28.676 A:middle
apps that can support deeper

00:02:28.676 --> 00:02:29.646 A:middle
CarPlay integration.

00:02:30.576 --> 00:02:32.406 A:middle
These are audio apps, messaging

00:02:32.406 --> 00:02:34.056 A:middle
and VoIP apps and automaker

00:02:34.056 --> 00:02:34.376 A:middle
apps.

00:02:35.096 --> 00:02:37.266 A:middle
Audio apps deliver music, news,

00:02:37.596 --> 00:02:39.856 A:middle
podcasts and other audio content

00:02:39.856 --> 00:02:41.636 A:middle
using a consistent design that's

00:02:41.636 --> 00:02:43.016 A:middle
optimized for use in the car.

00:02:44.116 --> 00:02:45.636 A:middle
Messaging and VoIP apps work

00:02:45.636 --> 00:02:47.976 A:middle
using Siri and can be updated to

00:02:47.976 --> 00:02:48.816 A:middle
appear in CarPlay.

00:02:49.836 --> 00:02:51.366 A:middle
Automaker apps provide vehicle

00:02:51.366 --> 00:02:53.156 A:middle
specific controls and displays

00:02:53.496 --> 00:02:54.646 A:middle
to keep drivers connected

00:02:54.646 --> 00:02:55.786 A:middle
without leaving CarPlay.

00:02:57.176 --> 00:02:58.396 A:middle
If you think your audio,

00:02:58.456 --> 00:03:00.436 A:middle
automaker, messaging or VoIP

00:03:00.436 --> 00:03:01.976 A:middle
calling app has the potential to

00:03:01.976 --> 00:03:04.116 A:middle
be supported by CarPlay tell us

00:03:04.116 --> 00:03:05.196 A:middle
about it at the CarPlay

00:03:05.196 --> 00:03:05.936 A:middle
developer portal.

00:03:06.656 --> 00:03:08.186 A:middle
There you'll be able to request

00:03:08.186 --> 00:03:09.506 A:middle
an entitlement to get your app

00:03:09.506 --> 00:03:10.256 A:middle
running in CarPlay.

00:03:10.786 --> 00:03:14.436 A:middle
Keep in mind that certain assets

00:03:14.436 --> 00:03:15.766 A:middle
and images will need to have

00:03:15.826 --> 00:03:17.686 A:middle
CarPlay specific assets and to

00:03:17.686 --> 00:03:20.116 A:middle
provide 2X and 3X sized images

00:03:20.236 --> 00:03:21.546 A:middle
since the CarPlay screen has

00:03:21.546 --> 00:03:23.226 A:middle
varying resolutions and sizes

00:03:23.606 --> 00:03:24.576 A:middle
depending on a vehicle's

00:03:24.576 --> 00:03:25.036 A:middle
display.

00:03:26.096 --> 00:03:27.706 A:middle
For more guidance on icons and

00:03:27.706 --> 00:03:28.966 A:middle
designing your app for CarPlay

00:03:29.486 --> 00:03:30.826 A:middle
check out the iOS Human

00:03:30.826 --> 00:03:32.036 A:middle
Interface Guidelines and the

00:03:32.036 --> 00:03:33.086 A:middle
CarPlay Human Interface

00:03:33.086 --> 00:03:33.626 A:middle
Guidelines.

00:03:36.056 --> 00:03:37.326 A:middle
While you can test the CarPlay

00:03:37.326 --> 00:03:39.956 A:middle
app on iOS simulator in Xcode it

00:03:40.006 --> 00:03:41.696 A:middle
is best to test on an actual

00:03:41.696 --> 00:03:42.946 A:middle
device connected to a real

00:03:42.946 --> 00:03:44.726 A:middle
vehicle head unit for realistic

00:03:44.766 --> 00:03:45.216 A:middle
results.

00:03:46.236 --> 00:03:47.586 A:middle
For apps that will play audio

00:03:47.746 --> 00:03:48.906 A:middle
the simulator has some

00:03:48.906 --> 00:03:50.336 A:middle
limitations on playback state

00:03:50.756 --> 00:03:52.106 A:middle
which does not reflect on what a

00:03:52.106 --> 00:03:53.566 A:middle
user will actually experience.

00:03:54.696 --> 00:03:55.976 A:middle
To fully debug your app with

00:03:55.976 --> 00:03:58.586 A:middle
LLDB support Xcode now supports

00:03:58.586 --> 00:04:00.036 A:middle
wireless debugging so that an

00:04:00.186 --> 00:04:01.676 A:middle
iPhone can be connected to a

00:04:01.676 --> 00:04:03.336 A:middle
vehicle or aftermarket head unit

00:04:03.456 --> 00:04:04.416 A:middle
while debugging your app.

00:04:05.156 --> 00:04:06.786 A:middle
For more information, please see

00:04:06.786 --> 00:04:08.016 A:middle
the debugging with Xcode 9

00:04:08.016 --> 00:04:09.786 A:middle
session which will be available

00:04:09.786 --> 00:04:11.076 A:middle
this week in WWDC.

00:04:11.656 --> 00:04:14.976 A:middle
If your app uses data protection

00:04:14.976 --> 00:04:17.096 A:middle
for user data or content keep in

00:04:17.096 --> 00:04:18.686 A:middle
mind that apps in CarPlay will

00:04:18.686 --> 00:04:20.096 A:middle
likely run while the iPhone is

00:04:20.096 --> 00:04:20.796 A:middle
pass code locked.

00:04:21.736 --> 00:04:22.866 A:middle
If your app has pass code

00:04:22.866 --> 00:04:24.156 A:middle
protected data using the

00:04:24.156 --> 00:04:25.696 A:middle
following types for files,

00:04:26.726 --> 00:04:29.696 A:middle
keychains or SQL like databases

00:04:29.696 --> 00:04:31.476 A:middle
shown here your data may be

00:04:31.476 --> 00:04:33.316 A:middle
unavailable while in CarPlay and

00:04:33.316 --> 00:04:34.116 A:middle
your app may behave

00:04:34.116 --> 00:04:34.856 A:middle
unexpectedly.

00:04:35.546 --> 00:04:38.626 A:middle
Let's take a closer look at

00:04:38.626 --> 00:04:39.856 A:middle
getting your app integrated with

00:04:39.856 --> 00:04:40.286 A:middle
CarPlay.

00:04:40.846 --> 00:04:42.946 A:middle
We will highlight the three

00:04:42.946 --> 00:04:44.356 A:middle
categories of apps that support

00:04:44.356 --> 00:04:46.496 A:middle
CarPlay integration, audio apps,

00:04:46.896 --> 00:04:48.366 A:middle
messaging and VoIP apps, and

00:04:48.366 --> 00:04:49.196 A:middle
automaker apps.

00:04:49.726 --> 00:04:52.186 A:middle
Let's get started with audio

00:04:52.936 --> 00:04:53.036 A:middle
apps.

00:04:54.446 --> 00:04:55.966 A:middle
Audio apps in CarPlay present

00:04:55.966 --> 00:04:57.436 A:middle
content in an interface that's

00:04:57.486 --> 00:04:58.756 A:middle
optimized for the platform

00:04:59.276 --> 00:05:00.696 A:middle
providing the user an easily

00:05:00.696 --> 00:05:02.146 A:middle
navigable way to access their

00:05:02.146 --> 00:05:02.626 A:middle
content.

00:05:03.426 --> 00:05:04.876 A:middle
Audio app developers provide a

00:05:04.876 --> 00:05:06.186 A:middle
data source, as well as a

00:05:06.186 --> 00:05:07.826 A:middle
navigation hierarchy for the

00:05:07.826 --> 00:05:09.266 A:middle
CarPlay platform to render

00:05:09.266 --> 00:05:09.756 A:middle
onscreen.

00:05:10.276 --> 00:05:13.056 A:middle
In addition, now playing

00:05:13.056 --> 00:05:14.466 A:middle
information will be presented

00:05:14.466 --> 00:05:16.006 A:middle
providing the user with relevant

00:05:16.006 --> 00:05:17.916 A:middle
metadata, as well as adjustable

00:05:17.916 --> 00:05:19.526 A:middle
commands for the user to handle

00:05:19.526 --> 00:05:21.416 A:middle
playback speeds, tracks and

00:05:21.416 --> 00:05:22.746 A:middle
other actions audio apps may

00:05:22.746 --> 00:05:23.216 A:middle
support.

00:05:25.156 --> 00:05:26.176 A:middle
After receiving the app

00:05:26.176 --> 00:05:27.506 A:middle
entitlement audio apps in

00:05:27.506 --> 00:05:29.076 A:middle
CarPlay must at a minimum

00:05:29.226 --> 00:05:30.496 A:middle
implement the MP playable

00:05:30.496 --> 00:05:32.736 A:middle
content APIs, which include the

00:05:32.736 --> 00:05:34.226 A:middle
data source and delegate in

00:05:34.226 --> 00:05:35.406 A:middle
order for CarPlay to fetch

00:05:35.406 --> 00:05:36.916 A:middle
content items and initialize

00:05:36.946 --> 00:05:37.376 A:middle
playback.

00:05:38.596 --> 00:05:40.386 A:middle
Audio apps must also respond to

00:05:40.496 --> 00:05:42.016 A:middle
MPRemoteCommandCenter events

00:05:42.566 --> 00:05:43.716 A:middle
which let the user perform

00:05:43.716 --> 00:05:45.136 A:middle
commands on your content, such

00:05:45.136 --> 00:05:47.766 A:middle
as play, pause or skip tracks.

00:05:48.536 --> 00:05:50.626 A:middle
Finally, audio apps must set and

00:05:50.626 --> 00:05:51.256 A:middle
update the

00:05:51.256 --> 00:05:52.456 A:middle
MPNowPlayingInfoCenter

00:05:52.456 --> 00:05:54.066 A:middle
dictionary which contain

00:05:54.066 --> 00:05:55.876 A:middle
metadata on the item that is

00:05:55.876 --> 00:05:57.416 A:middle
currently playing, such as item

00:05:57.416 --> 00:05:59.366 A:middle
title, artist name or duration

00:05:59.366 --> 00:05:59.646 A:middle
time.

00:06:00.166 --> 00:06:02.786 A:middle
Let's take a closer look at how

00:06:02.786 --> 00:06:04.046 A:middle
data is structured for audio

00:06:04.046 --> 00:06:04.326 A:middle
apps.

00:06:05.186 --> 00:06:06.506 A:middle
CarPlay will ask for content

00:06:06.506 --> 00:06:08.856 A:middle
items at a specific index path

00:06:08.856 --> 00:06:09.976 A:middle
using an NSIndexPath.

00:06:10.396 --> 00:06:11.606 A:middle
And this is different than how

00:06:11.606 --> 00:06:13.316 A:middle
NSIndexPath objects are used in

00:06:13.316 --> 00:06:14.016 A:middle
UITableView.

00:06:15.006 --> 00:06:16.006 A:middle
Let's go through an example

00:06:16.006 --> 00:06:17.926 A:middle
shown here where the left most

00:06:17.926 --> 00:06:19.616 A:middle
content items are the root items

00:06:19.806 --> 00:06:20.936 A:middle
and can be represented in the

00:06:20.936 --> 00:06:22.696 A:middle
user interface as individual

00:06:22.696 --> 00:06:24.246 A:middle
tabs or a root table view.

00:06:24.736 --> 00:06:27.686 A:middle
Here's the index paths for each

00:06:27.686 --> 00:06:29.156 A:middle
content item represented in the

00:06:29.156 --> 00:06:29.806 A:middle
hierarchy.

00:06:30.586 --> 00:06:32.216 A:middle
When CarPlay asks for a content

00:06:32.216 --> 00:06:33.776 A:middle
item for a particular index path

00:06:34.076 --> 00:06:35.526 A:middle
we, the audio app, would

00:06:35.526 --> 00:06:36.846 A:middle
traverse the hierarchy for the

00:06:36.846 --> 00:06:38.046 A:middle
requested content item.

00:06:38.836 --> 00:06:40.656 A:middle
In this example, we are asking

00:06:40.656 --> 00:06:42.576 A:middle
for the first child of the first

00:06:42.576 --> 00:06:44.366 A:middle
content which is the running

00:06:44.366 --> 00:06:47.636 A:middle
playlist content item.

00:06:47.846 --> 00:06:49.196 A:middle
CarPlay will also ask for the

00:06:49.196 --> 00:06:50.656 A:middle
number of child items of a

00:06:50.656 --> 00:06:51.636 A:middle
particular index.

00:06:52.196 --> 00:06:53.776 A:middle
In this example, we are asking

00:06:53.776 --> 00:06:55.056 A:middle
for the number of child items

00:06:55.206 --> 00:06:56.826 A:middle
for the third child item of the

00:06:56.826 --> 00:06:58.136 A:middle
second route content item.

00:06:59.116 --> 00:07:01.336 A:middle
In this example, we will return

00:07:01.926 --> 00:07:01.996 A:middle
two.

00:07:04.046 --> 00:07:05.356 A:middle
Some vehicles may enforce

00:07:05.356 --> 00:07:07.176 A:middle
limited content to show onscreen

00:07:07.246 --> 00:07:08.656 A:middle
depending on whether the vehicle

00:07:08.656 --> 00:07:09.206 A:middle
is in motion.

00:07:09.926 --> 00:07:11.116 A:middle
This can limit the number of

00:07:11.116 --> 00:07:13.146 A:middle
rows shown onscreen, as well as

00:07:13.146 --> 00:07:14.566 A:middle
container depth when drilling

00:07:14.566 --> 00:07:15.216 A:middle
into content.

00:07:16.016 --> 00:07:17.266 A:middle
Your app can take these changes

00:07:17.266 --> 00:07:19.026 A:middle
into account using MP Playable

00:07:19.026 --> 00:07:19.826 A:middle
Content Manager.

00:07:20.386 --> 00:07:23.086 A:middle
To check if content limits are

00:07:23.086 --> 00:07:24.806 A:middle
enforced implement the Delegate

00:07:24.806 --> 00:07:26.176 A:middle
Callback Content Manager Did

00:07:26.176 --> 00:07:28.576 A:middle
Update and check if the content

00:07:28.576 --> 00:07:29.736 A:middle
limits are enforced.

00:07:30.446 --> 00:07:31.836 A:middle
From there your app can check

00:07:31.836 --> 00:07:33.196 A:middle
the context properties to

00:07:33.196 --> 00:07:34.596 A:middle
determine how many items are

00:07:34.596 --> 00:07:36.476 A:middle
permitted in the table view and

00:07:36.476 --> 00:07:37.806 A:middle
the maximum depth in the

00:07:37.806 --> 00:07:39.416 A:middle
hierarchy your app is permitted

00:07:39.416 --> 00:07:39.776 A:middle
to show.

00:07:40.336 --> 00:07:42.816 A:middle
If your app benefits from

00:07:42.816 --> 00:07:44.446 A:middle
displaying data using tabs

00:07:44.506 --> 00:07:45.866 A:middle
rather than exclusively table

00:07:45.866 --> 00:07:48.026 A:middle
views you can add tabs by adding

00:07:48.026 --> 00:07:49.596 A:middle
UI browsable content support

00:07:49.596 --> 00:07:51.596 A:middle
section browsing in your app's

00:07:51.636 --> 00:07:52.856 A:middle
info.plist file.

00:07:53.746 --> 00:07:55.286 A:middle
We recommend having at most four

00:07:55.286 --> 00:07:57.616 A:middle
tabs with short titles due to

00:07:57.616 --> 00:07:58.766 A:middle
space constraints and for

00:07:58.766 --> 00:07:59.886 A:middle
vehicles that have a narrow

00:07:59.886 --> 00:08:01.526 A:middle
screen size, as well as

00:08:01.526 --> 00:08:02.646 A:middle
accounting for the Now Playing

00:08:02.646 --> 00:08:04.076 A:middle
button shown while content is

00:08:04.076 --> 00:08:04.376 A:middle
playing.

00:08:05.456 --> 00:08:06.666 A:middle
Tab image assets will be

00:08:06.666 --> 00:08:08.216 A:middle
rendered as template images on

00:08:08.216 --> 00:08:09.016 A:middle
the CarPlay screen.

00:08:09.016 --> 00:08:12.096 A:middle
Now let's talk about the Now

00:08:12.096 --> 00:08:13.196 A:middle
Playing screen in CarPlay.

00:08:13.866 --> 00:08:15.566 A:middle
Some controls and metadata here

00:08:15.616 --> 00:08:16.906 A:middle
are identical to what is shown

00:08:16.906 --> 00:08:17.656 A:middle
in Control Center.

00:08:18.466 --> 00:08:20.046 A:middle
In general, what controls and

00:08:20.046 --> 00:08:21.696 A:middle
data you see in Control Center

00:08:21.696 --> 00:08:23.186 A:middle
should also be presented here in

00:08:23.186 --> 00:08:24.806 A:middle
the CarPlay Now Playing screen.

00:08:25.876 --> 00:08:27.266 A:middle
This Now Playing screen can be

00:08:27.266 --> 00:08:28.766 A:middle
accessed either by the user

00:08:28.766 --> 00:08:30.356 A:middle
tapping Now Playing on the top

00:08:30.356 --> 00:08:31.596 A:middle
right of your app's navigation

00:08:31.596 --> 00:08:33.486 A:middle
interface or through the Now

00:08:33.486 --> 00:08:34.796 A:middle
Playing app on the CarPlay Home

00:08:34.796 --> 00:08:35.146 A:middle
screen.

00:08:36.236 --> 00:08:37.726 A:middle
Your app's name will appear on

00:08:37.726 --> 00:08:38.986 A:middle
the top right of the Now Playing

00:08:38.986 --> 00:08:42.116 A:middle
screen when it is active.

00:08:42.316 --> 00:08:44.116 A:middle
Setting metadata for CarPlay's

00:08:44.116 --> 00:08:45.666 A:middle
Now Playing screen is the same

00:08:45.666 --> 00:08:46.776 A:middle
as Control Center and other

00:08:46.776 --> 00:08:47.336 A:middle
sources.

00:08:47.956 --> 00:08:49.446 A:middle
Set a dictionary of information

00:08:49.446 --> 00:08:51.496 A:middle
to MPNowPlayingInfoCenter and

00:08:51.496 --> 00:08:52.806 A:middle
fill out as much of the entries

00:08:52.806 --> 00:08:53.436 A:middle
as appropriate.

00:08:53.966 --> 00:08:57.556 A:middle
In addition, respond to playback

00:08:57.556 --> 00:08:58.866 A:middle
commands so that the user can

00:08:58.866 --> 00:09:00.906 A:middle
choose to adjust content such as

00:09:00.956 --> 00:09:03.986 A:middle
play, pause, skip tracks or

00:09:03.986 --> 00:09:05.416 A:middle
shuffle and repeat of playback

00:09:05.416 --> 00:09:05.666 A:middle
queue.

00:09:06.726 --> 00:09:08.326 A:middle
These commands here are the ones

00:09:08.326 --> 00:09:09.266 A:middle
that are supported on the

00:09:09.266 --> 00:09:10.456 A:middle
CarPlay Now Playing screen.

00:09:10.996 --> 00:09:14.466 A:middle
New in iOS 11 is the ability to

00:09:14.466 --> 00:09:15.936 A:middle
adjust and display the playback

00:09:15.936 --> 00:09:17.256 A:middle
rate in the Now Playing screen.

00:09:17.916 --> 00:09:19.366 A:middle
To display playback rate in your

00:09:19.366 --> 00:09:20.456 A:middle
app's Now Playing screen in

00:09:20.456 --> 00:09:23.016 A:middle
CarPlay add MPNowPlayingInfo

00:09:23.016 --> 00:09:24.926 A:middle
PropertyDefaultPlaybackRate to

00:09:24.966 --> 00:09:26.796 A:middle
MP Now Playing Info Center and

00:09:26.796 --> 00:09:28.186 A:middle
respond to the change playback

00:09:28.186 --> 00:09:29.576 A:middle
rate command with an array of

00:09:29.576 --> 00:09:30.596 A:middle
supported rates in

00:09:30.596 --> 00:09:31.676 A:middle
MPRemoteCommandCenter.

00:09:32.166 --> 00:09:34.696 A:middle
Here is an example of how you

00:09:34.696 --> 00:09:36.006 A:middle
would implement playback rate

00:09:36.006 --> 00:09:36.876 A:middle
adjustments and code.

00:09:37.406 --> 00:09:38.806 A:middle
In this sample, the default

00:09:38.806 --> 00:09:40.146 A:middle
playback rate of the currently

00:09:40.146 --> 00:09:42.246 A:middle
playing item is 1.0 and the

00:09:42.246 --> 00:09:43.656 A:middle
supported playback rates here

00:09:43.656 --> 00:09:47.616 A:middle
are 0.5, 1.0, 1.5, and 2.0.

00:09:48.316 --> 00:09:49.566 A:middle
When the user wants to adjust

00:09:49.566 --> 00:09:51.036 A:middle
the playback speed increment the

00:09:51.036 --> 00:09:52.796 A:middle
playback rate forward cycling

00:09:52.796 --> 00:09:54.156 A:middle
back to the beginning if the

00:09:54.156 --> 00:09:55.486 A:middle
audio is playing at the fastest

00:09:55.486 --> 00:09:56.146 A:middle
supported rate.

00:09:57.046 --> 00:09:58.646 A:middle
In this code sample, playback

00:09:58.646 --> 00:10:01.056 A:middle
rate will increment to 1.5 then

00:10:01.056 --> 00:10:02.976 A:middle
2.0 and then back to 0.5.

00:10:03.976 --> 00:10:07.176 A:middle
Some audio apps may respond to

00:10:07.176 --> 00:10:08.756 A:middle
multiple commands in MP Remote

00:10:08.756 --> 00:10:09.396 A:middle
Command Center.

00:10:10.106 --> 00:10:11.326 A:middle
Depending on what commands are

00:10:11.326 --> 00:10:12.906 A:middle
enabled CarPlay's Now Playing

00:10:12.906 --> 00:10:14.526 A:middle
screen will combine certain

00:10:14.526 --> 00:10:15.966 A:middle
relevant commands into a single

00:10:15.966 --> 00:10:18.186 A:middle
button such as an ellipsis or a

00:10:18.186 --> 00:10:19.576 A:middle
menu button replacing the

00:10:19.576 --> 00:10:20.516 A:middle
previous track button.

00:10:20.626 --> 00:10:25.176 A:middle
For best practices, make sure

00:10:25.176 --> 00:10:26.536 A:middle
that content is actually ready

00:10:26.536 --> 00:10:28.096 A:middle
to be played or be displayed

00:10:28.166 --> 00:10:29.386 A:middle
before calling the completion

00:10:29.386 --> 00:10:31.286 A:middle
handlers in MP playable content

00:10:31.286 --> 00:10:32.726 A:middle
data source and MP playable

00:10:32.726 --> 00:10:33.466 A:middle
content delegate.

00:10:34.266 --> 00:10:35.576 A:middle
For apps that do not opt into

00:10:35.576 --> 00:10:37.226 A:middle
tabs and only use table views

00:10:37.756 --> 00:10:39.326 A:middle
the root table view must return

00:10:39.326 --> 00:10:40.166 A:middle
at least one item.

00:10:40.886 --> 00:10:42.306 A:middle
CarPlay would show a loading

00:10:42.306 --> 00:10:44.036 A:middle
activity indicator and will time

00:10:44.036 --> 00:10:45.816 A:middle
out after period of time if an

00:10:45.816 --> 00:10:46.916 A:middle
app has not responded with

00:10:46.916 --> 00:10:47.376 A:middle
content.

00:10:47.856 --> 00:10:49.996 A:middle
If your app has some initial

00:10:49.996 --> 00:10:51.626 A:middle
setup such as login credentials

00:10:52.066 --> 00:10:53.416 A:middle
populate the first row with an

00:10:53.416 --> 00:10:54.936 A:middle
item informing the user of the

00:10:54.936 --> 00:10:56.386 A:middle
app's current state onscreen.

00:10:57.596 --> 00:10:58.786 A:middle
That's it for enabling audio

00:10:58.786 --> 00:10:59.936 A:middle
apps and I'll hand it off to

00:10:59.936 --> 00:11:01.196 A:middle
Chris Whitney to discuss

00:11:01.226 --> 00:11:02.326 A:middle
messaging and VoIP apps in

00:11:02.326 --> 00:11:02.636 A:middle
CarPlay.

00:11:05.566 --> 00:11:06.856 A:middle
&gt;&gt; Hi, I'm Chris Whitney from

00:11:06.856 --> 00:11:08.016 A:middle
the CarPlay engineering team.

00:11:08.726 --> 00:11:10.246 A:middle
Albert talked about audio apps

00:11:10.366 --> 00:11:11.666 A:middle
now I will discuss a few more

00:11:11.666 --> 00:11:13.026 A:middle
categories of apps that can

00:11:13.026 --> 00:11:13.906 A:middle
integrate with CarPlay.

00:11:14.776 --> 00:11:16.516 A:middle
The first category I will cover

00:11:16.746 --> 00:11:18.456 A:middle
is messaging and voice over

00:11:18.456 --> 00:11:20.986 A:middle
Internet protocol calling apps.

00:11:22.086 --> 00:11:23.706 A:middle
In CarPlay Siri provides the

00:11:23.706 --> 00:11:26.036 A:middle
interface for messaging and VoIP

00:11:26.036 --> 00:11:26.806 A:middle
calling apps.

00:11:27.696 --> 00:11:29.296 A:middle
After the app icon is selected

00:11:29.296 --> 00:11:31.176 A:middle
on the Home screen, Siri offers

00:11:31.176 --> 00:11:32.556 A:middle
interactions for reading

00:11:32.556 --> 00:11:34.666 A:middle
messages, starting a new message

00:11:34.976 --> 00:11:36.196 A:middle
or starting an audio call.

00:11:37.226 --> 00:11:39.506 A:middle
Apps using SiriKit can already

00:11:39.506 --> 00:11:41.136 A:middle
handle these actions, but the

00:11:41.136 --> 00:11:43.216 A:middle
Siri request must contain the

00:11:43.216 --> 00:11:43.806 A:middle
app's name.

00:11:45.226 --> 00:11:46.566 A:middle
With a few additional changes

00:11:47.006 --> 00:11:49.626 A:middle
messaging and VoIP apps can have

00:11:49.626 --> 00:11:50.866 A:middle
a CarPlay experience that

00:11:50.866 --> 00:11:52.326 A:middle
includes a Home screen icon,

00:11:52.786 --> 00:11:54.956 A:middle
notifications, and a dedicated

00:11:54.956 --> 00:11:55.936 A:middle
Siri interface.

00:11:56.476 --> 00:12:00.606 A:middle
Here are the requirements for an

00:12:00.606 --> 00:12:02.606 A:middle
app to support messaging or VoIP

00:12:02.606 --> 00:12:03.746 A:middle
calling in CarPlay.

00:12:05.386 --> 00:12:07.326 A:middle
Messaging apps must implement

00:12:07.326 --> 00:12:09.706 A:middle
SirKit messaging intents and

00:12:09.706 --> 00:12:10.626 A:middle
sign their app with an

00:12:10.626 --> 00:12:11.976 A:middle
entitlement that is specific to

00:12:11.976 --> 00:12:12.796 A:middle
CarPlay messaging.

00:12:14.336 --> 00:12:16.906 A:middle
Similarly, VoIP calling apps

00:12:17.136 --> 00:12:18.816 A:middle
must implement the SiriKit

00:12:18.816 --> 00:12:20.776 A:middle
calling intents and sign their

00:12:20.776 --> 00:12:22.116 A:middle
app with an entitlement that is

00:12:22.116 --> 00:12:23.656 A:middle
specific to CarPlay VoIP

00:12:23.656 --> 00:12:24.016 A:middle
calling.

00:12:25.336 --> 00:12:27.046 A:middle
VoIP calling apps must also

00:12:27.046 --> 00:12:28.966 A:middle
implement CallKit to inform

00:12:28.966 --> 00:12:30.436 A:middle
CarPlay about the status of

00:12:30.436 --> 00:12:30.756 A:middle
calls.

00:12:31.426 --> 00:12:34.346 A:middle
A single app can support both

00:12:34.346 --> 00:12:36.286 A:middle
messaging and VoIP calling in

00:12:36.286 --> 00:12:36.686 A:middle
CarPlay.

00:12:38.106 --> 00:12:39.366 A:middle
Let's look into the SiriKit

00:12:39.366 --> 00:12:43.396 A:middle
requirements in more detail.

00:12:43.546 --> 00:12:46.466 A:middle
For messaging apps, Siri sends

00:12:46.466 --> 00:12:47.636 A:middle
messages using

00:12:47.826 --> 00:12:49.056 A:middle
INSendMessageIntent.

00:12:50.626 --> 00:12:53.146 A:middle
Siri reads new incoming messages

00:12:53.526 --> 00:12:55.296 A:middle
and searches for unread messages

00:12:55.546 --> 00:12:57.576 A:middle
using INSearchforMessagesIntent.

00:12:58.506 --> 00:13:00.756 A:middle
And once done reading Siri marks

00:13:00.756 --> 00:13:02.656 A:middle
messages as read by calling

00:13:02.846 --> 00:13:04.626 A:middle
INSendMessageAttributeIntent.

00:13:05.666 --> 00:13:07.646 A:middle
All three intents are required

00:13:07.646 --> 00:13:09.296 A:middle
to support a complete messaging

00:13:09.296 --> 00:13:10.576 A:middle
workflow in CarPlay.

00:13:11.166 --> 00:13:15.626 A:middle
For VoIP calling apps, Siri

00:13:15.626 --> 00:13:17.946 A:middle
starts audio calls using

00:13:18.156 --> 00:13:20.916 A:middle
INStartAudiCallIntent and

00:13:21.526 --> 00:13:23.466 A:middle
performs searches, such as for

00:13:23.466 --> 00:13:25.336 A:middle
missed calls using

00:13:25.486 --> 00:13:27.146 A:middle
INSearchCallHistoryIntent.

00:13:28.386 --> 00:13:30.046 A:middle
Both intents are required to

00:13:30.046 --> 00:13:31.526 A:middle
support a complete calling

00:13:31.526 --> 00:13:33.546 A:middle
workflow in CarPlay.

00:13:34.526 --> 00:13:36.986 A:middle
For details on SirKit see the

00:13:36.986 --> 00:13:39.176 A:middle
session's What's New in SiriKit

00:13:39.716 --> 00:13:41.736 A:middle
and Making Great SiriKit

00:13:41.736 --> 00:13:42.386 A:middle
Experiences.

00:13:42.476 --> 00:13:46.956 A:middle
Any app that has already

00:13:46.956 --> 00:13:49.176 A:middle
implemented CallKit gets a

00:13:49.176 --> 00:13:50.886 A:middle
CarPlay interface for incoming

00:13:50.986 --> 00:13:51.816 A:middle
and active calls.

00:13:52.836 --> 00:13:54.096 A:middle
But if your VoIP calling app

00:13:54.476 --> 00:13:56.186 A:middle
hasn't implemented CallKit yet

00:13:56.806 --> 00:13:58.136 A:middle
that will be a requirement for

00:13:58.136 --> 00:13:59.046 A:middle
CarPlay integration.

00:14:00.016 --> 00:14:02.226 A:middle
As a general overview, the app

00:14:02.226 --> 00:14:04.396 A:middle
must report incoming calls to

00:14:04.396 --> 00:14:07.166 A:middle
CallKit and handle the start,

00:14:07.416 --> 00:14:09.266 A:middle
answer and end call actions.

00:14:10.446 --> 00:14:11.666 A:middle
Additional actions, such as

00:14:11.666 --> 00:14:14.256 A:middle
mute, grouping, holding and

00:14:14.256 --> 00:14:16.616 A:middle
keypad tones should be handled

00:14:16.616 --> 00:14:18.366 A:middle
if supported by the app's VoIP

00:14:18.496 --> 00:14:18.976 A:middle
platform.

00:14:20.746 --> 00:14:22.236 A:middle
For more details on CallKit

00:14:22.936 --> 00:14:24.576 A:middle
watch the enhancing VoIP apps

00:14:24.576 --> 00:14:26.256 A:middle
with CallKit video from WWDC

00:14:26.256 --> 00:14:28.216 A:middle
2016.

00:14:30.686 --> 00:14:32.426 A:middle
Apps can show notifications in

00:14:32.426 --> 00:14:34.486 A:middle
CarPlay for incoming messages

00:14:34.836 --> 00:14:35.726 A:middle
and missed calls.

00:14:36.546 --> 00:14:37.706 A:middle
There's some additional setup

00:14:37.706 --> 00:14:39.306 A:middle
required to show notifications

00:14:39.306 --> 00:14:39.746 A:middle
in CarPlay.

00:14:40.376 --> 00:14:42.886 A:middle
The CarPlay option must be

00:14:42.886 --> 00:14:44.136 A:middle
included when requesting

00:14:44.136 --> 00:14:45.936 A:middle
authorization for notifications

00:14:46.336 --> 00:14:48.826 A:middle
and the messages must be

00:14:48.826 --> 00:14:50.976 A:middle
separated into a notification

00:14:50.976 --> 00:14:53.416 A:middle
category created with the Allow

00:14:53.416 --> 00:14:54.666 A:middle
in CarPlay option.

00:14:55.916 --> 00:14:58.206 A:middle
This notifications category must

00:14:58.206 --> 00:15:00.256 A:middle
be used exclusively for messages

00:15:00.456 --> 00:15:01.876 A:middle
and it should not include

00:15:01.956 --> 00:15:03.226 A:middle
notifications for other app

00:15:03.226 --> 00:15:03.746 A:middle
features.

00:15:04.296 --> 00:15:08.486 A:middle
The notification category must

00:15:08.486 --> 00:15:11.036 A:middle
specify a SiriKit intent to

00:15:11.036 --> 00:15:11.956 A:middle
handle selection of the

00:15:11.956 --> 00:15:15.296 A:middle
notification in CarPlay.

00:15:15.406 --> 00:15:17.286 A:middle
Only messaging or VoIP calling

00:15:17.286 --> 00:15:18.566 A:middle
apps that meet the CarPlay

00:15:18.566 --> 00:15:20.036 A:middle
requirements will be allowed to

00:15:20.036 --> 00:15:21.486 A:middle
request authorization for

00:15:21.486 --> 00:15:22.696 A:middle
showing notifications.

00:15:24.386 --> 00:15:26.356 A:middle
Also, users can use the Settings

00:15:26.356 --> 00:15:28.466 A:middle
op to disable showing your app's

00:15:28.466 --> 00:15:29.846 A:middle
notifications in CarPlay.

00:15:31.666 --> 00:15:32.536 A:middle
Let's look at the code for

00:15:32.536 --> 00:15:33.726 A:middle
setting up notifications in

00:15:33.726 --> 00:15:33.976 A:middle
CarPlay.

00:15:36.816 --> 00:15:38.706 A:middle
First, include the CarPlay

00:15:38.706 --> 00:15:39.976 A:middle
option when requesting

00:15:40.046 --> 00:15:41.586 A:middle
authorization for notifications.

00:15:42.966 --> 00:15:45.226 A:middle
Gracefully disable notifications

00:15:45.226 --> 00:15:47.176 A:middle
related features if the user

00:15:47.176 --> 00:15:48.566 A:middle
declines notification

00:15:48.616 --> 00:15:49.336 A:middle
authorization.

00:15:50.446 --> 00:15:52.546 A:middle
Next, create a new message

00:15:52.546 --> 00:15:54.566 A:middle
category that contains only

00:15:54.566 --> 00:15:56.186 A:middle
notifications for messages.

00:15:56.656 --> 00:15:57.976 A:middle
Notifications for other app

00:15:57.976 --> 00:16:00.596 A:middle
features, such as news or games

00:16:00.816 --> 00:16:02.126 A:middle
should not be included in this

00:16:02.126 --> 00:16:03.276 A:middle
notification category.

00:16:03.756 --> 00:16:06.066 A:middle
Assign an identifier to this

00:16:06.066 --> 00:16:08.136 A:middle
category and make sure that any

00:16:08.136 --> 00:16:10.286 A:middle
local or remote notifications

00:16:10.626 --> 00:16:12.686 A:middle
for messages have the same

00:16:12.686 --> 00:16:13.826 A:middle
category identifier.

00:16:14.366 --> 00:16:17.906 A:middle
Set up an intent identifier to

00:16:17.906 --> 00:16:19.706 A:middle
configure the Siri interaction

00:16:20.456 --> 00:16:21.446 A:middle
when the notification is

00:16:21.446 --> 00:16:22.316 A:middle
selected in CarPlay.

00:16:23.536 --> 00:16:24.646 A:middle
Usually that will be

00:16:24.896 --> 00:16:25.966 A:middle
INSearchForMessages

00:16:25.966 --> 00:16:27.596 A:middle
IntentIdentifier which

00:16:27.596 --> 00:16:29.386 A:middle
configures Siri to search for

00:16:29.566 --> 00:16:31.386 A:middle
and then read the message that

00:16:31.386 --> 00:16:32.756 A:middle
matches this notification.

00:16:33.276 --> 00:16:36.346 A:middle
There are a few best practices

00:16:36.346 --> 00:16:37.536 A:middle
to follow when building

00:16:37.536 --> 00:16:40.136 A:middle
messaging and VoIP calling apps.

00:16:41.006 --> 00:16:42.466 A:middle
Notifications should only

00:16:42.466 --> 00:16:43.776 A:middle
include information like the

00:16:43.776 --> 00:16:46.066 A:middle
sender and group name in the

00:16:46.066 --> 00:16:47.016 A:middle
title and subtitle.

00:16:47.546 --> 00:16:49.526 A:middle
The contents of a message should

00:16:49.526 --> 00:16:50.716 A:middle
not appear in CarPlay.

00:16:51.286 --> 00:16:54.476 A:middle
After reading a message, Siri

00:16:54.476 --> 00:16:55.036 A:middle
will use

00:16:55.186 --> 00:16:57.286 A:middle
INSentMessageAttributeIntent to

00:16:57.286 --> 00:16:58.376 A:middle
mark content as read.

00:16:59.466 --> 00:17:00.346 A:middle
The read status should be

00:17:00.346 --> 00:17:02.056 A:middle
reflected in the app and

00:17:02.056 --> 00:17:03.646 A:middle
subsequent search for messages

00:17:03.846 --> 00:17:04.266 A:middle
requests.

00:17:05.126 --> 00:17:08.466 A:middle
Since users may drive in and out

00:17:08.466 --> 00:17:10.866 A:middle
of cellular coverage areas apps

00:17:10.866 --> 00:17:12.066 A:middle
should use notifications to

00:17:12.066 --> 00:17:14.636 A:middle
communicate any missed calls or

00:17:14.636 --> 00:17:15.996 A:middle
message delivery failures.

00:17:17.336 --> 00:17:18.516 A:middle
This may require setting up

00:17:18.516 --> 00:17:19.776 A:middle
additional notification

00:17:19.776 --> 00:17:21.376 A:middle
categories as we have described

00:17:21.376 --> 00:17:21.696 A:middle
earlier.

00:17:22.256 --> 00:17:26.906 A:middle
The final category of apps that

00:17:26.906 --> 00:17:28.496 A:middle
can integrate into CarPlay are

00:17:28.496 --> 00:17:30.066 A:middle
automaker apps.

00:17:32.026 --> 00:17:33.686 A:middle
Automaker apps are the only

00:17:33.686 --> 00:17:35.006 A:middle
category of apps that can

00:17:35.006 --> 00:17:36.746 A:middle
display a custom user interface

00:17:36.746 --> 00:17:37.266 A:middle
in CarPlay.

00:17:38.176 --> 00:17:39.966 A:middle
In this example, the automaker

00:17:39.966 --> 00:17:41.246 A:middle
app provides controls for

00:17:41.246 --> 00:17:42.436 A:middle
adjusting the climate settings,

00:17:43.016 --> 00:17:45.256 A:middle
selecting radio stations, and

00:17:45.256 --> 00:17:46.626 A:middle
summoning roadside assistance.

00:17:47.856 --> 00:17:49.426 A:middle
Providing these controls in an

00:17:49.426 --> 00:17:51.866 A:middle
automaker app allows the user to

00:17:51.866 --> 00:17:53.136 A:middle
adjust the vehicle's climate and

00:17:53.136 --> 00:17:55.036 A:middle
radio without leaving CarPlay.

00:17:55.556 --> 00:17:58.306 A:middle
Automaker apps can take

00:17:58.306 --> 00:17:59.366 A:middle
advantage of the iPhone's

00:17:59.366 --> 00:18:00.866 A:middle
Internet connectivity and

00:18:00.866 --> 00:18:02.896 A:middle
powerful development platform to

00:18:02.896 --> 00:18:04.036 A:middle
create additional vehicle

00:18:04.036 --> 00:18:04.606 A:middle
features.

00:18:05.176 --> 00:18:07.406 A:middle
For example, this automaker app

00:18:07.676 --> 00:18:09.316 A:middle
could enable Siri driven voice

00:18:09.316 --> 00:18:11.406 A:middle
control of the climate and radio

00:18:11.406 --> 00:18:11.846 A:middle
settings.

00:18:15.606 --> 00:18:17.176 A:middle
Automaker apps must be created

00:18:17.176 --> 00:18:18.816 A:middle
by the car's manufacturer to

00:18:18.816 --> 00:18:20.496 A:middle
provide information and control

00:18:20.496 --> 00:18:22.046 A:middle
features on a connected vehicle.

00:18:22.546 --> 00:18:25.366 A:middle
These apps must be signed with a

00:18:25.366 --> 00:18:27.106 A:middle
specific CarPlay protocols

00:18:27.106 --> 00:18:27.756 A:middle
entitlement.

00:18:28.996 --> 00:18:30.826 A:middle
They must display a user

00:18:30.826 --> 00:18:31.906 A:middle
interface in CarPlay.

00:18:32.896 --> 00:18:35.516 A:middle
And they must only appear on

00:18:35.516 --> 00:18:37.186 A:middle
supported vehicles.

00:18:39.626 --> 00:18:40.686 A:middle
CarPlay determines if an

00:18:40.736 --> 00:18:42.486 A:middle
automaker app is supported on a

00:18:42.486 --> 00:18:44.576 A:middle
given vehicle by matching the

00:18:44.576 --> 00:18:46.206 A:middle
external accessory protocols

00:18:46.456 --> 00:18:48.356 A:middle
declared by the vehicle with the

00:18:48.356 --> 00:18:50.096 A:middle
CarPlay protocols entitlement

00:18:50.516 --> 00:18:53.036 A:middle
sign in to the app.

00:18:53.036 --> 00:18:53.996 A:middle
Thus, it is important to

00:18:53.996 --> 00:18:55.726 A:middle
consider potential automaker

00:18:55.726 --> 00:18:58.316 A:middle
apps during vehicle development

00:18:58.616 --> 00:18:59.946 A:middle
in order to have the appropriate

00:18:59.946 --> 00:19:01.636 A:middle
set of protocols declared by the

00:19:01.636 --> 00:19:02.046 A:middle
vehicle.

00:19:02.536 --> 00:19:05.576 A:middle
Here's an example of how CarPlay

00:19:05.576 --> 00:19:07.226 A:middle
matches automaker apps to

00:19:07.226 --> 00:19:07.646 A:middle
vehicles.

00:19:08.346 --> 00:19:10.786 A:middle
This vehicle declares two

00:19:10.786 --> 00:19:12.606 A:middle
protocols, a performance

00:19:12.646 --> 00:19:14.186 A:middle
protocol for collecting vehicle

00:19:14.186 --> 00:19:16.806 A:middle
statistics and a protocol for

00:19:16.806 --> 00:19:17.486 A:middle
climate control.

00:19:18.686 --> 00:19:20.506 A:middle
As shown here, protocol names

00:19:20.506 --> 00:19:21.676 A:middle
should be declared in reverse

00:19:21.926 --> 00:19:22.766 A:middle
DNS format.

00:19:23.416 --> 00:19:27.326 A:middle
The automaker wants to take

00:19:27.326 --> 00:19:28.446 A:middle
advantage of the vehicle's

00:19:28.446 --> 00:19:30.306 A:middle
performance statistics in a new

00:19:30.306 --> 00:19:33.156 A:middle
app called Track Laps that's

00:19:33.156 --> 00:19:34.426 A:middle
designed for use on racetracks.

00:19:35.556 --> 00:19:36.796 A:middle
The app includes the performance

00:19:36.826 --> 00:19:38.076 A:middle
protocol and its entitlements

00:19:38.866 --> 00:19:41.706 A:middle
and since both the app and the

00:19:41.706 --> 00:19:43.166 A:middle
vehicle support the performance

00:19:43.166 --> 00:19:47.126 A:middle
protocol the Track Laps app will

00:19:47.126 --> 00:19:49.886 A:middle
appear in CarPlay.

00:19:51.666 --> 00:19:53.796 A:middle
Automaker apps can also support

00:19:53.796 --> 00:19:54.826 A:middle
multiple protocols.

00:19:56.116 --> 00:19:57.896 A:middle
This automaker decides to follow

00:19:57.896 --> 00:19:59.516 A:middle
up on the success of Track Laps

00:19:59.986 --> 00:20:02.016 A:middle
with a new app called Comfort

00:20:02.016 --> 00:20:03.956 A:middle
Cruise that conveniently

00:20:03.956 --> 00:20:05.836 A:middle
configures the radio and climate

00:20:05.836 --> 00:20:07.016 A:middle
control with the driver's

00:20:07.056 --> 00:20:08.356 A:middle
favorite settings for commuting.

00:20:09.686 --> 00:20:10.856 A:middle
The app's entitlements include

00:20:10.856 --> 00:20:13.406 A:middle
both the climate protocol and a

00:20:13.406 --> 00:20:14.376 A:middle
new radio protocol.

00:20:14.986 --> 00:20:17.366 A:middle
This vehicle doesn't support the

00:20:17.366 --> 00:20:19.206 A:middle
radio protocol, but since both

00:20:19.206 --> 00:20:21.366 A:middle
the app and the vehicle support

00:20:21.366 --> 00:20:24.266 A:middle
the climate protocol the Comfort

00:20:24.266 --> 00:20:25.456 A:middle
Cruise app will appear in

00:20:25.456 --> 00:20:25.816 A:middle
CarPlay.

00:20:27.226 --> 00:20:28.986 A:middle
After launching automaker apps

00:20:29.266 --> 00:20:30.646 A:middle
should query the supported

00:20:30.646 --> 00:20:32.906 A:middle
external accessory protocols and

00:20:32.906 --> 00:20:34.466 A:middle
only display a user interface

00:20:35.226 --> 00:20:36.486 A:middle
for the supported features.

00:20:37.416 --> 00:20:39.156 A:middle
In this example, the Comfort

00:20:39.156 --> 00:20:40.736 A:middle
Cruise app should only show

00:20:40.736 --> 00:20:42.796 A:middle
climate controls since the radio

00:20:42.796 --> 00:20:44.576 A:middle
protocol is not supported on

00:20:44.576 --> 00:20:44.976 A:middle
this vehicle.

00:20:49.086 --> 00:20:50.586 A:middle
The automaker wants to create

00:20:50.586 --> 00:20:52.926 A:middle
another app called Charge Up

00:20:53.446 --> 00:20:54.456 A:middle
that shows their electric

00:20:54.456 --> 00:20:55.666 A:middle
vehicle charging stations.

00:20:56.406 --> 00:20:58.086 A:middle
To limit this app to only their

00:20:58.086 --> 00:20:59.926 A:middle
electric vehicles the automaker

00:20:59.926 --> 00:21:02.476 A:middle
declares a new electric protocol

00:21:02.766 --> 00:21:03.836 A:middle
in the app's entitlements.

00:21:04.446 --> 00:21:07.266 A:middle
Since this vehicle does not

00:21:07.266 --> 00:21:08.666 A:middle
support the electric protocol

00:21:09.296 --> 00:21:10.976 A:middle
the Charge Up app will not

00:21:10.976 --> 00:21:12.516 A:middle
appear in CarPlay on this

00:21:13.146 --> 00:21:13.366 A:middle
vehicle.

00:21:16.386 --> 00:21:17.446 A:middle
Building an automaker app

00:21:17.686 --> 00:21:18.986 A:middle
requires communicating with the

00:21:18.986 --> 00:21:19.366 A:middle
vehicle.

00:21:20.636 --> 00:21:22.486 A:middle
Automaker apps must communicate

00:21:22.486 --> 00:21:24.216 A:middle
directly from the iPhone to the

00:21:24.216 --> 00:21:25.956 A:middle
vehicle using the External

00:21:25.956 --> 00:21:26.816 A:middle
Accessory framework.

00:21:27.876 --> 00:21:29.526 A:middle
Directly communicating using

00:21:29.526 --> 00:21:31.516 A:middle
External Accessory improves the

00:21:31.516 --> 00:21:33.676 A:middle
responsiveness of the app and

00:21:33.676 --> 00:21:35.396 A:middle
avoids relying on connectivity

00:21:35.396 --> 00:21:36.356 A:middle
to Internet services.

00:21:37.646 --> 00:21:38.906 A:middle
To use the External Accessory

00:21:38.906 --> 00:21:41.326 A:middle
framework the app should define

00:21:41.326 --> 00:21:43.086 A:middle
a custom protocol name as shown

00:21:43.086 --> 00:21:45.706 A:middle
previously, implement the named

00:21:45.706 --> 00:21:46.996 A:middle
protocol in the vehicle

00:21:46.996 --> 00:21:50.646 A:middle
software, in the app observe

00:21:50.646 --> 00:21:53.146 A:middle
accessory connection events, and

00:21:53.146 --> 00:21:55.296 A:middle
upon connection initialize an EA

00:21:55.296 --> 00:21:56.656 A:middle
session to create networking

00:21:56.656 --> 00:21:57.686 A:middle
streams of the vehicle.

00:21:58.996 --> 00:22:01.036 A:middle
For more information see

00:22:01.036 --> 00:22:02.816 A:middle
External Accessory programming

00:22:03.486 --> 00:22:03.696 A:middle
topics.

00:22:05.716 --> 00:22:08.046 A:middle
Automaker apps can use UIKit to

00:22:08.046 --> 00:22:09.576 A:middle
display a user interface on the

00:22:09.576 --> 00:22:10.296 A:middle
CarPlay screen.

00:22:11.396 --> 00:22:12.456 A:middle
To create an interface in

00:22:12.456 --> 00:22:15.196 A:middle
CarPlay the app should observe

00:22:15.196 --> 00:22:16.716 A:middle
the UIScreen connection events

00:22:18.066 --> 00:22:19.146 A:middle
and when the screen connects

00:22:19.266 --> 00:22:20.316 A:middle
verify that the connected

00:22:20.316 --> 00:22:22.096 A:middle
screen's traits contain the

00:22:22.096 --> 00:22:22.866 A:middle
CarPlay idiom.

00:22:24.256 --> 00:22:26.106 A:middle
Besides CarPlay, iOS also

00:22:26.106 --> 00:22:27.396 A:middle
supports other external

00:22:27.396 --> 00:22:29.166 A:middle
displays, such as an airplane

00:22:29.166 --> 00:22:29.516 A:middle
display.

00:22:30.746 --> 00:22:32.906 A:middle
Only show CarPlay content on

00:22:32.906 --> 00:22:34.286 A:middle
screens with the CarPlay idiom.

00:22:34.836 --> 00:22:39.636 A:middle
The app creates a UIWindow for

00:22:39.636 --> 00:22:41.656 A:middle
the CarPlay screen and sets the

00:22:41.656 --> 00:22:43.676 A:middle
root view controller to a custom

00:22:43.676 --> 00:22:44.956 A:middle
UI view controller subclass.

00:22:46.436 --> 00:22:47.566 A:middle
Let's see how this looks when

00:22:47.566 --> 00:22:47.956 A:middle
all put together.

00:22:51.856 --> 00:22:53.076 A:middle
Here's the code for displaying a

00:22:53.076 --> 00:22:54.356 A:middle
view controller on the CarPlay

00:22:54.356 --> 00:22:54.776 A:middle
screen.

00:22:55.766 --> 00:22:56.856 A:middle
Usually this code would be

00:22:56.856 --> 00:22:58.256 A:middle
placed either in your UI

00:22:58.256 --> 00:23:01.066 A:middle
application delegate or in a new

00:23:01.066 --> 00:23:02.316 A:middle
class you've made for this code.

00:23:03.476 --> 00:23:05.366 A:middle
First, we'll add a new class

00:23:05.396 --> 00:23:07.166 A:middle
property to store the UIWindow

00:23:07.916 --> 00:23:08.756 A:middle
that we will create for the

00:23:08.756 --> 00:23:09.506 A:middle
CarPlay screen.

00:23:10.386 --> 00:23:12.026 A:middle
Next, we'll define an instance

00:23:12.026 --> 00:23:13.856 A:middle
method called updateCarWindow.

00:23:15.026 --> 00:23:16.266 A:middle
To check if a CarPlay screen is

00:23:16.266 --> 00:23:18.506 A:middle
connected we look for a UIScreen

00:23:18.786 --> 00:23:19.896 A:middle
that has the CarPlay idiom.

00:23:21.086 --> 00:23:22.666 A:middle
If no CarPlay idiom screens are

00:23:22.666 --> 00:23:24.476 A:middle
available then release any

00:23:24.476 --> 00:23:26.016 A:middle
previously created UIWindow

00:23:26.856 --> 00:23:27.816 A:middle
since CarPlay may have

00:23:28.016 --> 00:23:28.646 A:middle
disconnected.

00:23:29.196 --> 00:23:32.566 A:middle
If a CarPlay screen is connected

00:23:33.306 --> 00:23:35.276 A:middle
initialize a new UIWindow for

00:23:35.276 --> 00:23:37.586 A:middle
that screen and set up a custom

00:23:37.586 --> 00:23:39.616 A:middle
rootViewController that contains

00:23:39.616 --> 00:23:40.656 A:middle
the content that should appear

00:23:40.656 --> 00:23:41.106 A:middle
in CarPlay.

00:23:42.146 --> 00:23:43.716 A:middle
Here we are using a UI view

00:23:43.716 --> 00:23:45.536 A:middle
controller subclass called

00:23:45.736 --> 00:23:46.626 A:middle
carViewController.

00:23:47.676 --> 00:23:48.606 A:middle
That class will need to be

00:23:48.606 --> 00:23:49.086 A:middle
implemented.

00:23:49.586 --> 00:23:53.796 A:middle
Your app may launch after

00:23:53.796 --> 00:23:54.576 A:middle
CarPlay connected.

00:23:55.446 --> 00:23:57.096 A:middle
To handle that scenario call

00:23:57.096 --> 00:23:58.986 A:middle
updateCarWindow early in your

00:23:58.986 --> 00:24:00.856 A:middle
application's lifecycle, such as

00:24:00.856 --> 00:24:02.186 A:middle
an application did finish

00:24:02.186 --> 00:24:03.016 A:middle
launching with options.

00:24:04.376 --> 00:24:05.806 A:middle
Since CarPlay can also connect

00:24:05.806 --> 00:24:07.326 A:middle
after your app is launched

00:24:07.746 --> 00:24:08.236 A:middle
listen for the

00:24:08.236 --> 00:24:10.086 A:middle
UIScreenDidConnect and

00:24:10.086 --> 00:24:11.676 A:middle
UIScreenDidDisconnect

00:24:12.116 --> 00:24:14.056 A:middle
notifications and call

00:24:14.056 --> 00:24:15.846 A:middle
UpdateCarWindow in response to

00:24:15.846 --> 00:24:17.086 A:middle
those events.

00:24:18.676 --> 00:24:19.996 A:middle
There are a few differences in

00:24:19.996 --> 00:24:21.736 A:middle
UIKit behavior on the CarPlay

00:24:21.736 --> 00:24:23.776 A:middle
screen compared to the iPhone's

00:24:24.346 --> 00:24:25.486 A:middle
main screen.

00:24:25.686 --> 00:24:27.556 A:middle
UIButtonTypeSystem displays with

00:24:27.556 --> 00:24:29.476 A:middle
the default CarPlay style and is

00:24:29.476 --> 00:24:30.976 A:middle
the recommended way to create

00:24:30.976 --> 00:24:32.946 A:middle
buttons since it provides a

00:24:32.946 --> 00:24:34.856 A:middle
style and behavior consistent

00:24:34.856 --> 00:24:36.866 A:middle
with other CarPlay apps.

00:24:38.096 --> 00:24:38.726 A:middle
In CarPlay,

00:24:38.986 --> 00:24:41.116 A:middle
UITableViewController may limit

00:24:41.116 --> 00:24:44.006 A:middle
the length of tables and for

00:24:44.006 --> 00:24:45.106 A:middle
vehicles with a hardware

00:24:45.106 --> 00:24:47.186 A:middle
navigation device, such as the

00:24:48.096 --> 00:24:48.856 A:middle
[inaudible], the corresponding

00:24:48.856 --> 00:24:50.476 A:middle
focus movements are handled

00:24:50.476 --> 00:24:52.546 A:middle
through UIFocusEnvironment and

00:24:52.546 --> 00:24:53.796 A:middle
the related focus classes.

00:24:54.416 --> 00:24:57.976 A:middle
Note that not all system user

00:24:57.976 --> 00:24:59.676 A:middle
interface elements provided by

00:24:59.676 --> 00:25:01.546 A:middle
UIKit are available to automaker

00:25:02.536 --> 00:25:02.626 A:middle
apps.

00:25:05.086 --> 00:25:06.176 A:middle
There's a selection of SiriKit

00:25:06.176 --> 00:25:07.776 A:middle
intents relevant to automaker

00:25:07.776 --> 00:25:08.076 A:middle
apps.

00:25:09.396 --> 00:25:10.806 A:middle
The commands intents are

00:25:10.806 --> 00:25:11.856 A:middle
available to all apps.

00:25:12.346 --> 00:25:13.526 A:middle
They don't require a CarPlay

00:25:13.526 --> 00:25:15.336 A:middle
connection nor participating in

00:25:15.336 --> 00:25:16.436 A:middle
the CarPlay app program.

00:25:17.316 --> 00:25:18.956 A:middle
But an automaker app is a great

00:25:18.956 --> 00:25:19.916 A:middle
place to implement these

00:25:19.916 --> 00:25:22.016 A:middle
intents, which include locking

00:25:22.016 --> 00:25:23.496 A:middle
the vehicle, checking the fuel

00:25:23.496 --> 00:25:26.436 A:middle
level and sounding the horn.

00:25:26.596 --> 00:25:27.826 A:middle
There's also a set of intents

00:25:28.086 --> 00:25:29.216 A:middle
that require a CarPlay

00:25:29.216 --> 00:25:30.766 A:middle
connection and can only be

00:25:30.766 --> 00:25:32.246 A:middle
implemented by automaker apps.

00:25:33.516 --> 00:25:35.176 A:middle
The CarPlay intents include

00:25:35.176 --> 00:25:37.176 A:middle
climate control, defroster and

00:25:37.176 --> 00:25:38.156 A:middle
seat heater settings.

00:25:39.136 --> 00:25:40.976 A:middle
Also included are intents for

00:25:41.036 --> 00:25:42.756 A:middle
tuning the radio and selecting

00:25:42.786 --> 00:25:43.396 A:middle
an audio source.

00:25:44.026 --> 00:25:47.286 A:middle
There are a few best practices

00:25:47.286 --> 00:25:48.176 A:middle
for automaker apps.

00:25:49.176 --> 00:25:50.906 A:middle
The first is to make your app

00:25:50.906 --> 00:25:52.456 A:middle
useful even when CarPlay is not

00:25:52.456 --> 00:25:52.916 A:middle
available.

00:25:53.646 --> 00:25:55.256 A:middle
For example, when disconnected

00:25:55.256 --> 00:25:57.046 A:middle
from CarPlay an automaker app

00:25:57.046 --> 00:25:58.646 A:middle
can use Internet services to

00:25:58.646 --> 00:26:00.926 A:middle
remotely communicate with the

00:26:02.206 --> 00:26:02.436 A:middle
vehicle.

00:26:02.516 --> 00:26:04.026 A:middle
Consider backwards and forwards

00:26:04.176 --> 00:26:06.456 A:middle
compatibility in your automaker

00:26:07.776 --> 00:26:07.876 A:middle
app.

00:26:07.876 --> 00:26:09.306 A:middle
App updates should continue to

00:26:09.306 --> 00:26:11.396 A:middle
support older vehicles and new

00:26:11.396 --> 00:26:12.946 A:middle
features should not break

00:26:12.946 --> 00:26:16.916 A:middle
existing versions of the app.

00:26:17.006 --> 00:26:18.426 A:middle
Simplify the user interface,

00:26:19.246 --> 00:26:21.146 A:middle
most CarPlay apps should only

00:26:21.146 --> 00:26:22.876 A:middle
contain fundamental interface

00:26:22.876 --> 00:26:25.396 A:middle
elements, such as buttons,

00:26:25.896 --> 00:26:28.746 A:middle
labels, tables, navigation bars

00:26:29.356 --> 00:26:30.676 A:middle
and tabs.

00:26:32.106 --> 00:26:33.696 A:middle
Finally, if your automaker app

00:26:33.696 --> 00:26:34.786 A:middle
supports vehicles with a

00:26:34.786 --> 00:26:37.116 A:middle
hardware navigation device such

00:26:37.116 --> 00:26:38.866 A:middle
as a [inaudible] determine how

00:26:38.866 --> 00:26:40.686 A:middle
focus should move between the UI

00:26:40.686 --> 00:26:40.976 A:middle
elements.

00:26:44.506 --> 00:26:45.506 A:middle
We hope that you've learned how

00:26:45.506 --> 00:26:47.036 A:middle
to integrate an audio,

00:26:47.036 --> 00:26:49.006 A:middle
messaging, VoIP calling or

00:26:49.006 --> 00:26:50.366 A:middle
automaker app into CarPlay.

00:26:51.006 --> 00:26:52.056 A:middle
For more information about

00:26:52.056 --> 00:26:53.126 A:middle
CarPlay, see

00:26:53.126 --> 00:26:56.226 A:middle
developer.apple.com.

00:26:56.436 --> 00:26:57.716 A:middle
You can also learn more in

00:26:57.716 --> 00:26:58.776 A:middle
related sessions.

00:26:59.456 --> 00:27:00.926 A:middle
See the Debugging with Xcode 9

00:27:00.926 --> 00:27:02.306 A:middle
session for more information

00:27:02.306 --> 00:27:04.236 A:middle
about debugging apps during a

00:27:04.236 --> 00:27:05.376 A:middle
wired CarPlay connection.

00:27:06.266 --> 00:27:07.246 A:middle
For more information about

00:27:07.286 --> 00:27:09.946 A:middle
SiriKit, see the sessions What's

00:27:09.946 --> 00:27:11.986 A:middle
New in SiriKit and Making Great

00:27:11.986 --> 00:27:13.016 A:middle
SiriKit Experiences.

00:27:14.266 --> 00:27:15.356 A:middle
To learn how wireless CarPlay

00:27:15.356 --> 00:27:16.906 A:middle
works watch the Developing

00:27:16.906 --> 00:27:18.476 A:middle
Wireless CarPlay Systems video.

00:27:19.596 --> 00:27:22.096 A:middle
Videos from WWDC 2016 are

00:27:22.096 --> 00:27:24.026 A:middle
available for both CallKit and

00:27:24.026 --> 00:27:25.546 A:middle
CarPlay systems development

00:27:26.296 --> 00:27:26.476 A:middle
topics.
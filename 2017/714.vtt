WEBVTT

00:00:22.516 --> 00:00:24.776 A:middle
[ Applause ]

00:00:25.276 --> 00:00:25.726 A:middle
&gt;&gt; Hello.

00:00:26.516 --> 00:00:28.606 A:middle
[ Applause ]

00:00:29.106 --> 00:00:30.606 A:middle
Hello everybody, thank you for

00:00:30.606 --> 00:00:31.926 A:middle
coming this evening.

00:00:32.116 --> 00:00:33.156 A:middle
Last session of the day.

00:00:34.156 --> 00:00:35.516 A:middle
We're here to talk about what's

00:00:35.516 --> 00:00:38.106 A:middle
new in Wallet and Apple Pay.

00:00:38.796 --> 00:00:40.306 A:middle
And there are three things that

00:00:40.306 --> 00:00:41.206 A:middle
we're going to talk about.

00:00:41.206 --> 00:00:41.986 A:middle
We're going to break today's

00:00:41.986 --> 00:00:43.626 A:middle
session down to three sections.

00:00:44.036 --> 00:00:45.916 A:middle
The first one is going to be a

00:00:45.916 --> 00:00:47.116 A:middle
little bit about the Apply Pay

00:00:47.116 --> 00:00:47.916 A:middle
experience.

00:00:48.336 --> 00:00:49.696 A:middle
Some of you might be familiar

00:00:49.696 --> 00:00:51.216 A:middle
with Apple Pay, but we've also

00:00:51.216 --> 00:00:52.766 A:middle
been quite busy this past year,

00:00:52.936 --> 00:00:53.796 A:middle
so we're going to run through

00:00:53.796 --> 00:00:54.696 A:middle
some of the new things we've

00:00:54.696 --> 00:00:55.096 A:middle
been doing.

00:00:56.226 --> 00:00:57.526 A:middle
Then we're going to look at iOS

00:00:57.526 --> 00:00:59.746 A:middle
11 and macOS High Sierra and

00:00:59.746 --> 00:01:00.896 A:middle
we're going to talk about what's

00:01:00.896 --> 00:01:01.856 A:middle
new with Apple Pay.

00:01:02.396 --> 00:01:04.136 A:middle
And then, finally, we're going

00:01:04.136 --> 00:01:05.756 A:middle
to look at some of the new API

00:01:05.756 --> 00:01:07.786 A:middle
inside of Wallet.

00:01:08.216 --> 00:01:10.476 A:middle
Now, there are a few things

00:01:10.566 --> 00:01:11.826 A:middle
we're not going to cover in this

00:01:11.826 --> 00:01:12.296 A:middle
session.

00:01:12.576 --> 00:01:15.376 A:middle
We're not going to cover getting

00:01:15.376 --> 00:01:17.416 A:middle
started with the Apply Pay API

00:01:17.416 --> 00:01:19.196 A:middle
and how you integrate Apple Pay

00:01:19.196 --> 00:01:20.446 A:middle
with your payment processor.

00:01:20.786 --> 00:01:22.376 A:middle
We have a lot of great resources

00:01:22.376 --> 00:01:24.016 A:middle
for that, you can check out last

00:01:24.016 --> 00:01:27.026 A:middle
year's WWDC sessions, "Apply Pay

00:01:27.026 --> 00:01:28.606 A:middle
on the Web," and "What's New

00:01:28.606 --> 00:01:30.616 A:middle
With Wallet and Apple Pay" 2016

00:01:30.786 --> 00:01:31.666 A:middle
for more information.

00:01:33.106 --> 00:01:34.176 A:middle
So, let's dive right in and

00:01:34.316 --> 00:01:36.436 A:middle
let's talk about the Apply Pay

00:01:36.656 --> 00:01:37.416 A:middle
experience.

00:01:38.526 --> 00:01:39.816 A:middle
Now, hopefully many of you

00:01:39.816 --> 00:01:41.886 A:middle
who've used Apple Pay either in

00:01:41.886 --> 00:01:44.066 A:middle
a store, or in an app, or on the

00:01:44.116 --> 00:01:46.296 A:middle
web, and if you have, you'll

00:01:46.296 --> 00:01:48.286 A:middle
know that Apple Pay is easy,

00:01:48.616 --> 00:01:51.606 A:middle
secure, and private way to pay.

00:01:52.166 --> 00:01:55.516 A:middle
And when we first launched Apple

00:01:55.516 --> 00:01:57.566 A:middle
Pay in iOS 8, we supported

00:01:57.566 --> 00:02:00.106 A:middle
payments within applications.

00:02:00.576 --> 00:02:03.616 A:middle
Here's a good example.

00:02:03.986 --> 00:02:05.926 A:middle
But, since then we've expanded

00:02:05.926 --> 00:02:08.446 A:middle
Apple Pay to far more places.

00:02:09.386 --> 00:02:11.666 A:middle
We've expanded it to Safari.

00:02:12.796 --> 00:02:14.026 A:middle
You can now make payments from

00:02:14.026 --> 00:02:17.476 A:middle
Safari on mac and on iOS.

00:02:17.476 --> 00:02:19.196 A:middle
We've also expanded it to Siri.

00:02:19.886 --> 00:02:21.726 A:middle
You can make payments now from

00:02:21.726 --> 00:02:23.176 A:middle
within SiriKit.

00:02:24.096 --> 00:02:25.436 A:middle
Another great extension point

00:02:25.436 --> 00:02:26.936 A:middle
we've added Apple Pay to is

00:02:27.076 --> 00:02:28.906 A:middle
messages, you can write messages

00:02:28.906 --> 00:02:30.266 A:middle
apps that can take advantage of

00:02:30.266 --> 00:02:31.736 A:middle
Apple Pay directly from within

00:02:31.736 --> 00:02:32.896 A:middle
the message's application.

00:02:32.976 --> 00:02:35.036 A:middle
You can buy a movie ticket and

00:02:35.036 --> 00:02:36.336 A:middle
send it to a friend without ever

00:02:36.396 --> 00:02:37.846 A:middle
having to leave the messages

00:02:37.846 --> 00:02:38.036 A:middle
app.

00:02:39.426 --> 00:02:40.836 A:middle
And finally, we've added support

00:02:40.936 --> 00:02:42.136 A:middle
for watchOS.

00:02:42.526 --> 00:02:45.246 A:middle
You can make payments within

00:02:45.376 --> 00:02:46.926 A:middle
watchOS on WatchKit.

00:02:47.456 --> 00:02:49.816 A:middle
Last year, we also added

00:02:49.816 --> 00:02:52.176 A:middle
support, natively on the new Mac

00:02:52.176 --> 00:02:53.426 A:middle
Book Pro with Touch Bar.

00:02:53.836 --> 00:02:54.916 A:middle
So, now you can make payments

00:02:54.916 --> 00:02:56.376 A:middle
directly on your Mac without

00:02:56.376 --> 00:02:57.686 A:middle
handing them off to an iOS

00:02:57.686 --> 00:02:58.196 A:middle
device.

00:02:58.606 --> 00:03:00.896 A:middle
And hopefully you've also had a

00:03:00.896 --> 00:03:02.046 A:middle
chance to see some of the apps

00:03:02.176 --> 00:03:03.766 A:middle
that have been built on top of

00:03:03.766 --> 00:03:04.216 A:middle
WatchKit.

00:03:04.516 --> 00:03:05.766 A:middle
The Apple Store is a great

00:03:05.766 --> 00:03:06.246 A:middle
example.

00:03:06.386 --> 00:03:08.786 A:middle
You can buy accessories directly

00:03:08.986 --> 00:03:09.666 A:middle
from your wrist.

00:03:10.556 --> 00:03:12.276 A:middle
You just pick an accessory, pick

00:03:12.276 --> 00:03:13.606 A:middle
a card, and you're done.

00:03:14.836 --> 00:03:16.226 A:middle
Now, when we first launched

00:03:16.226 --> 00:03:17.546 A:middle
Apple Pay it was only available

00:03:17.546 --> 00:03:18.816 A:middle
in the United States, but since

00:03:18.816 --> 00:03:20.306 A:middle
then we've been extremely busy.

00:03:20.586 --> 00:03:22.316 A:middle
In the past year alone, we've

00:03:22.316 --> 00:03:23.936 A:middle
launched in over a dozen new

00:03:23.936 --> 00:03:24.566 A:middle
countries.

00:03:24.766 --> 00:03:26.106 A:middle
Here are all the countries that

00:03:26.106 --> 00:03:27.826 A:middle
we're currently supported in.

00:03:28.746 --> 00:03:29.576 A:middle
One country that I'm

00:03:29.576 --> 00:03:31.886 A:middle
particularly excited about is

00:03:31.886 --> 00:03:32.426 A:middle
Japan.

00:03:32.686 --> 00:03:34.166 A:middle
In Japan, you can actually use

00:03:34.166 --> 00:03:36.146 A:middle
Apple Pay directly on the Tokyo

00:03:36.146 --> 00:03:37.726 A:middle
Transit System with your Suica

00:03:37.726 --> 00:03:38.036 A:middle
Card.

00:03:38.036 --> 00:03:39.576 A:middle
It works really, really well.

00:03:41.156 --> 00:03:42.376 A:middle
Another thing we launched last

00:03:42.376 --> 00:03:45.396 A:middle
year after WWDC was Apple Pay

00:03:45.396 --> 00:03:46.566 A:middle
for nonprofits.

00:03:46.966 --> 00:03:48.226 A:middle
This is really interesting if

00:03:48.226 --> 00:03:49.746 A:middle
you're a nonprofit and you want

00:03:49.746 --> 00:03:51.546 A:middle
to take Apple Pay either within

00:03:51.546 --> 00:03:53.876 A:middle
your application, or perhaps on

00:03:53.876 --> 00:03:54.586 A:middle
your website.

00:03:54.586 --> 00:03:56.956 A:middle
Here's an example from OXFAM in

00:03:56.956 --> 00:03:57.836 A:middle
the United Kingdom.

00:03:57.836 --> 00:03:59.216 A:middle
They're one of the largest

00:03:59.436 --> 00:04:02.386 A:middle
nonprofits in the UK and they

00:04:02.386 --> 00:04:03.656 A:middle
actually found that using Apple

00:04:03.656 --> 00:04:05.796 A:middle
Pay reduced the time that it

00:04:05.796 --> 00:04:07.676 A:middle
took to get a donation from 2

00:04:07.676 --> 00:04:09.736 A:middle
minutes to 10 seconds.

00:04:09.846 --> 00:04:11.486 A:middle
That's a huge decrease.

00:04:11.816 --> 00:04:12.846 A:middle
And as a result, they're seeing

00:04:12.846 --> 00:04:14.926 A:middle
much better user experience and

00:04:14.926 --> 00:04:15.616 A:middle
performance.

00:04:16.836 --> 00:04:18.416 A:middle
Now, if you're interested in

00:04:18.416 --> 00:04:20.146 A:middle
accepting Apple Pay as a

00:04:20.146 --> 00:04:22.036 A:middle
nonprofit, it's really easy to

00:04:22.036 --> 00:04:22.356 A:middle
do.

00:04:22.966 --> 00:04:24.456 A:middle
You can use it inside of your

00:04:24.456 --> 00:04:25.586 A:middle
apps and on the web.

00:04:25.726 --> 00:04:27.346 A:middle
And to help support you, we've

00:04:27.346 --> 00:04:29.176 A:middle
added a new donate with Apple

00:04:29.176 --> 00:04:30.616 A:middle
Pay button style.

00:04:31.306 --> 00:04:32.696 A:middle
There's a very simple signup

00:04:32.696 --> 00:04:33.326 A:middle
process.

00:04:33.686 --> 00:04:34.836 A:middle
You can find out more about

00:04:34.836 --> 00:04:36.336 A:middle
where this is supported and how

00:04:36.336 --> 00:04:38.166 A:middle
to get started at the developer

00:04:38.166 --> 00:04:38.466 A:middle
site.

00:04:39.026 --> 00:04:42.066 A:middle
Now, if you're not using Apple

00:04:42.066 --> 00:04:43.996 A:middle
Pay, you might be wondering why

00:04:43.996 --> 00:04:46.506 A:middle
should I adapt it in my app or

00:04:46.506 --> 00:04:48.606 A:middle
on the web.

00:04:48.756 --> 00:04:50.696 A:middle
Apple Pay is one of the best

00:04:50.696 --> 00:04:52.096 A:middle
ways for users to pay.

00:04:52.166 --> 00:04:53.476 A:middle
It has one of the highest

00:04:53.576 --> 00:04:55.336 A:middle
customer satisfaction ratings of

00:04:55.336 --> 00:04:56.456 A:middle
any wallet.

00:04:56.946 --> 00:04:58.496 A:middle
But it's also the best way for

00:04:58.496 --> 00:04:59.746 A:middle
merchants to be paid.

00:05:00.326 --> 00:05:02.386 A:middle
I want to illustrate that with a

00:05:02.386 --> 00:05:04.116 A:middle
little example of a typical

00:05:04.116 --> 00:05:04.746 A:middle
product flow.

00:05:06.176 --> 00:05:07.306 A:middle
So, normally in the checkout

00:05:07.306 --> 00:05:09.926 A:middle
process, we buy a product.

00:05:09.926 --> 00:05:11.696 A:middle
We go to a website, we got to an

00:05:11.696 --> 00:05:13.446 A:middle
app, we see the product and we

00:05:13.606 --> 00:05:14.886 A:middle
add it to our cart.

00:05:15.306 --> 00:05:16.346 A:middle
And then we go to checkout.

00:05:16.346 --> 00:05:18.126 A:middle
And the first thing we normally

00:05:18.126 --> 00:05:20.436 A:middle
have to do is we have to create

00:05:20.436 --> 00:05:21.696 A:middle
an account, or sight in.

00:05:21.696 --> 00:05:23.566 A:middle
And if I don't have an account,

00:05:23.566 --> 00:05:25.256 A:middle
maybe I've got to like create

00:05:25.256 --> 00:05:27.606 A:middle
one and then go to my email to

00:05:27.606 --> 00:05:28.536 A:middle
verify it.

00:05:28.906 --> 00:05:30.386 A:middle
So, I've left the site already.

00:05:30.386 --> 00:05:32.106 A:middle
And then I come back and I've

00:05:32.106 --> 00:05:33.466 A:middle
got to add my shipping address.

00:05:34.206 --> 00:05:35.806 A:middle
And then once I add my shipping

00:05:35.806 --> 00:05:37.346 A:middle
address, well I shipped it to

00:05:37.346 --> 00:05:40.066 A:middle
work, and my credit card uses my

00:05:40.066 --> 00:05:41.236 A:middle
home address as my billing.

00:05:41.236 --> 00:05:42.256 A:middle
So, now I've got to add my

00:05:42.356 --> 00:05:43.236 A:middle
billing address.

00:05:43.696 --> 00:05:45.386 A:middle
And I've got to type in my card

00:05:45.386 --> 00:05:46.096 A:middle
details.

00:05:46.466 --> 00:05:48.056 A:middle
Except, I left my credit card on

00:05:48.056 --> 00:05:49.286 A:middle
the other side of the stage, so

00:05:49.286 --> 00:05:50.986 A:middle
now I've got to go over there to

00:05:50.986 --> 00:05:52.846 A:middle
get the CVV number on the back.

00:05:53.186 --> 00:05:55.116 A:middle
And then I've got to review the

00:05:55.116 --> 00:05:55.986 A:middle
transaction.

00:05:56.096 --> 00:05:58.266 A:middle
And then finally I can confirm

00:05:58.266 --> 00:05:58.896 A:middle
and pay.

00:05:59.826 --> 00:06:01.676 A:middle
So, it's not really surprising

00:06:01.676 --> 00:06:02.506 A:middle
that if you've done any

00:06:02.506 --> 00:06:04.976 A:middle
ecommerce work, conversion rates

00:06:04.976 --> 00:06:06.206 A:middle
is one of the biggest things you

00:06:06.206 --> 00:06:06.766 A:middle
encounter.

00:06:07.016 --> 00:06:08.826 A:middle
Users drop off all the time

00:06:08.826 --> 00:06:09.786 A:middle
during purchase.

00:06:10.586 --> 00:06:12.486 A:middle
But, with Apple Pay, it's so

00:06:12.486 --> 00:06:13.216 A:middle
much simpler.

00:06:13.636 --> 00:06:16.186 A:middle
You just tap or click the buy

00:06:16.186 --> 00:06:17.786 A:middle
with Apple Pay button, and

00:06:17.786 --> 00:06:18.286 A:middle
you're done.

00:06:18.286 --> 00:06:20.226 A:middle
All of these steps are coalesced

00:06:20.226 --> 00:06:22.686 A:middle
into a single user experience.

00:06:23.016 --> 00:06:24.306 A:middle
And this has some really

00:06:24.306 --> 00:06:26.556 A:middle
dramatic results for

00:06:26.636 --> 00:06:27.596 A:middle
performance.

00:06:28.086 --> 00:06:30.386 A:middle
Over the past three years, we've

00:06:30.386 --> 00:06:32.266 A:middle
been asking merchants what they

00:06:32.266 --> 00:06:33.276 A:middle
found with Apple Pay.

00:06:33.946 --> 00:06:35.006 A:middle
And they've told us that they've

00:06:35.006 --> 00:06:36.906 A:middle
seen between 2 and 5 times

00:06:36.906 --> 00:06:38.396 A:middle
increased conversion rates with

00:06:38.396 --> 00:06:40.416 A:middle
Apple Pay, that they've seen

00:06:40.416 --> 00:06:41.936 A:middle
higher purchase frequency.

00:06:42.466 --> 00:06:44.336 A:middle
And the checkouts move much,

00:06:44.336 --> 00:06:45.116 A:middle
much faster.

00:06:45.116 --> 00:06:47.436 A:middle
And a result of all of these,

00:06:48.016 --> 00:06:49.356 A:middle
they see improved customer

00:06:49.356 --> 00:06:51.266 A:middle
acquisition and satisfaction.

00:06:52.056 --> 00:06:53.446 A:middle
Users are more likely to become

00:06:53.446 --> 00:06:54.996 A:middle
your customers, and they're more

00:06:54.996 --> 00:06:56.136 A:middle
likely to be happy.

00:06:56.136 --> 00:06:57.956 A:middle
I want to give you a few

00:06:57.956 --> 00:06:58.676 A:middle
examples.

00:06:58.676 --> 00:07:00.866 A:middle
If you are a freelance or a

00:07:00.866 --> 00:07:02.556 A:middle
contractor, you might know about

00:07:02.556 --> 00:07:04.086 A:middle
Intuit, they have an app and a

00:07:04.126 --> 00:07:05.506 A:middle
service that lets you generate

00:07:05.506 --> 00:07:06.166 A:middle
invoices.

00:07:06.346 --> 00:07:07.656 A:middle
They took advantage of Apple

00:07:07.656 --> 00:07:07.986 A:middle
Pay.

00:07:08.036 --> 00:07:09.226 A:middle
You can pay your invoice

00:07:09.476 --> 00:07:10.086 A:middle
directly.

00:07:10.246 --> 00:07:11.126 A:middle
And they found that these

00:07:11.126 --> 00:07:13.116 A:middle
invoices were paid 30% faster

00:07:13.116 --> 00:07:13.826 A:middle
with Apple Pay.

00:07:14.146 --> 00:07:15.386 A:middle
And half these invoices were

00:07:15.386 --> 00:07:16.956 A:middle
paid immediately, the same day

00:07:16.956 --> 00:07:17.706 A:middle
they were received.

00:07:18.146 --> 00:07:19.596 A:middle
I used to be a freelancer and

00:07:19.596 --> 00:07:20.876 A:middle
that was unheard of when I

00:07:20.876 --> 00:07:21.566 A:middle
freelanced.

00:07:22.306 --> 00:07:24.516 A:middle
Another app that's had a lot of

00:07:24.516 --> 00:07:27.136 A:middle
success is Indiegogo.

00:07:27.136 --> 00:07:28.796 A:middle
They adopted Apple Pay so you

00:07:28.796 --> 00:07:31.166 A:middle
can use it to pledge for items

00:07:31.166 --> 00:07:34.026 A:middle
there and they've seen a 250%

00:07:34.026 --> 00:07:35.286 A:middle
increase in conversion rate.

00:07:36.456 --> 00:07:38.176 A:middle
There are a few other benefits

00:07:38.176 --> 00:07:40.096 A:middle
outside of conversion.

00:07:40.466 --> 00:07:43.206 A:middle
Many merchants see a reduction

00:07:43.996 --> 00:07:45.036 A:middle
in chargebacks.

00:07:45.246 --> 00:07:46.316 A:middle
This is huge.

00:07:46.316 --> 00:07:47.166 A:middle
If you deal with these, you'll

00:07:47.166 --> 00:07:48.486 A:middle
know they can be very expensive

00:07:48.486 --> 00:07:49.816 A:middle
and time consuming to resolve.

00:07:49.876 --> 00:07:52.016 A:middle
And perhaps, most importantly

00:07:52.016 --> 00:07:54.136 A:middle
with Apple Pay there's no need

00:07:54.136 --> 00:07:56.556 A:middle
to handle or store credit card

00:07:56.556 --> 00:07:57.066 A:middle
numbers.

00:07:58.086 --> 00:07:58.936 A:middle
This is huge.

00:07:58.936 --> 00:08:00.036 A:middle
You don't need to handle you

00:08:00.036 --> 00:08:01.376 A:middle
know regular credit card

00:08:01.376 --> 00:08:02.526 A:middle
numbers, instead you're handling

00:08:02.526 --> 00:08:04.536 A:middle
device-specific tokens.

00:08:05.566 --> 00:08:07.016 A:middle
You also get a trusted user

00:08:07.016 --> 00:08:07.796 A:middle
experience.

00:08:08.036 --> 00:08:09.376 A:middle
Instead of going to five

00:08:09.376 --> 00:08:10.746 A:middle
different sites and getting five

00:08:10.746 --> 00:08:12.266 A:middle
completely different checkouts,

00:08:12.526 --> 00:08:14.146 A:middle
you get a single UI that uses

00:08:14.146 --> 00:08:14.586 A:middle
trust.

00:08:14.676 --> 00:08:16.996 A:middle
Built directly in Safari or into

00:08:17.776 --> 00:08:17.926 A:middle
iOS.

00:08:19.776 --> 00:08:21.806 A:middle
So, hopefully if you haven't

00:08:21.906 --> 00:08:23.536 A:middle
adopted Apple Pay I've convinced

00:08:23.536 --> 00:08:25.676 A:middle
you to go after this session and

00:08:25.676 --> 00:08:27.056 A:middle
immediately start putting it on

00:08:27.056 --> 00:08:27.506 A:middle
your site.

00:08:27.766 --> 00:08:29.216 A:middle
So, I want to give you a few

00:08:29.336 --> 00:08:31.106 A:middle
bits of advice on how you can

00:08:31.106 --> 00:08:32.406 A:middle
perfect the Apple Pay

00:08:32.406 --> 00:08:33.116 A:middle
experience.

00:08:33.846 --> 00:08:34.806 A:middle
When you're thinking about

00:08:34.806 --> 00:08:36.316 A:middle
designing for Apple Pay, it's

00:08:36.316 --> 00:08:37.776 A:middle
important to think about three

00:08:37.996 --> 00:08:39.266 A:middle
basic principles.

00:08:39.846 --> 00:08:41.366 A:middle
How can I make purchasing

00:08:41.406 --> 00:08:41.966 A:middle
easier?

00:08:42.866 --> 00:08:44.356 A:middle
How can I make purchasing

00:08:44.356 --> 00:08:45.066 A:middle
faster?

00:08:46.016 --> 00:08:47.666 A:middle
And how can you make purchasing

00:08:47.996 --> 00:08:48.536 A:middle
clearer?

00:08:49.496 --> 00:08:50.996 A:middle
And when you put these together,

00:08:51.586 --> 00:08:53.686 A:middle
you get a great design and a

00:08:53.686 --> 00:08:54.986 A:middle
great user experience.

00:08:55.156 --> 00:08:55.996 A:middle
And if you've been to our

00:08:55.996 --> 00:08:58.276 A:middle
website, you'll see we use three

00:08:58.276 --> 00:09:00.586 A:middle
terms to describe how to best

00:09:00.766 --> 00:09:01.456 A:middle
perfect these.

00:09:01.596 --> 00:09:02.506 A:middle
One of these is something we

00:09:02.506 --> 00:09:03.646 A:middle
call upstreaming.

00:09:04.376 --> 00:09:05.526 A:middle
Another technique in our

00:09:05.526 --> 00:09:06.796 A:middle
interface guide, we call

00:09:06.796 --> 00:09:07.696 A:middle
defaulting.

00:09:07.946 --> 00:09:09.826 A:middle
And a third technique in our

00:09:09.826 --> 00:09:11.076 A:middle
interface guide we call

00:09:11.076 --> 00:09:11.996 A:middle
streamlining.

00:09:12.596 --> 00:09:14.056 A:middle
So, I want to run through each

00:09:14.056 --> 00:09:16.246 A:middle
of these and I want to see how

00:09:16.246 --> 00:09:17.406 A:middle
they can help.

00:09:18.066 --> 00:09:20.236 A:middle
Upstreaming is about

00:09:20.236 --> 00:09:22.076 A:middle
accelerating single item

00:09:22.076 --> 00:09:23.446 A:middle
purchases with Apple Pay

00:09:23.516 --> 00:09:25.086 A:middle
directly on product pages.

00:09:25.606 --> 00:09:27.346 A:middle
We're accelerating multi-item

00:09:27.346 --> 00:09:28.966 A:middle
purchases with express check

00:09:28.966 --> 00:09:29.236 A:middle
out.

00:09:29.726 --> 00:09:31.556 A:middle
Let me give you an example.

00:09:31.806 --> 00:09:33.656 A:middle
I live in San Francisco, so it

00:09:33.656 --> 00:09:35.306 A:middle
is obviously very important that

00:09:35.306 --> 00:09:36.596 A:middle
I have a constant stock of

00:09:36.886 --> 00:09:38.246 A:middle
hoodies to wear.

00:09:38.376 --> 00:09:40.516 A:middle
So, here is Lululemon's site, I

00:09:40.516 --> 00:09:42.246 A:middle
can buy a hoodie, and you'll see

00:09:42.446 --> 00:09:44.756 A:middle
that there is a buy with Apple

00:09:44.756 --> 00:09:46.196 A:middle
Pay button directly on the

00:09:46.196 --> 00:09:47.106 A:middle
product page.

00:09:48.026 --> 00:09:49.576 A:middle
Placing the Apple Pay button on

00:09:49.576 --> 00:09:51.456 A:middle
your product pages drastically

00:09:51.456 --> 00:09:53.706 A:middle
increases conversions by several

00:09:53.706 --> 00:09:54.966 A:middle
orders of magnitude.

00:09:54.966 --> 00:09:56.446 A:middle
It allows purchasing

00:09:56.716 --> 00:09:57.896 A:middle
immediately.

00:10:00.046 --> 00:10:01.276 A:middle
And also, if you allow

00:10:01.276 --> 00:10:02.636 A:middle
purchasing without creating

00:10:02.636 --> 00:10:04.376 A:middle
accounts, as is done here,

00:10:04.756 --> 00:10:05.686 A:middle
you'll get an even better

00:10:05.686 --> 00:10:06.536 A:middle
performance.

00:10:08.296 --> 00:10:11.976 A:middle
Now, sometimes, guest check out

00:10:12.436 --> 00:10:13.256 A:middle
isn't feasible.

00:10:13.786 --> 00:10:15.806 A:middle
But there are some techniques

00:10:15.806 --> 00:10:17.916 A:middle
you can use to help mitigate

00:10:17.916 --> 00:10:18.326 A:middle
this.

00:10:19.036 --> 00:10:20.276 A:middle
Firstly, you can write the

00:10:20.276 --> 00:10:22.096 A:middle
account creation seamless with

00:10:22.316 --> 00:10:23.566 A:middle
iOS and macOS.

00:10:24.086 --> 00:10:25.456 A:middle
One of the ways that you can do

00:10:25.456 --> 00:10:26.746 A:middle
this is through shared web

00:10:26.816 --> 00:10:27.626 A:middle
credentials.

00:10:27.626 --> 00:10:29.556 A:middle
This was introduced a few years

00:10:29.556 --> 00:10:30.616 A:middle
ago and there have actually been

00:10:30.616 --> 00:10:31.776 A:middle
some great improvements to

00:10:31.776 --> 00:10:33.176 A:middle
shared web credentials in iOS

00:10:33.176 --> 00:10:33.626 A:middle
11.

00:10:33.726 --> 00:10:35.516 A:middle
So, do check out the Safari

00:10:35.516 --> 00:10:36.996 A:middle
sessions to find out more about

00:10:36.996 --> 00:10:37.246 A:middle
that.

00:10:37.876 --> 00:10:39.356 A:middle
Another thing you can do that is

00:10:39.356 --> 00:10:42.536 A:middle
new in iOS 11 is have native app

00:10:42.636 --> 00:10:43.376 A:middle
autofill.

00:10:43.586 --> 00:10:45.646 A:middle
iOS 11 will now autofill

00:10:45.646 --> 00:10:47.996 A:middle
passwords within applications.

00:10:48.116 --> 00:10:49.456 A:middle
And to take advantage of this,

00:10:49.456 --> 00:10:51.556 A:middle
all you need to do is hint your

00:10:51.556 --> 00:10:53.796 A:middle
UI text fields with the right UI

00:10:53.796 --> 00:10:56.616 A:middle
text content type; password,

00:10:56.616 --> 00:10:57.646 A:middle
email, etcetera.

00:10:59.086 --> 00:11:00.856 A:middle
You can also create an account

00:11:00.856 --> 00:11:02.606 A:middle
after payment using data the you

00:11:02.606 --> 00:11:04.676 A:middle
gather from Apple Pay.

00:11:04.886 --> 00:11:05.906 A:middle
So, the user's email, for

00:11:05.906 --> 00:11:06.316 A:middle
example.

00:11:06.316 --> 00:11:08.396 A:middle
You can create an account once

00:11:08.396 --> 00:11:10.006 A:middle
purchase has happened.

00:11:10.956 --> 00:11:12.696 A:middle
Now, the second technique that I

00:11:12.696 --> 00:11:14.336 A:middle
mentioned is defaulting.

00:11:15.076 --> 00:11:16.766 A:middle
And this is about making Apple

00:11:16.766 --> 00:11:18.286 A:middle
Pay the default payment option

00:11:18.286 --> 00:11:19.116 A:middle
where possible.

00:11:19.116 --> 00:11:20.816 A:middle
And you can actually take

00:11:20.816 --> 00:11:22.546 A:middle
advantage of a new feature we're

00:11:22.546 --> 00:11:23.626 A:middle
adding that I'll talk about in

00:11:23.626 --> 00:11:24.846 A:middle
just a moment, that we call

00:11:24.846 --> 00:11:25.756 A:middle
in-line set up.

00:11:25.836 --> 00:11:26.866 A:middle
You'll see how that can make

00:11:27.126 --> 00:11:29.036 A:middle
Apple Pay immediate, even if the

00:11:29.036 --> 00:11:31.346 A:middle
user doesn't have cards on their

00:11:31.346 --> 00:11:32.436 A:middle
iOS device.

00:11:35.116 --> 00:11:36.896 A:middle
The final technique I mentioned

00:11:36.896 --> 00:11:38.026 A:middle
was streamlining.

00:11:38.956 --> 00:11:40.896 A:middle
This is about making purchasing

00:11:40.896 --> 00:11:43.086 A:middle
with Apple Pay quick and simple.

00:11:44.296 --> 00:11:45.296 A:middle
It's about collecting the

00:11:45.296 --> 00:11:46.856 A:middle
necessary information before

00:11:46.856 --> 00:11:47.816 A:middle
checkout begins.

00:11:47.816 --> 00:11:49.536 A:middle
If you need a size or a color,

00:11:49.686 --> 00:11:50.756 A:middle
make sure you get it before

00:11:50.756 --> 00:11:51.646 A:middle
checkout starts.

00:11:52.136 --> 00:11:53.556 A:middle
And it's also about preferring

00:11:53.556 --> 00:11:55.246 A:middle
customer information from Apple

00:11:55.246 --> 00:11:55.596 A:middle
Pay.

00:11:55.946 --> 00:11:57.496 A:middle
Don't ask for the user's email

00:11:57.496 --> 00:11:58.866 A:middle
address yourself.

00:11:58.866 --> 00:12:00.186 A:middle
You'll be able to collect it

00:12:00.186 --> 00:12:01.746 A:middle
along with shipping information,

00:12:01.826 --> 00:12:03.846 A:middle
billing information, and so on,

00:12:03.846 --> 00:12:04.926 A:middle
directly from the Apple Pay

00:12:04.926 --> 00:12:05.886 A:middle
sheet.

00:12:06.816 --> 00:12:08.636 A:middle
That brings me to the Apple Pay

00:12:08.636 --> 00:12:09.326 A:middle
sheet.

00:12:09.766 --> 00:12:11.096 A:middle
You may be familiar with it.

00:12:11.166 --> 00:12:12.226 A:middle
This is what it looks like on

00:12:12.226 --> 00:12:13.036 A:middle
the Apple Store.

00:12:13.396 --> 00:12:15.156 A:middle
And I've got some general advice

00:12:15.216 --> 00:12:16.506 A:middle
for when you're thinking about

00:12:16.506 --> 00:12:18.176 A:middle
using Apple Pay and how to best

00:12:18.176 --> 00:12:19.406 A:middle
take advantage of this sheet.

00:12:19.906 --> 00:12:22.716 A:middle
One piece of advice is only to

00:12:22.716 --> 00:12:24.406 A:middle
present and request essential

00:12:24.406 --> 00:12:25.106 A:middle
information.

00:12:26.056 --> 00:12:27.486 A:middle
Don't request information you're

00:12:27.486 --> 00:12:28.386 A:middle
not going to use.

00:12:28.386 --> 00:12:30.116 A:middle
If you don't need the user's

00:12:30.116 --> 00:12:31.546 A:middle
phone number, don't ask for it.

00:12:32.896 --> 00:12:34.306 A:middle
Another thing to bear in mind,

00:12:34.306 --> 00:12:36.006 A:middle
is that the screen estate is

00:12:36.006 --> 00:12:36.786 A:middle
quite limited.

00:12:36.786 --> 00:12:37.916 A:middle
There isn't a lot of space.

00:12:37.986 --> 00:12:38.936 A:middle
So, you should keep your line

00:12:38.936 --> 00:12:40.526 A:middle
items short and meaningful.

00:12:41.196 --> 00:12:43.066 A:middle
It's not intended to be a kind

00:12:43.066 --> 00:12:44.076 A:middle
of full receipt.

00:12:44.166 --> 00:12:45.446 A:middle
The Apple Pay sheet is intended

00:12:45.446 --> 00:12:46.396 A:middle
to be a summary.

00:12:46.706 --> 00:12:48.266 A:middle
So, use these line items to

00:12:48.266 --> 00:12:50.086 A:middle
explain additional charges,

00:12:50.436 --> 00:12:51.806 A:middle
discounts, tax.

00:12:52.136 --> 00:12:54.066 A:middle
Let me go back to the Apple

00:12:54.066 --> 00:12:55.506 A:middle
store and show you what I mean.

00:12:56.086 --> 00:12:58.376 A:middle
Here you'll see I'm buying an

00:12:58.486 --> 00:13:00.626 A:middle
iPad and here in the sheet I see

00:13:00.786 --> 00:13:04.626 A:middle
a subtotal, shipping, tax, and a

00:13:04.626 --> 00:13:05.166 A:middle
total.

00:13:05.686 --> 00:13:07.396 A:middle
So, very top level.

00:13:08.516 --> 00:13:10.986 A:middle
Now, sometimes you don't know

00:13:11.156 --> 00:13:12.786 A:middle
what you're going to charge.

00:13:13.956 --> 00:13:15.746 A:middle
Perhaps you're a ride sharing

00:13:15.746 --> 00:13:17.036 A:middle
company and you don't actually

00:13:17.036 --> 00:13:18.636 A:middle
charge the user until the ride

00:13:18.636 --> 00:13:19.026 A:middle
is over.

00:13:19.026 --> 00:13:20.886 A:middle
Or perhaps you want to add an

00:13:20.886 --> 00:13:22.486 A:middle
optional gratuity that the user

00:13:22.486 --> 00:13:24.136 A:middle
picks at the end of the

00:13:24.136 --> 00:13:24.856 A:middle
transaction.

00:13:25.146 --> 00:13:27.946 A:middle
You can use pending items to

00:13:27.946 --> 00:13:28.826 A:middle
achieve this.

00:13:28.826 --> 00:13:30.586 A:middle
It's important to clearly

00:13:30.586 --> 00:13:32.206 A:middle
disclose that these pending

00:13:32.206 --> 00:13:33.786 A:middle
items are additional costs.

00:13:34.136 --> 00:13:37.236 A:middle
Here's an example, we just mark

00:13:37.236 --> 00:13:39.936 A:middle
the type as pending, and it will

00:13:39.936 --> 00:13:41.766 A:middle
show up on the Apple Pay sheet

00:13:41.946 --> 00:13:42.716 A:middle
without an amount.

00:13:43.246 --> 00:13:46.676 A:middle
Now, the total amount has to be

00:13:46.676 --> 00:13:47.416 A:middle
nonnegative.

00:13:47.586 --> 00:13:48.686 A:middle
It doesn't really make sense to

00:13:48.686 --> 00:13:49.576 A:middle
have a payment that's for a

00:13:49.576 --> 00:13:50.276 A:middle
negative amount.

00:13:51.096 --> 00:13:52.456 A:middle
But it can be pending.

00:13:53.086 --> 00:13:54.746 A:middle
So, you can have a total that is

00:13:54.746 --> 00:13:56.696 A:middle
not known at the time the time

00:13:56.696 --> 00:13:57.936 A:middle
the transaction is taking place.

00:13:59.236 --> 00:14:00.536 A:middle
It's very important for the

00:14:00.536 --> 00:14:02.186 A:middle
total amount to use the business

00:14:02.186 --> 00:14:03.226 A:middle
name that will appear on the

00:14:03.226 --> 00:14:03.976 A:middle
card statement.

00:14:04.066 --> 00:14:05.396 A:middle
It's important for two reasons.

00:14:05.396 --> 00:14:07.836 A:middle
Firstly, users want to be able

00:14:07.836 --> 00:14:09.726 A:middle
to reconcile what appears within

00:14:09.726 --> 00:14:11.106 A:middle
the Wallet application and on

00:14:11.106 --> 00:14:12.556 A:middle
their bank statement with what

00:14:12.556 --> 00:14:13.026 A:middle
they paid.

00:14:13.566 --> 00:14:15.246 A:middle
Also, now that we support the

00:14:15.246 --> 00:14:16.876 A:middle
new Mac Book Pro with Touch Bar,

00:14:16.876 --> 00:14:18.526 A:middle
we actually show the merchant's

00:14:18.526 --> 00:14:20.486 A:middle
name on the Touch Bar itself.

00:14:20.806 --> 00:14:22.206 A:middle
So, again, it's important to

00:14:22.206 --> 00:14:23.386 A:middle
make sure that it matches what

00:14:23.386 --> 00:14:24.376 A:middle
the user expects.

00:14:26.676 --> 00:14:28.526 A:middle
Now, one use case that's grown

00:14:28.526 --> 00:14:29.956 A:middle
over the last year with Apple

00:14:29.956 --> 00:14:31.766 A:middle
Pay is subscriptions.

00:14:31.976 --> 00:14:34.176 A:middle
For example, news sites that

00:14:34.176 --> 00:14:36.436 A:middle
want to use Apple Pay on the web

00:14:36.816 --> 00:14:38.016 A:middle
to take subscriptions.

00:14:38.566 --> 00:14:39.976 A:middle
You can do that, but there's

00:14:39.976 --> 00:14:41.286 A:middle
some advice I'd like to give

00:14:41.286 --> 00:14:41.516 A:middle
you.

00:14:41.566 --> 00:14:43.716 A:middle
It's important to clarify the

00:14:43.716 --> 00:14:45.266 A:middle
subscription details prior to

00:14:45.266 --> 00:14:45.956 A:middle
payment.

00:14:46.436 --> 00:14:48.116 A:middle
It's important to include line

00:14:48.116 --> 00:14:49.876 A:middle
items that reiterate the billing

00:14:49.876 --> 00:14:50.556 A:middle
frequency.

00:14:51.456 --> 00:14:53.416 A:middle
And for variable subscriptions

00:14:53.636 --> 00:14:54.906 A:middle
use pending items.

00:14:55.136 --> 00:14:56.426 A:middle
Let me give you an example.

00:14:56.746 --> 00:14:59.276 A:middle
I have a little side job, a

00:14:59.276 --> 00:15:01.736 A:middle
little app I'm working, it sells

00:15:01.736 --> 00:15:03.336 A:middle
avocado toast to naïve

00:15:03.336 --> 00:15:04.026 A:middle
millennials.

00:15:04.366 --> 00:15:05.706 A:middle
Here it is.

00:15:05.706 --> 00:15:07.356 A:middle
It's a subscription, of course,

00:15:07.416 --> 00:15:08.736 A:middle
because that's what's getting

00:15:08.736 --> 00:15:10.166 A:middle
all the funding, so I'm told.

00:15:10.536 --> 00:15:12.146 A:middle
And here's my Apple Pay sheet.

00:15:12.766 --> 00:15:14.266 A:middle
And you'll see that I have here,

00:15:14.266 --> 00:15:16.016 A:middle
weekly service, so in my line

00:15:16.016 --> 00:15:18.306 A:middle
item I'm clearly indicating the

00:15:18.306 --> 00:15:19.266 A:middle
length of time that the

00:15:19.266 --> 00:15:20.206 A:middle
subscription is for.

00:15:20.696 --> 00:15:22.546 A:middle
I'm also noting a discount.

00:15:22.546 --> 00:15:23.556 A:middle
You can do that in the sheet.

00:15:23.556 --> 00:15:24.906 A:middle
You can note introductory

00:15:24.906 --> 00:15:25.546 A:middle
discounts.

00:15:25.846 --> 00:15:27.676 A:middle
And then what will be charged at

00:15:27.676 --> 00:15:28.686 A:middle
this current time.

00:15:29.286 --> 00:15:30.606 A:middle
And then you can use the same

00:15:30.606 --> 00:15:31.966 A:middle
information, the same payment

00:15:31.966 --> 00:15:33.716 A:middle
data you get from Apple Pay to

00:15:33.716 --> 00:15:35.156 A:middle
make subsequent charges.

00:15:36.566 --> 00:15:38.416 A:middle
Now, sometimes there are certain

00:15:38.416 --> 00:15:40.126 A:middle
types of subscriptions where the

00:15:40.126 --> 00:15:41.336 A:middle
cost varies.

00:15:41.556 --> 00:15:43.156 A:middle
Maybe you're a meal ordering

00:15:43.156 --> 00:15:45.016 A:middle
service and the number of meals

00:15:45.016 --> 00:15:46.966 A:middle
that the user gets varies week

00:15:46.966 --> 00:15:49.116 A:middle
by week, month by month.

00:15:49.116 --> 00:15:50.776 A:middle
Use pending amounts for variable

00:15:50.776 --> 00:15:51.616 A:middle
subscriptions.

00:15:51.996 --> 00:15:53.536 A:middle
Another thing to bear in mind is

00:15:53.536 --> 00:15:54.776 A:middle
that if your subscription is

00:15:54.776 --> 00:15:56.576 A:middle
variable, and the user changes

00:15:56.576 --> 00:15:58.186 A:middle
their plan, for example, you

00:15:58.186 --> 00:15:59.596 A:middle
only need to show the payment

00:15:59.596 --> 00:16:01.306 A:middle
sheet if a change is going to

00:16:01.306 --> 00:16:03.016 A:middle
result in additional fees.

00:16:03.616 --> 00:16:05.586 A:middle
If the user decreases the cost

00:16:05.636 --> 00:16:07.706 A:middle
authorization is necessary.

00:16:09.176 --> 00:16:10.566 A:middle
So, that's the payment sheet.

00:16:11.546 --> 00:16:13.546 A:middle
I want to talk now about

00:16:13.976 --> 00:16:14.736 A:middle
buttons.

00:16:15.476 --> 00:16:16.796 A:middle
Specifically, I want to talk

00:16:16.796 --> 00:16:18.666 A:middle
about the Apple Pay buttons.

00:16:18.976 --> 00:16:21.976 A:middle
Please, use the built-in Apple

00:16:21.976 --> 00:16:22.796 A:middle
Pay buttons.

00:16:22.996 --> 00:16:24.156 A:middle
Don't create your own.

00:16:24.156 --> 00:16:25.766 A:middle
A couple reasons why you don't

00:16:25.766 --> 00:16:26.476 A:middle
want to do that.

00:16:26.476 --> 00:16:28.176 A:middle
Firstly, the Apple Pay buttons

00:16:28.176 --> 00:16:30.566 A:middle
are localized to any language

00:16:30.566 --> 00:16:31.956 A:middle
that the user can choose.

00:16:32.246 --> 00:16:33.826 A:middle
They're also vectors, so they're

00:16:33.826 --> 00:16:35.536 A:middle
completely scalable, so you

00:16:35.536 --> 00:16:36.426 A:middle
don't need to worry about them

00:16:36.426 --> 00:16:37.416 A:middle
not looking right.

00:16:37.686 --> 00:16:39.066 A:middle
And they're available in a

00:16:39.066 --> 00:16:40.096 A:middle
number of styles.

00:16:40.526 --> 00:16:42.216 A:middle
We first introduced the native

00:16:42.216 --> 00:16:44.056 A:middle
buttons in iOS 8.3.

00:16:44.276 --> 00:16:46.246 A:middle
So, you can target 8.3 and

00:16:46.246 --> 00:16:48.136 A:middle
above, which is nearly the

00:16:48.136 --> 00:16:50.936 A:middle
entire in store base right now.

00:16:51.176 --> 00:16:55.066 A:middle
And in macOS 10.12.1 and iOS

00:16:55.066 --> 00:16:57.816 A:middle
10.1 we made it a little easier

00:16:58.246 --> 00:16:58.976 A:middle
on web.

00:16:58.976 --> 00:17:01.426 A:middle
We used simplified CSS styles.

00:17:01.886 --> 00:17:03.746 A:middle
Let me give you some examples,

00:17:03.746 --> 00:17:05.756 A:middle
some code examples.

00:17:05.756 --> 00:17:07.056 A:middle
So, here is the not very

00:17:07.056 --> 00:17:08.456 A:middle
exciting code in Swift.

00:17:08.886 --> 00:17:10.736 A:middle
PKPaymentButton is a UI button

00:17:10.736 --> 00:17:11.466 A:middle
subclass.

00:17:11.466 --> 00:17:12.566 A:middle
You just provide a type and a

00:17:12.566 --> 00:17:13.126 A:middle
style.

00:17:13.456 --> 00:17:16.306 A:middle
We have buttons in black, white,

00:17:16.466 --> 00:17:17.776 A:middle
and white with an outline.

00:17:18.626 --> 00:17:20.096 A:middle
Let me show you the same button

00:17:20.136 --> 00:17:20.966 A:middle
in HTML.

00:17:21.606 --> 00:17:23.826 A:middle
So, this is the new CSS style it

00:17:23.826 --> 00:17:26.956 A:middle
was introduced in iOS 10.1.

00:17:26.956 --> 00:17:28.306 A:middle
There's a WebKit appearance

00:17:28.346 --> 00:17:30.756 A:middle
style Apple Pay button, and a

00:17:30.756 --> 00:17:32.016 A:middle
type buy.

00:17:33.126 --> 00:17:34.916 A:middle
Now, we have four button styles.

00:17:35.116 --> 00:17:36.276 A:middle
Let me show them to you.

00:17:36.816 --> 00:17:39.386 A:middle
On the left are the Swift

00:17:39.686 --> 00:17:40.786 A:middle
symbols, on the right the CSS

00:17:40.786 --> 00:17:40.936 A:middle
names.

00:17:40.936 --> 00:17:44.316 A:middle
We have a plain button.

00:17:44.856 --> 00:17:47.596 A:middle
We have a buy with Apple Pay

00:17:47.596 --> 00:17:48.006 A:middle
button.

00:17:49.356 --> 00:17:51.146 A:middle
We also have a Set up Apple Pay

00:17:51.146 --> 00:17:51.556 A:middle
button.

00:17:51.776 --> 00:17:53.546 A:middle
We'll see how to use that

00:17:53.546 --> 00:17:54.046 A:middle
shortly.

00:17:55.006 --> 00:17:58.406 A:middle
And new in iOS 10.2 and macOS

00:17:58.406 --> 00:18:00.736 A:middle
10.12.3, we have a Donate with

00:18:00.736 --> 00:18:01.606 A:middle
Apple Pay button if you're a

00:18:01.606 --> 00:18:02.246 A:middle
nonprofit.

00:18:02.606 --> 00:18:04.006 A:middle
Now, obviously as a nonprofit,

00:18:04.006 --> 00:18:05.516 A:middle
you probably want to target all

00:18:05.516 --> 00:18:07.836 A:middle
versions of iOS or macOS before

00:18:08.326 --> 00:18:08.536 A:middle
that.

00:18:08.536 --> 00:18:09.696 A:middle
In that case, you can just fall

00:18:09.696 --> 00:18:11.076 A:middle
back to the regular plain

00:18:11.406 --> 00:18:11.796 A:middle
button.

00:18:12.116 --> 00:18:15.016 A:middle
So, that's the quick update on

00:18:15.016 --> 00:18:16.556 A:middle
Apple Pay over the past year and

00:18:16.556 --> 00:18:18.346 A:middle
a review of some of our best

00:18:18.346 --> 00:18:19.046 A:middle
practices.

00:18:20.236 --> 00:18:21.576 A:middle
And I want to tell you the

00:18:21.576 --> 00:18:22.796 A:middle
exciting part of the talk.

00:18:23.166 --> 00:18:25.366 A:middle
Which is what's new with Apple

00:18:27.296 --> 00:18:27.376 A:middle
Pay.

00:18:27.616 --> 00:18:29.726 A:middle
When we thought about what we

00:18:29.726 --> 00:18:30.856 A:middle
could do this year with Apple

00:18:30.856 --> 00:18:32.726 A:middle
Pay we thought how could we make

00:18:33.236 --> 00:18:35.296 A:middle
a best in class conversion even

00:18:35.296 --> 00:18:35.626 A:middle
better.

00:18:36.706 --> 00:18:37.956 A:middle
And how could we help users

00:18:37.956 --> 00:18:39.546 A:middle
resolve common problems that

00:18:39.546 --> 00:18:40.466 A:middle
they told us about.

00:18:41.576 --> 00:18:42.806 A:middle
And finally, how can we help

00:18:42.806 --> 00:18:44.206 A:middle
make getting started with Apple

00:18:44.206 --> 00:18:46.476 A:middle
Pay fast and easy, so even more

00:18:46.476 --> 00:18:47.846 A:middle
of your potential customers can

00:18:47.846 --> 00:18:50.926 A:middle
come with cards already on their

00:18:51.696 --> 00:18:51.856 A:middle
device.

00:18:52.006 --> 00:18:53.926 A:middle
So, I think you'll see that the

00:18:53.926 --> 00:18:55.036 A:middle
next few slides will show some

00:18:55.036 --> 00:18:55.746 A:middle
of the ways we're going to

00:18:55.746 --> 00:18:56.296 A:middle
achieve that.

00:18:56.676 --> 00:18:58.586 A:middle
The first way is through Set up

00:18:58.586 --> 00:18:59.136 A:middle
Apple Pay.

00:19:00.326 --> 00:19:02.636 A:middle
Now, starting with this version

00:19:02.636 --> 00:19:04.046 A:middle
of iOS, we strongly recommend

00:19:04.046 --> 00:19:05.086 A:middle
that you show the Apple Pay

00:19:05.086 --> 00:19:06.846 A:middle
button for all devices that are

00:19:06.846 --> 00:19:08.566 A:middle
hardware capable with Apple Pay.

00:19:09.056 --> 00:19:11.106 A:middle
And you can choose the Set up or

00:19:11.106 --> 00:19:12.656 A:middle
Buy button stars that suit your

00:19:12.656 --> 00:19:13.096 A:middle
needs.

00:19:13.096 --> 00:19:15.116 A:middle
If the API tells you the user

00:19:15.116 --> 00:19:16.726 A:middle
doesn't have any cards, you

00:19:16.726 --> 00:19:18.156 A:middle
could optionally display Set up.

00:19:18.156 --> 00:19:19.286 A:middle
If it makes more sense in your

00:19:19.286 --> 00:19:20.936 A:middle
design to stick with Buy, you

00:19:20.936 --> 00:19:21.546 A:middle
can do that.

00:19:22.916 --> 00:19:23.846 A:middle
But we've introduced something

00:19:23.846 --> 00:19:24.946 A:middle
to really help with that.

00:19:24.946 --> 00:19:25.776 A:middle
And the reason for this new

00:19:25.776 --> 00:19:27.636 A:middle
advice is because now we support

00:19:27.816 --> 00:19:28.986 A:middle
inline set up.

00:19:29.746 --> 00:19:31.566 A:middle
Apple Pay Set up is now offered

00:19:31.566 --> 00:19:32.566 A:middle
automatically.

00:19:32.876 --> 00:19:35.306 A:middle
If you try to present an Apple

00:19:35.306 --> 00:19:37.166 A:middle
Pay sheet on previous versions

00:19:37.166 --> 00:19:38.586 A:middle
of iOS, if the user didn't have

00:19:38.586 --> 00:19:40.006 A:middle
any cards, that would actually

00:19:40.006 --> 00:19:40.436 A:middle
be an error.

00:19:40.536 --> 00:19:42.226 A:middle
Actually, you wouldn't be able

00:19:42.226 --> 00:19:43.546 A:middle
to present the view controller.

00:19:43.866 --> 00:19:45.406 A:middle
Now, you will actually present,

00:19:45.526 --> 00:19:47.216 A:middle
or present Apple Pay Set up.

00:19:47.216 --> 00:19:49.986 A:middle
And most importantly, users are

00:19:49.986 --> 00:19:52.286 A:middle
returned to the purchase as soon

00:19:52.286 --> 00:19:53.366 A:middle
as set up completes.

00:19:53.596 --> 00:19:54.726 A:middle
Which means that it's actually

00:19:54.726 --> 00:19:56.606 A:middle
faster than a manual check out

00:19:56.606 --> 00:19:57.986 A:middle
to add and Apple Pay card and

00:19:57.986 --> 00:19:58.906 A:middle
complete the purchase.

00:19:59.166 --> 00:20:01.146 A:middle
I want to actually show you what

00:20:01.146 --> 00:20:03.236 A:middle
that looks like and how quick it

00:20:03.236 --> 00:20:03.666 A:middle
is.

00:20:04.046 --> 00:20:06.976 A:middle
So, here is the Apple store, on

00:20:06.976 --> 00:20:08.256 A:middle
their website this time, not

00:20:08.256 --> 00:20:08.626 A:middle
their app.

00:20:09.076 --> 00:20:10.056 A:middle
And we're going to see what

00:20:10.056 --> 00:20:11.546 A:middle
happens when we try to tap the

00:20:11.546 --> 00:20:13.536 A:middle
Buy button without cards.

00:20:13.706 --> 00:20:14.996 A:middle
It's going to go quite quickly.

00:20:15.576 --> 00:20:18.416 A:middle
Okay, so we get a little

00:20:18.416 --> 00:20:19.636 A:middle
dialogue to add a card.

00:20:20.096 --> 00:20:24.876 A:middle
We're going to add a card.

00:20:24.916 --> 00:20:26.226 A:middle
This is a card that I've already

00:20:26.226 --> 00:20:27.476 A:middle
used on another phone, so it's

00:20:27.476 --> 00:20:27.886 A:middle
already there.

00:20:27.886 --> 00:20:30.546 A:middle
I just enter my security code.

00:20:32.376 --> 00:20:33.796 A:middle
Now we're going to add the card.

00:20:34.516 --> 00:20:35.796 A:middle
Read the terms thoroughly

00:20:35.796 --> 00:20:36.306 A:middle
[laughter].

00:20:36.306 --> 00:20:40.496 A:middle
And then we're going to add it

00:20:40.496 --> 00:20:42.376 A:middle
to Wallet, activate the card.

00:20:42.426 --> 00:20:44.856 A:middle
And boom, we're done.

00:20:44.856 --> 00:20:46.766 A:middle
Now what's going to happen?

00:20:46.826 --> 00:20:47.856 A:middle
Immediately we're going to go to

00:20:47.856 --> 00:20:49.576 A:middle
the Apple Pay sheet so we can

00:20:49.576 --> 00:20:50.566 A:middle
continue the payment.

00:20:51.136 --> 00:20:51.996 A:middle
This is great.

00:20:51.996 --> 00:20:53.336 A:middle
That actually took less than 30

00:20:53.336 --> 00:20:54.786 A:middle
seconds, which is still much

00:20:54.786 --> 00:20:56.066 A:middle
faster than manually typing my

00:20:56.066 --> 00:20:57.056 A:middle
card number and all this

00:20:57.056 --> 00:20:58.856 A:middle
information on the regular Apple

00:20:58.856 --> 00:20:59.536 A:middle
Store checkout.

00:20:59.536 --> 00:21:01.326 A:middle
And again, this happens

00:21:01.326 --> 00:21:02.486 A:middle
completely automatically.

00:21:02.486 --> 00:21:03.846 A:middle
You don't have to make any code

00:21:03.846 --> 00:21:04.446 A:middle
changes.

00:21:04.626 --> 00:21:05.526 A:middle
There's no new API.

00:21:05.526 --> 00:21:07.426 A:middle
All you have to do is present

00:21:07.426 --> 00:21:08.936 A:middle
Apple Pay if the user doesn't

00:21:08.936 --> 00:21:09.646 A:middle
have cards.

00:21:09.646 --> 00:21:11.786 A:middle
So, I recommend you will go and

00:21:11.786 --> 00:21:14.196 A:middle
take advantage of that.

00:21:14.566 --> 00:21:15.886 A:middle
Now, if you were at the keynote,

00:21:15.996 --> 00:21:17.826 A:middle
or watched it online, one thing

00:21:17.826 --> 00:21:18.676 A:middle
that might have got you quite

00:21:18.676 --> 00:21:21.176 A:middle
excited was Apple Pay Cash.

00:21:22.456 --> 00:21:24.036 A:middle
Apple Pay Cash allows you to

00:21:24.036 --> 00:21:27.226 A:middle
send money to fellow users of

00:21:27.226 --> 00:21:27.866 A:middle
iMessage.

00:21:28.116 --> 00:21:29.706 A:middle
And the money you received is

00:21:29.706 --> 00:21:31.726 A:middle
kept inside Apple Pay Cash.

00:21:32.366 --> 00:21:34.266 A:middle
Now, Apple Pay Cash can be used

00:21:34.326 --> 00:21:36.206 A:middle
in stores, physical stores.

00:21:36.496 --> 00:21:37.766 A:middle
But it can also be used within

00:21:37.766 --> 00:21:39.566 A:middle
apps and on the web, just like

00:21:39.566 --> 00:21:40.416 A:middle
any other card.

00:21:40.726 --> 00:21:42.566 A:middle
In fact, if you can process

00:21:42.566 --> 00:21:44.876 A:middle
credit cards, you can process

00:21:45.006 --> 00:21:45.986 A:middle
Apple Pay Cash.

00:21:46.206 --> 00:21:47.686 A:middle
We will have more information on

00:21:47.686 --> 00:21:49.076 A:middle
exactly what you need to do very

00:21:49.216 --> 00:21:51.326 A:middle
shortly on our developer site.

00:21:51.616 --> 00:21:52.866 A:middle
But rest assured if you take

00:21:52.866 --> 00:21:54.086 A:middle
credit cards today, there will

00:21:54.086 --> 00:21:55.936 A:middle
be no real work to take Apple

00:21:55.936 --> 00:21:56.506 A:middle
Pay Cash.

00:21:57.266 --> 00:21:58.076 A:middle
There are a few things you

00:21:58.076 --> 00:21:59.246 A:middle
should know about Apple Pay Cash

00:21:59.246 --> 00:22:02.046 A:middle
if you're in in-app or website

00:22:02.046 --> 00:22:02.756 A:middle
developer.

00:22:03.276 --> 00:22:06.326 A:middle
Apple Pay Cash is a stored

00:22:06.326 --> 00:22:07.106 A:middle
balance card.

00:22:07.136 --> 00:22:08.066 A:middle
You have a balance.

00:22:09.016 --> 00:22:11.136 A:middle
So, let me give you an example.

00:22:11.406 --> 00:22:12.856 A:middle
My business model for

00:22:12.856 --> 00:22:14.216 A:middle
subscriptions wasn't really

00:22:14.216 --> 00:22:16.216 A:middle
working, so I've switched to an

00:22:16.216 --> 00:22:17.966 A:middle
on-demand model where we deliver

00:22:17.966 --> 00:22:19.986 A:middle
the avocado toast directly to

00:22:19.986 --> 00:22:20.746 A:middle
your seats.

00:22:21.316 --> 00:22:23.606 A:middle
And so, now I'm just going to

00:22:23.606 --> 00:22:24.736 A:middle
one off charge.

00:22:25.036 --> 00:22:26.256 A:middle
But I'm trying to make this

00:22:26.256 --> 00:22:27.556 A:middle
payment with an Apple Pay Cash

00:22:27.556 --> 00:22:27.886 A:middle
card.

00:22:28.146 --> 00:22:29.596 A:middle
Unfortunately, I don't have many

00:22:29.596 --> 00:22:30.476 A:middle
friends and they haven't

00:22:30.476 --> 00:22:31.626 A:middle
actually sent me any money.

00:22:31.676 --> 00:22:33.826 A:middle
So, you'll see this UI is new.

00:22:33.966 --> 00:22:35.806 A:middle
It says insufficient balance.

00:22:36.246 --> 00:22:37.736 A:middle
The important thing to note here

00:22:37.736 --> 00:22:39.176 A:middle
is that we're now using the

00:22:39.176 --> 00:22:41.326 A:middle
total amount that you supply to

00:22:41.326 --> 00:22:42.626 A:middle
determine whether the payment

00:22:42.626 --> 00:22:44.646 A:middle
can happen with Apple Pay Cash.

00:22:44.886 --> 00:22:46.846 A:middle
That means that it's important

00:22:46.846 --> 00:22:48.366 A:middle
that your total reflects what

00:22:48.366 --> 00:22:50.906 A:middle
you intend to charge, Apple Pay

00:22:50.906 --> 00:22:53.436 A:middle
Cash is only available when your

00:22:53.436 --> 00:22:56.216 A:middle
balance exceeds the total being

00:22:56.216 --> 00:22:56.776 A:middle
requested.

00:22:57.956 --> 00:22:59.686 A:middle
Now, if you're not sure of the

00:22:59.686 --> 00:23:01.896 A:middle
total, you can use a pending

00:23:02.436 --> 00:23:02.696 A:middle
amount.

00:23:02.696 --> 00:23:04.316 A:middle
Using a pending amount bypasses

00:23:04.316 --> 00:23:05.606 A:middle
this behavior, we will allow the

00:23:05.606 --> 00:23:07.106 A:middle
payment to happen regardless, of

00:23:07.106 --> 00:23:08.396 A:middle
course bear in mind it may still

00:23:08.396 --> 00:23:10.286 A:middle
be like any stored value card,

00:23:10.626 --> 00:23:11.996 A:middle
rejected if the user doesn't

00:23:11.996 --> 00:23:12.706 A:middle
have a balance.

00:23:13.246 --> 00:23:15.946 A:middle
Let's talk about some new API

00:23:15.946 --> 00:23:17.956 A:middle
that we've added briefly.

00:23:18.156 --> 00:23:20.256 A:middle
One use case we've been asked a

00:23:20.256 --> 00:23:21.216 A:middle
lot about, particularly in

00:23:21.216 --> 00:23:23.176 A:middle
Europe is about limiting Apple

00:23:23.176 --> 00:23:24.956 A:middle
Pay to specific countries.

00:23:25.156 --> 00:23:26.806 A:middle
Sometimes this is required for

00:23:26.806 --> 00:23:28.336 A:middle
regulatory compliance.

00:23:28.726 --> 00:23:29.746 A:middle
Now you can.

00:23:30.116 --> 00:23:31.546 A:middle
You just pass in this new

00:23:31.546 --> 00:23:33.026 A:middle
property, supportedCountries,

00:23:33.026 --> 00:23:35.096 A:middle
and you just set the countries

00:23:35.096 --> 00:23:36.256 A:middle
that you want to limit to.

00:23:37.066 --> 00:23:38.336 A:middle
Bear in mind that like some of

00:23:38.336 --> 00:23:40.266 A:middle
our other API that exists today,

00:23:40.266 --> 00:23:41.746 A:middle
that lets you say limit to

00:23:41.746 --> 00:23:43.816 A:middle
credit or debit cards, this

00:23:43.816 --> 00:23:45.216 A:middle
isn't available on every single

00:23:45.216 --> 00:23:45.596 A:middle
card.

00:23:45.596 --> 00:23:47.136 A:middle
So, just bear that in mind.

00:23:47.376 --> 00:23:48.766 A:middle
For more information about that,

00:23:48.766 --> 00:23:50.716 A:middle
check out last year's session.

00:23:50.886 --> 00:23:54.606 A:middle
Now, I want to talk about the

00:23:54.606 --> 00:23:55.856 A:middle
biggest change that we're making

00:23:55.856 --> 00:23:57.686 A:middle
to Apple Pay and that's to do

00:23:57.686 --> 00:23:59.576 A:middle
with error handling.

00:24:01.396 --> 00:24:04.066 A:middle
Sometimes, things can go wrong

00:24:04.686 --> 00:24:06.696 A:middle
with Apple Pay, I regret to tell

00:24:06.696 --> 00:24:06.906 A:middle
you.

00:24:07.236 --> 00:24:09.226 A:middle
And it can be problematic to

00:24:09.226 --> 00:24:11.106 A:middle
communicate this to users today.

00:24:11.106 --> 00:24:12.806 A:middle
We've had feedback from

00:24:12.806 --> 00:24:14.086 A:middle
developers, we've had feedback

00:24:14.086 --> 00:24:14.806 A:middle
from users.

00:24:15.286 --> 00:24:17.366 A:middle
What are some examples of this?

00:24:17.366 --> 00:24:20.016 A:middle
The payment instrument failed to

00:24:20.016 --> 00:24:20.676 A:middle
process.

00:24:21.476 --> 00:24:23.326 A:middle
The billing address didn't match

00:24:23.326 --> 00:24:24.976 A:middle
what the bank had on the card.

00:24:25.386 --> 00:24:27.186 A:middle
The email address was invalid.

00:24:27.786 --> 00:24:29.166 A:middle
The postal address had an

00:24:29.166 --> 00:24:32.056 A:middle
incorrect zip or postal code.

00:24:32.056 --> 00:24:33.826 A:middle
The telephone was missing an

00:24:33.826 --> 00:24:34.556 A:middle
area code.

00:24:35.126 --> 00:24:36.696 A:middle
And we can divide these up into

00:24:36.696 --> 00:24:37.796 A:middle
two categories.

00:24:38.316 --> 00:24:40.636 A:middle
We can divide them up into what

00:24:40.636 --> 00:24:43.536 A:middle
I call fatal errors and nonfatal

00:24:43.536 --> 00:24:43.946 A:middle
errors.

00:24:45.206 --> 00:24:46.666 A:middle
Fatal errors are errors that

00:24:46.666 --> 00:24:48.006 A:middle
can't actually be resolved by

00:24:48.006 --> 00:24:49.216 A:middle
the user there and then.

00:24:49.216 --> 00:24:50.246 A:middle
And you need to handle them

00:24:50.246 --> 00:24:51.436 A:middle
outside of Apple Pay.

00:24:51.766 --> 00:24:53.176 A:middle
But they're also often not

00:24:53.176 --> 00:24:53.896 A:middle
preventable.

00:24:54.316 --> 00:24:55.696 A:middle
What's an example of that?

00:24:56.146 --> 00:24:57.576 A:middle
The user has exceeded their

00:24:57.576 --> 00:24:58.246 A:middle
credit limit.

00:24:58.356 --> 00:24:59.936 A:middle
You're not going to be able to

00:24:59.936 --> 00:25:01.196 A:middle
solve that within Apple Pay,

00:25:01.196 --> 00:25:02.046 A:middle
you're going to need to go to

00:25:02.046 --> 00:25:03.066 A:middle
your bank to fix it.

00:25:04.046 --> 00:25:05.926 A:middle
But many errors are nonfatal,

00:25:05.926 --> 00:25:07.166 A:middle
they can be resolved by the

00:25:07.166 --> 00:25:07.636 A:middle
user.

00:25:08.236 --> 00:25:09.816 A:middle
And they can be handled within

00:25:09.816 --> 00:25:10.806 A:middle
Apple Pay itself.

00:25:11.186 --> 00:25:11.916 A:middle
And sometimes they're

00:25:11.916 --> 00:25:13.506 A:middle
foreseeable and preventable.

00:25:14.876 --> 00:25:16.906 A:middle
But in previous versions for

00:25:16.906 --> 00:25:18.566 A:middle
iOS, it was a little tricky to

00:25:18.566 --> 00:25:19.916 A:middle
communicate what exactly was

00:25:19.916 --> 00:25:20.246 A:middle
wrong.

00:25:21.336 --> 00:25:22.796 A:middle
Whenever a payment is complete

00:25:22.796 --> 00:25:24.456 A:middle
in the native API, you would

00:25:24.456 --> 00:25:25.476 A:middle
return a

00:25:25.476 --> 00:25:27.526 A:middle
PKPaymentAuthorizationStatus

00:25:27.746 --> 00:25:28.296 A:middle
Enum.

00:25:28.406 --> 00:25:29.916 A:middle
You'd have a similar Enum in the

00:25:29.916 --> 00:25:30.456 A:middle
web API.

00:25:30.456 --> 00:25:33.066 A:middle
And these have no specificity.

00:25:33.466 --> 00:25:34.696 A:middle
You can only say invalid

00:25:34.696 --> 00:25:35.936 A:middle
shipping address, invalid

00:25:35.976 --> 00:25:37.566 A:middle
billing, invalid contact.

00:25:38.146 --> 00:25:39.746 A:middle
So, the user's not really sure

00:25:39.746 --> 00:25:40.546 A:middle
what went wrong.

00:25:40.746 --> 00:25:41.906 A:middle
But even if the user could

00:25:41.946 --> 00:25:43.396 A:middle
figure out what went wrong, they

00:25:43.396 --> 00:25:44.756 A:middle
weren't actually able to edit

00:25:44.756 --> 00:25:45.846 A:middle
existing values.

00:25:46.206 --> 00:25:47.636 A:middle
So, they'd have to go and pick

00:25:47.636 --> 00:25:49.016 A:middle
an entirely new address or type

00:25:49.016 --> 00:25:49.416 A:middle
one in.

00:25:49.416 --> 00:25:51.436 A:middle
And that's not a great

00:25:51.436 --> 00:25:52.026 A:middle
experience.

00:25:52.076 --> 00:25:53.036 A:middle
So, we are changing that.

00:25:53.386 --> 00:25:54.646 A:middle
And we're changing it in three

00:25:54.646 --> 00:25:55.036 A:middle
ways.

00:25:55.876 --> 00:25:57.006 A:middle
Firstly, we're going to

00:25:57.006 --> 00:25:58.386 A:middle
introduce some new guidelines to

00:25:58.386 --> 00:25:59.746 A:middle
better handle user data.

00:26:00.676 --> 00:26:01.556 A:middle
We've also introduced a

00:26:01.556 --> 00:26:03.706 A:middle
brand-new UI for users to input

00:26:03.706 --> 00:26:04.536 A:middle
and edit data.

00:26:04.536 --> 00:26:05.906 A:middle
If you've tried out the iOS

00:26:05.906 --> 00:26:06.896 A:middle
Veetle, you might have seen

00:26:06.896 --> 00:26:07.216 A:middle
this.

00:26:07.836 --> 00:26:09.316 A:middle
And finally, and perhaps most

00:26:09.316 --> 00:26:10.496 A:middle
excitingly for you, we've

00:26:10.496 --> 00:26:12.756 A:middle
introduced new API to let you

00:26:12.756 --> 00:26:14.836 A:middle
communicate precise errors about

00:26:14.836 --> 00:26:15.506 A:middle
what went wrong.

00:26:16.726 --> 00:26:17.786 A:middle
So, let's go through these one

00:26:17.786 --> 00:26:18.166 A:middle
at a time.

00:26:18.676 --> 00:26:21.176 A:middle
Let's talk about handling user

00:26:21.176 --> 00:26:21.586 A:middle
data.

00:26:22.706 --> 00:26:23.546 A:middle
This is a fun one.

00:26:23.756 --> 00:26:26.176 A:middle
Contact information on iOS and

00:26:26.176 --> 00:26:27.526 A:middle
macOS can come from many

00:26:27.526 --> 00:26:28.636 A:middle
different sources.

00:26:29.026 --> 00:26:30.456 A:middle
It can come from iCloud, it can

00:26:30.456 --> 00:26:32.166 A:middle
come from contacts manually

00:26:32.166 --> 00:26:32.746 A:middle
typed in.

00:26:33.276 --> 00:26:34.276 A:middle
But it can also come from

00:26:34.276 --> 00:26:37.026 A:middle
LinkedIn, Facebook, VIDO,

00:26:37.226 --> 00:26:38.556 A:middle
[inaudible], it can come from

00:26:38.556 --> 00:26:39.176 A:middle
anywhere.

00:26:39.406 --> 00:26:41.296 A:middle
And you shouldn't expect this

00:26:41.296 --> 00:26:42.716 A:middle
information to conform to your

00:26:42.716 --> 00:26:44.026 A:middle
business logic.

00:26:45.316 --> 00:26:46.406 A:middle
What do I mean by that?

00:26:46.966 --> 00:26:49.066 A:middle
Here is an example of a postal

00:26:49.066 --> 00:26:49.566 A:middle
address.

00:26:49.926 --> 00:26:51.026 A:middle
It is for the Apple store in

00:26:51.026 --> 00:26:52.116 A:middle
Boston, which is a very nice

00:26:52.116 --> 00:26:52.666 A:middle
Apple store.

00:26:52.666 --> 00:26:54.206 A:middle
You should visit, say hello,

00:26:54.206 --> 00:26:55.116 A:middle
tell them I sent you.

00:26:56.466 --> 00:26:58.886 A:middle
Now, the address may look

00:26:58.886 --> 00:27:00.506 A:middle
correct to you, and if you wrote

00:27:00.506 --> 00:27:01.886 A:middle
this on an envelope and dropped

00:27:01.886 --> 00:27:03.206 A:middle
it in the mail, it would get

00:27:03.206 --> 00:27:03.436 A:middle
there.

00:27:04.126 --> 00:27:05.116 A:middle
But it's actually got a few

00:27:05.116 --> 00:27:07.186 A:middle
problems that could trick an

00:27:07.186 --> 00:27:08.596 A:middle
unwitting developer up.

00:27:08.596 --> 00:27:11.386 A:middle
Some of them don't really seem

00:27:11.386 --> 00:27:12.226 A:middle
like big problems.

00:27:12.566 --> 00:27:13.836 A:middle
Street is abbreviated.

00:27:14.326 --> 00:27:15.346 A:middle
Seems like most systems should

00:27:15.346 --> 00:27:16.356 A:middle
be able to handle this.

00:27:17.336 --> 00:27:19.766 A:middle
Some problems are a little more

00:27:19.766 --> 00:27:20.916 A:middle
serious.

00:27:20.916 --> 00:27:22.726 A:middle
If you paid attention in civics,

00:27:22.926 --> 00:27:23.916 A:middle
you may have noticed that

00:27:23.916 --> 00:27:25.316 A:middle
Massachusetts is misspelled.

00:27:25.316 --> 00:27:26.346 A:middle
It has two T's.

00:27:26.346 --> 00:27:27.756 A:middle
I lived there for four years.

00:27:27.756 --> 00:27:28.866 A:middle
I still can't spell it right.

00:27:29.866 --> 00:27:31.986 A:middle
Now, if you were doing an exact

00:27:31.986 --> 00:27:33.856 A:middle
string match on the state, this

00:27:33.856 --> 00:27:35.026 A:middle
might cause you a problem.

00:27:35.436 --> 00:27:37.126 A:middle
Another thing that's a little

00:27:37.126 --> 00:27:38.206 A:middle
odd is this zip code.

00:27:38.546 --> 00:27:41.356 A:middle
It says zip plus 4, which is a

00:27:41.666 --> 00:27:43.486 A:middle
regular zip code with 4

00:27:43.486 --> 00:27:44.516 A:middle
additional digits for

00:27:44.516 --> 00:27:45.456 A:middle
specificity.

00:27:46.236 --> 00:27:48.186 A:middle
If your backend system was only

00:27:48.186 --> 00:27:50.286 A:middle
expecting 5 digits, if your like

00:27:50.396 --> 00:27:51.696 A:middle
database was only going to

00:27:51.696 --> 00:27:53.606 A:middle
accept 5 numbers, you might hit

00:27:53.606 --> 00:27:54.936 A:middle
some problems ingesting this.

00:27:56.146 --> 00:27:58.636 A:middle
Country is another example where

00:27:58.636 --> 00:28:01.156 A:middle
you might trip up.

00:28:01.516 --> 00:28:03.326 A:middle
This is a localized country

00:28:03.326 --> 00:28:03.746 A:middle
name.

00:28:03.746 --> 00:28:05.386 A:middle
There's actually another field

00:28:05.386 --> 00:28:06.856 A:middle
that the user doesn't see called

00:28:06.856 --> 00:28:07.596 A:middle
country code.

00:28:07.806 --> 00:28:08.936 A:middle
You should use that instead,

00:28:08.966 --> 00:28:10.626 A:middle
because country code is always

00:28:10.626 --> 00:28:12.706 A:middle
going to be accurate.

00:28:12.826 --> 00:28:13.876 A:middle
This is in the language of the

00:28:13.876 --> 00:28:14.216 A:middle
user.

00:28:14.546 --> 00:28:16.606 A:middle
So, you may well be like, OK I'm

00:28:16.606 --> 00:28:17.946 A:middle
going to string match United

00:28:17.946 --> 00:28:19.366 A:middle
States, USA, all of its

00:28:19.366 --> 00:28:19.906 A:middle
variants.

00:28:19.906 --> 00:28:21.496 A:middle
Well, surprise, your user is

00:28:21.496 --> 00:28:23.046 A:middle
French and this field is

00:28:23.046 --> 00:28:25.336 A:middle
actually Etats-Unis and you

00:28:25.336 --> 00:28:26.366 A:middle
can't now ingest it.

00:28:26.366 --> 00:28:28.256 A:middle
So, don't use country, use

00:28:28.256 --> 00:28:28.996 A:middle
country code.

00:28:29.086 --> 00:28:31.886 A:middle
The phone number also could trip

00:28:31.886 --> 00:28:32.636 A:middle
you up.

00:28:32.636 --> 00:28:33.556 A:middle
It has some dashes.

00:28:33.556 --> 00:28:34.886 A:middle
So, if your system was only set

00:28:34.886 --> 00:28:36.826 A:middle
up to accept numeric digits you

00:28:36.826 --> 00:28:37.736 A:middle
could have some problems.

00:28:37.916 --> 00:28:39.976 A:middle
But it's also got a country

00:28:40.486 --> 00:28:42.276 A:middle
code, which could trip you up.

00:28:43.026 --> 00:28:45.096 A:middle
So, be prepared for fuzzy input.

00:28:45.306 --> 00:28:47.216 A:middle
Don't force the user to comply

00:28:47.216 --> 00:28:49.396 A:middle
with your business logic.

00:28:49.656 --> 00:28:50.806 A:middle
There are lots of techniques you

00:28:50.806 --> 00:28:52.846 A:middle
can do to validate addresses.

00:28:52.846 --> 00:28:55.056 A:middle
For example instead of using the

00:28:55.056 --> 00:28:56.746 A:middle
state field directly you can

00:28:56.746 --> 00:28:58.356 A:middle
infer it from the zip code.

00:28:58.696 --> 00:28:59.606 A:middle
That's an example.

00:28:59.766 --> 00:29:01.226 A:middle
There are lots of tools to help

00:29:01.226 --> 00:29:02.956 A:middle
you pass phone numbers, both

00:29:02.956 --> 00:29:04.786 A:middle
tolls available within iOS and

00:29:04.786 --> 00:29:06.086 A:middle
also third party tools.

00:29:06.866 --> 00:29:07.866 A:middle
You might wonder, well why

00:29:07.866 --> 00:29:09.216 A:middle
doesn't Apple Pay do this for

00:29:09.216 --> 00:29:09.486 A:middle
me?

00:29:09.766 --> 00:29:11.826 A:middle
Well, your business logic may

00:29:11.826 --> 00:29:13.316 A:middle
actually differ from another

00:29:13.316 --> 00:29:14.516 A:middle
merchant's business logic.

00:29:14.516 --> 00:29:16.386 A:middle
One merchant may only accept

00:29:16.386 --> 00:29:17.326 A:middle
phone numbers with a country

00:29:17.326 --> 00:29:17.656 A:middle
code.

00:29:17.936 --> 00:29:19.746 A:middle
Another merchant may only accept

00:29:19.746 --> 00:29:20.646 A:middle
phone numbers without.

00:29:21.046 --> 00:29:22.366 A:middle
And you don't want the user to

00:29:22.366 --> 00:29:23.356 A:middle
like have to create two

00:29:23.356 --> 00:29:24.706 A:middle
different addresses, two

00:29:24.706 --> 00:29:25.616 A:middle
different phone numbers.

00:29:26.046 --> 00:29:27.216 A:middle
So, don't force the user to

00:29:27.216 --> 00:29:28.386 A:middle
comply with your business logic.

00:29:28.386 --> 00:29:30.856 A:middle
Now, we are going to help you a

00:29:30.856 --> 00:29:31.196 A:middle
little bit.

00:29:31.196 --> 00:29:33.016 A:middle
There's some new API's within

00:29:33.016 --> 00:29:34.416 A:middle
the context framework to support

00:29:34.416 --> 00:29:35.596 A:middle
worldwide addresses.

00:29:35.786 --> 00:29:37.266 A:middle
The example I gave for you was

00:29:37.266 --> 00:29:38.576 A:middle
from the US, but these problems

00:29:38.576 --> 00:29:39.876 A:middle
actually happen throughout the

00:29:39.876 --> 00:29:40.266 A:middle
world.

00:29:40.506 --> 00:29:42.256 A:middle
There are new fields in contact

00:29:42.256 --> 00:29:43.606 A:middle
for something that's called

00:29:43.606 --> 00:29:45.326 A:middle
supplementary sub-locality.

00:29:45.546 --> 00:29:47.176 A:middle
That's very applicable in China.

00:29:47.736 --> 00:29:49.486 A:middle
In Japan, now, within Apple Pay

00:29:49.486 --> 00:29:51.246 A:middle
you can request phonetic name in

00:29:51.246 --> 00:29:52.456 A:middle
addition to regular name,

00:29:52.896 --> 00:29:54.646 A:middle
another very important addition

00:29:54.646 --> 00:29:54.936 A:middle
there.

00:29:55.666 --> 00:29:56.946 A:middle
But despite all of these, and

00:29:56.946 --> 00:29:58.796 A:middle
despite your best intentions,

00:29:59.666 --> 00:30:01.846 A:middle
things can still go wrong.

00:30:02.046 --> 00:30:03.906 A:middle
The USPS may be able to deliver

00:30:03.906 --> 00:30:05.556 A:middle
this to Santa, but I cannot.

00:30:05.556 --> 00:30:07.156 A:middle
I know not where he lives.

00:30:08.116 --> 00:30:09.916 A:middle
So, what are somethings that can

00:30:09.916 --> 00:30:10.566 A:middle
go wrong?

00:30:10.566 --> 00:30:11.916 A:middle
The phone number could just be

00:30:11.916 --> 00:30:13.326 A:middle
missing digits entirely.

00:30:13.726 --> 00:30:15.576 A:middle
The postal code and address

00:30:15.576 --> 00:30:16.526 A:middle
don't match.

00:30:16.526 --> 00:30:18.716 A:middle
The email address is misspelled.

00:30:19.266 --> 00:30:20.966 A:middle
The address is otherwise

00:30:20.966 --> 00:30:21.696 A:middle
unusable.

00:30:22.396 --> 00:30:23.936 A:middle
And so, we're going to introduce

00:30:23.936 --> 00:30:25.716 A:middle
some new API to help you out

00:30:25.716 --> 00:30:26.086 A:middle
with that.

00:30:26.446 --> 00:30:28.636 A:middle
And we call it custom errors.

00:30:29.916 --> 00:30:32.056 A:middle
Custom errors let you gracefully

00:30:32.056 --> 00:30:33.826 A:middle
handle invalid or incorrect data

00:30:33.826 --> 00:30:34.476 A:middle
in Apple Pay.

00:30:34.866 --> 00:30:36.316 A:middle
And they also let you display

00:30:36.426 --> 00:30:37.886 A:middle
custom error messages.

00:30:37.886 --> 00:30:39.736 A:middle
Your own error messages directly

00:30:39.736 --> 00:30:40.776 A:middle
in the Apple Pay sheet.

00:30:41.346 --> 00:30:42.686 A:middle
You can direct the user to

00:30:42.686 --> 00:30:44.986 A:middle
specific fields that need

00:30:45.206 --> 00:30:45.836 A:middle
correction.

00:30:46.666 --> 00:30:48.606 A:middle
Let's go back to my delightful

00:30:48.606 --> 00:30:49.736 A:middle
avocado toast app.

00:30:50.066 --> 00:30:51.766 A:middle
The delivery wasn't working, so

00:30:51.766 --> 00:30:53.336 A:middle
I've gone back to subscriptions.

00:30:53.596 --> 00:30:54.886 A:middle
We're going for our series A

00:30:54.886 --> 00:30:55.386 A:middle
funding.

00:30:55.786 --> 00:30:57.236 A:middle
And you'll see here, I've got a

00:30:57.236 --> 00:30:58.236 A:middle
shipping address error.

00:30:58.366 --> 00:30:59.996 A:middle
Shipping address incorrect.

00:30:59.996 --> 00:31:03.236 A:middle
And that's not very clear, but

00:31:03.236 --> 00:31:04.836 A:middle
if the user taps in, you'll

00:31:04.836 --> 00:31:06.136 A:middle
actually see, now we have a

00:31:06.136 --> 00:31:07.896 A:middle
custom error that was provided

00:31:07.936 --> 00:31:09.276 A:middle
by the application.

00:31:09.486 --> 00:31:10.696 A:middle
Your zip code doesn't match your

00:31:10.696 --> 00:31:11.166 A:middle
city.

00:31:11.206 --> 00:31:13.116 A:middle
And if you go through even

00:31:13.116 --> 00:31:14.106 A:middle
further, we'll actually

00:31:14.106 --> 00:31:16.086 A:middle
highlight the individual fields

00:31:16.226 --> 00:31:17.786 A:middle
for the user to correct.

00:31:17.786 --> 00:31:19.766 A:middle
You'll see an example in Jon's

00:31:19.766 --> 00:31:20.966 A:middle
demo, shortly.

00:31:22.596 --> 00:31:24.896 A:middle
Now, one unfortunate side effect

00:31:24.896 --> 00:31:25.846 A:middle
of this is that we've had to

00:31:25.846 --> 00:31:27.756 A:middle
deprecate a little bit of API.

00:31:28.016 --> 00:31:29.786 A:middle
All of our completion handlers

00:31:29.916 --> 00:31:32.026 A:middle
in the past in Apple Pay took,

00:31:32.086 --> 00:31:33.526 A:middle
as I mentioned this Enum.

00:31:34.146 --> 00:31:35.356 A:middle
Well, we didn't really want to

00:31:35.356 --> 00:31:36.806 A:middle
have hundreds of different Enums

00:31:36.806 --> 00:31:37.866 A:middle
for each type of error.

00:31:37.896 --> 00:31:40.816 A:middle
So, instead we're replacing them

00:31:40.816 --> 00:31:42.226 A:middle
with an object.

00:31:42.226 --> 00:31:43.246 A:middle
In this case, this is the

00:31:43.246 --> 00:31:44.726 A:middle
delicate callback when a payment

00:31:44.726 --> 00:31:46.246 A:middle
is actually authorized and you

00:31:46.246 --> 00:31:47.106 A:middle
return a

00:31:47.106 --> 00:31:48.706 A:middle
PKPaymentAuthorizationResult.

00:31:49.236 --> 00:31:52.716 A:middle
So, we have to do little bit of

00:31:52.886 --> 00:31:53.136 A:middle
renaming.

00:31:53.136 --> 00:31:54.946 A:middle
Now, this result object contains

00:31:54.946 --> 00:31:56.606 A:middle
a status and it contains an

00:31:56.606 --> 00:31:57.676 A:middle
array of errors.

00:31:58.166 --> 00:31:59.606 A:middle
Now, the status is the status

00:31:59.606 --> 00:32:00.466 A:middle
that you're used to.

00:32:00.466 --> 00:32:02.056 A:middle
The payment was successful or

00:32:02.526 --> 00:32:02.926 A:middle
not.

00:32:02.926 --> 00:32:03.956 A:middle
If you, for example, have a

00:32:03.956 --> 00:32:05.286 A:middle
successful payment, you simply

00:32:05.286 --> 00:32:07.136 A:middle
return a result with no errors

00:32:07.466 --> 00:32:08.826 A:middle
and a single status set.

00:32:09.666 --> 00:32:11.256 A:middle
But the errors themselves just

00:32:11.256 --> 00:32:12.696 A:middle
standard NS errors describing

00:32:12.696 --> 00:32:13.336 A:middle
what went wrong.

00:32:14.366 --> 00:32:15.586 A:middle
Each error represents an

00:32:15.586 --> 00:32:16.846 A:middle
individual problem with a

00:32:16.846 --> 00:32:17.256 A:middle
payment.

00:32:17.666 --> 00:32:19.046 A:middle
And you can chain errors

00:32:19.046 --> 00:32:19.496 A:middle
together.

00:32:19.496 --> 00:32:20.616 A:middle
So, you can have more than one.

00:32:20.616 --> 00:32:22.046 A:middle
If the user's email is wrong,

00:32:22.186 --> 00:32:23.636 A:middle
phone is wrong, shipping is

00:32:23.636 --> 00:32:23.866 A:middle
wrong.

00:32:23.866 --> 00:32:25.016 A:middle
You can just do it all in one

00:32:25.016 --> 00:32:25.226 A:middle
go.

00:32:26.406 --> 00:32:28.406 A:middle
Now, you use NSError codes to

00:32:28.406 --> 00:32:31.196 A:middle
indicate the issue and User Info

00:32:31.196 --> 00:32:32.846 A:middle
Keys on NSError to provide

00:32:32.846 --> 00:32:34.446 A:middle
specific resolution steps and

00:32:34.446 --> 00:32:35.116 A:middle
information.

00:32:35.736 --> 00:32:38.676 A:middle
Now, creating NSErrors can be a

00:32:38.676 --> 00:32:39.896 A:middle
little bit laborious and so

00:32:39.896 --> 00:32:41.596 A:middle
we've got some factory helpers

00:32:41.596 --> 00:32:43.386 A:middle
to assist you here.

00:32:43.616 --> 00:32:45.276 A:middle
Here's an example in Swift.

00:32:45.576 --> 00:32:47.276 A:middle
I'm creating a payment shipping

00:32:47.276 --> 00:32:48.346 A:middle
address invalid error.

00:32:48.636 --> 00:32:49.806 A:middle
And you'll see that this takes

00:32:49.806 --> 00:32:51.676 A:middle
two properties at two

00:32:51.676 --> 00:32:52.386 A:middle
parameters.

00:32:52.646 --> 00:32:55.506 A:middle
It takes a CN contact key

00:32:55.506 --> 00:32:57.026 A:middle
indicating the field that was

00:32:57.026 --> 00:32:57.366 A:middle
wrong.

00:32:57.366 --> 00:32:58.826 A:middle
So, in this case, the error is

00:32:59.006 --> 00:33:00.446 A:middle
the user put a wrong country in

00:33:00.446 --> 00:33:01.886 A:middle
and we only deliver to the US.

00:33:02.136 --> 00:33:03.616 A:middle
So, I say CN postal address

00:33:03.616 --> 00:33:04.296 A:middle
country key.

00:33:04.566 --> 00:33:05.966 A:middle
And then the localized

00:33:05.966 --> 00:33:06.626 A:middle
description.

00:33:06.746 --> 00:33:08.026 A:middle
This is a localized error that

00:33:08.026 --> 00:33:09.126 A:middle
you provide that will be

00:33:09.126 --> 00:33:09.946 A:middle
displayed in the sheet.

00:33:10.746 --> 00:33:12.796 A:middle
Now, in ES6 and JavaScript,

00:33:12.796 --> 00:33:14.456 A:middle
obviously NSError doesn't exist.

00:33:14.786 --> 00:33:17.616 A:middle
So, we have a new type called

00:33:17.616 --> 00:33:18.506 A:middle
Apple Pay Error.

00:33:18.506 --> 00:33:20.476 A:middle
You can check for the existence

00:33:20.476 --> 00:33:21.936 A:middle
of this type to determine

00:33:21.936 --> 00:33:24.026 A:middle
whether Safari supports this new

00:33:24.026 --> 00:33:24.316 A:middle
API.

00:33:25.026 --> 00:33:27.496 A:middle
And here you provide the type of

00:33:27.496 --> 00:33:29.226 A:middle
error, shipping contact is

00:33:29.526 --> 00:33:30.116 A:middle
invalid.

00:33:30.116 --> 00:33:31.326 A:middle
The field it relates to,

00:33:31.396 --> 00:33:33.046 A:middle
country, and your localized

00:33:33.046 --> 00:33:33.606 A:middle
description.

00:33:33.816 --> 00:33:35.916 A:middle
And most of our delegate

00:33:35.916 --> 00:33:37.936 A:middle
callback have changed.

00:33:38.436 --> 00:33:39.826 A:middle
So, here's another example,

00:33:39.826 --> 00:33:41.456 A:middle
didSelectShipingContract, and it

00:33:41.456 --> 00:33:42.216 A:middle
takes an object,

00:33:42.596 --> 00:33:43.826 A:middle
PKPaymentRequest

00:33:44.046 --> 00:33:45.366 A:middle
ShippingContactUpdate.

00:33:46.736 --> 00:33:48.516 A:middle
Now, like for like APIs are

00:33:48.646 --> 00:33:50.666 A:middle
available in Safari 11.

00:33:50.666 --> 00:33:53.066 A:middle
Safari 11, only on iOS 11 and

00:33:53.066 --> 00:33:54.366 A:middle
macOS High Sierra.

00:33:54.366 --> 00:33:56.156 A:middle
It's not support on Safari 11

00:33:56.156 --> 00:33:58.066 A:middle
running on older versions of the

00:33:58.066 --> 00:33:59.696 A:middle
operating system.

00:33:59.826 --> 00:34:01.166 A:middle
Now, because JavaScript is a

00:34:01.166 --> 00:34:02.406 A:middle
little more forgiving when it

00:34:02.406 --> 00:34:04.646 A:middle
comes to API's we haven't had to

00:34:04.646 --> 00:34:06.086 A:middle
actually make a deprecation

00:34:06.086 --> 00:34:06.386 A:middle
here.

00:34:06.666 --> 00:34:07.706 A:middle
The existing completion

00:34:07.706 --> 00:34:08.686 A:middle
functions have nearly been

00:34:08.686 --> 00:34:09.456 A:middle
overloaded.

00:34:09.776 --> 00:34:12.266 A:middle
So, here is the old API, you'll

00:34:12.266 --> 00:34:13.636 A:middle
see we passed in individual

00:34:13.636 --> 00:34:15.586 A:middle
items, the total, the line

00:34:15.586 --> 00:34:16.726 A:middle
items, the status.

00:34:16.936 --> 00:34:18.826 A:middle
And the new API, we simply pass

00:34:18.826 --> 00:34:20.176 A:middle
in an object.

00:34:20.436 --> 00:34:21.546 A:middle
So, if you're actually writing

00:34:21.546 --> 00:34:22.696 A:middle
Apple Pay on web, this is a

00:34:22.696 --> 00:34:23.766 A:middle
pretty straightforward change

00:34:23.766 --> 00:34:24.066 A:middle
for you.

00:34:24.846 --> 00:34:25.876 A:middle
Now, if you are writing Apple

00:34:25.876 --> 00:34:28.076 A:middle
Pay in application, I want to

00:34:28.076 --> 00:34:29.416 A:middle
show you that it's really not

00:34:29.416 --> 00:34:31.136 A:middle
that much work to implement this

00:34:31.136 --> 00:34:31.586 A:middle
new API.

00:34:31.586 --> 00:34:33.686 A:middle
And to do that, I'm going to ask

00:34:33.686 --> 00:34:35.276 A:middle
Jon to come up and he's going to

00:34:35.276 --> 00:34:36.366 A:middle
give you a quick demo of how to

00:34:36.366 --> 00:34:37.816 A:middle
migrate an Apple Pay App.

00:34:38.206 --> 00:34:38.486 A:middle
Jon.

00:34:39.516 --> 00:34:42.756 A:middle
[ Applause ]

00:34:43.256 --> 00:34:43.856 A:middle
&gt;&gt; Hi, everyone.

00:34:44.026 --> 00:34:45.366 A:middle
I'm Jon and I'm going to show

00:34:45.366 --> 00:34:47.446 A:middle
you how easy it is to update and

00:34:47.446 --> 00:34:49.306 A:middle
existing Apple Pay project in

00:34:49.376 --> 00:34:50.856 A:middle
Swift, to the new API.

00:34:51.646 --> 00:34:53.276 A:middle
So, I'm going to be going

00:34:53.276 --> 00:34:54.396 A:middle
through four things today.

00:34:54.956 --> 00:34:56.516 A:middle
First, I'll take a look at an

00:34:56.646 --> 00:34:58.726 A:middle
existing project's code and see

00:34:58.726 --> 00:35:00.026 A:middle
its current implementation.

00:35:00.346 --> 00:35:01.416 A:middle
And if you've worked with Apple

00:35:01.416 --> 00:35:03.076 A:middle
Pay before, most of this stuff

00:35:03.076 --> 00:35:04.436 A:middle
will be familiar to you already.

00:35:05.196 --> 00:35:06.756 A:middle
Second, I'll deploy the app to

00:35:06.756 --> 00:35:08.616 A:middle
the simulator and interact with

00:35:08.616 --> 00:35:10.686 A:middle
the Apple Pay sheet as if I were

00:35:10.686 --> 00:35:12.516 A:middle
a customer of your app trying to

00:35:12.516 --> 00:35:14.216 A:middle
ship an item to one of my

00:35:14.216 --> 00:35:14.776 A:middle
friends.

00:35:15.496 --> 00:35:17.516 A:middle
The next thing I'll do is I'll

00:35:17.516 --> 00:35:18.816 A:middle
update the code that we have

00:35:19.256 --> 00:35:21.126 A:middle
with the new API and show you

00:35:21.126 --> 00:35:22.476 A:middle
three different errors that

00:35:22.476 --> 00:35:23.736 A:middle
we've introduced this year.

00:35:24.446 --> 00:35:26.216 A:middle
And lastly, I'll deploy the app

00:35:26.216 --> 00:35:27.986 A:middle
again to the simulator and show

00:35:27.986 --> 00:35:29.576 A:middle
you the differences in behaviors

00:35:29.866 --> 00:35:31.576 A:middle
from the old Apple Pay sheet and

00:35:31.576 --> 00:35:32.606 A:middle
the new Apple Pay sheet.

00:35:33.266 --> 00:35:34.456 A:middle
So, let's take a look at what we

00:35:34.456 --> 00:35:34.736 A:middle
have.

00:35:36.426 --> 00:35:37.916 A:middle
So, as you can see, our app is

00:35:37.916 --> 00:35:38.536 A:middle
pretty simple.

00:35:38.726 --> 00:35:40.896 A:middle
It has an image of the item that

00:35:40.896 --> 00:35:43.026 A:middle
we want to purchase, as well as

00:35:43.026 --> 00:35:44.346 A:middle
a Buy with Apple Pay button.

00:35:44.806 --> 00:35:46.116 A:middle
So, let's jump into the code.

00:35:47.106 --> 00:35:48.476 A:middle
The first function we have is

00:35:48.546 --> 00:35:50.716 A:middle
viewDidLoad and in here, we're

00:35:50.716 --> 00:35:52.216 A:middle
creating a PKPayment button,

00:35:52.586 --> 00:35:54.266 A:middle
setting the type to buy and the

00:35:54.326 --> 00:35:56.356 A:middle
style to black, as well as

00:35:56.356 --> 00:35:58.076 A:middle
adding it to the view.

00:35:58.076 --> 00:36:00.746 A:middle
And in the add to view function,

00:36:01.026 --> 00:36:02.446 A:middle
we're adding various constraints

00:36:02.446 --> 00:36:04.066 A:middle
to it as well as setting the

00:36:04.066 --> 00:36:06.306 A:middle
target, when I click it to this

00:36:06.306 --> 00:36:07.986 A:middle
next function, startPayment.

00:36:08.496 --> 00:36:11.016 A:middle
So, let's take a look at that.

00:36:11.496 --> 00:36:13.076 A:middle
So, here the first things we do

00:36:13.446 --> 00:36:15.226 A:middle
is create a few PKPayment

00:36:15.226 --> 00:36:17.296 A:middle
summary items, as well as a

00:36:17.296 --> 00:36:18.496 A:middle
PKShipping method.

00:36:18.846 --> 00:36:20.066 A:middle
And then the last thing is

00:36:20.096 --> 00:36:22.646 A:middle
create an array of those objects

00:36:22.646 --> 00:36:24.646 A:middle
that we'll later pass in to the

00:36:24.646 --> 00:36:25.586 A:middle
PKPayment request.

00:36:26.656 --> 00:36:27.516 A:middle
So, let's take a look at the

00:36:27.516 --> 00:36:28.706 A:middle
payment request.

00:36:29.746 --> 00:36:30.986 A:middle
Here, it's pretty simple.

00:36:31.056 --> 00:36:33.186 A:middle
After we initialize it, we set

00:36:33.186 --> 00:36:35.176 A:middle
the payment summary items to the

00:36:35.176 --> 00:36:37.096 A:middle
items that we created before, as

00:36:37.096 --> 00:36:38.566 A:middle
well as set various properties,

00:36:39.006 --> 00:36:40.856 A:middle
such as a merchant identifier,

00:36:40.856 --> 00:36:41.936 A:middle
the capabilities.

00:36:42.306 --> 00:36:43.646 A:middle
Etcetera, etcetera.

00:36:44.306 --> 00:36:46.166 A:middle
The last thing, this last line

00:36:46.166 --> 00:36:47.336 A:middle
is probably the most important.

00:36:47.726 --> 00:36:49.676 A:middle
It's required shipping contact

00:36:49.676 --> 00:36:49.916 A:middle
field.

00:36:50.596 --> 00:36:52.196 A:middle
And this is a new property in

00:36:52.196 --> 00:36:53.316 A:middle
PKPayment request.

00:36:53.986 --> 00:36:55.976 A:middle
And here it takes in a set of PK

00:36:55.976 --> 00:36:58.076 A:middle
content fields and in this case,

00:36:58.256 --> 00:37:00.076 A:middle
the developer is requesting the

00:37:00.076 --> 00:37:01.826 A:middle
user provide an email address,

00:37:02.156 --> 00:37:03.616 A:middle
as well as a postal address.

00:37:03.926 --> 00:37:05.546 A:middle
So, the last thing we do in this

00:37:05.546 --> 00:37:08.056 A:middle
function is create a PKPayment

00:37:08.056 --> 00:37:10.296 A:middle
authorization controller, with

00:37:10.296 --> 00:37:11.386 A:middle
this payment request that we

00:37:11.386 --> 00:37:11.886 A:middle
created.

00:37:12.346 --> 00:37:13.676 A:middle
Set the delegate to ourselves

00:37:14.166 --> 00:37:14.926 A:middle
and present it.

00:37:15.346 --> 00:37:16.416 A:middle
So, that's pretty simple.

00:37:17.646 --> 00:37:18.946 A:middle
So, let's take a look at the

00:37:18.946 --> 00:37:19.626 A:middle
protocol.

00:37:20.586 --> 00:37:22.356 A:middle
The first function we have, it's

00:37:22.356 --> 00:37:23.766 A:middle
a didSelectShippingContact

00:37:23.766 --> 00:37:24.246 A:middle
function.

00:37:24.746 --> 00:37:26.516 A:middle
So, this gets called whenever

00:37:26.516 --> 00:37:27.906 A:middle
the Apple Pay sheet first comes

00:37:27.906 --> 00:37:30.416 A:middle
up, as well as whenever a user

00:37:30.416 --> 00:37:32.366 A:middle
edits one of their addresses, or

00:37:32.366 --> 00:37:33.626 A:middle
selects a new address.

00:37:34.426 --> 00:37:35.406 A:middle
And you can tell that this is

00:37:35.406 --> 00:37:36.726 A:middle
the old API because this

00:37:36.726 --> 00:37:38.496 A:middle
completion block takes in a

00:37:38.496 --> 00:37:40.306 A:middle
PKPaymentAuthorizationStatus

00:37:40.306 --> 00:37:40.696 A:middle
Enum.

00:37:41.436 --> 00:37:43.006 A:middle
Another thing to note is that

00:37:43.006 --> 00:37:44.646 A:middle
this contact information is

00:37:44.646 --> 00:37:47.186 A:middle
actually redacted, so you don't

00:37:47.186 --> 00:37:48.816 A:middle
get information like the email

00:37:48.816 --> 00:37:51.436 A:middle
address, the phone number, or

00:37:51.436 --> 00:37:53.006 A:middle
the street until the user

00:37:53.006 --> 00:37:54.136 A:middle
authorizes the payment.

00:37:54.136 --> 00:37:57.416 A:middle
So, let's see what we have here.

00:37:57.966 --> 00:37:59.166 A:middle
So, we're doing some basic

00:37:59.166 --> 00:38:01.226 A:middle
validation and in this case,

00:38:01.226 --> 00:38:02.756 A:middle
we're just checking if the state

00:38:02.756 --> 00:38:03.366 A:middle
is valid.

00:38:03.746 --> 00:38:05.236 A:middle
And if it's not, we set the

00:38:05.236 --> 00:38:05.956 A:middle
status to

00:38:05.956 --> 00:38:07.686 A:middle
invalidShippingPostalAddress.

00:38:08.156 --> 00:38:09.516 A:middle
Otherwise, we set the payment

00:38:09.516 --> 00:38:10.636 A:middle
status to success.

00:38:11.346 --> 00:38:12.406 A:middle
The last thing we do, it's

00:38:12.406 --> 00:38:13.436 A:middle
called the completion block,

00:38:13.856 --> 00:38:15.876 A:middle
with that paymentStatus, as well

00:38:15.876 --> 00:38:17.366 A:middle
as the same shipping methods,

00:38:17.576 --> 00:38:18.806 A:middle
and the same payment summary

00:38:18.806 --> 00:38:19.236 A:middle
items.

00:38:19.776 --> 00:38:21.166 A:middle
Of course, you can update the

00:38:21.166 --> 00:38:22.626 A:middle
shipping methods and the summary

00:38:22.626 --> 00:38:23.956 A:middle
items if you needed to.

00:38:23.956 --> 00:38:25.716 A:middle
But in this case, we're just

00:38:25.716 --> 00:38:26.706 A:middle
passing the same ones.

00:38:27.906 --> 00:38:29.736 A:middle
So, the next function we have is

00:38:29.736 --> 00:38:31.626 A:middle
the didAuthorizePaymentMethod.

00:38:31.626 --> 00:38:33.346 A:middle
And this gets called after the

00:38:33.346 --> 00:38:34.876 A:middle
user authorizes the payment,

00:38:35.296 --> 00:38:36.846 A:middle
using Touch ID, or with

00:38:36.846 --> 00:38:37.456 A:middle
Passcode.

00:38:38.026 --> 00:38:39.486 A:middle
And another thing to note is

00:38:39.486 --> 00:38:41.326 A:middle
that this PKPayment object

00:38:41.726 --> 00:38:43.526 A:middle
contains a property shipping

00:38:43.526 --> 00:38:46.166 A:middle
contact, with the full contact

00:38:46.166 --> 00:38:46.846 A:middle
information.

00:38:47.226 --> 00:38:48.506 A:middle
So, you're given the email

00:38:48.506 --> 00:38:50.016 A:middle
address, the phone and the

00:38:50.016 --> 00:38:51.426 A:middle
street that you were not given

00:38:51.426 --> 00:38:52.146 A:middle
previously.

00:38:52.626 --> 00:38:53.836 A:middle
So, we hope that you can

00:38:53.836 --> 00:38:55.386 A:middle
validate the full contact

00:38:55.386 --> 00:38:56.926 A:middle
information in this method.

00:38:58.296 --> 00:38:59.876 A:middle
And for simplicity sake, all

00:38:59.876 --> 00:39:00.666 A:middle
we're doing is checking the

00:39:00.666 --> 00:39:02.216 A:middle
email, but you can do more of

00:39:02.216 --> 00:39:02.616 A:middle
course.

00:39:03.066 --> 00:39:05.646 A:middle
And if the email check fails, we

00:39:05.646 --> 00:39:07.756 A:middle
set the payment status to the

00:39:07.876 --> 00:39:10.286 A:middle
Enum invalidShippingContact.

00:39:11.316 --> 00:39:13.206 A:middle
And if it succeeds, we set the

00:39:13.206 --> 00:39:14.666 A:middle
payment status to success.

00:39:15.206 --> 00:39:16.236 A:middle
The last thing we do is call the

00:39:16.236 --> 00:39:17.286 A:middle
completion block with that

00:39:17.286 --> 00:39:17.756 A:middle
status.

00:39:18.266 --> 00:39:19.456 A:middle
So, let's see how this works

00:39:19.866 --> 00:39:21.706 A:middle
after we deploy it and interact

00:39:21.706 --> 00:39:22.916 A:middle
with the Apple Pay sheet in the

00:39:22.916 --> 00:39:23.406 A:middle
simulator.

00:39:23.406 --> 00:39:26.706 A:middle
So, the app comes up.

00:39:27.406 --> 00:39:28.566 A:middle
We tap the buy with Apple Pay

00:39:28.566 --> 00:39:28.916 A:middle
button.

00:39:29.026 --> 00:39:30.076 A:middle
And the Apple Pay sheet comes

00:39:30.076 --> 00:39:30.296 A:middle
up.

00:39:30.846 --> 00:39:31.966 A:middle
So, let's say I want to ship

00:39:31.966 --> 00:39:33.506 A:middle
this to my friend Sarah.

00:39:34.086 --> 00:39:35.906 A:middle
After I select shipping, I can

00:39:35.906 --> 00:39:38.466 A:middle
select add shipping address and

00:39:38.466 --> 00:39:40.946 A:middle
as you can see, this is the new

00:39:40.946 --> 00:39:43.996 A:middle
UI to add a shipping address.

00:39:44.556 --> 00:39:45.826 A:middle
So, you can either enter it

00:39:45.826 --> 00:39:47.596 A:middle
manually or search one of your

00:39:47.596 --> 00:39:49.766 A:middle
contacts, or use one of the

00:39:49.766 --> 00:39:51.976 A:middle
suggested locations that the

00:39:52.096 --> 00:39:53.726 A:middle
Apple Pay sheet provides for

00:39:53.726 --> 00:39:53.926 A:middle
you.

00:39:54.396 --> 00:39:56.056 A:middle
In this case, I'm just going to

00:39:56.056 --> 00:39:57.246 A:middle
select my friend Sarah.

00:39:57.616 --> 00:40:00.076 A:middle
She lives in Hawaii, so it might

00:40:00.076 --> 00:40:01.586 A:middle
be a little bit, there might be

00:40:01.586 --> 00:40:02.766 A:middle
some problems with the address.

00:40:03.106 --> 00:40:03.666 A:middle
Well, let's see.

00:40:04.316 --> 00:40:06.816 A:middle
Of course, there's an error.

00:40:07.216 --> 00:40:09.106 A:middle
And you can see that the text is

00:40:09.106 --> 00:40:10.866 A:middle
red so the user knows that

00:40:10.866 --> 00:40:11.836 A:middle
there's something wrong with the

00:40:11.836 --> 00:40:12.286 A:middle
address.

00:40:12.766 --> 00:40:15.216 A:middle
But it's not really clear where

00:40:15.326 --> 00:40:16.836 A:middle
the issue is.

00:40:17.246 --> 00:40:19.256 A:middle
As I look at it, the street

00:40:19.256 --> 00:40:20.226 A:middle
seems fine.

00:40:20.496 --> 00:40:21.576 A:middle
Hawaii is a valid state.

00:40:21.736 --> 00:40:23.406 A:middle
Everything looks fine.

00:40:23.406 --> 00:40:26.896 A:middle
And so, if I select that, again,

00:40:27.386 --> 00:40:28.506 A:middle
there's not a lot of information

00:40:28.506 --> 00:40:29.376 A:middle
on what's wrong with the

00:40:29.376 --> 00:40:29.926 A:middle
address.

00:40:30.516 --> 00:40:33.686 A:middle
I know my friend, Daniel, likes

00:40:33.686 --> 00:40:34.526 A:middle
this item as well.

00:40:34.906 --> 00:40:36.266 A:middle
So, he lives in California.

00:40:36.266 --> 00:40:37.506 A:middle
So, let's just see if we can

00:40:37.506 --> 00:40:38.236 A:middle
ship it to him.

00:40:38.316 --> 00:40:40.946 A:middle
After we got back, it looks like

00:40:40.946 --> 00:40:41.746 A:middle
there's no more error.

00:40:42.126 --> 00:40:42.806 A:middle
So, there must have been

00:40:42.806 --> 00:40:44.216 A:middle
something wrong with Sarah's

00:40:44.216 --> 00:40:45.776 A:middle
address, but it wasn't clear to

00:40:45.776 --> 00:40:47.796 A:middle
me what was the actual issue.

00:40:48.086 --> 00:40:49.626 A:middle
So, let's try to authorize this

00:40:49.626 --> 00:40:51.226 A:middle
payment by hitting the Pay with

00:40:51.226 --> 00:40:54.676 A:middle
Passcode button.

00:40:54.676 --> 00:40:55.946 A:middle
The Apple Pay sheet shows that

00:40:55.946 --> 00:40:56.686 A:middle
there's an error with the

00:40:56.686 --> 00:40:57.246 A:middle
contact.

00:40:57.846 --> 00:40:59.416 A:middle
Again, the text is highlighted

00:40:59.416 --> 00:40:59.756 A:middle
red.

00:41:00.216 --> 00:41:02.606 A:middle
And if I select that, there's no

00:41:02.776 --> 00:41:06.126 A:middle
clear text showing what's wrong

00:41:06.126 --> 00:41:07.356 A:middle
with this contact information.

00:41:07.736 --> 00:41:09.236 A:middle
It could be the percent sign, it

00:41:09.736 --> 00:41:12.356 A:middle
could be just I don't like an

00:41:12.356 --> 00:41:13.836 A:middle
iCloud.com email address.

00:41:14.406 --> 00:41:15.636 A:middle
So, let's just select Daniel's

00:41:15.766 --> 00:41:16.986 A:middle
real email address to see how

00:41:16.986 --> 00:41:17.566 A:middle
that works.

00:41:18.536 --> 00:41:20.456 A:middle
After we select that, we hit Pay

00:41:20.456 --> 00:41:22.766 A:middle
with Passcode and the payment

00:41:22.766 --> 00:41:23.286 A:middle
succeeds.

00:41:23.816 --> 00:41:25.696 A:middle
Okay, so that's good.

00:41:26.166 --> 00:41:27.676 A:middle
But as a user, it was really

00:41:27.676 --> 00:41:29.386 A:middle
difficult to figure out what was

00:41:29.386 --> 00:41:30.526 A:middle
wrong with the address that we

00:41:30.526 --> 00:41:31.346 A:middle
had previously.

00:41:31.846 --> 00:41:33.696 A:middle
So, let's implement the new APIs

00:41:33.696 --> 00:41:34.426 A:middle
that we have.

00:41:34.736 --> 00:41:36.336 A:middle
So, the first function that we

00:41:36.336 --> 00:41:36.836 A:middle
have is a

00:41:36.836 --> 00:41:39.866 A:middle
didSelectShippingContact method.

00:41:40.546 --> 00:41:42.646 A:middle
And here it takes in a

00:41:42.936 --> 00:41:43.726 A:middle
PKPaymentRequest

00:41:43.726 --> 00:41:45.326 A:middle
ShippingContactUpdate object.

00:41:45.966 --> 00:41:48.816 A:middle
The first thing we want to do is

00:41:48.816 --> 00:41:50.716 A:middle
we have a local variable of the

00:41:50.716 --> 00:41:53.296 A:middle
update before and we don't

00:41:53.296 --> 00:41:54.246 A:middle
initialize it yet.

00:41:54.906 --> 00:41:56.806 A:middle
We'll initialize it afterwards,

00:41:57.076 --> 00:41:58.836 A:middle
after we check the errors that

00:41:58.836 --> 00:41:59.206 A:middle
we have.

00:41:59.876 --> 00:42:01.326 A:middle
The next thing we do is create

00:42:01.326 --> 00:42:03.386 A:middle
an array of errors that we'll

00:42:03.386 --> 00:42:05.556 A:middle
append to as we validate the

00:42:05.906 --> 00:42:07.446 A:middle
address.

00:42:07.686 --> 00:42:09.606 A:middle
So, similar to before, we're

00:42:09.606 --> 00:42:11.216 A:middle
checking if the state is valid.

00:42:11.636 --> 00:42:13.676 A:middle
And if it's not valid, instead

00:42:13.676 --> 00:42:15.496 A:middle
of setting the status to an

00:42:15.496 --> 00:42:17.416 A:middle
invalid shipping address, we'll

00:42:17.416 --> 00:42:19.006 A:middle
append an error, a new type of

00:42:19.006 --> 00:42:19.246 A:middle
error.

00:42:19.596 --> 00:42:20.966 A:middle
A paymentShipingAddress

00:42:20.966 --> 00:42:22.056 A:middle
UnserviceableError.

00:42:22.506 --> 00:42:24.576 A:middle
And in here, all it takes is a

00:42:24.576 --> 00:42:25.656 A:middle
localized description.

00:42:26.206 --> 00:42:27.406 A:middle
And in this case, we're saying

00:42:27.826 --> 00:42:29.266 A:middle
that we're unable to ship to

00:42:29.266 --> 00:42:31.276 A:middle
this state.

00:42:31.596 --> 00:42:32.936 A:middle
Let's see, we'll add another

00:42:32.936 --> 00:42:33.636 A:middle
check that we didn't do

00:42:33.636 --> 00:42:35.376 A:middle
previously, which is check if

00:42:35.376 --> 00:42:36.406 A:middle
the zip is valid.

00:42:37.036 --> 00:42:39.016 A:middle
And this is another type of

00:42:39.016 --> 00:42:40.776 A:middle
error a paymentShippingAddress

00:42:40.816 --> 00:42:41.596 A:middle
InvalidError.

00:42:42.056 --> 00:42:44.556 A:middle
And this takes in a key, a

00:42:44.556 --> 00:42:46.356 A:middle
CNPostalAddress key.

00:42:46.976 --> 00:42:48.236 A:middle
And in this case we're taking a

00:42:48.236 --> 00:42:50.206 A:middle
CNPostalAddress postal code key,

00:42:50.566 --> 00:42:53.536 A:middle
which tells PassKit to show

00:42:53.836 --> 00:42:56.076 A:middle
where the error is while the

00:42:56.076 --> 00:42:57.346 A:middle
user tries to edit their

00:42:57.346 --> 00:42:57.876 A:middle
address.

00:42:59.396 --> 00:43:00.386 A:middle
Again, this takes in

00:43:00.386 --> 00:43:03.566 A:middle
localizedDescription, the zip

00:43:03.906 --> 00:43:05.666 A:middle
code doesn't match the city.

00:43:06.556 --> 00:43:08.646 A:middle
Yeah, so let's continue.

00:43:09.036 --> 00:43:10.986 A:middle
And the next thing we do is

00:43:10.986 --> 00:43:12.446 A:middle
check if the errors array is

00:43:12.446 --> 00:43:12.926 A:middle
empty.

00:43:13.096 --> 00:43:16.186 A:middle
If it is, we'll initialize our

00:43:16.186 --> 00:43:17.606 A:middle
update object with the

00:43:17.606 --> 00:43:19.376 A:middle
paymentSummaryItems, unchanged.

00:43:19.826 --> 00:43:22.256 A:middle
Otherwise, we'll initialize the

00:43:22.256 --> 00:43:25.436 A:middle
update object with the errors as

00:43:25.436 --> 00:43:27.056 A:middle
well as the payment summary

00:43:27.056 --> 00:43:28.486 A:middle
items and the shipping methods.

00:43:29.576 --> 00:43:32.256 A:middle
So, the last thing we do here is

00:43:32.386 --> 00:43:33.626 A:middle
call the completion block, with

00:43:33.786 --> 00:43:34.596 A:middle
this new object.

00:43:35.936 --> 00:43:37.516 A:middle
So, let's fix our

00:43:37.516 --> 00:43:38.906 A:middle
didAuthorizePayment function.

00:43:39.406 --> 00:43:42.536 A:middle
So, this is the old code that we

00:43:42.536 --> 00:43:43.856 A:middle
have, so we can comment that

00:43:43.856 --> 00:43:44.156 A:middle
out.

00:43:44.726 --> 00:43:46.026 A:middle
And the first thing we do,

00:43:46.146 --> 00:43:48.956 A:middle
similarly to before, is create

00:43:49.366 --> 00:43:50.856 A:middle
an array of errors that we'll

00:43:50.856 --> 00:43:51.476 A:middle
append to.

00:43:52.766 --> 00:43:54.166 A:middle
In this case, we're checking one

00:43:54.166 --> 00:43:56.006 A:middle
thing, which is if the email

00:43:56.006 --> 00:43:57.966 A:middle
address is valid or not.

00:43:58.406 --> 00:44:01.756 A:middle
And if it's not, we'll append

00:44:01.756 --> 00:44:03.236 A:middle
another type of error, a

00:44:03.236 --> 00:44:04.846 A:middle
paymentContactInvalidError.

00:44:05.156 --> 00:44:06.006 A:middle
And instead of taking a

00:44:06.006 --> 00:44:08.236 A:middle
CNPostalAddress key, this takes

00:44:08.236 --> 00:44:10.476 A:middle
in a PKContact field key.

00:44:11.356 --> 00:44:13.456 A:middle
And here, we're passing and

00:44:13.966 --> 00:44:16.626 A:middle
email address so that it can

00:44:16.626 --> 00:44:18.236 A:middle
show in the correct location.

00:44:18.676 --> 00:44:20.016 A:middle
Okay, and that takes another

00:44:20.016 --> 00:44:21.946 A:middle
localized description that will

00:44:21.946 --> 00:44:23.136 A:middle
be presented on the Apple Pay

00:44:23.136 --> 00:44:23.476 A:middle
sheet.

00:44:26.476 --> 00:44:28.206 A:middle
Similarly, we're checking if the

00:44:28.206 --> 00:44:29.946 A:middle
errors array is empty.

00:44:30.376 --> 00:44:31.986 A:middle
If it is, we'll set this status

00:44:32.096 --> 00:44:32.796 A:middle
to success.

00:44:33.046 --> 00:44:34.536 A:middle
Otherwise, we'll set the status

00:44:34.926 --> 00:44:35.596 A:middle
to failure.

00:44:35.966 --> 00:44:37.696 A:middle
And the last thing we do is call

00:44:37.696 --> 00:44:39.736 A:middle
the completion block with

00:44:39.816 --> 00:44:40.446 A:middle
initialize

00:44:40.446 --> 00:44:42.316 A:middle
PKPaymentAuthorizationResult,

00:44:42.926 --> 00:44:44.626 A:middle
using that same status as well

00:44:44.626 --> 00:44:45.786 A:middle
as the errors that we created.

00:44:46.996 --> 00:44:48.326 A:middle
So, let's see how this works

00:44:48.476 --> 00:44:50.136 A:middle
after we deploy it.

00:44:51.316 --> 00:44:52.956 A:middle
After the app comes up, we'll

00:44:52.956 --> 00:44:53.856 A:middle
hit the Buy with Apple Pay

00:44:53.856 --> 00:44:54.926 A:middle
button once again.

00:44:54.926 --> 00:44:57.196 A:middle
And immediately we're presented

00:44:57.196 --> 00:44:57.766 A:middle
with an error.

00:44:58.256 --> 00:44:59.376 A:middle
The app doesn't ship to this

00:44:59.376 --> 00:45:00.066 A:middle
shipping address.

00:45:00.066 --> 00:45:01.396 A:middle
So, this is one of the new

00:45:01.396 --> 00:45:02.356 A:middle
errors that we've introduced

00:45:02.356 --> 00:45:02.816 A:middle
this year.

00:45:03.596 --> 00:45:05.616 A:middle
And there's a shipping

00:45:05.616 --> 00:45:08.506 A:middle
unavailable text underneath out

00:45:08.506 --> 00:45:08.976 A:middle
contact.

00:45:09.496 --> 00:45:11.456 A:middle
After I select that, there's

00:45:11.456 --> 00:45:13.516 A:middle
text underneath our contact

00:45:13.516 --> 00:45:14.736 A:middle
saying unable to ship to this

00:45:14.736 --> 00:45:15.066 A:middle
state.

00:45:15.516 --> 00:45:16.946 A:middle
So, this is pretty clear to the

00:45:16.946 --> 00:45:19.826 A:middle
user, saying that the app

00:45:19.956 --> 00:45:21.516 A:middle
doesn't support shipping to

00:45:21.516 --> 00:45:22.066 A:middle
Hawaii.

00:45:22.736 --> 00:45:24.496 A:middle
Let's try to ship this to my

00:45:24.496 --> 00:45:26.816 A:middle
friend, John Appleseed whose

00:45:27.226 --> 00:45:29.006 A:middle
shipping address is in

00:45:29.296 --> 00:45:29.936 A:middle
Cupertino.

00:45:30.056 --> 00:45:33.286 A:middle
After I select that, an error

00:45:33.366 --> 00:45:35.496 A:middle
shows up saying that the zip

00:45:35.496 --> 00:45:36.586 A:middle
code doesn't match the city.

00:45:37.166 --> 00:45:39.006 A:middle
And if I select that address,

00:45:39.876 --> 00:45:41.786 A:middle
the zip code is highlighted in

00:45:41.786 --> 00:45:42.136 A:middle
red.

00:45:42.636 --> 00:45:45.296 A:middle
And because I know that 12345

00:45:45.536 --> 00:45:47.446 A:middle
isn't the proper zip code to

00:45:47.446 --> 00:45:49.906 A:middle
Cupertino I can fix that and

00:45:49.906 --> 00:45:53.386 A:middle
write 95014, hit done to save

00:45:53.386 --> 00:45:53.576 A:middle
it.

00:45:53.976 --> 00:45:56.126 A:middle
Go back, and I fixed all the

00:45:56.246 --> 00:45:57.526 A:middle
contact information, or the

00:45:57.526 --> 00:45:59.586 A:middle
address issues that I've had.

00:46:00.336 --> 00:46:01.746 A:middle
Again, let's try to pay with

00:46:01.746 --> 00:46:04.816 A:middle
Passcode and see that we have an

00:46:04.816 --> 00:46:06.346 A:middle
error with our contact

00:46:06.346 --> 00:46:07.026 A:middle
information.

00:46:07.676 --> 00:46:09.696 A:middle
After we click that, we see that

00:46:10.226 --> 00:46:11.496 A:middle
there's an invalid character

00:46:11.496 --> 00:46:13.326 A:middle
found in the email, which is the

00:46:13.326 --> 00:46:14.176 A:middle
percent sign.

00:46:14.626 --> 00:46:17.036 A:middle
So, as a user I can edit this

00:46:17.036 --> 00:46:18.296 A:middle
email address to remove that

00:46:18.296 --> 00:46:20.116 A:middle
percent sign, or I can just

00:46:20.116 --> 00:46:22.676 A:middle
select another email address.

00:46:23.196 --> 00:46:24.556 A:middle
So, I'll select John Appleseed's

00:46:24.556 --> 00:46:25.956 A:middle
email address, at mac.com.

00:46:27.056 --> 00:46:29.436 A:middle
I went back, hit pay with

00:46:29.436 --> 00:46:31.296 A:middle
Passcode, the payment should

00:46:31.296 --> 00:46:31.836 A:middle
authorize.

00:46:32.466 --> 00:46:34.776 A:middle
And that shows you with the new

00:46:34.776 --> 00:46:36.416 A:middle
APIs that we introduce in iOS

00:46:36.416 --> 00:46:38.866 A:middle
11, you have the power to give

00:46:38.866 --> 00:46:40.646 A:middle
more feedback to the user when

00:46:40.646 --> 00:46:42.136 A:middle
dealing with addresses on the

00:46:42.136 --> 00:46:42.946 A:middle
Apple Pay sheet.

00:46:43.566 --> 00:46:45.146 A:middle
And we hope that this creates a

00:46:45.146 --> 00:46:46.996 A:middle
better user experience, when

00:46:46.996 --> 00:46:48.716 A:middle
users are using Apple Pay within

00:46:48.716 --> 00:46:49.186 A:middle
your apps.

00:46:49.436 --> 00:46:49.976 A:middle
Thank you.

00:46:50.516 --> 00:46:54.546 A:middle
[ Applause ]

00:46:55.046 --> 00:46:55.556 A:middle
&gt;&gt; Thank you Jon.

00:46:55.896 --> 00:46:57.616 A:middle
I hope you all go off and take

00:46:57.616 --> 00:46:59.296 A:middle
the time to update your apps.

00:46:59.716 --> 00:47:01.946 A:middle
I want to talk briefly about

00:47:01.946 --> 00:47:02.986 A:middle
what's new with Wallet.

00:47:03.646 --> 00:47:04.846 A:middle
If you've downloaded [inaudible]

00:47:05.196 --> 00:47:06.746 A:middle
of iOS 11, you might have

00:47:06.746 --> 00:47:08.236 A:middle
noticed one major thing that's

00:47:08.236 --> 00:47:09.706 A:middle
new with Wallet, it looks a

00:47:09.706 --> 00:47:10.336 A:middle
little different.

00:47:10.426 --> 00:47:11.876 A:middle
It's a little brighter.

00:47:12.226 --> 00:47:13.486 A:middle
There's also, if you haven't

00:47:13.486 --> 00:47:14.786 A:middle
found it yet, a new mass

00:47:14.816 --> 00:47:16.396 A:middle
deletion management interface

00:47:16.396 --> 00:47:16.976 A:middle
for your passes.

00:47:16.976 --> 00:47:19.896 A:middle
This new color scheme means that

00:47:19.896 --> 00:47:20.976 A:middle
it's probably a good time for

00:47:20.976 --> 00:47:22.386 A:middle
you to revisit your past

00:47:22.386 --> 00:47:22.876 A:middle
designs.

00:47:23.076 --> 00:47:24.476 A:middle
Take a look at them, make sure

00:47:24.476 --> 00:47:26.126 A:middle
that they look great.

00:47:26.406 --> 00:47:27.816 A:middle
If you never updated them to

00:47:27.816 --> 00:47:30.776 A:middle
have watch assets or 3x assets,

00:47:31.046 --> 00:47:32.006 A:middle
may be a good time.

00:47:32.606 --> 00:47:34.336 A:middle
Well, I also want to give you a

00:47:34.336 --> 00:47:36.256 A:middle
quick update about NFC passes.

00:47:36.256 --> 00:47:38.706 A:middle
NFC passes are regular passes

00:47:38.706 --> 00:47:39.796 A:middle
that let you send customer

00:47:39.796 --> 00:47:41.556 A:middle
information over NFC.

00:47:41.556 --> 00:47:43.696 A:middle
Starting in iOS 11 we are only

00:47:43.696 --> 00:47:45.506 A:middle
going to support a more secure

00:47:45.506 --> 00:47:47.016 A:middle
type of NFC pass that we call

00:47:47.016 --> 00:47:48.606 A:middle
encrypted NFC passes.

00:47:48.606 --> 00:47:50.506 A:middle
If you'd like to know more about

00:47:50.506 --> 00:47:51.856 A:middle
NFC passes, you can check out

00:47:51.856 --> 00:47:52.976 A:middle
last year's session.

00:47:52.976 --> 00:47:54.416 A:middle
You can also go to our

00:47:54.416 --> 00:47:56.606 A:middle
developer's site and find out

00:47:56.606 --> 00:47:58.516 A:middle
more, and register to take

00:47:58.516 --> 00:48:00.506 A:middle
advantage of them.

00:48:00.656 --> 00:48:02.226 A:middle
Now, there's one minor new

00:48:02.226 --> 00:48:03.716 A:middle
feature in Wallet this year for

00:48:03.716 --> 00:48:04.166 A:middle
passes.

00:48:04.166 --> 00:48:05.476 A:middle
And that's sharing.

00:48:05.696 --> 00:48:07.566 A:middle
Much requested feature, passes

00:48:07.566 --> 00:48:09.786 A:middle
can now be opted out sharing.

00:48:10.476 --> 00:48:12.296 A:middle
This is useful for single use

00:48:12.296 --> 00:48:14.266 A:middle
items like loyalty cards of

00:48:14.266 --> 00:48:14.906 A:middle
tickets.

00:48:15.056 --> 00:48:16.256 A:middle
It's really easy to take

00:48:16.256 --> 00:48:16.916 A:middle
advantage of.

00:48:17.366 --> 00:48:19.186 A:middle
It's just a top level JSON key

00:48:19.376 --> 00:48:21.446 A:middle
in your pass JSON.

00:48:21.446 --> 00:48:22.906 A:middle
Here it is sharingProhibited.

00:48:22.906 --> 00:48:24.576 A:middle
So, your gift cards, your

00:48:24.576 --> 00:48:25.826 A:middle
loyalty cards.

00:48:25.826 --> 00:48:27.706 A:middle
You set this to true and the

00:48:27.706 --> 00:48:29.856 A:middle
user can't share it via airdrop,

00:48:29.856 --> 00:48:30.546 A:middle
iMessage.

00:48:30.766 --> 00:48:33.146 A:middle
This is a convenience feature,

00:48:33.146 --> 00:48:34.266 A:middle
not a security feature.

00:48:34.266 --> 00:48:36.726 A:middle
Obviously, users can still share

00:48:36.726 --> 00:48:37.506 A:middle
in other ways.

00:48:37.506 --> 00:48:39.406 A:middle
It won't be supported on older

00:48:39.406 --> 00:48:40.546 A:middle
versions of iOS.

00:48:40.796 --> 00:48:42.426 A:middle
But it's good if you need a good

00:48:42.426 --> 00:48:43.726 A:middle
reason to not allow the user to

00:48:43.726 --> 00:48:45.656 A:middle
share for pure experience

00:48:45.966 --> 00:48:46.816 A:middle
reasons.

00:48:47.666 --> 00:48:50.656 A:middle
That's what's new with Apple Pay

00:48:50.656 --> 00:48:51.766 A:middle
and Wallet.

00:48:52.006 --> 00:48:53.666 A:middle
We saw some guidelines for

00:48:53.666 --> 00:48:55.596 A:middle
building best in brands Apple

00:48:55.596 --> 00:48:57.676 A:middle
Pay experiences, new API for

00:48:57.776 --> 00:48:59.836 A:middle
handling complex errors, and new

00:48:59.836 --> 00:49:02.166 A:middle
ways to share interact passes in

00:49:02.166 --> 00:49:02.306 A:middle
NFC.

00:49:02.306 --> 00:49:03.846 A:middle
And for more information on any

00:49:03.846 --> 00:49:05.456 A:middle
of these things, you can check

00:49:05.456 --> 00:49:06.866 A:middle
out our developer site.

00:49:07.006 --> 00:49:09.126 A:middle
There's something else you also

00:49:09.126 --> 00:49:10.296 A:middle
might want to check out and I

00:49:10.296 --> 00:49:11.636 A:middle
suspect a lot of you in the room

00:49:11.636 --> 00:49:13.236 A:middle
are extremely excited by.

00:49:13.506 --> 00:49:15.796 A:middle
And that is the Core NFC

00:49:15.936 --> 00:49:17.176 A:middle
framework.

00:49:17.176 --> 00:49:20.846 A:middle
Now, you can read NFC tags on

00:49:20.846 --> 00:49:22.916 A:middle
supported hardware.

00:49:23.186 --> 00:49:24.956 A:middle
Now we have a special session

00:49:24.956 --> 00:49:25.316 A:middle
for this.

00:49:25.316 --> 00:49:26.456 A:middle
It's online only.

00:49:26.636 --> 00:49:28.636 A:middle
It's available now.

00:49:28.636 --> 00:49:31.696 A:middle
It's just search introducing

00:49:31.696 --> 00:49:33.686 A:middle
CoreNFC on the WWDC site, check

00:49:33.686 --> 00:49:33.996 A:middle
it out.

00:49:34.616 --> 00:49:35.826 A:middle
That's everything from us for

00:49:35.826 --> 00:49:36.346 A:middle
this year.

00:49:36.576 --> 00:49:38.036 A:middle
I hope you go out now and have a

00:49:38.036 --> 00:49:39.626 A:middle
great beer bash and I hope we'll

00:49:39.626 --> 00:49:41.136 A:middle
see you next year to talk even

00:49:41.136 --> 00:49:42.636 A:middle
more about Apple Pay and Wallet.

00:49:42.836 --> 00:49:43.786 A:middle
Thank you very much.

00:49:44.516 --> 00:49:48.730 A:middle
[ Applause ]
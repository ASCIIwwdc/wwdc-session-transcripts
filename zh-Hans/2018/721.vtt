WEBVTT

00:00:07.516 --> 00:00:15.500 A:middle
［ 音乐 ］

00:00:18.046 --> 00:00:19.216 A:middle
&gt;&gt; 大家好 欢迎来到

00:00:19.216 --> 00:00:22.386 A:middle
有关于自动填充凭证提供商扩展的会议

00:00:23.846 --> 00:00:25.246 A:middle
在这一视频中 我将首先给出

00:00:25.246 --> 00:00:26.506 A:middle
一个关于

00:00:26.506 --> 00:00:28.006 A:middle
密码自动填充功能的概览

00:00:28.006 --> 00:00:29.186 A:middle
以及该功能是如何在 iOS 12 中被进一步改进的

00:00:30.386 --> 00:00:31.986 A:middle
之后 我会深入讲解有关于

00:00:31.986 --> 00:00:33.546 A:middle
密码管理 App

00:00:33.606 --> 00:00:34.786 A:middle
现在如何将密码自动填充

00:00:34.786 --> 00:00:37.326 A:middle
通过 iOS 12 中的新 API 进行整合

00:00:38.846 --> 00:00:39.886 A:middle
同时 我会推荐一些

00:00:39.886 --> 00:00:41.256 A:middle
最佳做法

00:00:41.256 --> 00:00:43.866 A:middle
供你们在采用这些新 API 的时候使用

00:00:45.556 --> 00:00:47.906 A:middle
首先 我们来谈一谈密码自动填充

00:00:50.696 --> 00:00:52.596 A:middle
iOS 11 带来了两项

00:00:52.596 --> 00:00:53.946 A:middle
关于密码自动填充的重大改进

00:00:54.776 --> 00:00:56.186 A:middle
第一 相关成度最高的凭证

00:00:56.186 --> 00:00:57.266 A:middle
会直接显示在

00:00:57.266 --> 00:00:58.416 A:middle
快速输入栏中

00:00:58.706 --> 00:00:59.876 A:middle
所以只需要轻点一下就可以

00:01:00.786 --> 00:01:02.466 A:middle
第二 iOS 11 带来了

00:01:02.466 --> 00:01:04.025 A:middle
App 内的密码自动填充功能

00:01:04.506 --> 00:01:05.836 A:middle
这使得

00:01:05.916 --> 00:01:07.166 A:middle
使用 iCloud 钥匙串中的凭证变得极为方便

00:01:07.166 --> 00:01:08.826 A:middle
无论是在

00:01:08.826 --> 00:01:10.846 A:middle
网页内还是在 App 中

00:01:10.846 --> 00:01:12.006 A:middle
比如你们刚才看到的 那个闪闪发光的 App

00:01:13.996 --> 00:01:17.046 A:middle
在 iOS 和 tvOS 12 中 你还可以在

00:01:17.046 --> 00:01:18.426 A:middle
Apple TV 的 App 中使用密码自动填充

00:01:18.526 --> 00:01:20.306 A:middle
通过在一台 iOS 设备上

00:01:20.306 --> 00:01:23.476 A:middle
来选择需要输入的凭证即可

00:01:23.476 --> 00:01:24.456 A:middle
这些功能对于

00:01:24.456 --> 00:01:26.006 A:middle
iCloud 钥匙串的用户来说棒极了

00:01:26.006 --> 00:01:27.186 A:middle
但也有些用户依赖于其它的

00:01:27.186 --> 00:01:28.406 A:middle
密码管理 App 来存储

00:01:28.406 --> 00:01:29.116 A:middle
他们的安全凭证

00:01:30.656 --> 00:01:32.136 A:middle
为了让这些用户在使用他们的安全凭证

00:01:32.136 --> 00:01:33.346 A:middle
的时候 也能变得同样便捷

00:01:33.346 --> 00:01:38.446 A:middle
iOS 12 允许密码管理 App 整合自动填充功能

00:01:38.446 --> 00:01:39.656 A:middle
以便于提供如同 iCloud 钥匙串

00:01:39.656 --> 00:01:40.046 A:middle
一样的体验

00:01:41.736 --> 00:01:44.346 A:middle
在 iOS 12 中 密码自动填充设置

00:01:44.346 --> 00:01:45.676 A:middle
有了一个全新的 UI

00:01:45.926 --> 00:01:47.476 A:middle
允许用户自己选择

00:01:47.476 --> 00:01:48.776 A:middle
向自动填充功能中

00:01:48.776 --> 00:01:51.126 A:middle
提供凭证的 App

00:01:51.126 --> 00:01:52.406 A:middle
来作为对于 iCloud 钥匙串的补充或替代

00:01:52.586 --> 00:01:56.006 A:middle
通过使用快速输入栏

00:01:56.936 --> 00:01:58.146 A:middle
用户能够以列表形式浏览

00:01:58.146 --> 00:02:00.036 A:middle
他们存储在密码管理 App 中的凭证

00:01:58.146 --> 00:02:00.036 A:middle
他们存储在密码管理 App 中的凭证

00:02:00.876 --> 00:02:03.296 A:middle
这一 UI 是由与密码管理 App

00:02:03.296 --> 00:02:04.146 A:middle
捆绑的扩展所支持的

00:02:04.146 --> 00:02:06.656 A:middle
当一个凭证被选中

00:02:06.976 --> 00:02:07.986 A:middle
该扩展会将其送回自动填充中

00:02:07.986 --> 00:02:10.515 A:middle
随后用户名和密码

00:02:10.515 --> 00:02:11.686 A:middle
就会被填入 App 中

00:02:12.326 --> 00:02:16.356 A:middle
当然 快速输入栏预测

00:02:16.356 --> 00:02:16.626 A:middle
也能够如此工作

00:02:17.186 --> 00:02:18.386 A:middle
现在 自动填充能够显示出

00:02:18.386 --> 00:02:19.796 A:middle
由 App 指定的最佳凭证

00:02:19.796 --> 00:02:21.396 A:middle
所以 要访问

00:02:21.646 --> 00:02:22.416 A:middle
只需轻点一下就够了

00:02:23.956 --> 00:02:25.486 A:middle
当使用这些凭证的时候

00:02:25.606 --> 00:02:27.016 A:middle
App 扩展可以选择性地

00:02:27.016 --> 00:02:28.596 A:middle
显示出它的原有 UI

00:02:28.596 --> 00:02:29.666 A:middle
以便在输入凭证之前

00:02:29.666 --> 00:02:30.106 A:middle
验证用户

00:02:33.116 --> 00:02:34.796 A:middle
这一整合使得

00:02:34.796 --> 00:02:36.506 A:middle
使用密码管理 App 的用户

00:02:36.506 --> 00:02:38.076 A:middle
在登录 App 的时候更加便捷

00:02:38.076 --> 00:02:39.066 A:middle
因为他们不再需要

00:02:39.066 --> 00:02:40.436 A:middle
切换 App 来拷贝他们的凭证

00:02:41.846 --> 00:02:43.216 A:middle
它也让密码自动填充

00:02:43.216 --> 00:02:44.426 A:middle
能够在更多的 App 中使用

00:02:44.836 --> 00:02:46.346 A:middle
任何支持 iCloud 钥匙串自动填充的 App

00:02:46.346 --> 00:02:47.826 A:middle
现在都能够与

00:02:47.826 --> 00:02:49.336 A:middle
密码管理 App 协同工作

00:02:49.336 --> 00:02:50.346 A:middle
且不需要任何额外操作

00:02:50.826 --> 00:02:54.726 A:middle
看过这一概览之后

00:02:54.726 --> 00:02:55.926 A:middle
我们来深入看一看

00:02:55.926 --> 00:02:57.336 A:middle
如何将这些功能

00:02:57.336 --> 00:02:57.926 A:middle
在你的 App 中执行

00:02:58.576 --> 00:02:59.946 A:middle
主要有四步需要讲解

00:03:02.336 --> 00:03:04.006 A:middle
首先 你需要配置

00:03:04.006 --> 00:03:05.426 A:middle
你的项目来使用这些

00:03:05.426 --> 00:03:06.536 A:middle
全新的 API

00:03:07.226 --> 00:03:08.106 A:middle
这其中包括

00:03:08.106 --> 00:03:09.706 A:middle
向你的 App 中添加新功能

00:03:09.706 --> 00:03:11.006 A:middle
以及向你的项目中添加扩展

00:03:11.526 --> 00:03:13.116 A:middle
自动填充将会使用这一扩展

00:03:13.116 --> 00:03:14.136 A:middle
当它需要访问你的 App

00:03:14.136 --> 00:03:16.636 A:middle
或者需要在系统中

00:03:17.696 --> 00:03:18.006 A:middle
显示它的 UI 的时候

00:03:18.036 --> 00:03:19.566 A:middle
其次 你的扩展需要

00:03:19.566 --> 00:03:20.786 A:middle
能够支持以列表显示出

00:03:20.786 --> 00:03:21.896 A:middle
用户可选择的凭证

00:03:21.896 --> 00:03:23.256 A:middle
当他们通过

00:03:23.256 --> 00:03:24.346 A:middle
快速输入栏

00:03:24.346 --> 00:03:24.536 A:middle
打开你的扩展的时候

00:03:26.736 --> 00:03:28.626 A:middle
然后 如果你想要自动填充

00:03:28.626 --> 00:03:29.746 A:middle
在快速输入栏内

00:03:29.746 --> 00:03:31.226 A:middle
显示出你的 App 的凭证

00:03:31.226 --> 00:03:32.466 A:middle
你需要为此添加支持

00:03:32.466 --> 00:03:33.566 A:middle
通过告知系统

00:03:33.566 --> 00:03:34.656 A:middle
你想要显示出的凭证

00:03:35.116 --> 00:03:36.536 A:middle
并在你的扩展中

00:03:36.536 --> 00:03:38.746 A:middle
执行另一个 API 来回应

00:03:38.746 --> 00:03:39.326 A:middle
用户对于凭证的选择

00:03:40.856 --> 00:03:43.536 A:middle
最后 你也许想要使用一个允许你显示出

00:03:43.536 --> 00:03:44.886 A:middle
你的扩展的 UI 的 API

00:03:44.886 --> 00:03:47.876 A:middle
当用户在设置中

00:03:47.876 --> 00:03:48.356 A:middle
选择了你的密码管理 App 时

00:03:49.096 --> 00:03:50.096 A:middle
我们来更细致地

00:03:50.096 --> 00:03:50.546 A:middle
了解一下这些步骤

00:03:53.016 --> 00:03:54.646 A:middle
首先 你需要对你的项目

00:03:54.646 --> 00:03:55.826 A:middle
做一些改动

00:03:56.456 --> 00:03:57.506 A:middle
以在你的 App 功能中启用

00:03:57.506 --> 00:04:00.556 A:middle
自动填充凭证提供商为首

00:03:57.506 --> 00:04:00.556 A:middle
自动填充凭证提供商为首

00:04:01.316 --> 00:04:02.716 A:middle
这将为你的 App

00:04:02.716 --> 00:04:04.116 A:middle
添加所必需的权限

00:04:04.116 --> 00:04:05.696 A:middle
并将其连接到新的认证服务框架

00:04:05.696 --> 00:04:07.716 A:middle
它可以提供

00:04:07.716 --> 00:04:08.936 A:middle
为整合密码自动填充

00:04:08.936 --> 00:04:09.416 A:middle
所需要的 API

00:04:09.826 --> 00:04:13.936 A:middle
随后 你需要添加一个

00:04:13.936 --> 00:04:15.316 A:middle
自动填充凭证提供商扩展目标

00:04:15.316 --> 00:04:16.946 A:middle
到你的项目中

00:04:17.676 --> 00:04:19.296 A:middle
Xcode 10 包含了

00:04:19.296 --> 00:04:20.116 A:middle
该扩展的全新模版

00:04:20.656 --> 00:04:23.666 A:middle
该模版会为你创建一个新的

00:04:23.666 --> 00:04:24.706 A:middle
视图控制器层级 一个 ASCredential

00:04:25.136 --> 00:04:27.986 A:middle
ProviderViewController 的子层级

00:04:29.076 --> 00:04:30.326 A:middle
当自动填充需要唤醒你的扩展时

00:04:30.326 --> 00:04:31.766 A:middle
它会创建一个

00:04:31.766 --> 00:04:33.336 A:middle
该层级的实例

00:04:33.336 --> 00:04:34.366 A:middle
并对指定模式做出请求

00:04:34.766 --> 00:04:35.606 A:middle
你的子层级

00:04:35.606 --> 00:04:36.026 A:middle
将会覆盖它

00:04:37.756 --> 00:04:38.996 A:middle
那么一旦 你已经配置好了你的项目

00:04:38.996 --> 00:04:41.146 A:middle
在你的扩展里

00:04:41.146 --> 00:04:42.626 A:middle
需要添加的第一样东西

00:04:42.626 --> 00:04:43.756 A:middle
就是用户可以

00:04:43.756 --> 00:04:44.726 A:middle
通过快速输入栏

00:04:44.726 --> 00:04:45.286 A:middle
来浏览的凭证列表

00:04:45.566 --> 00:04:46.866 A:middle
它是这样运作的

00:04:47.446 --> 00:04:50.616 A:middle
当用户在登录某一 App 时

00:04:50.736 --> 00:04:51.926 A:middle
他们可以使用快速输入栏

00:04:51.926 --> 00:04:53.376 A:middle
来打开你的凭证列表

00:04:54.026 --> 00:04:56.306 A:middle
此时自动填充将会

00:04:56.306 --> 00:04:57.776 A:middle
启动你的 App 扩展

00:04:57.776 --> 00:04:58.946 A:middle
并告知它用户在何处登录

00:04:58.946 --> 00:05:00.566 A:middle
这样你就可以给出

00:04:58.946 --> 00:05:00.566 A:middle
这样你就可以给出

00:05:00.566 --> 00:05:01.926 A:middle
相关程度最高的凭证建议

00:05:03.816 --> 00:05:05.436 A:middle
自动填充是通过

00:05:05.436 --> 00:05:06.736 A:middle
准备好一系列

00:05:06.736 --> 00:05:08.086 A:middle
ASCredentialServiceIdentifier

00:05:08.086 --> 00:05:10.716 A:middle
代表着用户当前正在使用的服务

00:05:10.716 --> 00:05:11.146 A:middle
来做到这一点的

00:05:11.976 --> 00:05:12.956 A:middle
你的扩展可能会收到

00:05:12.956 --> 00:05:14.636 A:middle
多个服务标识符

00:05:14.636 --> 00:05:16.086 A:middle
如果自动填充能够识别多个

00:05:16.086 --> 00:05:17.386 A:middle
更好更合适的

00:05:17.386 --> 00:05:18.236 A:middle
以便在当前环境下使用

00:05:19.956 --> 00:05:21.866 A:middle
在 App 内 服务标识符

00:05:21.866 --> 00:05:23.836 A:middle
是基于该 App 所相关域名的

00:05:24.406 --> 00:05:25.976 A:middle
采用了通用链接 接力

00:05:25.976 --> 00:05:27.876 A:middle
或者共享网页凭证的 App

00:05:27.876 --> 00:05:29.856 A:middle
将会有相关联的域名

00:05:31.006 --> 00:05:32.606 A:middle
例如 这个闪闪发光的 App

00:05:32.606 --> 00:05:33.456 A:middle
与 shiny.example.com 相关联

00:05:33.456 --> 00:05:36.386 A:middle
那么自动填充

00:05:36.386 --> 00:05:37.586 A:middle
将会为你的扩展提供

00:05:37.586 --> 00:05:39.086 A:middle
一个服务标识符

00:05:39.086 --> 00:05:41.436 A:middle
它的类型是域名 shiny.example.com

00:05:42.866 --> 00:05:44.286 A:middle
在 Safari 浏览器中

00:05:44.286 --> 00:05:46.056 A:middle
服务标识符是基于

00:05:46.086 --> 00:05:47.966 A:middle
用户当前正在登录的页面 URL

00:05:51.316 --> 00:05:52.976 A:middle
自动填充会将服务标识符

00:05:52.976 --> 00:05:54.786 A:middle
通过请求

00:05:54.786 --> 00:05:56.186 A:middle
已准备好的

00:05:56.186 --> 00:05:57.796 A:middle
服务标识符模式凭证列表

00:05:57.796 --> 00:05:59.266 A:middle
在你的视图控制器中

00:06:00.286 --> 00:06:02.066 A:middle
在这里 你的扩展应该

00:06:02.066 --> 00:06:03.526 A:middle
建立起它的 UI 来显示

00:06:03.526 --> 00:06:05.466 A:middle
用户的凭证信息

00:06:05.466 --> 00:06:06.546 A:middle
且它应该能够通过所提供的服务标识符

00:06:06.546 --> 00:06:08.156 A:middle
为相关度最高的那些

00:06:08.156 --> 00:06:09.166 A:middle
给出高优先级

00:06:09.926 --> 00:06:11.636 A:middle
在这一步 有两件事会发生

00:06:12.196 --> 00:06:15.286 A:middle
如果用户选择忽略你的扩展

00:06:15.286 --> 00:06:16.656 A:middle
你可以通过调用

00:06:16.656 --> 00:06:18.306 A:middle
出错取消请求

00:06:18.436 --> 00:06:20.456 A:middle
来告知系统

00:06:20.456 --> 00:06:21.586 A:middle
在你的视图控制器扩展环境中

00:06:21.586 --> 00:06:23.906 A:middle
自动填充就会

00:06:23.906 --> 00:06:24.886 A:middle
忽略你的扩展

00:06:28.976 --> 00:06:30.886 A:middle
如果用户选择了

00:06:30.886 --> 00:06:32.086 A:middle
一个他们想要使用的凭证

00:06:32.506 --> 00:06:33.976 A:middle
你的扩展就会建立一个

00:06:33.976 --> 00:06:35.736 A:middle
基于用户选择的

00:06:35.736 --> 00:06:37.596 A:middle
ASPasswordCredential

00:06:37.596 --> 00:06:39.286 A:middle
然后通过调用

00:06:39.286 --> 00:06:40.596 A:middle
完成请求和所选凭证模式

00:06:40.596 --> 00:06:42.106 A:middle
来把它交给自动填充

00:06:42.106 --> 00:06:43.206 A:middle
在扩展环境中进行

00:06:44.046 --> 00:06:45.526 A:middle
那么自动填充就会使用

00:06:45.526 --> 00:06:47.236 A:middle
那个凭证来填充

00:06:47.316 --> 00:06:49.126 A:middle
App 中的用户名和密码

00:06:51.656 --> 00:06:53.036 A:middle
这里有一些非常棒的实例

00:06:53.036 --> 00:06:53.986 A:middle
是凭证列表所应该遵循的

00:06:53.986 --> 00:06:55.926 A:middle
为了最好的用户体验

00:06:56.946 --> 00:06:58.426 A:middle
首先 要确保

00:06:58.426 --> 00:06:59.856 A:middle
在你的 UI 中添加一个按钮

00:06:59.856 --> 00:07:00.456 A:middle
来取消请求

00:06:59.856 --> 00:07:00.456 A:middle
来取消请求

00:07:01.446 --> 00:07:02.616 A:middle
用户可能会随时改变主意

00:07:02.616 --> 00:07:03.986 A:middle
是否登录他们的服务

00:07:03.986 --> 00:07:05.136 A:middle
亦或是意识到 他们没有保存好的凭证

00:07:05.136 --> 00:07:06.746 A:middle
所以你应该

00:07:06.746 --> 00:07:08.096 A:middle
允许用户忽略你的扩展

00:07:08.096 --> 00:07:09.956 A:middle
不需要选择任何凭证

00:07:12.856 --> 00:07:14.746 A:middle
同样你的凭证列表 UI

00:07:14.746 --> 00:07:16.006 A:middle
应该让所有凭证都可见

00:07:16.006 --> 00:07:17.646 A:middle
不论他们是不是

00:07:17.676 --> 00:07:19.216 A:middle
与服务标识符相符

00:07:19.896 --> 00:07:21.486 A:middle
在某些情况下

00:07:21.486 --> 00:07:22.526 A:middle
用户可能需要从一个不同的域名下

00:07:22.526 --> 00:07:23.246 A:middle
选择一个凭证

00:07:24.226 --> 00:07:25.516 A:middle
允许用户

00:07:25.516 --> 00:07:26.776 A:middle
从列表中访问整套凭证

00:07:26.776 --> 00:07:28.256 A:middle
以确保你的扩展

00:07:28.256 --> 00:07:29.696 A:middle
时刻都能派上用场

00:07:31.916 --> 00:07:33.576 A:middle
用户认证

00:07:33.576 --> 00:07:35.096 A:middle
是完全取决于你的扩展的

00:07:35.406 --> 00:07:36.796 A:middle
如果你需要认证用户

00:07:36.796 --> 00:07:38.236 A:middle
那么当凭证列表出现的时候

00:07:38.236 --> 00:07:39.426 A:middle
你就应该执行认证

00:07:39.856 --> 00:07:43.396 A:middle
以上就是你如何

00:07:43.396 --> 00:07:44.596 A:middle
在你的扩展中操作凭证列表

00:07:44.596 --> 00:07:45.936 A:middle
以保证你的 App 中的凭证

00:07:45.936 --> 00:07:47.576 A:middle
无论在何地

00:07:47.576 --> 00:07:48.466 A:middle
只需要登录 都是可用的

00:07:49.076 --> 00:07:51.566 A:middle
现在我们要将它变得更加方便

00:07:51.566 --> 00:07:53.206 A:middle
通过允许自动填充

00:07:53.206 --> 00:07:54.396 A:middle
将这些凭证

00:07:54.486 --> 00:07:55.566 A:middle
直接显示在快速输入栏上

00:07:56.116 --> 00:07:58.346 A:middle
我将以一个概览开始

00:07:58.346 --> 00:07:59.516 A:middle
关于这些操作如何进行

00:07:59.776 --> 00:08:01.116 A:middle
描述一下你的代码所扮演的角色

00:07:59.776 --> 00:08:01.116 A:middle
描述一下你的代码所扮演的角色

00:08:01.116 --> 00:08:05.123 A:middle
系统 以及用户正在登录的 App

00:08:07.376 --> 00:08:09.186 A:middle
首先 你的 App 需要

00:08:09.186 --> 00:08:10.876 A:middle
让自动填充提前知道

00:08:11.126 --> 00:08:12.356 A:middle
它想要将什么凭证

00:08:12.356 --> 00:08:13.816 A:middle
显示在快速输入栏上

00:08:15.126 --> 00:08:16.266 A:middle
你的 App 需要提供给自动填充

00:08:16.266 --> 00:08:17.996 A:middle
一份凭证身份列表

00:08:18.336 --> 00:08:19.846 A:middle
凭证身份包含

00:08:19.846 --> 00:08:21.106 A:middle
凭证相关信息

00:08:21.406 --> 00:08:22.746 A:middle
例如用户名和服务

00:08:22.746 --> 00:08:24.616 A:middle
但没有密码

00:08:25.106 --> 00:08:28.116 A:middle
当用户开始登录 App 时

00:08:28.116 --> 00:08:29.886 A:middle
App 会与自动填充对话

00:08:29.886 --> 00:08:31.356 A:middle
并让它知道

00:08:31.356 --> 00:08:32.756 A:middle
何时用户名栏或者密码栏

00:08:32.756 --> 00:08:33.356 A:middle
被选中

00:08:34.645 --> 00:08:35.946 A:middle
随后自动填充就会寻找

00:08:35.946 --> 00:08:36.796 A:middle
合适的凭证身份

00:08:36.796 --> 00:08:38.265 A:middle
来为 App 提供建议

00:08:38.905 --> 00:08:39.866 A:middle
这一操作是通过

00:08:39.866 --> 00:08:40.616 A:middle
搜索由你的 App 提供的

00:08:40.616 --> 00:08:43.076 A:middle
凭证身份来进行的

00:08:43.076 --> 00:08:44.706 A:middle
所以你的扩展 暂时还不需要启动

00:08:45.996 --> 00:08:46.856 A:middle
如果有任何匹配的

00:08:46.856 --> 00:08:47.726 A:middle
凭证身份

00:08:47.726 --> 00:08:49.886 A:middle
自动填充会将它们显示在

00:08:49.886 --> 00:08:50.616 A:middle
快速输入栏内

00:08:51.726 --> 00:08:53.096 A:middle
这些建议是

00:08:53.096 --> 00:08:54.666 A:middle
系统私密提供的

00:08:54.666 --> 00:08:56.246 A:middle
所以 App 还不能确定

00:08:56.246 --> 00:08:57.466 A:middle
用户为 App

00:08:57.466 --> 00:08:58.946 A:middle
保存了什么凭证

00:09:01.356 --> 00:09:02.746 A:middle
当用户选择了其中一条建议

00:09:02.746 --> 00:09:05.106 A:middle
自动填充就会启动你的扩展

00:09:05.106 --> 00:09:06.496 A:middle
来向它询问

00:09:06.496 --> 00:09:07.846 A:middle
完整凭证

00:09:07.846 --> 00:09:08.346 A:middle
包括密码

00:09:08.836 --> 00:09:11.516 A:middle
它会告知你的扩展

00:09:11.596 --> 00:09:12.736 A:middle
用户选择了哪个

00:09:12.736 --> 00:09:16.216 A:middle
凭证身份

00:09:16.216 --> 00:09:17.556 A:middle
随后你的扩展会寻找

00:09:17.556 --> 00:09:18.926 A:middle
属于所选凭证的密码

00:09:18.926 --> 00:09:20.316 A:middle
在你的 App 的数据库中

00:09:21.256 --> 00:09:22.736 A:middle
在此时 扩展可以选择

00:09:22.736 --> 00:09:24.426 A:middle
在返回密码之前

00:09:24.546 --> 00:09:25.806 A:middle
显示它自己的 UI

00:09:26.726 --> 00:09:27.826 A:middle
对于密码管理 App 来说

00:09:27.826 --> 00:09:29.246 A:middle
请求用户输入

00:09:29.246 --> 00:09:31.126 A:middle
一个主管密码

00:09:31.126 --> 00:09:32.016 A:middle
或者执行其它形式的

00:09:32.016 --> 00:09:36.626 A:middle
针对 App 的认证是非常有用的

00:09:36.886 --> 00:09:37.976 A:middle
一旦你的扩展掌握了密码

00:09:37.976 --> 00:09:39.906 A:middle
它会将其打包进

00:09:39.906 --> 00:09:41.536 A:middle
一个 ASPasswordCredential

00:09:41.536 --> 00:09:42.796 A:middle
通过完成扩展请求

00:09:42.796 --> 00:09:43.736 A:middle
来传递给自动填充

00:09:44.226 --> 00:09:47.426 A:middle
如果扩展没有显示出自己的 UI

00:09:47.426 --> 00:09:49.476 A:middle
自动填充会

00:09:49.476 --> 00:09:50.826 A:middle
为用户执行

00:09:50.826 --> 00:09:51.296 A:middle
适当的认证

00:09:52.116 --> 00:09:53.346 A:middle
根据设备和用户偏好的不同

00:09:53.346 --> 00:09:55.116 A:middle
这一认证可能是

00:09:55.116 --> 00:09:57.356 A:middle
面容 ID 触控 ID

00:09:57.356 --> 00:09:58.666 A:middle
设备密码或者什么都没有

00:09:59.236 --> 00:10:02.726 A:middle
如果认证成功

00:09:59.236 --> 00:10:02.726 A:middle
如果认证成功

00:10:02.726 --> 00:10:05.976 A:middle
自动填充就会填充 App 中的用户名和密码

00:10:06.336 --> 00:10:08.676 A:middle
这之中发生了非常多的事

00:10:08.806 --> 00:10:09.596 A:middle
所以我要梳理一遍

00:10:09.596 --> 00:10:10.666 A:middle
作为一个开发人员

00:10:10.666 --> 00:10:11.856 A:middle
你需要为这一工作流程

00:10:11.856 --> 00:10:12.286 A:middle
所做的支持

00:10:12.816 --> 00:10:16.096 A:middle
你需要做的三件事是

00:10:16.346 --> 00:10:17.656 A:middle
向自动填充提供

00:10:17.656 --> 00:10:18.866 A:middle
你想向用户建议的

00:10:18.866 --> 00:10:19.966 A:middle
凭证身份

00:10:20.926 --> 00:10:21.836 A:middle
在你的扩展中执行支持

00:10:21.836 --> 00:10:22.736 A:middle
以便建议被选中后

00:10:22.736 --> 00:10:24.196 A:middle
提供密码

00:10:24.196 --> 00:10:27.666 A:middle
并在扩展中显示定制 UI

00:10:27.666 --> 00:10:28.866 A:middle
目的是在返回凭证前

00:10:28.866 --> 00:10:30.446 A:middle
认证用户

00:10:30.446 --> 00:10:31.546 A:middle
如果你的 UX 需要的话

00:10:32.546 --> 00:10:33.736 A:middle
重申一下

00:10:33.736 --> 00:10:34.196 A:middle
这一步不是必需的

00:10:34.776 --> 00:10:36.036 A:middle
如果你不显示出定制 UI

00:10:36.036 --> 00:10:37.716 A:middle
来执行验证

00:10:37.716 --> 00:10:38.646 A:middle
自动填充会为你

00:10:38.646 --> 00:10:39.746 A:middle
执行适当的验证

00:10:42.936 --> 00:10:44.296 A:middle
凭证身份

00:10:44.296 --> 00:10:46.246 A:middle
是由 ASPasswordCredentialIdentity 实例

00:10:46.246 --> 00:10:47.606 A:middle
来表现的

00:10:48.336 --> 00:10:49.526 A:middle
这一层级包含所有

00:10:49.526 --> 00:10:52.126 A:middle
自动填充所需要知道的凭证信息

00:10:52.126 --> 00:10:53.746 A:middle
以便确定在何处提供它们

00:10:54.676 --> 00:10:55.636 A:middle
其中包含了一个服务标识符

00:10:55.636 --> 00:10:57.526 A:middle
它会告诉自动填充

00:10:57.526 --> 00:10:59.036 A:middle
在哪一个 App 或是网页上

00:10:59.036 --> 00:11:00.336 A:middle
提供凭证建议

00:10:59.036 --> 00:11:00.336 A:middle
提供凭证建议

00:11:01.496 --> 00:11:03.086 A:middle
凭证中的用户名

00:11:03.626 --> 00:11:06.646 A:middle
以及可选记录身份字符串

00:11:06.646 --> 00:11:07.906 A:middle
你可以使用它们

00:11:07.906 --> 00:11:09.086 A:middle
来连接这一身份

00:11:09.086 --> 00:11:10.176 A:middle
到你的 App 自身数据库中的一项记录

00:11:10.176 --> 00:11:13.446 A:middle
以及一项等级参数

00:11:14.336 --> 00:11:15.776 A:middle
如果用户有多个凭证

00:11:15.776 --> 00:11:17.166 A:middle
对应一项服务

00:11:17.166 --> 00:11:19.006 A:middle
且快速输入栏无法显示

00:11:19.006 --> 00:11:20.196 A:middle
你可以使用等级参数

00:11:20.196 --> 00:11:21.156 A:middle
来标记特定的凭证身份

00:11:21.156 --> 00:11:23.206 A:middle
来给它们更高或更低的优先级

00:11:24.436 --> 00:11:25.556 A:middle
有更高等级的凭证身份

00:11:25.656 --> 00:11:26.826 A:middle
会优先于

00:11:26.826 --> 00:11:29.466 A:middle
低等级的凭证身份被给出

00:11:32.476 --> 00:11:34.316 A:middle
这些凭证身份

00:11:34.316 --> 00:11:35.696 A:middle
会被保存在凭证身份库中

00:11:35.696 --> 00:11:38.896 A:middle
也就是你 App 中的数据库

00:11:38.896 --> 00:11:40.606 A:middle
你可以使用 ASCredentialIdentityStore 级

00:11:40.606 --> 00:11:42.296 A:middle
来对其进行修改

00:11:43.356 --> 00:11:44.846 A:middle
自动填充为用户提供建议凭证

00:11:44.846 --> 00:11:46.276 A:middle
是通过搜索

00:11:46.276 --> 00:11:47.736 A:middle
你 App 中的凭证身份库

00:11:48.316 --> 00:11:51.836 A:middle
凭证身份库

00:11:51.836 --> 00:11:53.196 A:middle
有完整的数据保护

00:11:53.196 --> 00:11:55.026 A:middle
除了开放数据

00:11:55.026 --> 00:11:56.446 A:middle
所以没有任何操作

00:11:56.446 --> 00:11:57.266 A:middle
能在设备锁定的时候执行

00:11:58.246 --> 00:11:59.416 A:middle
系统永远不会

00:11:59.416 --> 00:12:00.616 A:middle
将凭证身份库与云服务同步

00:11:59.416 --> 00:12:00.616 A:middle
将凭证身份库与云服务同步

00:12:00.616 --> 00:12:02.516 A:middle
或将其包含在备份中

00:12:02.736 --> 00:12:04.746 A:middle
所以这些信息

00:12:05.276 --> 00:12:06.000 A:middle
永远不会离开设备

00:12:07.826 --> 00:12:09.246 A:middle
每一个 App 都有独立的

00:12:09.246 --> 00:12:11.216 A:middle
凭证身份库 并且只有 App 本身或者

00:12:11.216 --> 00:12:13.436 A:middle
相应扩展 才能对其进行修改

00:12:14.066 --> 00:12:15.336 A:middle
这一库只会被自动填充读取

00:12:15.336 --> 00:12:17.246 A:middle
用于决定

00:12:17.246 --> 00:12:19.286 A:middle
向用户建议什么凭证

00:12:19.836 --> 00:12:23.316 A:middle
并且凭证身份库

00:12:23.316 --> 00:12:26.226 A:middle
只有在 App 扩展被用户启用后

00:12:26.226 --> 00:12:27.296 A:middle
才能被修改

00:12:28.506 --> 00:12:29.716 A:middle
如果你的扩展未启用

00:12:29.866 --> 00:12:31.616 A:middle
对于库的更新的任何尝试将会失败

00:12:32.106 --> 00:12:33.386 A:middle
如果用户禁用了你的扩展

00:12:33.386 --> 00:12:34.806 A:middle
或者删除了你的 App

00:12:35.146 --> 00:12:36.296 A:middle
整个凭证身份库

00:12:36.296 --> 00:12:37.026 A:middle
将会被删除

00:12:37.476 --> 00:12:42.706 A:middle
你的 App 需要更新其凭证身份库

00:12:42.706 --> 00:12:43.856 A:middle
当对于它所能提供的凭证

00:12:43.856 --> 00:12:45.076 A:middle
有新的信息变动的时候

00:12:46.316 --> 00:12:47.896 A:middle
举例来说

00:12:47.896 --> 00:12:49.616 A:middle
你的 App 使用线上服务

00:12:49.616 --> 00:12:50.916 A:middle
来保存用户的凭证

00:12:51.456 --> 00:12:54.156 A:middle
当用户登录时

00:12:54.156 --> 00:12:55.006 A:middle
你的 App 会开始获取

00:12:55.006 --> 00:12:56.026 A:middle
用户的凭证

00:12:56.486 --> 00:12:59.186 A:middle
这时你应该在库中

00:12:59.186 --> 00:13:00.796 A:middle
更新凭证身份列表

00:12:59.186 --> 00:13:00.796 A:middle
更新凭证身份列表

00:13:00.796 --> 00:13:02.066 A:middle
以便于新添加的凭证

00:13:02.066 --> 00:13:03.406 A:middle
能够显示在快速输入栏上

00:13:03.926 --> 00:13:08.506 A:middle
如果用户添加 删除

00:13:08.506 --> 00:13:10.326 A:middle
或修改他们的凭证

00:13:10.326 --> 00:13:11.446 A:middle
你的 App 要更新

00:13:11.446 --> 00:13:13.556 A:middle
凭证身份库

00:13:13.556 --> 00:13:15.006 A:middle
以保证能一直准确地反馈出

00:13:15.006 --> 00:13:16.716 A:middle
这一组凭证 这是由你的 App 所提供的

00:13:18.516 --> 00:13:20.046 A:middle
这些更新可能是由于

00:13:20.046 --> 00:13:21.466 A:middle
在 App 内 用户在

00:13:21.536 --> 00:13:23.426 A:middle
本定做出了修改

00:13:23.426 --> 00:13:25.566 A:middle
或者可能是因为你的 App 同步了

00:13:25.566 --> 00:13:27.606 A:middle
来自其它登录了线上服务的设备中的变更

00:13:29.746 --> 00:13:31.616 A:middle
然后 如果用户要

00:13:31.616 --> 00:13:34.926 A:middle
在当前设备上 登出线上服务

00:13:34.926 --> 00:13:36.016 A:middle
你的 App 要

00:13:36.016 --> 00:13:37.696 A:middle
从库中移除所有的凭证身份

00:13:37.696 --> 00:13:39.136 A:middle
用户不会再看到

00:13:39.136 --> 00:13:40.606 A:middle
关于这些凭证的建议

00:13:44.086 --> 00:13:46.136 A:middle
在你的代码中 你要使用

00:13:46.136 --> 00:13:47.826 A:middle
ASCredentialIdentityStore 级

00:13:47.826 --> 00:13:51.686 A:middle
来与凭证身份库互动

00:13:51.686 --> 00:13:53.246 A:middle
通过使用替代凭证身份

00:13:53.246 --> 00:13:55.286 A:middle
并移除所有的

00:13:55.286 --> 00:13:56.946 A:middle
凭证身份模式

00:13:57.716 --> 00:13:59.116 A:middle
你可以替代或者清除

00:13:59.116 --> 00:14:00.516 A:middle
被自动填充

00:13:59.116 --> 00:14:00.516 A:middle
被自动填充

00:14:00.516 --> 00:14:01.676 A:middle
纳入考虑建议范畴内的

00:14:01.676 --> 00:14:02.246 A:middle
凭证身份

00:14:04.556 --> 00:14:06.026 A:middle
当出现个人修改时

00:14:06.026 --> 00:14:07.826 A:middle
这些已保存的凭证身份

00:14:07.826 --> 00:14:09.496 A:middle
或已移除的凭证身份模式

00:14:09.496 --> 00:14:11.666 A:middle
会允许你

00:14:11.666 --> 00:14:15.386 A:middle
添加 更新或移除凭证身份

00:14:15.386 --> 00:14:16.906 A:middle
而不需要完全替代库中的内容

00:14:20.426 --> 00:14:21.486 A:middle
关于系统

00:14:21.486 --> 00:14:23.426 A:middle
需要了解的一个重要方面

00:14:23.426 --> 00:14:25.036 A:middle
就是凭证身份库

00:14:25.036 --> 00:14:26.506 A:middle
有时会被删除

00:14:26.506 --> 00:14:27.516 A:middle
但你的 App 无法预见这一点

00:14:28.076 --> 00:14:31.276 A:middle
例如 如果用户

00:14:31.276 --> 00:14:32.596 A:middle
在自动填充中禁用了你的扩展

00:14:32.596 --> 00:14:34.336 A:middle
而随后又重新启用了它

00:14:34.336 --> 00:14:36.386 A:middle
但系统已经清空了库

00:14:37.296 --> 00:14:38.696 A:middle
如果系统认为

00:14:38.696 --> 00:14:39.996 A:middle
你的 App 提供凭证身份

00:14:39.996 --> 00:14:41.546 A:middle
但一直不能

00:14:41.546 --> 00:14:43.076 A:middle
提供密码

00:14:43.076 --> 00:14:44.276 A:middle
当用户选择这些凭证的时候

00:14:44.276 --> 00:14:46.076 A:middle
那么凭证身份库

00:14:46.076 --> 00:14:47.976 A:middle
就会被删除

00:14:47.976 --> 00:14:49.116 A:middle
以防用户再看到这些

00:14:49.116 --> 00:14:50.646 A:middle
陈旧无用的凭证建议

00:14:51.076 --> 00:14:56.176 A:middle
如果用户从备份中恢复了他们的设备

00:14:56.176 --> 00:14:57.116 A:middle
并且有使用你的

00:14:57.116 --> 00:14:59.056 A:middle
凭证提供扩展

00:14:59.056 --> 00:15:00.306 A:middle
但是库中不会存在

00:14:59.056 --> 00:15:00.306 A:middle
但是库中不会存在

00:15:00.306 --> 00:15:01.736 A:middle
任何凭证身份

00:15:01.736 --> 00:15:02.596 A:middle
因为它没有被包含在备份中

00:15:02.596 --> 00:15:04.546 A:middle
你的 App 要能够

00:15:04.546 --> 00:15:06.516 A:middle
处理这些情况

00:15:06.596 --> 00:15:08.316 A:middle
ASCredentialIdentityStore

00:15:08.316 --> 00:15:09.576 A:middle
能够帮助你检测这些情况

00:15:09.706 --> 00:15:10.726 A:middle
你就能够采取合适的操作

00:15:10.726 --> 00:15:12.376 A:middle
当你需要更新库的时候

00:15:15.776 --> 00:15:17.336 A:middle
你可以使用状态获取模式

00:15:17.446 --> 00:15:18.666 A:middle
来询问系统

00:15:18.666 --> 00:15:20.006 A:middle
关于你的 App 的

00:15:20.006 --> 00:15:21.846 A:middle
凭证身份库的情况

00:15:21.846 --> 00:15:23.356 A:middle
将其返回为一个

00:15:23.356 --> 00:15:24.176 A:middle
ASCredentialIdentityStoreState 项目

00:15:25.876 --> 00:15:27.566 A:middle
它会告知你的第一件事

00:15:27.566 --> 00:15:28.926 A:middle
是用户是否

00:15:28.926 --> 00:15:30.016 A:middle
启用了你的扩展

00:15:30.726 --> 00:15:31.816 A:middle
你应该在试图更新

00:15:31.816 --> 00:15:32.686 A:middle
凭证身份库之前

00:15:32.686 --> 00:15:33.746 A:middle
检查这一点

00:15:34.256 --> 00:15:35.606 A:middle
如果你的扩展被禁用了

00:15:35.736 --> 00:15:36.816 A:middle
那么保存或移除

00:15:36.816 --> 00:15:38.716 A:middle
凭证身份是没有意义的

00:15:42.116 --> 00:15:44.306 A:middle
它同样支持

00:15:44.306 --> 00:15:45.606 A:middle
增量更新属性

00:15:46.026 --> 00:15:47.136 A:middle
你可以用它来判断

00:15:47.136 --> 00:15:48.626 A:middle
你的身份库是否有改动

00:15:48.626 --> 00:15:49.576 A:middle
自从上一次

00:15:49.576 --> 00:15:51.636 A:middle
更新之后

00:15:51.636 --> 00:15:52.746 A:middle
如果你之前保存了

00:15:52.746 --> 00:15:53.756 A:middle
凭证身份到库中

00:15:53.756 --> 00:15:55.826 A:middle
就会返回 true 值

00:15:56.436 --> 00:15:57.646 A:middle
提示你应该使用

00:15:57.646 --> 00:15:59.146 A:middle
增量保存凭证身份

00:15:59.146 --> 00:16:03.386 A:middle
并移除凭证身份模式

00:15:59.146 --> 00:16:03.386 A:middle
并移除凭证身份模式

00:16:03.386 --> 00:16:04.916 A:middle
如果库还没有被写入

00:16:04.916 --> 00:16:07.746 A:middle
也许是因为你的 App 被禁用后

00:16:07.786 --> 00:16:08.996 A:middle
又重新启用了

00:16:10.026 --> 00:16:11.446 A:middle
那么增量更新

00:16:11.446 --> 00:16:12.546 A:middle
就会返回 false 值

00:16:12.736 --> 00:16:13.706 A:middle
你就应该

00:16:13.706 --> 00:16:15.176 A:middle
向身份库中加入凭证身份的

00:16:15.176 --> 00:16:16.176 A:middle
完整列表

00:16:16.176 --> 00:16:19.996 A:middle
通过使用替代凭证身份的方法

00:16:22.306 --> 00:16:23.466 A:middle
一旦你的 App 开始保存

00:16:23.466 --> 00:16:24.626 A:middle
凭证身份到库中

00:16:24.626 --> 00:16:26.716 A:middle
自动填充就可以开始

00:16:26.716 --> 00:16:27.546 A:middle
给出你的 App 中的凭证

00:16:27.546 --> 00:16:28.776 A:middle
显示在快速输入栏内

00:16:29.916 --> 00:16:31.556 A:middle
接下来 你需要在你的扩展中

00:16:31.556 --> 00:16:32.816 A:middle
添加支持来提供密码

00:16:32.816 --> 00:16:33.976 A:middle
当其中的

00:16:33.976 --> 00:16:35.756 A:middle
某一个凭证建议被选取

00:16:37.836 --> 00:16:39.846 A:middle
此时 自动填充

00:16:39.846 --> 00:16:41.376 A:middle
会首先启动你的扩展

00:16:41.376 --> 00:16:42.866 A:middle
并向它请求密码

00:16:42.866 --> 00:16:44.166 A:middle
但不在屏幕上显示你的 UI

00:16:44.346 --> 00:16:46.886 A:middle
自动填充在执行这一步时

00:16:46.886 --> 00:16:48.596 A:middle
在你的视图控制器中

00:16:48.626 --> 00:16:50.306 A:middle
会调用无需用户

00:16:50.536 --> 00:16:51.896 A:middle
交互凭证提供的方法

00:16:52.616 --> 00:16:53.846 A:middle
然后提供出一个

00:16:53.846 --> 00:16:54.776 A:middle
ASPasswordCredentialIdentity

00:16:55.026 --> 00:16:56.026 A:middle
代表着该凭证

00:16:56.026 --> 00:16:59.766 A:middle
已被填充在这一方法中

00:16:59.766 --> 00:17:00.956 A:middle
你需要查找

00:16:59.766 --> 00:17:00.956 A:middle
你需要查找

00:17:00.956 --> 00:17:01.786 A:middle
属于给定凭证的相关密码

00:17:01.786 --> 00:17:03.346 A:middle
并将其交还给

00:17:03.346 --> 00:17:05.106 A:middle
自动填充

00:17:05.106 --> 00:17:07.026 A:middle
通过使用所选凭证 完成请求的方法

00:17:07.536 --> 00:17:11.016 A:middle
如果你的扩展

00:17:11.016 --> 00:17:12.526 A:middle
想要显示出自己的 UI

00:17:13.195 --> 00:17:14.546 A:middle
就取消扩展请求

00:17:14.705 --> 00:17:15.986 A:middle
通过使用

00:17:15.986 --> 00:17:18.016 A:middle
需要用户交互错误代码

00:17:18.016 --> 00:17:20.236 A:middle
在 ASExtensionErrorDomin 内

00:17:22.116 --> 00:17:23.836 A:middle
系统就会在你的视图控制器中

00:17:23.836 --> 00:17:25.746 A:middle
调用准备接口

00:17:25.746 --> 00:17:28.966 A:middle
以提供凭证模式

00:17:28.966 --> 00:17:29.286 A:middle
并显示它的 UI

00:17:30.436 --> 00:17:31.966 A:middle
在这一方法中

00:17:31.966 --> 00:17:33.786 A:middle
你的扩展会为工作流程建立它的 UI

00:17:33.786 --> 00:17:34.726 A:middle
来提供密码

00:17:35.796 --> 00:17:37.236 A:middle
当密码最后准备好

00:17:37.236 --> 00:17:40.916 A:middle
你将凭证返回给自动填充

00:17:40.916 --> 00:17:43.586 A:middle
通过使用所选凭证 完成请求方法

00:17:44.806 --> 00:17:48.746 A:middle
再一次 如果你的 UI 显示出来了

00:17:48.746 --> 00:17:50.076 A:middle
自动填充就不会执行任何认证

00:17:50.076 --> 00:17:51.676 A:middle
在它填入返回的凭证之前

00:17:52.266 --> 00:17:53.486 A:middle
是由你的扩展来决定

00:17:53.486 --> 00:17:54.236 A:middle
什么类型的认证

00:17:54.236 --> 00:17:55.546 A:middle
是它所需要的

00:17:59.016 --> 00:18:00.436 A:middle
在执行这一功能时

00:17:59.016 --> 00:18:00.436 A:middle
在执行这一功能时

00:18:00.436 --> 00:18:01.526 A:middle
要牢记一点

00:18:01.526 --> 00:18:02.896 A:middle
你的扩展

00:18:02.896 --> 00:18:04.346 A:middle
需要快速回应

00:18:04.346 --> 00:18:05.846 A:middle
最开始无 UI 的请求

00:18:05.846 --> 00:18:07.896 A:middle
无论结果是什么

00:18:09.316 --> 00:18:11.066 A:middle
你的 UI 显示出来

00:18:11.066 --> 00:18:12.816 A:middle
所以对用户来说

00:18:12.816 --> 00:18:14.086 A:middle
你的扩展在后台运行

00:18:14.086 --> 00:18:15.056 A:middle
并不会被他们察觉

00:18:16.076 --> 00:18:18.776 A:middle
返回密码需要很长时间

00:18:18.776 --> 00:18:20.676 A:middle
用户可能会感知到系统 你的 App

00:18:20.676 --> 00:18:23.846 A:middle
或者他们正在使用的服务无响应

00:18:24.796 --> 00:18:25.786 A:middle
这对于用户体验来说

00:18:25.786 --> 00:18:26.426 A:middle
是非常糟糕的

00:18:26.946 --> 00:18:29.436 A:middle
并且这是非常重要的

00:18:29.776 --> 00:18:31.396 A:middle
如果几秒钟过去之后

00:18:31.396 --> 00:18:32.556 A:middle
你的扩展还没有

00:18:32.556 --> 00:18:34.586 A:middle
返回密码 被请求显示 UI

00:18:34.586 --> 00:18:36.356 A:middle
或由于别的错误被取消

00:18:36.356 --> 00:18:38.116 A:middle
自动填充会

00:18:38.116 --> 00:18:39.776 A:middle
取消扩展且不填充凭证

00:18:41.616 --> 00:18:43.486 A:middle
然而 这一超时问题

00:18:43.486 --> 00:18:45.376 A:middle
不会发生在排错测试版中

00:18:45.376 --> 00:18:47.066 A:middle
也不会发生在模拟器中

00:18:47.066 --> 00:18:48.226 A:middle
所以你有大把时间

00:18:48.226 --> 00:18:49.996 A:middle
来排查错误 并且不受系统影响

00:18:54.236 --> 00:18:55.746 A:middle
当你在添加支持

00:18:55.746 --> 00:18:56.736 A:middle
让凭证显示在

00:18:56.736 --> 00:18:57.726 A:middle
快速输入栏时

00:18:57.726 --> 00:18:59.346 A:middle
保持凭证身份库

00:18:59.346 --> 00:19:02.226 A:middle
是最新版本尤为重要

00:18:59.346 --> 00:19:02.226 A:middle
是最新版本尤为重要

00:19:02.226 --> 00:19:03.756 A:middle
并且要与你的 App 所了解的凭证同步

00:19:04.856 --> 00:19:07.996 A:middle
如果库不能与你的 App 数据同步

00:19:07.996 --> 00:19:09.166 A:middle
用户就看不到新添加的凭证

00:19:09.166 --> 00:19:10.156 A:middle
在快速输入栏内

00:19:10.156 --> 00:19:13.436 A:middle
或者可能会在快速输入栏上 一直看到某个凭证

00:19:13.606 --> 00:19:14.816 A:middle
即便他们已经从你的 App 中

00:19:14.816 --> 00:19:15.286 A:middle
删除了这一凭证

00:19:16.686 --> 00:19:18.046 A:middle
你应该好好利用

00:19:18.046 --> 00:19:19.416 A:middle
ASCredentialIdentityStore 的

00:19:19.616 --> 00:19:21.186 A:middle
增量更新 API

00:19:21.906 --> 00:19:23.346 A:middle
每当有凭证改变时

00:19:23.346 --> 00:19:26.986 A:middle
就替换整个凭证身份列表

00:19:26.986 --> 00:19:28.286 A:middle
会十分费力费时 特别是

00:19:28.286 --> 00:19:29.966 A:middle
当你有多个凭证身份要更新

00:19:31.016 --> 00:19:32.506 A:middle
这样做对表现而言更有好处

00:19:32.506 --> 00:19:33.666 A:middle
增量保存

00:19:33.666 --> 00:19:35.396 A:middle
新的凭证身份

00:19:35.396 --> 00:19:36.986 A:middle
或者当有变动时移除那些被删除的凭证

00:19:36.986 --> 00:19:39.866 A:middle
而不要覆盖整个库

00:19:42.316 --> 00:19:43.916 A:middle
请记住

00:19:43.916 --> 00:19:45.266 A:middle
当你的扩展被调用

00:19:45.336 --> 00:19:46.496 A:middle
说明用户正在使用

00:19:46.496 --> 00:19:47.106 A:middle
其它的 App

00:19:47.816 --> 00:19:50.886 A:middle
将互动和 UI 减少到最小

00:19:50.886 --> 00:19:52.306 A:middle
并且只添加

00:19:52.306 --> 00:19:53.546 A:middle
为了用户获取密码所必需的部分

00:19:56.496 --> 00:19:57.666 A:middle
如果加载你的密码数据库

00:19:57.666 --> 00:19:59.086 A:middle
包含了非常复杂的步骤

00:19:59.086 --> 00:20:02.676 A:middle
请避免在视图加载方法中 重做这一步骤

00:19:59.086 --> 00:20:02.676 A:middle
请避免在视图加载方法中 重做这一步骤

00:20:02.676 --> 00:20:04.016 A:middle
在你的视图控制器中

00:20:04.016 --> 00:20:04.596 A:middle
并稍后再将其解散

00:20:05.416 --> 00:20:06.836 A:middle
系统可能会重复使用

00:20:06.836 --> 00:20:08.446 A:middle
你的 App 扩展

00:20:08.446 --> 00:20:09.806 A:middle
如果用户顺序登录多个服务

00:20:09.806 --> 00:20:11.386 A:middle
需要使用你的扩展

00:20:12.686 --> 00:20:13.886 A:middle
请考虑使用单一模式

00:20:13.886 --> 00:20:15.766 A:middle
那么任何在一次扩展请求内

00:20:15.766 --> 00:20:17.596 A:middle
完成的工作

00:20:17.596 --> 00:20:19.276 A:middle
都可以被重复使用

00:20:19.276 --> 00:20:20.296 A:middle
只要不是必须重复执行

00:20:20.836 --> 00:20:24.836 A:middle
以上就概括了

00:20:24.836 --> 00:20:26.096 A:middle
如何将你的凭证

00:20:26.096 --> 00:20:29.206 A:middle
显示在快速输入栏上

00:20:29.376 --> 00:20:31.056 A:middle
最后 我再来谈一个 API

00:20:31.056 --> 00:20:33.056 A:middle
它可能对你的扩展会有帮助

00:20:34.106 --> 00:20:35.426 A:middle
当用户为密码自动填充

00:20:35.426 --> 00:20:37.006 A:middle
而启用了你的扩展

00:20:38.296 --> 00:20:39.796 A:middle
你可能需要做一些设置

00:20:39.796 --> 00:20:41.096 A:middle
为了让用户得到最佳体验

00:20:41.676 --> 00:20:43.186 A:middle
首先 如果你支持

00:20:43.186 --> 00:20:44.046 A:middle
在快速输入栏内

00:20:44.046 --> 00:20:45.726 A:middle
显示凭证

00:20:45.726 --> 00:20:47.026 A:middle
你的扩展需要先提供

00:20:47.026 --> 00:20:48.126 A:middle
凭证身份

00:20:48.126 --> 00:20:49.086 A:middle
给自动填充

00:20:50.116 --> 00:20:52.296 A:middle
但此时 显示其它设置可能也是有用的

00:20:52.296 --> 00:20:54.226 A:middle
比如让用户可以

00:20:54.226 --> 00:20:55.416 A:middle
通过登录

00:20:55.416 --> 00:20:56.736 A:middle
一项线上服务

00:20:56.736 --> 00:20:58.016 A:middle
来取回密码

00:20:58.016 --> 00:20:58.396 A:middle
如果他们还没有登录的话

00:21:00.286 --> 00:21:02.156 A:middle
认证服务提供

00:21:02.156 --> 00:21:03.816 A:middle
一个 API 来支持这些工作流程

00:21:04.476 --> 00:21:05.516 A:middle
当这些都在你的扩展上启用

00:21:05.516 --> 00:21:07.396 A:middle
设置可以启动

00:21:07.396 --> 00:21:08.726 A:middle
你的扩展并显示出它的 UI

00:21:08.726 --> 00:21:11.386 A:middle
你就可以让用户来配置它

00:21:13.096 --> 00:21:15.646 A:middle
要进行这一操作

00:21:15.646 --> 00:21:17.076 A:middle
为你的扩展打开

00:21:17.076 --> 00:21:19.176 A:middle
信息特性列表

00:21:19.276 --> 00:21:21.096 A:middle
并在 NSExtensionAttributes 下添加一个

00:21:21.156 --> 00:21:23.716 A:middle
新的键 ASCredentialProviderExtension

00:21:23.716 --> 00:21:26.186 A:middle
ShowsConfigurationUI

00:21:26.186 --> 00:21:27.496 A:middle
且布尔值为 yes

00:21:28.426 --> 00:21:29.666 A:middle
这就是系统能够如何知道

00:21:29.666 --> 00:21:30.956 A:middle
当你的扩展被启用后

00:21:30.956 --> 00:21:31.496 A:middle
要去使用它

00:21:33.896 --> 00:21:37.546 A:middle
然后执行 为扩展配置准备接口方法

00:21:37.546 --> 00:21:38.906 A:middle
在你的视图控制器中

00:21:41.776 --> 00:21:43.026 A:middle
当你的扩展被首次启用时

00:21:43.606 --> 00:21:47.146 A:middle
当你的扩展设置完毕

00:21:47.726 --> 00:21:49.076 A:middle
在你的扩展环境下调用

00:21:49.076 --> 00:21:52.616 A:middle
完成扩展配置请求模式

00:21:52.616 --> 00:21:54.256 A:middle
设置就会关闭你的 UI

00:21:54.336 --> 00:21:57.456 A:middle
此时 你的扩展就被启动了

00:21:57.906 --> 00:22:00.236 A:middle
它此时为自动填充提供了凭证身份

00:21:57.906 --> 00:22:00.236 A:middle
它此时为自动填充提供了凭证身份

00:22:00.236 --> 00:22:01.486 A:middle
以便在快速输入栏上显示建议

00:22:02.136 --> 00:22:03.356 A:middle
它可以提供密码

00:22:03.356 --> 00:22:04.326 A:middle
当这些建议被选中时

00:22:04.326 --> 00:22:06.316 A:middle
并且它也能显示给用户

00:22:06.316 --> 00:22:07.666 A:middle
所有凭证的列表

00:22:08.236 --> 00:22:09.496 A:middle
你现在已经完成了

00:22:09.496 --> 00:22:10.926 A:middle
将密码自动填充整合进你的 App 中这件事

00:22:10.926 --> 00:22:11.906 A:middle
用户可以开始享受

00:22:11.906 --> 00:22:13.166 A:middle
将密码保存在你的 App 中

00:22:13.166 --> 00:22:14.576 A:middle
所带来的便捷

00:22:14.806 --> 00:22:15.646 A:middle
无论何时何地

00:22:18.276 --> 00:22:20.906 A:middle
还有更多非常棒的实例

00:22:20.906 --> 00:22:22.706 A:middle
你可以在开发你的扩展时 进行参考

00:22:23.256 --> 00:22:27.496 A:middle
正如我们之前所谈的

00:22:27.496 --> 00:22:28.856 A:middle
主视图控制器是负责

00:22:28.856 --> 00:22:32.076 A:middle
显示 UI 为不同的功能

00:22:32.866 --> 00:22:34.156 A:middle
要做到这一点

00:22:34.156 --> 00:22:35.536 A:middle
我们建议使用独立的视图控制器

00:22:35.536 --> 00:22:36.876 A:middle
且它们是由主视图控制器

00:22:36.876 --> 00:22:37.376 A:middle
所管理的

00:22:38.596 --> 00:22:40.286 A:middle
比如说 你可能想要

00:22:40.286 --> 00:22:42.786 A:middle
用一个视图控制器层级来显示

00:22:42.786 --> 00:22:43.146 A:middle
凭证身份列表

00:22:43.456 --> 00:22:44.896 A:middle
另一个用来

00:22:44.896 --> 00:22:45.886 A:middle
在填充凭证时

00:22:45.886 --> 00:22:46.546 A:middle
认证用户

00:22:47.056 --> 00:22:50.066 A:middle
你可以将这些视图控制器

00:22:50.066 --> 00:22:51.826 A:middle
显示在主视图控制器中

00:22:51.826 --> 00:22:53.306 A:middle
或者使用视图控制器控制面板

00:22:53.376 --> 00:22:54.366 A:middle
来嵌入它们的视图

00:22:54.506 --> 00:22:56.496 A:middle
如果你通过

00:22:56.496 --> 00:22:57.746 A:middle
显示视图控制器来准备接口

00:22:57.746 --> 00:22:59.366 A:middle
这一显示过程

00:22:59.366 --> 00:23:00.206 A:middle
是需要无动画的

00:22:59.366 --> 00:23:00.206 A:middle
是需要无动画的

00:23:00.206 --> 00:23:03.086 A:middle
因为主视图控制器的显示

00:23:03.086 --> 00:23:04.766 A:middle
已经有了动画

00:23:05.356 --> 00:23:09.766 A:middle
总而言之 扩展需要是

00:23:09.766 --> 00:23:10.826 A:middle
轻量化的

00:23:10.826 --> 00:23:12.416 A:middle
且能够随时终止的

00:23:12.416 --> 00:23:13.396 A:middle
这也包括

00:23:13.396 --> 00:23:14.896 A:middle
自动填充凭证提供扩展

00:23:16.046 --> 00:23:17.226 A:middle
你的扩展是会被唤醒

00:23:17.226 --> 00:23:18.846 A:middle
来执行一件指定的任务

00:23:18.996 --> 00:23:20.126 A:middle
所以你不应该添加任何

00:23:20.126 --> 00:23:21.966 A:middle
不必要的工作流程

00:23:21.966 --> 00:23:23.536 A:middle
或者多余的交互

00:23:25.116 --> 00:23:26.666 A:middle
请注意 系统可能会

00:23:26.666 --> 00:23:27.866 A:middle
在任何时候

00:23:27.866 --> 00:23:29.526 A:middle
出于各类原因

00:23:29.526 --> 00:23:30.026 A:middle
终止或暂定你的扩展

00:23:30.026 --> 00:23:33.566 A:middle
比如说 系统会终止

00:23:33.566 --> 00:23:34.866 A:middle
凭证提供扩展

00:23:34.866 --> 00:23:36.166 A:middle
当用户切换 App

00:23:36.166 --> 00:23:37.016 A:middle
而它们处于使用状态时

00:23:38.656 --> 00:23:39.936 A:middle
你的扩展将会得到一个

00:23:39.936 --> 00:23:41.206 A:middle
独立的标记盒 它来自于主要 App

00:23:41.206 --> 00:23:42.616 A:middle
但它仍然需要共享数据

00:23:42.616 --> 00:23:44.726 A:middle
比如用户的凭证

00:23:45.586 --> 00:23:47.106 A:middle
使用 App 组或共享钥匙串

00:23:47.106 --> 00:23:48.746 A:middle
以便在扩展和 App 之间

00:23:48.746 --> 00:23:50.146 A:middle
共享数据

00:23:51.316 --> 00:23:52.616 A:middle
关于扩展开发的回顾

00:23:52.616 --> 00:23:54.596 A:middle
请参考

00:23:54.596 --> 00:23:56.426 A:middle
为 iOS 和 OS X 建立扩展

00:23:56.506 --> 00:23:58.856 A:middle
会议的第二部分

00:23:58.856 --> 00:24:00.436 A:middle
来自于 WWDC 2014

00:23:58.856 --> 00:24:00.436 A:middle
来自于 WWDC 2014

00:24:03.036 --> 00:24:05.246 A:middle
最后 你可以使用 Safari 浏览器

00:24:05.246 --> 00:24:06.046 A:middle
如果你需要为你的

00:24:06.046 --> 00:24:07.386 A:middle
凭证提供扩展排查错误

00:24:07.576 --> 00:24:08.456 A:middle
当你测试

00:24:08.456 --> 00:24:09.096 A:middle
凭证填充的时候

00:24:10.396 --> 00:24:12.416 A:middle
要执行这一步

00:24:12.416 --> 00:24:13.966 A:middle
首先激活扩展方案流程

00:24:13.966 --> 00:24:15.476 A:middle
选择目标 然后选择运行

00:24:17.556 --> 00:24:19.526 A:middle
当你执行这一操作时 Xcode 会询问

00:24:19.526 --> 00:24:20.896 A:middle
让你选择一个 App 来承载

00:24:20.896 --> 00:24:21.476 A:middle
这一扩展

00:24:22.136 --> 00:24:23.886 A:middle
在列表中选择 Safari 浏览器

00:24:23.886 --> 00:24:25.266 A:middle
然后单击运行按钮

00:24:26.766 --> 00:24:28.386 A:middle
Safari 浏览器会启动

00:24:28.386 --> 00:24:29.946 A:middle
你就可以定位到

00:24:29.946 --> 00:24:30.926 A:middle
你想要测试你的扩展的

00:24:30.926 --> 00:24:31.496 A:middle
登录页面

00:24:32.376 --> 00:24:33.496 A:middle
当你打开你的凭证列表

00:24:33.496 --> 00:24:36.416 A:middle
或者在快速输入栏中 选择一个凭证

00:24:36.546 --> 00:24:38.076 A:middle
扩展就会启动

00:24:38.076 --> 00:24:39.376 A:middle
Xcode 会附上排错程序

00:24:39.376 --> 00:24:40.916 A:middle
这样你就可以开始

00:24:40.916 --> 00:24:41.576 A:middle
你的排错过程了

00:24:44.506 --> 00:24:46.106 A:middle
要在其它情况下

00:24:46.106 --> 00:24:48.316 A:middle
为你的扩展排错

00:24:48.316 --> 00:24:50.436 A:middle
使用 Attach to Process Item 选项

00:24:50.436 --> 00:24:51.806 A:middle
在 Xcode 的排错菜单中

00:24:51.806 --> 00:24:52.206 A:middle
来附加排错程序

00:24:53.426 --> 00:24:54.626 A:middle
如果你想要测试设置 UI

00:24:54.626 --> 00:24:56.746 A:middle
你可以手动打开设置

00:24:56.746 --> 00:24:58.806 A:middle
来启用你的扩展

00:24:58.806 --> 00:25:00.326 A:middle
或者你也可以打开任何 App 的登录页面

00:24:58.806 --> 00:25:00.326 A:middle
或者你也可以打开任何 App 的登录页面

00:25:00.326 --> 00:25:01.636 A:middle
如果你想在那里为自动填充排错

00:25:05.376 --> 00:25:07.686 A:middle
总结一下 iOS 12

00:25:07.686 --> 00:25:08.836 A:middle
允许密码管理 App

00:25:08.836 --> 00:25:10.056 A:middle
整合密码自动填充功能

00:25:11.146 --> 00:25:13.736 A:middle
使用全新的认证服务框架中的 API

00:25:13.736 --> 00:25:15.426 A:middle
你的凭证提供扩展

00:25:15.426 --> 00:25:16.896 A:middle
可以展示给用户

00:25:16.896 --> 00:25:18.296 A:middle
一张完整的凭证列表

00:25:18.916 --> 00:25:19.746 A:middle
将凭证显示在

00:25:19.746 --> 00:25:21.696 A:middle
快速输入栏上

00:25:21.696 --> 00:25:22.976 A:middle
并在设置中 有选择地

00:25:22.976 --> 00:25:24.856 A:middle
为用户提供配置扩展的方式

00:25:27.416 --> 00:25:30.486 A:middle
更多信息 请参考有关这一会议的

00:25:30.486 --> 00:25:31.006 A:middle
Apple 开发人员页面

00:25:32.066 --> 00:25:32.996 A:middle
要了解更多关于

00:25:32.996 --> 00:25:33.916 A:middle
iOS 12 中的密码管理改进

00:25:33.916 --> 00:25:37.796 A:middle
请查看 自动强密码和安全码

00:25:37.796 --> 00:25:39.276 A:middle
自动填充会议

00:25:40.156 --> 00:25:41.226 A:middle
如果你想进一步了解

00:25:41.226 --> 00:25:42.216 A:middle
密码自动填充功能

00:25:42.216 --> 00:25:44.276 A:middle
和相关领域

00:25:44.736 --> 00:25:46.156 A:middle
请查看介绍 App

00:25:46.156 --> 00:25:48.166 A:middle
的密码自动填充会议

00:25:48.166 --> 00:25:49.866 A:middle
来自于 WWDC 2017

WEBVTT

00:00:18.218 --> 00:00:21.154 align:middle line:0
（MAPKIT JS简介
演讲212）

00:00:21.221 --> 00:00:22.356 align:middle line:-1
大家好

00:00:28.629 --> 00:00:29.596 align:middle line:-1
我是Vicki Murley

00:00:29.663 --> 00:00:32.566 align:middle line:-2
我是MapKit JS团队的
工程经理

00:00:32.633 --> 00:00:36.136 align:middle line:-2
这是演讲212
MapKit JS简介

00:00:37.337 --> 00:00:40.607 align:middle line:-1
十多年前当iPhone刚出来时

00:00:40.674 --> 00:00:42.376 align:middle line:-1
它确实改变了整个行业

00:00:42.543 --> 00:00:43.710 align:middle line:-1
它将我们带入了

00:00:43.777 --> 00:00:46.780 align:middle line:-1
现在称为app生态系统的世界

00:00:47.347 --> 00:00:49.783 align:middle line:-2
仔细想一下这很有趣
因为对我们很多人来说

00:00:49.850 --> 00:00:52.953 align:middle line:-2
app是我们日常生活中
一个不可或缺的组成部分

00:00:53.086 --> 00:00:56.590 align:middle line:-2
但在有app之前
先有的是网站

00:00:57.291 --> 00:00:59.860 align:middle line:-2
如果你的公司
是在iPhone之前成立的

00:00:59.927 --> 00:01:02.362 align:middle line:-1
你可能以一个网站开始你的事业

00:00:59.927 --> 00:01:02.362 align:middle line:-1
你可能以一个网站开始你的事业

00:01:02.429 --> 00:01:04.531 align:middle line:-1
即使在今天 如果你有app产品

00:01:04.697 --> 00:01:07.568 align:middle line:-1
你可能也在使用网站来吸引更多用户

00:01:07.634 --> 00:01:09.837 align:middle line:-1
或者只是其它不同的受众

00:01:10.437 --> 00:01:13.173 align:middle line:-1
所以很多开发者 就像你一样

00:01:13.240 --> 00:01:15.375 align:middle line:-1
有一个网站和一个app

00:01:15.442 --> 00:01:19.947 align:middle line:-1
WWDC网站就是一个很好的例子

00:01:20.080 --> 00:01:22.883 align:middle line:0
我们有这个网站
还有一个附带app

00:01:23.016 --> 00:01:24.218 align:middle line:0
你可能正在使用它

00:01:24.284 --> 00:01:26.553 align:middle line:0
在会议中心附近寻找各种路线信息

00:01:26.620 --> 00:01:29.022 align:middle line:0
就好像这周你在这里做的一样

00:01:29.890 --> 00:01:32.326 align:middle line:-1
所以在Apple 我们真的很幸运

00:01:32.392 --> 00:01:37.097 align:middle line:-2
因为我们已经能够在我们自己的
网站上显示Apple Maps

00:01:37.297 --> 00:01:38.599 align:middle line:-1
有一段时间了

00:01:38.799 --> 00:01:41.368 align:middle line:-1
这是WWDC网站上的一个页面

00:01:41.435 --> 00:01:44.972 align:middle line:-2
它能向你展示
会议中心附近的其他活动

00:01:46.173 --> 00:01:49.142 align:middle line:-2
若你曾用过iCloud.com
Find My iPhone功能

00:01:49.209 --> 00:01:51.678 align:middle line:-2
你就已经在网站上
看到过Apple Maps了

00:01:52.613 --> 00:01:55.382 align:middle line:-1
如果你曾经搜索过零售商店

00:01:55.449 --> 00:01:58.318 align:middle line:-2
这也是网页中的
Apple Maps的例子

00:01:58.385 --> 00:01:59.520 align:middle line:-1
（寻找商店）

00:01:59.586 --> 00:02:00.554 align:middle line:-1
你们中的大多数人

00:01:59.586 --> 00:02:00.554 align:middle line:-1
你们中的大多数人

00:02:00.621 --> 00:02:03.757 align:middle line:-2
可能都在app中
使用过MapKit

00:02:04.224 --> 00:02:05.259 align:middle line:-1
今天

00:02:05.325 --> 00:02:08.762 align:middle line:-2
我们开放了MapKit JS
以便你可以在你的网站上使用它

00:02:08.829 --> 00:02:10.464 align:middle line:-1
（MAPKIT JS）

00:02:14.868 --> 00:02:19.540 align:middle line:-2
本周的WWDC上
开放了MapKit JS测试版

00:02:19.606 --> 00:02:22.042 align:middle line:-1
这是我们一直在自己的网站上

00:02:22.109 --> 00:02:24.044 align:middle line:-1
所使用的库

00:02:24.878 --> 00:02:30.450 align:middle line:-2
当前所有网页地图库
都有一个免费的使用级别

00:02:30.517 --> 00:02:33.253 align:middle line:-2
比如你的某些数量以内的请求
是免费的

00:02:33.387 --> 00:02:35.789 align:middle line:-1
MapKit JS测试版也不例外

00:02:36.223 --> 00:02:38.358 align:middle line:-2
作为MapKit JS测试版
的一部分

00:02:38.425 --> 00:02:42.663 align:middle line:-1
你可以得到25万次地图初始化

00:02:43.830 --> 00:02:46.266 align:middle line:-1
和两万五千个服务请求

00:02:46.500 --> 00:02:51.572 align:middle line:-2
这包括地理编码 搜索
搜索自动完成和路线查找

00:02:51.805 --> 00:02:56.410 align:middle line:-2
通常这些免费的使用级别
有一定的使用期限

00:02:56.510 --> 00:02:59.713 align:middle line:-1
可能是每年 每月或每周

00:03:00.514 --> 00:03:01.715 align:middle line:-1
对于MapKit JS测试版

00:03:01.782 --> 00:03:05.419 align:middle line:-2
我们每天都会为你提供
刚才所说的免费使用量

00:03:05.485 --> 00:03:07.554 align:middle line:-1
（每天）

00:03:11.692 --> 00:03:13.160 align:middle line:-1
所以这是很大一笔数额

00:03:13.527 --> 00:03:16.797 align:middle line:-1
但是如果你需要更多来支持你的用例

00:03:16.864 --> 00:03:18.866 align:middle line:-2
或你的公司
你可以与我们联系

00:03:18.932 --> 00:03:20.133 align:middle line:-1
网上有一个表格

00:03:20.200 --> 00:03:23.737 align:middle line:-1
只需填写并提交 我们将收到该请求

00:03:23.804 --> 00:03:24.872 align:middle line:-1
（需要更多？联系我们）

00:03:24.938 --> 00:03:27.674 align:middle line:-2
要想使用MapKit JS
你需要一个密钥

00:03:27.774 --> 00:03:30.677 align:middle line:-2
你可以通过登录你的开发者帐户
来获得这个密钥

00:03:30.811 --> 00:03:34.114 align:middle line:-2
你需要转到
“证书、ID和配置文件”面板

00:03:34.248 --> 00:03:36.183 align:middle line:-1
你可以在那里得到一个密钥

00:03:36.250 --> 00:03:39.720 align:middle line:-2
就像你使用开发者帐户中的
任何其他服务一样

00:03:39.786 --> 00:03:40.988 align:middle line:-1
（获取MAPKIT JS密钥）

00:03:41.054 --> 00:03:44.925 align:middle line:-2
MapKit JS测试版
当前可用的密钥 数量有限

00:03:44.992 --> 00:03:48.095 align:middle line:-1
所以我建议你尽快去申请一个

00:03:50.764 --> 00:03:53.967 align:middle line:-2
一旦你得到一个密钥
并开始使用MapKit JS

00:03:54.101 --> 00:03:56.503 align:middle line:-2
我的意思是 我可能带有偏见
因为我在这工作

00:03:56.570 --> 00:03:59.907 align:middle line:-1
但我认为你会很喜欢它的很多东西

00:04:00.374 --> 00:04:04.545 align:middle line:-2
第一件事是它可以
让你的app和网站

00:04:04.611 --> 00:04:06.780 align:middle line:-1
统一使用同一个地图提供者

00:04:07.147 --> 00:04:10.384 align:middle line:-2
我们注意到有很多人在app中
使用了Apple Maps

00:04:10.884 --> 00:04:13.120 align:middle line:-2
你将可在任何地方
用Apple Maps了

00:04:13.187 --> 00:04:15.322 align:middle line:-2
（为什么你会喜欢
MAPKIT JS）

00:04:15.389 --> 00:04:19.625 align:middle line:-2
MapKit JS API
实际上受到

00:04:19.692 --> 00:04:22.229 align:middle line:-2
你正在使用的本地
MapKit API的启发

00:04:22.296 --> 00:04:25.365 align:middle line:-2
但它们使用的是
Web开发者所熟悉的约定

00:04:25.432 --> 00:04:27.501 align:middle line:-1
所以它们应该很容易适应

00:04:29.703 --> 00:04:36.643 align:middle line:-2
此外 MapKit JS能为网页
带来与Apple Maps同样的使用体验

00:04:36.877 --> 00:04:40.747 align:middle line:-2
它具有32种本地化语言
并完全支持从右到左的文字显示顺序

00:04:41.281 --> 00:04:44.751 align:middle line:-1
它可以通过键盘和语音来使用

00:04:45.319 --> 00:04:49.623 align:middle line:-2
它拥有Apple Maps中
我们都见过且喜爱的漂亮制图

00:04:49.756 --> 00:04:52.826 align:middle line:-2
它也支持原生手势
如双指缩放

00:04:52.893 --> 00:04:57.698 align:middle line:-2
双指旋转 还可以移动
和双指滚动进行放大

00:04:59.199 --> 00:05:02.469 align:middle line:0
它还使用了一种
称为自适应渲染模式的东西

00:04:59.199 --> 00:05:02.469 align:middle line:0
它还使用了一种
称为自适应渲染模式的东西

00:05:02.669 --> 00:05:04.271 align:middle line:-1
它的意思是

00:05:04.338 --> 00:05:07.407 align:middle line:-1
有几种不同的模式可以渲染地图

00:05:07.841 --> 00:05:10.177 align:middle line:-1
第一种是客户端渲染

00:05:10.244 --> 00:05:15.215 align:middle line:-2
这是一个完整的WebGL引擎
它在客户端渲染地图

00:05:15.749 --> 00:05:20.187 align:middle line:0
这使我们能够做很多事情
比如当用户双指缩放

00:05:20.320 --> 00:05:24.491 align:middle line:0
或双指滚动来放大时
这些非常平滑的过渡

00:05:24.558 --> 00:05:28.295 align:middle line:0
当我们在缩放级别之间切换时
你会看到标签淡入淡出

00:05:28.362 --> 00:05:29.630 align:middle line:-1
就像本地app一样

00:05:29.696 --> 00:05:32.099 align:middle line:-2
（客户端渲染（CSR）
在客户端渲染的完整WebGL地图）

00:05:32.165 --> 00:05:35.102 align:middle line:-1
此外 客户端渲染为我们提供了

00:05:35.169 --> 00:05:36.637 align:middle line:-1
对地图上标签的完全控制

00:05:36.837 --> 00:05:39.339 align:middle line:-1
所以我们可以启用旋转等功能

00:05:39.573 --> 00:05:42.476 align:middle line:-1
我用两根手指旋转地图

00:05:42.676 --> 00:05:45.879 align:middle line:-1
但标签在我旋转时仍然保持水平

00:05:47.447 --> 00:05:49.816 align:middle line:-1
最后 通过使用CSR

00:05:49.883 --> 00:05:54.555 align:middle line:-2
我们可以显示你经常
在iOS上看到的标记样式注释

00:05:54.721 --> 00:05:58.192 align:middle line:-2
这个注释的标题是
My Marker

00:05:58.292 --> 00:06:01.228 align:middle line:-2
如果我选择这个注释
就会出现副标题

00:05:58.292 --> 00:06:01.228 align:middle line:-2
如果我选择这个注释
就会出现副标题

00:06:01.295 --> 00:06:04.398 align:middle line:-1
但它会覆盖它下面的那个标签

00:06:04.865 --> 00:06:08.735 align:middle line:-2
因此通过客户端渲染
和对标签的完全控制

00:06:08.869 --> 00:06:11.538 align:middle line:-1
我们可以将该标签隐藏起来

00:06:11.638 --> 00:06:15.275 align:middle line:-1
从而使地图上的标签不会

00:06:15.342 --> 00:06:16.543 align:middle line:-1
与注释的文本重叠

00:06:18.245 --> 00:06:20.614 align:middle line:-1
即使用户放大和缩小

00:06:20.681 --> 00:06:23.717 align:middle line:-1
并且地图标签正在不断变化

00:06:23.851 --> 00:06:27.588 align:middle line:-2
但地图标签永远不会
覆盖你的注释标签

00:06:28.088 --> 00:06:30.524 align:middle line:-1
实际上 如果你有一个可拖动的注释

00:06:30.591 --> 00:06:33.727 align:middle line:-1
并且用户在地图上到处移动它

00:06:34.061 --> 00:06:38.298 align:middle line:-1
地图标签永远不会覆盖你的注释标签

00:06:39.700 --> 00:06:43.003 align:middle line:-2
这是渲染模式之一
即客户端渲染

00:06:43.437 --> 00:06:47.808 align:middle line:-2
但是Web代码可以在任何地方运行
并且不是所有设备都是一样的

00:06:48.408 --> 00:06:51.845 align:middle line:-1
有些时候你的用户

00:06:51.912 --> 00:06:54.348 align:middle line:-1
可能运行在低性能配置的设备上

00:06:54.414 --> 00:06:56.450 align:middle line:-1
也许是一个旧设备

00:06:56.517 --> 00:07:00.020 align:middle line:-2
我们有一种不同的模式
我们称之为仅标签客户端渲染

00:06:56.517 --> 00:07:00.020 align:middle line:-2
我们有一种不同的模式
我们称之为仅标签客户端渲染

00:07:00.687 --> 00:07:01.955 align:middle line:-1
它实际上

00:07:02.122 --> 00:07:05.692 align:middle line:-1
是一个显示底图的图像块网格

00:07:05.993 --> 00:07:10.564 align:middle line:-1
其顶部有一层WebGL标签

00:07:10.797 --> 00:07:14.168 align:middle line:-2
因此我们仍然可以为
尽可能多的用户

00:07:14.234 --> 00:07:18.005 align:middle line:-1
以高性能的方式提供这些强大的功能

00:07:18.605 --> 00:07:20.140 align:middle line:-1
如旋转和标签冲突处理

00:07:22.042 --> 00:07:25.546 align:middle line:-2
如果用户的配置
根本不支持WebGL

00:07:25.612 --> 00:07:27.915 align:middle line:-2
他们将会得到我们称之为
服务器端渲染的东西

00:07:27.981 --> 00:07:31.418 align:middle line:-1
这是一个图像贴图网格

00:07:31.618 --> 00:07:34.521 align:middle line:-2
在这种情况下
标签实际上是图像的一部分

00:07:36.290 --> 00:07:38.825 align:middle line:-1
所以自适应渲染模式非常酷

00:07:38.892 --> 00:07:42.796 align:middle line:-2
因为对每个客户端配置
都有一个理想的模式

00:07:43.497 --> 00:07:46.867 align:middle line:-1
我们会自动为你的用户选择最佳模式

00:07:46.934 --> 00:07:50.337 align:middle line:-2
因此你无需决定
应该使用WebGL版本

00:07:50.404 --> 00:07:52.639 align:middle line:-2
还是贴图版本
或其他什么版本

00:07:52.706 --> 00:07:57.277 align:middle line:-2
我们运行一个快速测试
并为该用户提供该配置的最佳模式

00:07:57.344 --> 00:07:58.912 align:middle line:-1
（自适应渲染模式）

00:07:58.979 --> 00:08:00.480 align:middle line:-1
根据我们迄今的经验

00:07:58.979 --> 00:08:00.480 align:middle line:-1
根据我们迄今的经验

00:08:00.547 --> 00:08:02.883 align:middle line:-1
大多数用户正在使用客户端渲染

00:08:02.950 --> 00:08:04.885 align:middle line:-1
或仅标签客户端渲染

00:08:06.253 --> 00:08:08.589 align:middle line:-2
以上是对MapKit JS
的快速介绍

00:08:08.655 --> 00:08:11.592 align:middle line:-2
现在为了告诉你
有关使用API的更多信息

00:08:11.658 --> 00:08:13.961 align:middle line:-2
我将把舞台
交给Julien Quint

00:08:21.401 --> 00:08:22.503 align:middle line:-1
谢谢 Vicki

00:08:22.569 --> 00:08:24.004 align:middle line:0
（在你的网站上
使用MAPKIT JS）

00:08:24.771 --> 00:08:28.675 align:middle line:-2
我们来看看为你的网站
使用MapKit JS的技术细节

00:08:29.843 --> 00:08:31.545 align:middle line:-1
我们将看到如何设置地图

00:08:32.179 --> 00:08:34.347 align:middle line:-1
如何导航以及注释这张地图

00:08:34.414 --> 00:08:36.350 align:middle line:-1
以便你可以显示自己的数据

00:08:37.451 --> 00:08:40.120 align:middle line:-1
最后 我们将看到如何启用

00:08:40.453 --> 00:08:41.989 align:middle line:-1
与其它服务的富交互

00:08:42.054 --> 00:08:43.890 align:middle line:-1
（设置你的地图）

00:08:43.957 --> 00:08:46.927 align:middle line:-2
要设置你的地图
你需要经过这四个步骤

00:08:47.828 --> 00:08:49.796 align:middle line:-1
第一步是导入MapKit JS

00:08:50.197 --> 00:08:53.567 align:middle line:-2
你可以看到一个script标签
你可以将其添加在页面的某处

00:08:53.934 --> 00:08:58.205 align:middle line:-1
MapKit JS脚本的URL

00:08:58.672 --> 00:09:00.307 align:middle line:-1
包含一个版本号

00:08:58.672 --> 00:09:00.307 align:middle line:-1
包含一个版本号

00:09:01.141 --> 00:09:04.444 align:middle line:-1
我们遵循语义版本控制系统

00:09:04.511 --> 00:09:07.114 align:middle line:-1
其中第一个数字是主要版本号

00:09:07.181 --> 00:09:10.551 align:middle line:-1
它在引入重大更改时才会更新

00:09:10.617 --> 00:09:13.020 align:middle line:-1
第二个数字是次要版本号

00:09:13.086 --> 00:09:17.591 align:middle line:-1
所以当修复漏洞或添加新功能时

00:09:17.758 --> 00:09:19.893 align:middle line:-1
以及引入性能改进时

00:09:19.960 --> 00:09:21.161 align:middle line:-1
我们更新这个数字

00:09:21.228 --> 00:09:24.865 align:middle line:-2
最后对于紧急补丁
我们更新补丁号

00:09:24.932 --> 00:09:27.701 align:middle line:-1
你可以指定一个X而不是特定的数字

00:09:27.768 --> 00:09:29.536 align:middle line:-1
作为次要或补丁版本

00:09:29.603 --> 00:09:33.974 align:middle line:-2
我们建议你
从此版本5.0.X开始使用

00:09:34.041 --> 00:09:38.011 align:middle line:-2
以便你能够在我们的第一个
公开发行版中得到所有bug的修复

00:09:38.078 --> 00:09:40.147 align:middle line:-1
（第2步：创建地图容器）

00:09:40.214 --> 00:09:43.250 align:middle line:-1
为了能够在你的网站上显示地图

00:09:43.450 --> 00:09:47.654 align:middle line:-2
你需要告诉MapKit
在哪里显示该地图

00:09:47.721 --> 00:09:52.826 align:middle line:-2
为了做到这一点
你可以使用HTML元素

00:09:52.893 --> 00:09:55.362 align:middle line:-1
它将成为你的地图的容器

00:09:55.529 --> 00:09:57.164 align:middle line:-2
这个例子中
我用元素

00:09:57.231 --> 00:10:00.901 align:middle line:-1
这通常是非常好的选择

00:09:57.231 --> 00:10:00.901 align:middle line:-1
这通常是非常好的选择

00:10:01.335 --> 00:10:04.805 align:middle line:-2
我给它一个ID
以便我可以轻松地引用它

00:10:04.972 --> 00:10:08.976 align:middle line:-1
一件非常重要的事情是设定它的大小

00:10:09.243 --> 00:10:11.645 align:middle line:-1
因为地图没有自己的大小

00:10:11.712 --> 00:10:15.883 align:middle line:-1
所以它只会使用包含它的元素的大小

00:10:16.250 --> 00:10:18.151 align:middle line:-1
所以如果你有一个元素

00:10:18.285 --> 00:10:21.188 align:middle line:-1
它在这里用灰色背景表示

00:10:21.388 --> 00:10:24.291 align:middle line:-1
地图会显示在该元素内

00:10:24.358 --> 00:10:27.794 align:middle line:-2
如果你的元素大小发生变化
那么你的地图大小也会发生变化

00:10:28.161 --> 00:10:29.463 align:middle line:-2
（第3步：
初始化MAPKIT JS）

00:10:29.530 --> 00:10:32.332 align:middle line:-1
我为我的地图设置了一个元素

00:10:32.633 --> 00:10:35.435 align:middle line:-1
下一步是初始化MapKit JS

00:10:35.502 --> 00:10:39.706 align:middle line:-2
我们刚才看到你需要一个密钥
才能使用MapKit JS

00:10:39.940 --> 00:10:42.342 align:middle line:-1
以及初始化MapKit

00:10:43.443 --> 00:10:46.613 align:middle line:-2
你需要获得
authorizationCallback

00:10:46.680 --> 00:10:51.919 align:middle line:-2
以便你能够使用
MapKit JS提供的服务

00:10:51.985 --> 00:10:56.823 align:middle line:-2
最重要的是它可以在你的网站上
实际显示地图

00:10:58.025 --> 00:11:01.528 align:middle line:0
最后一步是使用MapKit中的
map构造函数

00:10:58.025 --> 00:11:01.528 align:middle line:0
最后一步是使用MapKit中的
map构造函数

00:11:01.595 --> 00:11:03.931 align:middle line:0
创建一个地图对象

00:11:04.031 --> 00:11:07.267 align:middle line:0
我给它地图容器的ID
因此地图将显示在这里

00:11:07.334 --> 00:11:08.535 align:middle line:-1
这就是所发生的事

00:11:08.769 --> 00:11:10.938 align:middle line:-1
我们的网页上显示了一个地图

00:11:12.406 --> 00:11:13.740 align:middle line:-1
这是默认地图

00:11:13.807 --> 00:11:16.043 align:middle line:-1
我们没有传递任何其他参数

00:11:16.109 --> 00:11:18.612 align:middle line:-2
所以它会显示
一个默认区域和默认控件

00:11:18.679 --> 00:11:21.715 align:middle line:-1
你可以在角落处看到控件

00:11:21.782 --> 00:11:24.184 align:middle line:-1
你可以看到用来旋转的指南针

00:11:24.651 --> 00:11:25.819 align:middle line:-1
缩放控件

00:11:26.887 --> 00:11:29.122 align:middle line:-1
顶部的地图类型控件等

00:11:30.791 --> 00:11:33.260 align:middle line:-1
这是一个非常大的区域

00:11:33.527 --> 00:11:36.864 align:middle line:-1
但是如果你在一个页面上

00:11:36.930 --> 00:11:39.433 align:middle line:-1
只想显示一张非常小的地图

00:11:39.499 --> 00:11:42.569 align:middle line:-1
这些控件会占用很多宝贵的空间

00:11:42.636 --> 00:11:46.707 align:middle line:-2
因此默认情况下 当你的地图尺寸
低于某个宽度或高度时

00:11:46.773 --> 00:11:49.877 align:middle line:-1
我们将自动隐藏这些控件

00:11:50.944 --> 00:11:54.147 align:middle line:-1
在触控设备上 情况略有不同

00:11:54.214 --> 00:11:56.683 align:middle line:-1
我们并不需要显示一些控件

00:11:56.750 --> 00:11:58.252 align:middle line:-1
比如缩放或指南针

00:11:58.318 --> 00:12:01.288 align:middle line:-1
因为我们可以用手势

00:11:58.318 --> 00:12:01.288 align:middle line:-1
因为我们可以用手势

00:12:01.355 --> 00:12:04.858 align:middle line:-1
来旋转地图或放大

00:12:05.225 --> 00:12:08.629 align:middle line:-1
所以我们不需要显示这些控件

00:12:08.695 --> 00:12:11.298 align:middle line:-2
来浪费这些空间
因此我们默认关闭它们

00:12:11.365 --> 00:12:12.933 align:middle line:-2
（平台和地图尺寸
——特定的默认值）

00:12:13.000 --> 00:12:16.069 align:middle line:-2
注意Apple徽标和法律文本
将始终存在

00:12:16.970 --> 00:12:18.438 align:middle line:-1
这些是控件的默认值

00:12:18.505 --> 00:12:22.476 align:middle line:-2
但你也可以自己设置
这些控件的可见性

00:12:22.643 --> 00:12:24.645 align:middle line:-1
某些控件是所谓的自适应控件

00:12:24.711 --> 00:12:26.713 align:middle line:-1
这包括指南针和比例尺

00:12:26.847 --> 00:12:29.183 align:middle line:-1
这意味着取决于平台

00:12:29.249 --> 00:12:31.318 align:middle line:-1
他们的行为会略有不同

00:12:31.385 --> 00:12:35.756 align:middle line:-2
在iOS上 默认情况下不显示
指南针控件

00:12:35.822 --> 00:12:37.324 align:middle line:-1
但如果地图旋转了

00:12:37.391 --> 00:12:40.327 align:middle line:-2
我们就会显示它以指示
北方的朝向

00:12:40.394 --> 00:12:44.698 align:middle line:-1
比例尺是地图上距离单位的指标

00:12:44.765 --> 00:12:48.769 align:middle line:-1
我们只在用户放大和缩小时才显示它

00:12:49.036 --> 00:12:53.707 align:middle line:-1
所以当我们进行缩放和旋转时

00:12:53.774 --> 00:12:56.009 align:middle line:-1
我们可以看到指南针

00:12:56.076 --> 00:12:57.444 align:middle line:-1
在右下角出现并消失

00:12:57.511 --> 00:13:00.447 align:middle line:-1
并且比例尺在左上角出现和消失

00:12:57.511 --> 00:13:00.447 align:middle line:-1
并且比例尺在左上角出现和消失

00:13:00.514 --> 00:13:02.382 align:middle line:-1
当然我们也可以设置这些控件

00:13:02.449 --> 00:13:04.451 align:middle line:-1
始终可见或始终隐藏

00:13:04.518 --> 00:13:06.153 align:middle line:-1
（任意情景下的可配置控件）

00:13:06.220 --> 00:13:08.255 align:middle line:-1
其余控件都有一个二进制状态

00:13:08.322 --> 00:13:14.461 align:middle line:-2
以便通过设置其布尔属性
将它们隐藏或设置为可见

00:13:16.163 --> 00:13:16.997 align:middle line:-1
在这个例子中

00:13:17.064 --> 00:13:20.701 align:middle line:-1
我们将显示桌面上默认不显示的控件

00:13:20.834 --> 00:13:22.836 align:middle line:-1
例如用户位置控件

00:13:22.903 --> 00:13:26.240 align:middle line:-1
它出现在窗口的右下角

00:13:26.573 --> 00:13:27.908 align:middle line:-1
在这里 我已经选择了它

00:13:27.975 --> 00:13:29.977 align:middle line:-1
现在正在跟踪用户位置

00:13:30.043 --> 00:13:32.679 align:middle line:-1
你可以在地图中心看到用户当前位置

00:13:33.280 --> 00:13:37.451 align:middle line:-2
比例尺显示在左上方
因为我将其标记为始终可见

00:13:38.719 --> 00:13:41.054 align:middle line:-1
我们可以进一步配置这些控件

00:13:42.089 --> 00:13:45.459 align:middle line:-1
为了更好地匹配页面的配色方案

00:13:45.526 --> 00:13:47.794 align:middle line:-1
你可以设置地图的色调

00:13:47.861 --> 00:13:51.365 align:middle line:-1
这会改变用户控件的颜色

00:13:51.431 --> 00:13:55.202 align:middle line:-1
例如 你可以看到地图的所有控件…

00:13:55.269 --> 00:13:57.738 align:middle line:-2
你可以看到用户控件
现在突出显示为红色

00:13:57.804 --> 00:14:00.407 align:middle line:-1
因为我将其色调颜色设置为红色

00:13:57.804 --> 00:14:00.407 align:middle line:-1
因为我将其色调颜色设置为红色

00:14:00.474 --> 00:14:02.543 align:middle line:-1
你可以在此处使用任何CSS颜色值

00:14:03.143 --> 00:14:04.611 align:middle line:-1
（本地化）

00:14:04.678 --> 00:14:08.615 align:middle line:-2
MapKit将使用你的浏览器的
语言配置

00:14:09.216 --> 00:14:14.955 align:middle line:-2
以便它能够调整为
你的用户所期望的语言

00:14:15.022 --> 00:14:18.025 align:middle line:-1
你也可以在初始化调用中设置语言

00:14:18.091 --> 00:14:21.061 align:middle line:-2
或者你甚至可以使用
language属性即时设置它

00:14:21.128 --> 00:14:22.696 align:middle line:-1
这里我把它设置为日语

00:14:22.763 --> 00:14:27.868 align:middle line:-1
因此我可以以日语显示地图以及控件

00:14:28.235 --> 00:14:30.771 align:middle line:-2
比如你可以看到指南针中的
北方指示符

00:14:30.871 --> 00:14:32.472 align:middle line:-1
已被替换

00:14:32.539 --> 00:14:35.442 align:middle line:-1
并且单位现在使用了公制系统

00:14:35.509 --> 00:14:40.147 align:middle line:-1
这在日本比使用英里或码更传统

00:14:42.216 --> 00:14:45.219 align:middle line:-1
如果你将语言设置为从右向左显示

00:14:45.285 --> 00:14:48.055 align:middle line:-2
例如本例中的希伯来语
或阿拉伯语

00:14:48.121 --> 00:14:52.226 align:middle line:-2
其中的控件也会被镜像显示
以符合用户的期望

00:14:53.861 --> 00:14:56.730 align:middle line:-1
控件是你的用户可以与地图

00:14:56.797 --> 00:14:58.832 align:middle line:-1
进行交互的一些方法

00:14:58.899 --> 00:15:00.434 align:middle line:-1
也是直接交互的方法

00:14:58.899 --> 00:15:00.434 align:middle line:-1
也是直接交互的方法

00:15:00.501 --> 00:15:04.838 align:middle line:-2
正如我所说的
我们可以在触摸设备上使用触摸事件

00:15:04.972 --> 00:15:06.607 align:middle line:-1
在桌面上对于一些手势

00:15:06.673 --> 00:15:07.975 align:middle line:-1
你可以使用触控板

00:15:08.041 --> 00:15:11.078 align:middle line:-1
你也可以使用鼠标点击并平移地图

00:15:11.144 --> 00:15:14.348 align:middle line:-1
或双击以放大地图

00:15:14.481 --> 00:15:17.885 align:middle line:-1
你也可以直接禁用这些交互

00:15:18.118 --> 00:15:20.687 align:middle line:-2
比如通过将ZoomEnabled
ScrollEnabled

00:15:20.854 --> 00:15:23.056 align:middle line:-2
或RotateEnabled属性值
设置为“false”

00:15:23.123 --> 00:15:25.792 align:middle line:-1
例如 如果你有个非常小的地图

00:15:25.859 --> 00:15:27.361 align:middle line:-1
就像我之前展示的那种

00:15:27.728 --> 00:15:28.629 align:middle line:-1
你可能需要确保

00:15:28.695 --> 00:15:31.398 align:middle line:-1
用户不会意外移动地图

00:15:31.465 --> 00:15:33.667 align:middle line:-1
以确保它始终显示正确的区域

00:15:33.734 --> 00:15:36.069 align:middle line:-2
你就可以将这些属性
设置为“false”

00:15:36.236 --> 00:15:37.804 align:middle line:-1
这将会使地图变为静态

00:15:38.305 --> 00:15:40.140 align:middle line:-1
（导航和注释地图）

00:15:40.207 --> 00:15:43.844 align:middle line:-2
现在我们知道了
如何在我们的页面上设置地图

00:15:43.911 --> 00:15:46.580 align:middle line:-1
我们还希望展示一些有趣的内容

00:15:47.648 --> 00:15:52.419 align:middle line:-2
我们可以通过导航浏览世界各地
来展示特定区域

00:15:52.519 --> 00:15:53.921 align:middle line:-1
也可以注释地图

00:15:53.987 --> 00:15:55.756 align:middle line:-1
来引起对我们想展示的

00:15:56.823 --> 00:15:58.225 align:middle line:-1
区域的关注

00:16:00.694 --> 00:16:03.063 align:middle line:-1
我们将看到如何设置中心和区域

00:16:03.130 --> 00:16:05.832 align:middle line:-1
如何向地图添加注释以标记位置

00:16:05.899 --> 00:16:08.869 align:middle line:-2
以及如何使用叠层
来覆盖地图的某些区域

00:16:09.369 --> 00:16:11.305 align:middle line:-1
我们从地图的中心和区域开始说起

00:16:13.307 --> 00:16:14.741 align:middle line:-1
同样 这是一个默认地图

00:16:15.142 --> 00:16:18.078 align:middle line:-1
它显示的是默认区域

00:16:18.145 --> 00:16:22.216 align:middle line:-1
它已经缩小到最小级别

00:16:22.516 --> 00:16:26.186 align:middle line:-1
并将地图中心置于0/0经纬度上

00:16:26.753 --> 00:16:29.756 align:middle line:-2
你可能想展示世界中
一个更具体的区域

00:16:29.823 --> 00:16:31.225 align:middle line:-1
对于这个例子

00:16:31.291 --> 00:16:34.394 align:middle line:-1
我想将焦点集中在巴西的里约热内卢

00:16:35.229 --> 00:16:37.664 align:middle line:-1
为此 我将设置我的地图中心

00:16:37.731 --> 00:16:39.366 align:middle line:-1
为里约热内卢的坐标

00:16:39.433 --> 00:16:40.701 align:middle line:-1
你可以在右边看到

00:16:40.767 --> 00:16:45.239 align:middle line:-1
地图中心已经移动到里约热内卢

00:16:45.839 --> 00:16:48.609 align:middle line:-2
但是设置地图的中心
不会改变缩放比例

00:16:48.675 --> 00:16:51.144 align:middle line:-2
因此在这样的尺度下
里约还不算关注的焦点

00:16:51.211 --> 00:16:53.247 align:middle line:-1
因为我们可以看到整个南美洲

00:16:53.313 --> 00:16:55.215 align:middle line:-1
所以让我们放大一点

00:16:55.282 --> 00:16:56.283 align:middle line:-1
（在地图上移动）

00:16:56.350 --> 00:16:59.286 align:middle line:-2
为了做到这一点
我会设置一个区域

00:16:59.353 --> 00:17:02.289 align:middle line:-1
一个坐标区域由一个中心

00:16:59.353 --> 00:17:02.289 align:middle line:-1
一个坐标区域由一个中心

00:17:02.356 --> 00:17:05.358 align:middle line:-1
它由处于地图的中心的这些点表示

00:17:05.626 --> 00:17:07.861 align:middle line:-1
以及纬度和经度范围组成

00:17:07.928 --> 00:17:12.266 align:middle line:-1
我在这里将该区域显示为这个虚线框

00:17:12.933 --> 00:17:17.538 align:middle line:-2
但我们会注意到
最终在地图上显示的区域

00:17:17.637 --> 00:17:20.140 align:middle line:-1
将比你要求显示的区域更大

00:17:20.207 --> 00:17:23.609 align:middle line:-1
因为我们需要确保它完全包括在

00:17:23.676 --> 00:17:25.979 align:middle line:-1
你为地图设置的边界里面

00:17:26.046 --> 00:17:28.147 align:middle line:-2
所以在这种情况下
我需要添加一些填充

00:17:28.448 --> 00:17:32.219 align:middle line:-1
即该地区的北部和南部

00:17:32.452 --> 00:17:34.655 align:middle line:-1
以显示指定的整个区域

00:17:34.788 --> 00:17:39.793 align:middle line:-2
就编码
和MapKit JS框架而言

00:17:40.761 --> 00:17:43.297 align:middle line:-2
中心被设置为一个
mapkit.Coordinate对象

00:17:43.363 --> 00:17:45.499 align:middle line:-1
这是一个纬度和经度对

00:17:45.832 --> 00:17:48.936 align:middle line:-2
地图的区域用
CoordinateRegion来表示

00:17:49.269 --> 00:17:51.972 align:middle line:-1
它是一个包含两个成员的对象

00:17:52.039 --> 00:17:53.941 align:middle line:-1
一个中心 也即一个坐标

00:17:54.341 --> 00:17:55.442 align:middle line:-1
以及坐标跨度

00:17:55.509 --> 00:17:58.512 align:middle line:-1
它是一个纬度增量和一个经度增量

00:17:59.112 --> 00:18:01.615 align:middle line:-1
（总是展示正确的区域）

00:17:59.112 --> 00:18:01.615 align:middle line:-1
（总是展示正确的区域）

00:18:01.682 --> 00:18:04.651 align:middle line:-1
我是怎么得到我在这些截图中

00:18:04.718 --> 00:18:06.286 align:middle line:-1
向你展示的这个区域或坐标的呢

00:18:06.353 --> 00:18:08.689 align:middle line:-1
实际上有很多方法可以查到

00:18:10.123 --> 00:18:12.092 align:middle line:-1
特定的区域和坐标

00:18:12.159 --> 00:18:16.163 align:middle line:-2
你可以在维基百科上查找它们
并将其放入你的代码中

00:18:16.230 --> 00:18:21.635 align:middle line:-2
你可以从某些
具有地理信息的数据库中获取它们

00:18:22.336 --> 00:18:25.172 align:middle line:-1
但还有一种方法可以获得这些信息

00:18:25.439 --> 00:18:30.978 align:middle line:-2
就是使用MapKit服务
它包括地理编码和搜索

00:18:31.044 --> 00:18:34.081 align:middle line:-1
地理编码可以让你查找一个地方

00:18:34.982 --> 00:18:36.950 align:middle line:-1
并将返回一个坐标和一个区域

00:18:37.017 --> 00:18:38.685 align:middle line:-1
在前面的这个例子中

00:18:38.752 --> 00:18:41.054 align:middle line:-2
我使用了
MapKit JS的地理编码

00:18:41.121 --> 00:18:44.324 align:middle line:-1
来查找里约热内卢的坐标和区域

00:18:44.391 --> 00:18:46.193 align:middle line:-1
这就是我对地图进行的设置

00:18:46.627 --> 00:18:50.163 align:middle line:-1
你也可以使用搜索功能来搜索地方

00:18:50.230 --> 00:18:54.034 align:middle line:-1
它不仅会返回这些地方的坐标

00:18:54.101 --> 00:18:56.537 align:middle line:-2
而且还会返回
你可在地图上进行设置的边界区域

00:18:56.837 --> 00:18:59.373 align:middle line:-1
以此确保它包含全部结果

00:18:59.640 --> 00:19:01.141 align:middle line:-1
（设置一个包含项目的区域）

00:18:59.640 --> 00:19:01.141 align:middle line:-1
（设置一个包含项目的区域）

00:19:01.208 --> 00:19:04.978 align:middle line:-2
在地图上快速设置区域的另一种方式
非常方便

00:19:05.045 --> 00:19:06.813 align:middle line:-2
它是一个名为
showItems的方法

00:19:07.047 --> 00:19:10.617 align:middle line:-2
我们现在看看
如何在地图上添加注释和叠层

00:19:10.684 --> 00:19:11.785 align:middle line:-1
且通过调用showItems

00:19:11.852 --> 00:19:15.556 align:middle line:-2
我们将确保能够得到
一个包含所有这些项目的区域

00:19:15.622 --> 00:19:17.591 align:middle line:-1
以便用户可以看到它们

00:19:17.658 --> 00:19:19.626 align:middle line:-1
（区域变化可以使用动画效果）

00:19:19.693 --> 00:19:21.862 align:middle line:-1
我会提到区域更改可以使用动画效果

00:19:21.929 --> 00:19:24.765 align:middle line:-1
因此你可以提供一个很好的动画效果

00:19:24.831 --> 00:19:27.000 align:middle line:-1
或者你也可以立即设置区域

00:19:29.203 --> 00:19:32.439 align:middle line:-1
这些事情 比如改变地区

00:19:32.773 --> 00:19:35.809 align:middle line:-2
改变中心等
可以在你的代码中完成

00:19:35.876 --> 00:19:39.213 align:middle line:-1
但它们也可以由用户的交互来完成

00:19:39.279 --> 00:19:42.716 align:middle line:-1
你希望能够对这些交互作出响应

00:19:43.050 --> 00:19:44.751 align:middle line:-1
map对象…

00:19:45.752 --> 00:19:48.922 align:middle line:-1
允许你监听用户事件

00:19:49.223 --> 00:19:51.959 align:middle line:-2
例如区域更改事件
它们何时开始以及何时结束

00:19:52.259 --> 00:19:53.961 align:middle line:-1
因为这可以用动画来表示

00:19:54.094 --> 00:19:58.332 align:middle line:-2
还有诸如滚动 缩放和旋转等手势的
开始和结束

00:19:58.465 --> 00:20:01.301 align:middle line:-1
我们遵循DOM事件处理模型

00:19:58.465 --> 00:20:01.301 align:middle line:-1
我们遵循DOM事件处理模型

00:20:01.368 --> 00:20:03.403 align:middle line:-1
所以你会见到这些熟悉的方法

00:20:03.470 --> 00:20:05.906 align:middle line:-2
如addEventListener
和removeEventListener

00:20:06.206 --> 00:20:07.341 align:middle line:-1
其参数为事件的名称

00:20:07.407 --> 00:20:11.044 align:middle line:-2
以及一个包含事件参数的
event对象

00:20:11.111 --> 00:20:12.045 align:middle line:-1
举个例子

00:20:12.112 --> 00:20:15.883 align:middle line:-1
如果我想每当用户打开不同的区域时

00:20:15.949 --> 00:20:18.318 align:middle line:-1
都用一些新信息刷新我的地图

00:20:18.385 --> 00:20:20.921 align:middle line:-2
我可以监听
region-change-end事件

00:20:21.121 --> 00:20:24.658 align:middle line:-2
这会让我知道
地图已经切换到一个新的地方

00:20:24.725 --> 00:20:26.960 align:middle line:-1
现在我可以使用该地图的区域

00:20:27.027 --> 00:20:32.266 align:middle line:-1
来计算我想在此阶段显示哪些信息

00:20:34.735 --> 00:20:39.473 align:middle line:-2
现在我们知道了如何设置地图
让我们在上面添加一些自己的信息

00:20:39.706 --> 00:20:41.542 align:middle line:-1
我们可以用注释和叠层来做到这一点

00:20:41.608 --> 00:20:43.010 align:middle line:-1
我将从注释开始

00:20:43.076 --> 00:20:45.345 align:middle line:-1
MapKit JS提供了三种注释

00:20:45.412 --> 00:20:47.614 align:middle line:0
第一种你刚才已经看到过

00:20:47.681 --> 00:20:49.483 align:middle line:0
它是标记注释

00:20:50.517 --> 00:20:51.852 align:middle line:0
你可使用图像或DOM元素

00:20:51.919 --> 00:20:55.989 align:middle line:0
来自定义注释
这比标记注释

00:20:56.256 --> 00:20:57.791 align:middle line:0
所提供的信息更多

00:20:57.858 --> 00:21:01.328 align:middle line:0
其中DOM元素注释将
具有完全可定制的外观

00:20:57.858 --> 00:21:01.328 align:middle line:0
其中DOM元素注释将
具有完全可定制的外观

00:21:01.762 --> 00:21:02.729 align:middle line:-1
（标记注释）

00:21:02.796 --> 00:21:03.697 align:middle line:-1
标记注释

00:21:03.764 --> 00:21:06.867 align:middle line:-2
是MapKit JS提供的
最有用的注释

00:21:06.934 --> 00:21:12.005 align:middle line:-1
因为它们内置了丰富的交互功能

00:21:12.673 --> 00:21:14.107 align:middle line:-1
并且还有很多样式可供选择

00:21:14.174 --> 00:21:16.109 align:middle line:-1
因此它们与你在iOS上

00:21:16.176 --> 00:21:18.245 align:middle line:-1
看到的标记注释类似

00:21:19.079 --> 00:21:22.216 align:middle line:-2
他们有一个选中和取消选中的
内置动画

00:21:22.449 --> 00:21:25.619 align:middle line:-1
并且它们会自动隐藏底层的地图标签

00:21:25.886 --> 00:21:26.753 align:middle line:-1
如我们刚才所见

00:21:26.820 --> 00:21:28.622 align:middle line:-1
所以这里当我选中我的注释时

00:21:28.922 --> 00:21:34.194 align:middle line:-2
车站出口的标签将会隐藏
从而为副标题留出空间

00:21:34.261 --> 00:21:36.530 align:middle line:-1
（外观自动适应当前的渲染模式）

00:21:36.597 --> 00:21:38.365 align:middle line:-1
标记注释…

00:21:39.199 --> 00:21:43.136 align:middle line:-1
标记注释的外观也会自动适应

00:21:43.370 --> 00:21:44.304 align:middle line:-1
MapKit JS为

00:21:44.371 --> 00:21:46.673 align:middle line:-1
你的地图选择的渲染模式

00:21:46.940 --> 00:21:48.208 align:middle line:-1
我们已经看到

00:21:48.275 --> 00:21:51.945 align:middle line:-2
当使用客户端渲染模式
或仅标签客户端渲染模式时

00:21:52.012 --> 00:21:53.780 align:middle line:-1
我们可以隐藏标签

00:21:53.847 --> 00:21:55.916 align:middle line:-1
我们也可以显示你在地图上的

00:21:55.983 --> 00:21:57.417 align:middle line:-1
注释的标题和副标题

00:21:57.484 --> 00:22:00.020 align:middle line:-1
这就是左侧显示的内容

00:21:57.484 --> 00:22:00.020 align:middle line:-1
这就是左侧显示的内容

00:22:00.754 --> 00:22:04.858 align:middle line:-2
如果你使用服务器端渲染
则标签会内置到标签贴片中

00:22:04.925 --> 00:22:05.959 align:middle line:-1
而且无法隐藏它们

00:22:06.026 --> 00:22:07.961 align:middle line:-1
如果你看下右边的地图

00:22:08.028 --> 00:22:11.665 align:middle line:-2
我们可以看到更多的标签
因为它们都没有被隐藏

00:22:11.765 --> 00:22:15.602 align:middle line:-1
因此为了能够清晰地显示我们的注释

00:22:15.802 --> 00:22:19.606 align:middle line:-2
我们将只显示注释气球
并且标签不会显示在地图上

00:22:19.840 --> 00:22:23.377 align:middle line:-1
我们仍然可以通过选中标注泡泡

00:22:23.443 --> 00:22:26.413 align:middle line:-1
来看到这些注释的标题和副标题

00:22:26.480 --> 00:22:27.648 align:middle line:-1
就像在这个例子中一样

00:22:27.714 --> 00:22:28.715 align:middle line:-1
自定义注释

00:22:28.782 --> 00:22:31.885 align:middle line:-1
也会使用这种标注泡泡

00:22:31.952 --> 00:22:33.654 align:middle line:-1
来显示其标题和副标题

00:22:35.322 --> 00:22:39.226 align:middle line:-1
最后 标记注释提供了很多样式选项

00:22:39.560 --> 00:22:41.728 align:middle line:-1
这是标记注释的默认值

00:22:41.795 --> 00:22:44.364 align:middle line:-1
你可以使用坐标和一些属性

00:22:44.698 --> 00:22:46.900 align:middle line:-2
如标题和副标题
来创建注释

00:22:46.967 --> 00:22:50.437 align:middle line:-1
这是基本的默认渲染

00:22:50.537 --> 00:22:53.440 align:middle line:-2
你将看到一个字形图像
它是气球中显示的图钉

00:22:53.507 --> 00:22:55.676 align:middle line:-1
并且它呈现红色

00:22:56.977 --> 00:23:00.214 align:middle line:-2
你可以将该颜色更改为
任何CSS颜色值

00:22:56.977 --> 00:23:00.214 align:middle line:-2
你可以将该颜色更改为
任何CSS颜色值

00:23:00.280 --> 00:23:03.550 align:middle line:-1
在这里我用了一个绿色的气球

00:23:03.784 --> 00:23:05.986 align:middle line:-1
你还可以更改字形的颜色

00:23:06.086 --> 00:23:07.921 align:middle line:-1
字形只能有一种颜色

00:23:08.121 --> 00:23:11.124 align:middle line:-2
在这个例子中
我从默认的白色

00:23:11.191 --> 00:23:12.359 align:middle line:-1
切换为黄色

00:23:13.894 --> 00:23:15.462 align:middle line:-1
你可以更改字形的图像

00:23:15.529 --> 00:23:18.432 align:middle line:-2
将MapKit JS
提供的默认图钉

00:23:18.498 --> 00:23:21.401 align:middle line:-1
更改为你可以提供的任何光栅图像

00:23:21.468 --> 00:23:23.370 align:middle line:-1
在这个例子中 我提供了这个图像

00:23:23.604 --> 00:23:26.106 align:middle line:-1
你可以为图片提供多个来源

00:23:26.173 --> 00:23:27.808 align:middle line:-1
以适应不同的像素比例

00:23:27.875 --> 00:23:29.409 align:middle line:-2
（自定义以适应你网站的
外观和感觉）

00:23:29.476 --> 00:23:32.679 align:middle line:-1
当注释被选中时 它变得更大

00:23:32.746 --> 00:23:35.582 align:middle line:-2
因此你有更多空间
在你的字形中显示更多细节

00:23:35.649 --> 00:23:37.584 align:middle line:-2
因此在这个例子中
我们也可以指定

00:23:37.651 --> 00:23:38.852 align:middle line:-1
一个选中字形图像

00:23:39.086 --> 00:23:41.655 align:middle line:-1
它与原始图像不同

00:23:43.390 --> 00:23:44.491 align:middle line:-1
最后 除了图像

00:23:44.558 --> 00:23:46.994 align:middle line:-1
你还可以使用某些文字来更改字形

00:23:47.261 --> 00:23:51.164 align:middle line:-1
我们建议你使用非常短的字符串

00:23:51.231 --> 00:23:52.833 align:middle line:-1
比如一到三个字符

00:23:53.166 --> 00:23:55.636 align:middle line:-2
在这个例子中
我只使用了一个字母M

00:23:55.969 --> 00:23:58.639 align:middle line:-1
当字形文字和字形图像都被指定时

00:23:58.705 --> 00:24:00.874 align:middle line:-1
将显示字形文字

00:23:58.705 --> 00:24:00.874 align:middle line:-1
将显示字形文字

00:24:01.508 --> 00:24:04.545 align:middle line:-1
现在我们知道了如何显示标记注释

00:24:04.611 --> 00:24:07.281 align:middle line:-2
我们可以疯狂的在地图上
添加很多注释

00:24:07.681 --> 00:24:11.552 align:middle line:-1
这是在巴黎搜索咖啡馆和酒吧的结果

00:24:11.618 --> 00:24:15.155 align:middle line:-2
我为它们设置了不同的样式
以便将它们彼此区分开来

00:24:15.522 --> 00:24:18.859 align:middle line:-1
但问题是在同一区域内

00:24:18.926 --> 00:24:20.994 align:middle line:-1
有非常密集的注释

00:24:21.895 --> 00:24:24.131 align:middle line:-2
幸运的是我们在
MapKit JS中有两种方法

00:24:24.198 --> 00:24:25.866 align:middle line:-1
来处理这种混乱

00:24:26.400 --> 00:24:30.170 align:middle line:-2
第一种是在注释上设置
displayPriority属性

00:24:30.704 --> 00:24:33.240 align:middle line:-1
这意味着当两个注释相冲突时

00:24:33.307 --> 00:24:35.375 align:middle line:-2
displayPriority
最高的注释

00:24:35.442 --> 00:24:36.577 align:middle line:-1
其为一个数字

00:24:37.144 --> 00:24:41.648 align:middle line:-2
将会隐藏具有
最低displayPriority的注释

00:24:41.715 --> 00:24:42.883 align:middle line:-1
（注释冲突）

00:24:42.950 --> 00:24:44.751 align:middle line:-2
因此在这个例子中
我们看到很多注释

00:24:44.818 --> 00:24:45.919 align:middle line:-1
已被隐藏出去

00:24:45.986 --> 00:24:48.822 align:middle line:-2
当你放大和缩小时
这种冲突检测将再次运行

00:24:48.889 --> 00:24:53.126 align:middle line:-1
比如放大地图可以让你发现更多注释

00:24:53.427 --> 00:24:55.429 align:middle line:-2
当它们具有相同的
displayPriority时

00:24:55.596 --> 00:24:59.399 align:middle line:-1
我们将使用屏幕底部显示的那个

00:25:00.267 --> 00:25:01.902 align:middle line:-1
来作为优先级最高的注释

00:25:01.969 --> 00:25:03.070 align:middle line:-1
（注释群集）

00:25:03.136 --> 00:25:05.639 align:middle line:-1
处理混乱的另一种方法是使用群集

00:25:05.706 --> 00:25:07.407 align:middle line:-1
而不是使用这些显示优先级

00:25:07.608 --> 00:25:11.411 align:middle line:-2
在这种情况下
当两个注释具有相同的群集标识符时

00:25:11.478 --> 00:25:14.014 align:middle line:-2
这是一个可以
在标记注释上设置的属性

00:25:14.281 --> 00:25:15.482 align:middle line:-1
且是一个简单的字符串

00:25:15.816 --> 00:25:19.920 align:middle line:-2
当两个注释冲突
并具有相同的群集标识符时

00:25:19.987 --> 00:25:23.323 align:middle line:-2
它们将被替换为
能够表示它们两个的单个注释

00:25:23.390 --> 00:25:26.994 align:middle line:-2
当然 如果两个以上的注释相冲突
它们也将如此

00:25:27.261 --> 00:25:28.228 align:middle line:-1
因此在这个例子中

00:25:28.295 --> 00:25:31.899 align:middle line:-1
我们看到一些注释可以单独显示

00:25:31.965 --> 00:25:33.934 align:middle line:-1
因为它们没有邻居

00:25:34.368 --> 00:25:36.770 align:middle line:-1
但在中心的密集区域

00:25:36.870 --> 00:25:40.174 align:middle line:-1
我们将几个注释聚集在一起

00:25:40.941 --> 00:25:43.944 align:middle line:-2
创建群集时
我们使用标记注释来表示它

00:25:44.011 --> 00:25:44.978 align:middle line:-1
我们使用字形

00:25:45.045 --> 00:25:47.447 align:middle line:-1
来显示群集中有多少个注释

00:25:47.714 --> 00:25:52.886 align:middle line:-1
你还可以更改群集的外观

00:25:52.953 --> 00:25:57.057 align:middle line:-1
通过指定新的样式或新的注释类型

00:25:57.658 --> 00:26:01.862 align:middle line:0
现在我们将通过一个小演示
来展示这些注释的实际操作

00:25:57.658 --> 00:26:01.862 align:middle line:0
现在我们将通过一个小演示
来展示这些注释的实际操作

00:26:01.929 --> 00:26:03.664 align:middle line:-1
（标记注释演示）

00:26:06.533 --> 00:26:07.634 align:middle line:-1
在这个演示中

00:26:09.303 --> 00:26:11.104 align:middle line:-1
它应该在这里显示

00:26:11.171 --> 00:26:12.105 align:middle line:-1
（嘿！是大脚怪！）

00:26:12.172 --> 00:26:13.774 align:middle line:-2
这个演示中
我们将使用一张地图

00:26:14.374 --> 00:26:16.677 align:middle line:-1
我们要显示的数据

00:26:17.377 --> 00:26:20.480 align:middle line:-1
是在这个地区发生的大脚怪目击事件

00:26:20.714 --> 00:26:23.851 align:middle line:-2
所以在本次演讲之后
或者也许是本周末

00:26:23.917 --> 00:26:26.420 align:middle line:-1
当会议结束以后

00:26:26.520 --> 00:26:29.923 align:middle line:-1
你可以去探索北加州的树林

00:26:29.990 --> 00:26:31.458 align:middle line:-1
来看看能不能找到大脚怪

00:26:33.660 --> 00:26:35.262 align:middle line:-1
我创建了一张地图

00:26:36.063 --> 00:26:39.333 align:middle line:-1
我已经按照刚才幻灯片中

00:26:39.399 --> 00:26:41.869 align:middle line:-1
所显示的方式进行了初始化

00:26:43.203 --> 00:26:44.037 align:middle line:-1
我所做的是

00:26:44.104 --> 00:26:49.977 align:middle line:-1
我收集了大脚怪目击事件的清单

00:26:50.377 --> 00:26:52.145 align:middle line:-1
包括他们的位置

00:26:52.212 --> 00:26:56.984 align:middle line:-2
它们发生的年份
以及其它一些信息

00:26:57.384 --> 00:26:58.418 align:middle line:-1
我想要做的是…

00:26:58.485 --> 00:27:01.154 align:middle line:-1
我想要使用这些注释并在地图上

00:26:58.485 --> 00:27:01.154 align:middle line:-1
我想要使用这些注释并在地图上

00:27:01.221 --> 00:27:02.422 align:middle line:-1
用标记注释来显示它们

00:27:02.489 --> 00:27:07.261 align:middle line:-2
让我创建一个函数来将
一个具有所有这些属性的目击事件

00:27:07.327 --> 00:27:10.697 align:middle line:-1
转换为一个标记注释

00:27:12.099 --> 00:27:15.302 align:middle line:-2
所以对于一个目击事件
我想将其坐标

00:27:15.369 --> 00:27:17.871 align:middle line:-1
用作标记注释的坐标

00:27:18.505 --> 00:27:20.774 align:middle line:-1
这些目击事件还有其他一些属性

00:27:20.841 --> 00:27:24.444 align:middle line:-2
例如目击年份
我将在标题中显示它

00:27:24.611 --> 00:27:27.214 align:middle line:-1
这些数据来自

00:27:27.281 --> 00:27:30.584 align:middle line:-1
大脚怪野外研究组织的数据库

00:27:30.717 --> 00:27:32.252 align:middle line:-1
所以我会显示ID

00:27:32.319 --> 00:27:34.922 align:middle line:-2
以便如果你有兴趣了解
更多有关该目击事件的细节

00:27:34.988 --> 00:27:39.560 align:middle line:-1
你可以查看该数据库并获取更多信息

00:27:39.927 --> 00:27:42.529 align:middle line:-2
最后 我已经准备好
创建一个标记注释

00:27:42.596 --> 00:27:45.532 align:middle line:-2
通过使用这个坐标
和我创建的这些选项

00:27:46.266 --> 00:27:49.102 align:middle line:-1
现在我知道了该如何

00:27:49.169 --> 00:27:50.404 align:middle line:-1
设置目击事件的标记注释

00:27:50.470 --> 00:27:54.875 align:middle line:-1
我现在要获取准备好的目击事件

00:27:56.310 --> 00:27:58.545 align:middle line:-1
在这个目击清单中

00:27:58.779 --> 00:28:01.181 align:middle line:-2
我会为其中每个目击事件
创建一个注释

00:27:58.779 --> 00:28:01.181 align:middle line:-2
我会为其中每个目击事件
创建一个注释

00:28:02.783 --> 00:28:07.387 align:middle line:-1
然后我会确保它们在地图上显示

00:28:07.754 --> 00:28:09.389 align:middle line:-1
我的注释将显示在地图上

00:28:09.456 --> 00:28:12.259 align:middle line:-2
我将使用showItems方法
这非常方便

00:28:12.326 --> 00:28:15.462 align:middle line:-1
因为它不仅确保项目可见

00:28:15.529 --> 00:28:17.331 align:middle line:-1
还会将它们添加到地图中

00:28:18.532 --> 00:28:20.133 align:middle line:-1
由于我正在做一个网页

00:28:20.200 --> 00:28:22.870 align:middle line:-2
因此我还可以在我的页面上
添加一些额外的信息

00:28:22.936 --> 00:28:25.339 align:middle line:-1
比如这个地区有多少次目击

00:28:26.507 --> 00:28:29.443 align:middle line:-1
让我保存它

00:28:30.577 --> 00:28:32.012 align:middle line:-1
并重新加载

00:28:33.313 --> 00:28:36.316 align:middle line:-2
我现在看到一张
有60个目击事件的地图

00:28:36.650 --> 00:28:38.485 align:middle line:-1
所有这些注释都是目击事件

00:28:38.552 --> 00:28:41.121 align:middle line:-1
我们遇到了我刚才强调的问题

00:28:41.188 --> 00:28:43.257 align:middle line:-1
这就是在这个公园地区

00:28:43.323 --> 00:28:47.027 align:middle line:-2
我可以看到很多目击事件发生
并且它们都相互重叠

00:28:47.160 --> 00:28:48.328 align:middle line:-1
即使我放大

00:28:48.395 --> 00:28:50.464 align:middle line:-1
这仍然很混乱

00:28:50.697 --> 00:28:52.466 align:middle line:-1
所以我会使用注释上的

00:28:52.533 --> 00:28:56.904 align:middle line:-1
显示优先级属性清理它

00:28:58.138 --> 00:29:00.407 align:middle line:-1
为了替显示优先级选择一个指标

00:28:58.138 --> 00:29:00.407 align:middle line:-1
为了替显示优先级选择一个指标

00:29:00.474 --> 00:29:05.479 align:middle line:-2
我将使用的是这些目击中的
一个非常重要的属性

00:29:05.679 --> 00:29:07.748 align:middle line:-1
即是否是清晰的目击

00:29:07.814 --> 00:29:09.783 align:middle line:-1
也就是是否有人真的看到了大脚怪

00:29:10.117 --> 00:29:13.854 align:middle line:-2
还是说他们只是听到或看到
它的一些痕迹

00:29:13.954 --> 00:29:15.455 align:middle line:-1
现在我有了这个明确的指标

00:29:15.522 --> 00:29:17.991 align:middle line:-1
我将用它来设置我的显示优先级

00:29:18.325 --> 00:29:19.793 align:middle line:-1
显示优先级是一个数字

00:29:19.860 --> 00:29:22.162 align:middle line:-1
并且这些优先级可能非常随意

00:29:22.229 --> 00:29:26.066 align:middle line:-2
因此我们提供预定义的值
比如Required

00:29:26.133 --> 00:29:29.136 align:middle line:-2
它表示你的注释必须
始终显示在地图上

00:29:29.236 --> 00:29:31.672 align:middle line:-2
除此以外也有
High和Low显示优先级

00:29:31.839 --> 00:29:35.142 align:middle line:-2
因此当目击清晰时
我会设置displayPriority为High

00:29:35.275 --> 00:29:37.978 align:middle line:-2
否则我会设置
displayPriority为Low

00:29:38.679 --> 00:29:40.948 align:middle line:-1
最后 我还会编码这些信息

00:29:41.014 --> 00:29:42.382 align:middle line:-1
作为我的注释的颜色

00:29:42.449 --> 00:29:44.518 align:middle line:-1
以便用户更好地理解

00:29:44.585 --> 00:29:47.421 align:middle line:-1
为什么有些注释会显示而有些不会

00:29:47.754 --> 00:29:50.691 align:middle line:-2
当它是棕色时
代表这是一个清晰的目击注释

00:29:50.757 --> 00:29:52.693 align:middle line:-2
当它是绿色时
则代表它不是那么清晰

00:29:53.260 --> 00:29:55.262 align:middle line:-1
我们来看看它的区别

00:29:56.797 --> 00:29:59.333 align:middle line:-1
现在你可以看到地图更简洁了

00:29:59.533 --> 00:30:02.503 align:middle line:-1
因为所有的冲突都已解决

00:29:59.533 --> 00:30:02.503 align:middle line:-1
因为所有的冲突都已解决

00:30:02.569 --> 00:30:05.172 align:middle line:-1
你可以看到一些注释是棕色的

00:30:05.239 --> 00:30:06.406 align:middle line:-1
这些都是清晰的目击

00:30:06.473 --> 00:30:07.474 align:middle line:-1
它们可能是那些

00:30:07.541 --> 00:30:10.944 align:middle line:-1
应该最先访问的最有趣的目击事件

00:30:12.513 --> 00:30:14.615 align:middle line:-2
但是你也可以看到
如果我放大地图

00:30:14.982 --> 00:30:17.518 align:middle line:-1
会有新的目击事件显示出来

00:30:17.684 --> 00:30:19.653 align:middle line:-1
因此你的用户可以浏览地图

00:30:19.720 --> 00:30:24.525 align:middle line:-1
并找出他们希望看到大脚怪的地方

00:30:25.425 --> 00:30:28.161 align:middle line:-1
我将通过为地图添加另一条信息

00:30:29.029 --> 00:30:31.131 align:middle line:-1
来结束本演示

00:30:31.298 --> 00:30:32.699 align:middle line:-1
我会改变字形

00:30:33.300 --> 00:30:34.368 align:middle line:-1
为…

00:30:35.302 --> 00:30:37.905 align:middle line:-1
我准备好的大脚怪的图标

00:30:37.971 --> 00:30:39.907 align:middle line:-1
这是一个简单的PNG图像

00:30:41.909 --> 00:30:43.810 align:middle line:-1
我将其用于清晰的目击

00:30:44.411 --> 00:30:47.047 align:middle line:-1
如果目击不太清晰

00:30:47.114 --> 00:30:51.652 align:middle line:-1
我将设置字形文本为一个问号

00:30:52.219 --> 00:30:53.520 align:middle line:-1
使其更加明确

00:30:55.122 --> 00:30:57.958 align:middle line:-1
现在我可以看到

00:30:58.592 --> 00:31:01.929 align:middle line:-1
这些值得怀疑的目击上有一个问号

00:30:58.592 --> 00:31:01.929 align:middle line:-1
这些值得怀疑的目击上有一个问号

00:31:02.262 --> 00:31:05.032 align:middle line:-1
而对大脚怪的清晰目击事件

00:31:05.165 --> 00:31:06.834 align:middle line:-1
将会有大脚怪的图标

00:31:09.002 --> 00:31:11.371 align:middle line:-1
这是我们的第一个演示

00:31:12.673 --> 00:31:13.640 align:middle line:-1
谢谢

00:31:14.875 --> 00:31:16.109 align:middle line:-1
（演示回顾）

00:31:16.176 --> 00:31:17.010 align:middle line:-1
所以…

00:31:17.511 --> 00:31:21.682 align:middle line:-2
在本演示中 我们展示了
如何从JavaScript对象

00:31:21.748 --> 00:31:22.983 align:middle line:-1
创建标记注释

00:31:23.483 --> 00:31:27.588 align:middle line:-2
如何设置注释的显示优先级
来整理我们的地图

00:31:28.222 --> 00:31:31.425 align:middle line:-2
以及如何使用彩色字形图像
和字形文字

00:31:31.491 --> 00:31:35.596 align:middle line:-1
来将我们的信息转换到地图上

00:31:36.129 --> 00:31:37.364 align:middle line:-1
（图片注释）

00:31:37.431 --> 00:31:40.467 align:middle line:-1
有时标记注释非常方便

00:31:40.534 --> 00:31:43.937 align:middle line:-2
但可能不是你想要在地图上
使用的内容

00:31:44.004 --> 00:31:46.507 align:middle line:-1
例如 如果你想使用公司的徽标

00:31:46.573 --> 00:31:48.675 align:middle line:-1
它有多种颜色

00:31:48.742 --> 00:31:52.980 align:middle line:-2
那么你不能使用字形图像
因为它仅限于一种颜色

00:31:53.480 --> 00:31:55.282 align:middle line:-1
有时候注释的形状

00:31:55.349 --> 00:31:57.551 align:middle line:-1
并非是你想要的

00:31:57.618 --> 00:31:58.452 align:middle line:-1
所以在这种情况下

00:31:58.519 --> 00:32:02.189 align:middle line:-1
你可以提供图像来表示你的注释

00:31:58.519 --> 00:32:02.189 align:middle line:-1
你可以提供图像来表示你的注释

00:32:02.256 --> 00:32:04.491 align:middle line:-2
在这个例子中
我使用这样的小贴纸图像

00:32:05.225 --> 00:32:08.195 align:middle line:-1
来标记我最近去过的地方

00:32:09.496 --> 00:32:12.199 align:middle line:-1
我可以使用这些光栅图像进行注释

00:32:12.266 --> 00:32:14.735 align:middle line:-1
标题和副标题将显示在标注泡泡中

00:32:14.801 --> 00:32:17.604 align:middle line:-1
就像服务器端渲染的标记注释一样

00:32:17.871 --> 00:32:19.606 align:middle line:-1
为了创建一个图像注释

00:32:19.673 --> 00:32:22.509 align:middle line:-1
这与创建标记注释非常相似

00:32:22.609 --> 00:32:25.045 align:middle line:-1
但必须提供附加属性

00:32:25.112 --> 00:32:27.114 align:middle line:-1
即图像的URL

00:32:27.281 --> 00:32:30.617 align:middle line:-2
在这里你可以看到
两个不同像素比的不同URL

00:32:31.518 --> 00:32:32.653 align:middle line:-1
（自定义注释）

00:32:32.719 --> 00:32:35.656 align:middle line:-1
表示注释的另一种方式

00:32:35.722 --> 00:32:37.891 align:middle line:-1
是使用经典的图钉

00:32:38.358 --> 00:32:41.595 align:middle line:-1
而且图钉通常有许多不同的颜色

00:32:41.662 --> 00:32:43.830 align:middle line:-1
问题是如果我想提供

00:32:43.897 --> 00:32:44.998 align:middle line:-1
很多不同的颜色

00:32:45.065 --> 00:32:47.367 align:middle line:-1
我需要提供很多不同的图像

00:32:47.601 --> 00:32:49.603 align:middle line:-1
这很快就会变得无法管理

00:32:49.670 --> 00:32:52.940 align:middle line:-1
因此我可以使用自定义注释

00:32:53.006 --> 00:32:54.408 align:middle line:-2
在这种情况下
我不使用图像

00:32:54.474 --> 00:32:58.278 align:middle line:-2
而是使用任何DOM元素
来表示我的注释

00:32:58.545 --> 00:33:00.147 align:middle line:-1
（元素是根据需求创建的）

00:32:58.545 --> 00:33:00.147 align:middle line:-1
（元素是根据需求创建的）

00:33:00.214 --> 00:33:03.717 align:middle line:-1
这些元素是根据你的注释需求创建的

00:33:03.851 --> 00:33:04.918 align:middle line:-1
我们来看一个例子

00:33:04.985 --> 00:33:06.386 align:middle line:-1
这里如果我想

00:33:07.754 --> 00:33:10.924 align:middle line:-1
在我的地图上显示任意颜色的图钉

00:33:11.692 --> 00:33:14.962 align:middle line:-2
我将用坐标和选项作为参数
创建一个注释

00:33:15.028 --> 00:33:17.030 align:middle line:-1
第三个参数是一个函数

00:33:17.097 --> 00:33:19.566 align:middle line:-1
它将返回该注释的DOM元素

00:33:19.867 --> 00:33:22.069 align:middle line:-2
在这个例子中
我将使用canvas元素

00:33:22.302 --> 00:33:24.705 align:middle line:-2
我创建一个canvas元素
获取它的上下文

00:33:24.771 --> 00:33:27.074 align:middle line:-2
我在该canvas元素上
绘制一个图钉

00:33:27.140 --> 00:33:30.043 align:middle line:-1
我将图钉头的颜色改成我想要的颜色

00:33:30.110 --> 00:33:31.211 align:middle line:-1
然后返回这个canvas

00:33:31.278 --> 00:33:33.747 align:middle line:-1
这就是地图上为此注释

00:33:33.814 --> 00:33:34.948 align:middle line:-1
显示的画布

00:33:37.651 --> 00:33:40.621 align:middle line:-1
这些是你可以使用的三种注释

00:33:40.687 --> 00:33:44.591 align:middle line:-2
但有时候你想要展示的
不仅仅是单个位置

00:33:44.658 --> 00:33:47.060 align:middle line:-1
或一组单个位置

00:33:47.127 --> 00:33:50.864 align:middle line:-1
有时你想要在地图上显示完整的区域

00:33:50.931 --> 00:33:52.065 align:middle line:-1
（叠层）

00:33:52.132 --> 00:33:53.467 align:middle line:-2
要做到这一点
我们可以使用叠层

00:33:53.534 --> 00:33:56.336 align:middle line:-1
我们提供三种不同的叠层

00:33:57.070 --> 00:33:59.640 align:middle line:-1
以下是一些如何使用它们的例子

00:34:00.440 --> 00:34:01.542 align:middle line:-1
使用圆形叠层

00:34:01.608 --> 00:34:05.212 align:middle line:-1
你可以显示从某个点开始的所有距离

00:34:05.279 --> 00:34:08.348 align:middle line:-2
使用折线叠层
我们可以显示两点之间的路线

00:34:08.715 --> 00:34:13.085 align:middle line:-1
你可以使用多边形叠层

00:34:13.353 --> 00:34:16.422 align:middle line:-1
来突出显示地理区域 例如州

00:34:16.489 --> 00:34:18.125 align:middle line:-1
国家或城市的边界等等

00:34:18.192 --> 00:34:19.393 align:middle line:-1
（圆形叠层）

00:34:19.458 --> 00:34:22.029 align:middle line:-1
这里是一个圆形叠层的例子

00:34:22.295 --> 00:34:23.996 align:middle line:-1
现在这是布鲁塞尔

00:34:24.264 --> 00:34:27.167 align:middle line:-2
并且我把我的地图的中心
放在Manneken Pis

00:34:27.768 --> 00:34:30.938 align:middle line:-1
它在城市的正中心

00:34:31.004 --> 00:34:33.273 align:middle line:-1
这是一个非常适合逛街的地方

00:34:33.473 --> 00:34:39.045 align:middle line:-2
通过使用围绕中心点的
递增半径同心圆

00:34:39.112 --> 00:34:41.215 align:middle line:-1
我可以看到步行距离

00:34:41.380 --> 00:34:44.585 align:middle line:-1
这里我使用坐标创建了叠层

00:34:44.650 --> 00:34:48.155 align:middle line:-1
你需要传给圆形叠层的第二个参数

00:34:48.222 --> 00:34:50.023 align:middle line:-1
是以米为单位的半径

00:34:50.090 --> 00:34:52.592 align:middle line:-1
所以在这里 每个叠层都有一个半径

00:34:52.659 --> 00:34:55.295 align:middle line:-1
从400米开始每次增加400米

00:34:55.362 --> 00:34:57.063 align:middle line:-1
即400 800等

00:34:57.631 --> 00:35:00.067 align:middle line:-1
我们可以看到右边有一个

00:34:57.631 --> 00:35:00.067 align:middle line:-1
我们可以看到右边有一个

00:35:00.133 --> 00:35:03.203 align:middle line:-1
漫画艺术博物馆

00:35:03.270 --> 00:35:04.238 align:middle line:-1
这听起来很有趣

00:35:04.304 --> 00:35:08.909 align:middle line:-2
它看起来可能在
1200到1600米之间

00:35:08.976 --> 00:35:10.711 align:middle line:-1
即大约10到15分钟的步行路程

00:35:11.979 --> 00:35:13.947 align:middle line:-1
我可以用叠层做的一件重要的事

00:35:14.014 --> 00:35:15.449 align:middle line:-1
是我也可以设计它们的样式

00:35:16.116 --> 00:35:19.553 align:middle line:-2
所以在这里
为了表示这种样式的叠层

00:35:19.620 --> 00:35:21.788 align:middle line:-2
我可以使用
mapkit.Style对象

00:35:22.389 --> 00:35:24.458 align:middle line:-1
它有几个属性

00:35:24.525 --> 00:35:27.327 align:middle line:-1
如线宽 线条和笔触颜色

00:35:27.394 --> 00:35:29.663 align:middle line:-1
它也可以是任何CSS颜色

00:35:29.930 --> 00:35:34.935 align:middle line:-1
默认情况下圆形叠层用蓝色填充

00:35:35.169 --> 00:35:37.104 align:middle line:-2
但在这个例子中
我希望它们是透明的

00:35:37.171 --> 00:35:39.673 align:middle line:-2
所以我将fillColor
设置为null

00:35:41.542 --> 00:35:45.345 align:middle line:-1
我决定我想去参观这个漫画博物馆

00:35:45.612 --> 00:35:47.314 align:middle line:-1
正如我们将要展示的那样

00:35:47.381 --> 00:35:51.518 align:middle line:-2
MapKit JS可以为你提供
显示两点之间行走

00:35:51.585 --> 00:35:52.619 align:middle line:-1
和驾车路线的服务

00:35:52.786 --> 00:35:54.788 align:middle line:-1
在这个例子中 我向它查询了

00:35:54.988 --> 00:35:58.058 align:middle line:-2
从我所在之处Manneken Pis
到我想去的地方的路线

00:35:58.926 --> 00:36:00.494 align:middle line:-1
我得到的结果是

00:35:58.926 --> 00:36:00.494 align:middle line:-1
我得到的结果是

00:36:00.561 --> 00:36:03.597 align:middle line:-1
此地图上使用折线叠层表示的路线

00:36:03.664 --> 00:36:05.866 align:middle line:-1
折线叠层是一个点列表

00:36:05.933 --> 00:36:09.269 align:middle line:-1
它们都是相互关联的坐标

00:36:09.336 --> 00:36:13.106 align:middle line:-2
我还可以调整它们的样式
比如通过设置笔触不透明度

00:36:13.173 --> 00:36:16.510 align:middle line:-2
或粗线宽
以确保它显示在我的地图上

00:36:18.478 --> 00:36:20.547 align:middle line:-1
最后一个例子是多边形叠层

00:36:20.614 --> 00:36:23.350 align:middle line:-1
这对数据可视化之类的用例非常有用

00:36:23.417 --> 00:36:25.252 align:middle line:-1
这里我有一张美国地图

00:36:25.319 --> 00:36:28.322 align:middle line:-1
其中每个州都是它自己的叠层

00:36:28.522 --> 00:36:31.925 align:middle line:-1
多边形叠层也由一系列点定义

00:36:31.992 --> 00:36:33.427 align:middle line:-1
在这个例子中

00:36:34.962 --> 00:36:36.563 align:middle line:-1
叠层形状是封闭且被填充的

00:36:36.630 --> 00:36:37.931 align:middle line:-1
（多边形叠层）

00:36:37.998 --> 00:36:40.701 align:middle line:-1
你甚至可以指定点列表

00:36:40.767 --> 00:36:42.503 align:middle line:-1
来实现更复杂的方案

00:36:42.569 --> 00:36:44.805 align:middle line:-1
比如说 如果你有飞地和外飞地

00:36:44.872 --> 00:36:48.008 align:middle line:-1
这通常是真实地理区域的情况

00:36:49.376 --> 00:36:50.477 align:middle line:-1
注释和叠层

00:36:50.544 --> 00:36:54.314 align:middle line:-1
也可以添加一些额外的信息

00:36:54.381 --> 00:36:56.183 align:middle line:-1
即这个data属性

00:36:56.450 --> 00:36:58.285 align:middle line:-1
因此在这个例子中 我想展示

00:36:58.819 --> 00:37:01.588 align:middle line:-1
美国每个州的人口

00:36:58.819 --> 00:37:01.588 align:middle line:-1
美国每个州的人口

00:37:01.655 --> 00:37:03.290 align:middle line:-1
我可以将其显示为一种颜色

00:37:03.991 --> 00:37:06.560 align:middle line:-1
这让我对人口有一个大概的了解

00:37:06.627 --> 00:37:09.129 align:middle line:-1
但我也可以添加一些额外的数据

00:37:09.196 --> 00:37:12.799 align:middle line:-1
这样如果用户选中其中一个叠层

00:37:12.866 --> 00:37:14.735 align:middle line:-1
在这个例子中是德克萨斯州

00:37:14.902 --> 00:37:19.006 align:middle line:-2
我可以显示
其实际人口超过两千万人

00:37:20.140 --> 00:37:22.709 align:middle line:-1
叠层可以被选中 就像注释一样

00:37:23.110 --> 00:37:24.511 align:middle line:-1
（GEOJSON导入）

00:37:25.879 --> 00:37:29.082 align:middle line:-2
为了显示叠层
例如我向你展示的路线

00:37:29.149 --> 00:37:31.418 align:middle line:-1
或所有的州

00:37:31.485 --> 00:37:33.620 align:middle line:-2
我们需要大量的数据
我们需要很多点

00:37:33.687 --> 00:37:37.024 align:middle line:-2
对于州来说
我们有成千上万的点

00:37:37.791 --> 00:37:40.794 align:middle line:-2
所以将这些数据存入你的程序的
一种简单方法

00:37:40.861 --> 00:37:42.296 align:middle line:-1
是使用GeoJSON导入

00:37:42.362 --> 00:37:43.964 align:middle line:-1
若你有一个GeoJSON数据文件

00:37:44.364 --> 00:37:47.067 align:middle line:-2
你就可以使用
MapKit JS自动导入它

00:37:47.634 --> 00:37:49.436 align:middle line:-1
注解和叠层会被创建

00:37:49.503 --> 00:37:52.472 align:middle line:-2
在这个例子中
这是一个不同的数据文件

00:37:52.573 --> 00:37:55.943 align:middle line:-1
其中有很多UFO目击事件

00:37:56.543 --> 00:37:58.445 align:middle line:-1
这只是地图的一部分细节

00:37:58.512 --> 00:38:01.315 align:middle line:-1
你可以看到有很多目击事件

00:37:58.512 --> 00:38:01.315 align:middle line:-1
你可以看到有很多目击事件

00:38:02.349 --> 00:38:05.752 align:middle line:-1
所有这些注释和叠层都是自动创建的

00:38:05.819 --> 00:38:09.523 align:middle line:-2
它们当然也可以使用
一些委托方法进行定制

00:38:09.990 --> 00:38:11.525 align:middle line:-1
（响应用户交互）

00:38:11.592 --> 00:38:15.729 align:middle line:-1
最后 这些注释和叠层

00:38:15.796 --> 00:38:17.531 align:middle line:-1
可以被用户选中

00:38:17.698 --> 00:38:21.468 align:middle line:-2
你想监听它们上的事件
以及地图上的事件

00:38:21.802 --> 00:38:24.204 align:middle line:-1
你可以监听选中和取消选中事件

00:38:24.271 --> 00:38:27.441 align:middle line:-2
我们之前也看到过
注释可以被拖动

00:38:27.608 --> 00:38:29.276 align:middle line:-1
所以你也可以监听拖动事件

00:38:29.343 --> 00:38:32.513 align:middle line:-2
这也使用了
addEventListener方法

00:38:32.579 --> 00:38:35.549 align:middle line:-2
例如 你可以使用
addEventListener

00:38:36.049 --> 00:38:38.018 align:middle line:-1
来监听地图中的选中事件

00:38:38.085 --> 00:38:42.155 align:middle line:-1
它会告诉你注释或叠层何时被选中了

00:38:42.222 --> 00:38:44.525 align:middle line:-1
我们将在演示中看到一个例子

00:38:46.059 --> 00:38:47.361 align:middle line:-1
下一节是

00:38:47.494 --> 00:38:49.630 align:middle line:0
启用与服务的富交互

00:38:49.696 --> 00:38:52.599 align:middle line:0
对于本节
我将把麦克风交给Melody

00:39:05.612 --> 00:39:08.882 align:middle line:-2
MapKit JS
为你提供三种服务

00:39:09.149 --> 00:39:11.752 align:middle line:-1
地理编码 搜索和路线

00:39:12.619 --> 00:39:14.755 align:middle line:-1
我将逐步介绍每一个例子

00:39:14.821 --> 00:39:17.257 align:middle line:-2
但在此之前
我会告诉你他们有什么共同之处

00:39:18.759 --> 00:39:20.627 align:middle line:-1
你可以以类似的方式使用这些服务

00:39:20.861 --> 00:39:22.029 align:middle line:-1
它包括四个简单的步骤

00:39:22.462 --> 00:39:24.498 align:middle line:-1
首先创建服务对象

00:39:25.065 --> 00:39:27.901 align:middle line:-1
然后指定请求参数和选项

00:39:28.368 --> 00:39:29.670 align:middle line:-1
然后你发出请求

00:39:30.137 --> 00:39:32.372 align:middle line:-1
最后通过回调函数

00:39:32.439 --> 00:39:33.807 align:middle line:-1
处理异步响应

00:39:34.608 --> 00:39:36.577 align:middle line:-1
首先我们来谈谈地理编码器

00:39:36.977 --> 00:39:38.478 align:middle line:-1
（地理编码）

00:39:38.545 --> 00:39:40.480 align:middle line:-2
下面是一个如何使用
地理编码器的例子

00:39:40.547 --> 00:39:42.316 align:middle line:-1
它包含两个方法

00:39:42.716 --> 00:39:44.251 align:middle line:-2
lookup和
reverseLookup

00:39:44.585 --> 00:39:47.120 align:middle line:-1
如果你有一个地址或位置

00:39:47.187 --> 00:39:48.889 align:middle line:-1
而你想找到坐标

00:39:48.956 --> 00:39:49.990 align:middle line:-1
或者反过来

00:39:50.057 --> 00:39:52.459 align:middle line:-2
你有一个坐标
并且你想要找到该地址

00:39:53.994 --> 00:39:56.263 align:middle line:-1
第一步是创建你的对象

00:39:57.664 --> 00:40:01.301 align:middle line:-2
你可以向其提供一个可选的
getsUserLocation参数

00:39:57.664 --> 00:40:01.301 align:middle line:-2
你可以向其提供一个可选的
getsUserLocation参数

00:40:01.668 --> 00:40:05.072 align:middle line:-2
这将允许你为地理编码器
提供更多上下文

00:40:05.339 --> 00:40:07.708 align:middle line:-1
这在存在同名地方

00:40:07.774 --> 00:40:10.110 align:middle line:-1
但处于不同位置的情况下很有用

00:40:10.677 --> 00:40:13.313 align:middle line:-1
例如 如果你在此处使用地理编码器

00:40:13.380 --> 00:40:16.450 align:middle line:-2
你最有可能得到
加利福尼亚布里斯班

00:40:16.517 --> 00:40:18.285 align:middle line:-1
而非澳大利亚布里斯班

00:40:20.020 --> 00:40:21.588 align:middle line:-1
接下来你需要构建请求

00:40:21.722 --> 00:40:23.724 align:middle line:-1
我们在这里使用这个会议中心

00:40:25.192 --> 00:40:26.927 align:middle line:-1
接下来你需要处理响应

00:40:27.528 --> 00:40:28.762 align:middle line:-1
正如我们之前提到的

00:40:28.829 --> 00:40:32.533 align:middle line:-2
地理编码器可以轻松用于
放置标记注释

00:40:32.633 --> 00:40:35.202 align:middle line:-2
所以我们这里在地图上
添加一个标记注释

00:40:37.838 --> 00:40:40.707 align:middle line:-1
我们在这里有一个反向查找的例子

00:40:40.774 --> 00:40:41.875 align:middle line:-1
其中我们有一个坐标

00:40:41.942 --> 00:40:44.011 align:middle line:-1
我们想找到这个地方的地址

00:40:46.046 --> 00:40:47.447 align:middle line:-1
这就是地理编码器

00:40:47.781 --> 00:40:50.918 align:middle line:-1
接下来是服务上下文

00:40:51.185 --> 00:40:52.186 align:middle line:-1
正如我之前提到的

00:40:52.252 --> 00:40:55.022 align:middle line:-2
你可以提供一个
getsUserLocation参数

00:40:55.088 --> 00:40:58.292 align:middle line:-1
你也可以提供搜索的坐标和区域

00:40:58.792 --> 00:41:02.262 align:middle line:-2
这对为你的用户提供
最相关的结果很有用

00:40:58.792 --> 00:41:02.262 align:middle line:-2
这对为你的用户提供
最相关的结果很有用

00:41:03.096 --> 00:41:06.934 align:middle line:-1
这就是存在同名

00:41:07.000 --> 00:41:07.968 align:middle line:-1
但不同地方的情况

00:41:08.035 --> 00:41:10.771 align:middle line:-2
或者你可以将最近的
搜索结果提供给用户

00:41:10.838 --> 00:41:11.972 align:middle line:-1
（服务上下文）

00:41:12.039 --> 00:41:13.140 align:middle line:-1
（搜索）

00:41:13.207 --> 00:41:15.976 align:middle line:-1
以下是如何使用搜索服务的示例

00:41:16.577 --> 00:41:19.513 align:middle line:-2
这是一个在用户附近
找到咖啡馆的例子

00:41:20.814 --> 00:41:23.150 align:middle line:-1
首先你创建你的服务对象

00:41:25.018 --> 00:41:28.922 align:middle line:-2
然后使用“coffee”
这样的查询来构建请求

00:41:28.989 --> 00:41:30.657 align:middle line:-1
你也可以做一些更具体的事情

00:41:30.724 --> 00:41:33.627 align:middle line:-1
比如提供咖啡店的具体名称

00:41:35.996 --> 00:41:37.631 align:middle line:-1
然后你可以处理结果

00:41:38.899 --> 00:41:41.401 align:middle line:-1
这可以使用注释轻松显示

00:41:41.468 --> 00:41:44.371 align:middle line:-1
因为有时它返回多个结果

00:41:44.571 --> 00:41:46.807 align:middle line:-1
你也可以使用坐标以及标题

00:41:46.874 --> 00:41:49.142 align:middle line:-1
来填充注释的字段

00:41:51.044 --> 00:41:53.514 align:middle line:-2
最后我们使用
map.showItems方法

00:41:53.580 --> 00:41:56.183 align:middle line:-1
同时添加并显示该注释

00:41:58.519 --> 00:42:00.354 align:middle line:-1
如果请求中包含

00:41:58.519 --> 00:42:00.354 align:middle line:-1
如果请求中包含

00:42:00.420 --> 00:42:02.656 align:middle line:-2
你想要发送的完整查询
这就很有用

00:42:02.723 --> 00:42:05.926 align:middle line:-2
但是如果你想要一个
能响应用户输入的搜索栏

00:42:06.159 --> 00:42:08.395 align:middle line:-2
你就可以使用
Search.autocomplete方法

00:42:08.462 --> 00:42:09.563 align:middle line:-1
（搜索自动补全）

00:42:09.630 --> 00:42:10.697 align:middle line:-1
通过使用搜索自动补全功能

00:42:10.764 --> 00:42:14.668 align:middle line:-1
你可以向服务提供部分查询字段

00:42:14.735 --> 00:42:17.004 align:middle line:-1
并提供建议来让你的用户

00:42:17.070 --> 00:42:18.472 align:middle line:-1
少输入一些字符

00:42:18.539 --> 00:42:20.841 align:middle line:-2
你随后可以使用
用户选择的建议来完成搜索

00:42:22.442 --> 00:42:23.377 align:middle line:-1
（路线）

00:42:23.443 --> 00:42:25.245 align:middle line:-1
最后一项服务是查找路线

00:42:27.314 --> 00:42:31.084 align:middle line:-2
与其他服务类似
你可以创建你的路线对象

00:42:32.019 --> 00:42:35.689 align:middle line:-2
你可以选择提供一种语言
随后将以该语言

00:42:35.956 --> 00:42:37.457 align:middle line:-1
返回路线步骤

00:42:38.992 --> 00:42:40.460 align:middle line:-1
如果你不提供语言

00:42:40.694 --> 00:42:43.263 align:middle line:-2
提供给MapKit
初始化函数的语言

00:42:43.330 --> 00:42:44.264 align:middle line:-1
将被使用

00:42:44.364 --> 00:42:47.167 align:middle line:-2
如果那也没有提供
则浏览器的首选语言

00:42:47.234 --> 00:42:48.168 align:middle line:-1
将被使用

00:42:50.037 --> 00:42:52.873 align:middle line:-1
然后使用两个必填字段构建你的请求

00:42:52.940 --> 00:42:54.641 align:middle line:-2
即origin
和destination

00:42:54.975 --> 00:42:58.178 align:middle line:-1
它们可以是坐标 地址或地点

00:43:00.147 --> 00:43:03.050 align:middle line:-1
默认情况下 交通工具类型是汽车

00:43:03.150 --> 00:43:05.385 align:middle line:-2
你可使用Transport枚举
将其切换为

00:43:05.452 --> 00:43:06.987 align:middle line:-1
步行路线

00:43:07.287 --> 00:43:09.890 align:middle line:-2
我们不会这样做
因为这是一个很远的路程

00:43:10.157 --> 00:43:12.292 align:middle line:-2
但我们会使用
requestAlternateRoutes

00:43:12.659 --> 00:43:15.562 align:middle line:-2
你可以使用它为用户
提供多个可选路线

00:43:15.696 --> 00:43:18.465 align:middle line:-1
这样我们可以显示不同的路线

00:43:18.532 --> 00:43:20.834 align:middle line:-1
而不是默认的最佳路线

00:43:22.870 --> 00:43:26.306 align:middle line:-1
最后 你可以在地图上显示你的结果

00:43:26.406 --> 00:43:29.443 align:middle line:-2
这里我们使用了折线叠层
就像你之前看到的那样

00:43:29.543 --> 00:43:32.880 align:middle line:-1
你还会得到一组路线步骤以及距离

00:43:32.946 --> 00:43:33.981 align:middle line:-1
和旅行时间

00:43:34.047 --> 00:43:35.315 align:middle line:-1
以上这些就是服务

00:43:35.382 --> 00:43:36.717 align:middle line:-1
现在你对它们更熟悉了

00:43:36.783 --> 00:43:38.552 align:middle line:-1
Julien将回到台上演示

00:43:45.492 --> 00:43:46.593 align:middle line:-1
谢谢 Melody

00:43:46.760 --> 00:43:48.996 align:middle line:-1
我们将从刚才的地方继续

00:43:49.429 --> 00:43:52.599 align:middle line:-2
我们将继续构建
Bigfoot Finder

00:43:53.867 --> 00:43:55.969 align:middle line:-1
这个网页

00:43:57.137 --> 00:43:58.272 align:middle line:-1
还缺少一样东西

00:43:58.438 --> 00:44:01.608 align:middle line:-1
尽管它可以告诉我们当前在哪里

00:43:58.438 --> 00:44:01.608 align:middle line:-1
尽管它可以告诉我们当前在哪里

00:44:02.209 --> 00:44:04.578 align:middle line:-1
也可以告诉我们大脚怪的位置

00:44:04.645 --> 00:44:06.613 align:middle line:-1
但它还没有告诉我们如何到达那里

00:44:07.514 --> 00:44:09.716 align:middle line:-1
所以我想补充一些路线

00:44:10.250 --> 00:44:14.188 align:middle line:-2
从我们当前的位置
即McEnery会议中心

00:44:14.621 --> 00:44:17.291 align:middle line:-1
到这些大脚怪的位置

00:44:17.591 --> 00:44:21.161 align:middle line:-2
我将用MapKit JS路线服务
来做到这一点

00:44:21.562 --> 00:44:23.564 align:middle line:-1
我将使用折线叠层来绘制这些路线

00:44:24.431 --> 00:44:28.702 align:middle line:-2
但我需要做的第一件事
是我需要确保用户…

00:44:29.203 --> 00:44:31.772 align:middle line:-2
我需要找到一种方式
以便用户可以告诉我

00:44:31.839 --> 00:44:34.074 align:middle line:-1
他们希望看到哪一个目击点

00:44:34.241 --> 00:44:35.142 align:middle line:-1
所以…

00:44:35.843 --> 00:44:37.277 align:middle line:-1
这一个被选中了

00:44:37.344 --> 00:44:40.113 align:middle line:-1
这可能是用户想要看的 对吧

00:44:40.414 --> 00:44:42.282 align:middle line:-1
接下来就是我们要做的事

00:44:42.482 --> 00:44:46.119 align:middle line:-1
我们将使用地图的选中事件监听器

00:44:46.286 --> 00:44:49.489 align:middle line:-1
来监听用户对注释的选择

00:44:49.690 --> 00:44:52.893 align:middle line:-2
当某个注释被选中时
这意味着用户可能想知道

00:44:52.960 --> 00:44:56.396 align:middle line:-1
如何去到那个特定的位置

00:44:56.530 --> 00:44:59.766 align:middle line:-1
所以我们会请求路线并绘制它

00:45:00.100 --> 00:45:01.635 align:middle line:-1
以便用户看到如何到达那里

00:45:01.702 --> 00:45:04.104 align:middle line:-1
最后 我们还可以让他们选择

00:45:04.171 --> 00:45:06.406 align:middle line:-1
路线服务返回的

00:45:06.473 --> 00:45:09.276 align:middle line:-1
可选路线中的一条

00:45:09.743 --> 00:45:12.779 align:middle line:-1
并显示有关这些路线的更多信息

00:45:13.380 --> 00:45:15.782 align:middle line:0
我们先来设置我们的事件监听器

00:45:17.751 --> 00:45:20.287 align:middle line:-1
我们在地图上监听选中事件

00:45:20.687 --> 00:45:24.458 align:middle line:-1
它告诉我们注释或叠层何时被选中了

00:45:24.825 --> 00:45:28.128 align:middle line:-1
这是我收到的事件对象的属性

00:45:28.195 --> 00:45:30.130 align:middle line:-2
如果annotation属性中
有值

00:45:30.197 --> 00:45:32.566 align:middle line:-1
那么这意味着这个注释刚刚被选中了

00:45:32.633 --> 00:45:37.538 align:middle line:-2
因此在MapKit中
一次只能有一个注释或叠层被选中

00:45:37.604 --> 00:45:39.139 align:middle line:-1
所以这里就不会有歧义

00:45:39.206 --> 00:45:41.008 align:middle line:-1
这是我们想要去的那个

00:45:41.241 --> 00:45:43.977 align:middle line:-1
我将显示到该注释的路线

00:45:46.747 --> 00:45:49.316 align:middle line:-2
显示我们的路线意味着
在地图上绘制它

00:45:49.550 --> 00:45:54.388 align:middle line:0
让我们设置一个折线叠层
来在地图上绘制路线

00:45:54.988 --> 00:45:59.226 align:middle line:-2
首先我将定义一种
用于所有路线的样式

00:45:59.393 --> 00:46:03.197 align:middle line:-2
设置不透明度和线宽
以确保路线更加显眼

00:45:59.393 --> 00:46:03.197 align:middle line:-2
设置不透明度和线宽
以确保路线更加显眼

00:46:03.397 --> 00:46:06.500 align:middle line:-1
默认的颜色是蓝色 这挺好的

00:46:06.567 --> 00:46:08.035 align:middle line:-1
我们就用它

00:46:08.535 --> 00:46:10.571 align:middle line:-1
就像我们之前写的函数

00:46:10.637 --> 00:46:14.007 align:middle line:-1
来为引用对象按需创建注释一样

00:46:14.074 --> 00:46:16.610 align:middle line:-1
这里我们将为路线按需创建叠层

00:46:17.177 --> 00:46:22.216 align:middle line:-2
MapKit JS路线服务
所返回的路线

00:46:22.482 --> 00:46:25.919 align:middle line:-1
包含许多信息 其中包括一条路径

00:46:26.086 --> 00:46:30.591 align:middle line:-1
这是你可以从A到B的步骤列表

00:46:30.958 --> 00:46:34.561 align:middle line:-1
每个步骤列表本身都包含一个点列表

00:46:35.529 --> 00:46:38.098 align:middle line:-1
如果你记得为了创建折线叠层

00:46:38.165 --> 00:46:39.433 align:middle line:-1
我需要一个点列表

00:46:39.499 --> 00:46:41.301 align:middle line:-1
所以既然我有一个点列表的列表

00:46:41.368 --> 00:46:43.403 align:middle line:-1
我会将它缩减为一个列表

00:46:43.704 --> 00:46:47.341 align:middle line:0
以便我将所有路径步骤
一个接一个地放入

00:46:48.075 --> 00:46:51.778 align:middle line:-2
这是我想用来创建
我的折线叠层的点列表

00:46:51.845 --> 00:46:54.214 align:middle line:-1
这是我刚刚定义的

00:46:54.548 --> 00:46:57.117 align:middle line:-1
我希望我的叠层显示的样式

00:46:57.584 --> 00:47:02.155 align:middle line:-2
然后我会让用户能够选择这个叠层
来查看更多信息

00:46:57.584 --> 00:47:02.155 align:middle line:-2
然后我会让用户能够选择这个叠层
来查看更多信息

00:47:02.222 --> 00:47:06.593 align:middle line:-2
我会将所有路线对象
保存在data属性中

00:47:06.660 --> 00:47:10.330 align:middle line:-2
这样我就可以显示
预计行程时间和距离

00:47:11.865 --> 00:47:14.201 align:middle line:-1
我知道如何绘制这些叠层

00:47:14.268 --> 00:47:17.371 align:middle line:-1
现在我需要从服务中请求它们

00:47:17.971 --> 00:47:19.673 align:middle line:-1
所以我们开始吧

00:47:21.475 --> 00:47:23.911 align:middle line:-1
这有点长 但不是很糟糕

00:47:24.111 --> 00:47:26.547 align:middle line:-1
我首先需要创建一个路线对象

00:47:26.747 --> 00:47:30.284 align:middle line:-1
我将为路线使用当前语言

00:47:30.350 --> 00:47:31.818 align:middle line:-1
所以使用默认就可以了

00:47:33.220 --> 00:47:36.690 align:middle line:-2
现在当我请求一条
到特定注释的路线时

00:47:36.757 --> 00:47:39.393 align:middle line:-2
或更确切地说
一组到特定注释的路线

00:47:39.893 --> 00:47:41.428 align:middle line:-1
我会先清理我的地图

00:47:41.495 --> 00:47:44.765 align:middle line:-2
因为也许我之前已经展示过
去其它地方的路线

00:47:45.499 --> 00:47:48.635 align:middle line:-1
如果我查询地图的其他列表属性

00:47:48.702 --> 00:47:52.272 align:middle line:-2
它会告诉我哪些叠层
目前已添加到地图中

00:47:52.339 --> 00:47:55.175 align:middle line:-2
我就可以使用removeOverlays方法
删除它们

00:47:55.242 --> 00:47:59.413 align:middle line:-2
现在我有了一个干净的地图
我可以显示新的路线了

00:47:59.880 --> 00:48:02.049 align:middle line:-1
我正在构建请求

00:47:59.880 --> 00:48:02.049 align:middle line:-1
我正在构建请求

00:48:02.115 --> 00:48:05.452 align:middle line:0
对于origin 我将这个位置硬编码进去
即“McEnery Convention Center”

00:48:05.853 --> 00:48:10.591 align:middle line:-1
我也可以设置坐标

00:48:10.657 --> 00:48:12.359 align:middle line:-1
但这样更方便

00:48:12.693 --> 00:48:15.529 align:middle line:0
对于destination
我将使用坐标 因为我有这些数据

00:48:15.596 --> 00:48:18.966 align:middle line:0
它们是作为参数给出的注释的坐标

00:48:20.000 --> 00:48:27.007 align:middle line:0
我想展示几条可能的路线

00:48:27.140 --> 00:48:30.644 align:middle line:-2
所以我要确保requestAlternateRoutes属性
被设置为true

00:48:32.446 --> 00:48:34.381 align:middle line:-1
现在我的请求已经构建完毕

00:48:35.148 --> 00:48:36.183 align:middle line:-1
我可在directions服务上

00:48:36.250 --> 00:48:39.419 align:middle line:-1
调用route方法执行它

00:48:42.723 --> 00:48:45.325 align:middle line:-1
当你做这样的查询时可能会出错

00:48:45.392 --> 00:48:48.262 align:middle line:-1
所以我们必须确保当错误发生时

00:48:48.328 --> 00:48:49.363 align:middle line:-1
我们可以处理错误

00:48:49.463 --> 00:48:51.665 align:middle line:-1
在这个例子中 我会回退到

00:48:51.732 --> 00:48:55.502 align:middle line:-2
显示我创建的默认路线
它只是一条直线

00:48:55.569 --> 00:48:58.172 align:middle line:-2
所以如果我们看到一条直线
我们就知道发生了错误

00:49:00.007 --> 00:49:01.208 align:middle line:-1
但让我们关注…

00:49:01.275 --> 00:49:05.412 align:middle line:-2
让我们乐观一点
并关注请求成功的情况

00:49:05.479 --> 00:49:08.282 align:middle line:-2
在这种情况下
我将得到一个路线列表

00:49:08.348 --> 00:49:12.119 align:middle line:-2
我将为它们中的每一个
创建一个新的折线叠层

00:49:13.053 --> 00:49:16.323 align:middle line:-2
我将在地图上使用
可靠的showItems方法

00:49:16.523 --> 00:49:19.059 align:middle line:-2
来添加这些路线
并确保通过设置

00:49:19.126 --> 00:49:21.395 align:middle line:-1
能够包含这些路线的区域来显示它们

00:49:21.895 --> 00:49:26.466 align:middle line:-1
让我介绍一下该方法的更多选项

00:49:26.600 --> 00:49:28.001 align:middle line:-1
第一个是animate

00:49:28.101 --> 00:49:31.238 align:middle line:-1
因为我想确保有一个流畅的动画

00:49:31.305 --> 00:49:37.277 align:middle line:-2
以从地图的当前区域过渡到
显示路线的区域

00:49:38.545 --> 00:49:42.115 align:middle line:0
最后 我还将添加一些填充
以便我可以保留一些上下文

00:49:42.182 --> 00:49:45.652 align:middle line:0
而不是只将地图限制在路线周围

00:49:46.987 --> 00:49:48.055 align:middle line:-1
我现在已经准备好了

00:49:49.723 --> 00:49:54.995 align:middle line:-2
从本会议中心请求路线
到其中一个注释

00:49:55.062 --> 00:49:56.763 align:middle line:-1
让我们再次选中这个

00:49:57.831 --> 00:50:00.334 align:middle line:-1
现在我的注释已被选中

00:49:57.831 --> 00:50:00.334 align:middle line:-1
现在我的注释已被选中

00:50:00.501 --> 00:50:02.169 align:middle line:-1
请求也已经执行

00:50:03.237 --> 00:50:05.272 align:middle line:-1
我看到有三个不同的结果

00:50:05.339 --> 00:50:08.909 align:middle line:-2
这些路线的一部分是一样的
但随后分道扬镳

00:50:09.843 --> 00:50:13.413 align:middle line:-2
它们从我们现在的位置开始
即会议中心

00:50:13.614 --> 00:50:14.781 align:middle line:-1
所以我认为这是对的

00:50:14.882 --> 00:50:16.517 align:middle line:-1
是的 这看起来没错

00:50:17.551 --> 00:50:19.653 align:middle line:-1
我有三个结果

00:50:19.953 --> 00:50:22.422 align:middle line:-1
现在我可能有兴趣了解更多

00:50:22.489 --> 00:50:25.759 align:middle line:-1
关于行程时间和距离的差异

00:50:25.959 --> 00:50:27.227 align:middle line:-1
我可以通过选中来做到

00:50:27.294 --> 00:50:29.696 align:middle line:-2
但如果我选中一条路线
其结果是

00:50:29.763 --> 00:50:33.133 align:middle line:-1
我的注释已被取消选择

00:50:33.200 --> 00:50:35.502 align:middle line:-1
因为一次只能有一个选中对象

00:50:35.602 --> 00:50:37.671 align:middle line:-1
这里的问题是

00:50:39.106 --> 00:50:41.742 align:middle line:-1
选中的叠层没有默认行为

00:50:42.176 --> 00:50:43.777 align:middle line:-1
所以我们来实现自己的

00:50:43.844 --> 00:50:46.046 align:middle line:-1
我们要做的是突出显示这些叠层

00:50:46.113 --> 00:50:48.982 align:middle line:-1
然后在侧栏中显示它们的信息

00:50:49.650 --> 00:50:52.052 align:middle line:-1
为了突出这些叠层

00:50:52.586 --> 00:50:54.221 align:middle line:-1
我将创建一个新的样式

00:50:55.422 --> 00:50:56.757 align:middle line:-1
用于突出显示叠层

00:50:56.823 --> 00:51:00.194 align:middle line:-1
让我们把它放在我的旧样式旁边

00:50:56.823 --> 00:51:00.194 align:middle line:-1
让我们把它放在我的旧样式旁边

00:51:00.594 --> 00:51:02.563 align:middle line:-1
此样式将保持相同的不透明度

00:51:02.629 --> 00:51:05.699 align:middle line:-1
我们让线变粗 并且设置为紫色

00:51:05.766 --> 00:51:08.068 align:middle line:-1
以使其更加明显

00:51:10.070 --> 00:51:13.774 align:middle line:-2
但是现在我们需要在叠层被选中后
为其应用此样式

00:51:14.241 --> 00:51:19.279 align:middle line:-2
幸运的是我已经有了一个
选中事件处理程序

00:51:20.881 --> 00:51:22.015 align:middle line:-1
到目前为止

00:51:22.082 --> 00:51:26.353 align:middle line:-1
我们只对监听选中的注释感兴趣

00:51:26.520 --> 00:51:31.291 align:middle line:-2
但现在我们只需添加一个新的…
我们将其追加到这个函数中

00:51:33.694 --> 00:51:34.528 align:middle line:-1
哎呀

00:51:35.162 --> 00:51:36.029 align:middle line:-1
逗号…

00:51:36.563 --> 00:51:38.465 align:middle line:-1
现在如果注释被选中

00:51:38.532 --> 00:51:40.367 align:middle line:-1
其处理仍然与以前一样

00:51:40.434 --> 00:51:43.537 align:middle line:-2
但如果是叠层被选中
我就会将其样式设置为

00:51:43.637 --> 00:51:46.406 align:middle line:-2
我刚刚定义的
SELECTED_ROUTE_STYLE

00:51:46.473 --> 00:51:48.809 align:middle line:-1
以便其突出显示

00:51:49.877 --> 00:51:51.478 align:middle line:-1
我们看看实际效果

00:51:55.582 --> 00:51:58.785 align:middle line:-2
我们这次可以选择不同的注释
我感到很幸运

00:52:00.721 --> 00:52:04.057 align:middle line:-2
现在我们可以看到
我们可以从所提供的

00:52:07.227 --> 00:52:09.596 align:middle line:-1
路线列表中选中路线

00:52:09.663 --> 00:52:11.265 align:middle line:-1
我还没有实现显示数据

00:52:12.165 --> 00:52:14.201 align:middle line:-1
我们看看选中另一条路线如何

00:52:14.701 --> 00:52:18.172 align:middle line:-2
这里发生的事情是当一个叠层
被选中时 默认情况下

00:52:18.238 --> 00:52:19.306 align:middle line:-1
没有任何事情发生

00:52:19.373 --> 00:52:22.209 align:middle line:-2
而取消选中叠层时
默认情况下也不会发生任何事情

00:52:22.276 --> 00:52:25.479 align:middle line:-1
所以我也必须实现这部分行为

00:52:27.447 --> 00:52:28.582 align:middle line:-1
在这个例子中

00:52:29.116 --> 00:52:33.687 align:middle line:0
我将为deselect事件
添加一个新的事件监听器

00:52:34.188 --> 00:52:38.225 align:middle line:0
当取消选中叠层时
我将切换其样式

00:52:38.292 --> 00:52:39.459 align:middle line:0
为默认值

00:52:41.595 --> 00:52:44.531 align:middle line:-1
这应该能解决我的问题

00:52:45.666 --> 00:52:46.900 align:middle line:-1
我们再试一次

00:52:47.701 --> 00:52:49.069 align:middle line:-1
我选中这条路线

00:52:49.469 --> 00:52:52.139 align:middle line:-1
如果我再次选中同一个地方

00:52:52.206 --> 00:52:54.441 align:middle line:-1
因为我们这里有两个叠层互相重叠

00:52:54.508 --> 00:52:56.443 align:middle line:-1
这将选中另一个叠层

00:52:56.910 --> 00:52:59.379 align:middle line:-2
现在取消选中事件处理器
能够正常运行

00:52:59.446 --> 00:53:02.816 align:middle line:-1
所以我刚才的突出显示已经消失了

00:52:59.446 --> 00:53:02.816 align:middle line:-1
所以我刚才的突出显示已经消失了

00:53:02.916 --> 00:53:06.753 align:middle line:-1
而且现在新选中的对象能够正确显示

00:53:07.087 --> 00:53:09.122 align:middle line:-1
这似乎工作得很好

00:53:10.157 --> 00:53:11.625 align:middle line:-1
这是另一个例子

00:53:12.826 --> 00:53:15.262 align:middle line:-1
同样的 我可以选中这些路线

00:53:17.030 --> 00:53:18.599 align:middle line:-1
但我想了解更多关于它们的信息

00:53:18.665 --> 00:53:20.467 align:middle line:-1
我想知道行车路线是什么

00:53:20.534 --> 00:53:24.605 align:middle line:-2
使用其中一条路线与另一条路线相比
分别所需的时间等等

00:53:25.506 --> 00:53:26.406 align:middle line:-1
所以…

00:53:26.940 --> 00:53:28.809 align:middle line:-1
这非常简单

00:53:28.876 --> 00:53:32.446 align:middle line:-1
因为我需要的东西都已经存在

00:53:32.679 --> 00:53:36.517 align:middle line:-1
我已将数据保存在我的叠层中

00:53:36.717 --> 00:53:39.686 align:middle line:-2
我也有一个选中事件监听器
和一个取消选中事件监听器

00:53:39.753 --> 00:53:43.724 align:middle line:0
所以当叠层被选中时
我会将这些数据

00:53:46.226 --> 00:53:47.327 align:middle line:0
显示在侧边栏中

00:53:48.862 --> 00:53:50.264 align:middle line:-1
这属于很典型的

00:53:50.330 --> 00:53:53.400 align:middle line:-1
Web开发技术

00:53:53.467 --> 00:53:58.071 align:middle line:-2
我们有一些数据并且
想将其格式化为HTML

00:53:58.138 --> 00:53:59.540 align:middle line:-1
所以我不会讨论其中的细节

00:53:59.606 --> 00:54:01.475 align:middle line:-1
但我们关注的细节

00:53:59.606 --> 00:54:01.475 align:middle line:-1
但我们关注的细节

00:54:01.542 --> 00:54:04.011 align:middle line:-1
与叠层相关

00:54:04.478 --> 00:54:06.980 align:middle line:-1
当叠层被选中时 它就会显示出来

00:54:07.581 --> 00:54:10.017 align:middle line:0
我不会在这个选中事件上
犯同样的错误

00:54:10.083 --> 00:54:13.754 align:middle line:0
所以当叠层取消选中时
我会直接隐藏数据

00:54:13.820 --> 00:54:16.723 align:middle line:-1
从而不会同时出现多条路线

00:54:18.458 --> 00:54:19.660 align:middle line:-1
我们再试一次

00:54:20.561 --> 00:54:22.729 align:middle line:-2
我们还是选中上次那个注释
我喜欢这个例子

00:54:23.797 --> 00:54:26.567 align:middle line:-1
我再次选中这条路线

00:54:26.700 --> 00:54:30.571 align:middle line:-2
现在该路线被选中了
我们可以在右侧看到

00:54:30.771 --> 00:54:33.040 align:middle line:-1
一些额外的信息

00:54:33.340 --> 00:54:34.875 align:middle line:-1
这是路线的简称

00:54:34.942 --> 00:54:37.845 align:middle line:-1
这是从汉密尔顿公路出发的路线

00:54:38.512 --> 00:54:41.648 align:middle line:-2
路程为70公里
在理想的驾驶条件下

00:54:41.715 --> 00:54:44.651 align:middle line:-1
我需要1小时32分钟到达那里

00:54:44.718 --> 00:54:45.986 align:middle line:-1
以下是我可以跟随的

00:54:46.053 --> 00:54:49.056 align:middle line:-1
到达目的地的所有步骤

00:54:49.857 --> 00:54:51.358 align:middle line:-1
我也可以看看这条路线如何

00:54:52.059 --> 00:54:56.630 align:middle line:-1
它的路程实际上更长 但它却更快

00:54:57.164 --> 00:54:59.700 align:middle line:-1
就是这样

00:54:59.766 --> 00:55:04.238 align:middle line:-1
我们已经构建了一个大脚怪查找器

00:54:59.766 --> 00:55:04.238 align:middle line:-1
我们已经构建了一个大脚怪查找器

00:55:05.272 --> 00:55:10.010 align:middle line:-2
它可以让我们选择想去的地方
并告诉我们怎么去

00:55:12.746 --> 00:55:13.614 align:middle line:-1
谢谢

00:55:13.680 --> 00:55:14.848 align:middle line:0
（演示——路线和用户交互）

00:55:14.982 --> 00:55:16.750 align:middle line:-1
（演示回顾）

00:55:16.850 --> 00:55:17.784 align:middle line:-1
快速回顾一下

00:55:17.851 --> 00:55:20.087 align:middle line:-1
我们看到了如何对用户事件做出响应

00:55:20.153 --> 00:55:22.155 align:middle line:-2
在这个演示中为选中事件
和取消选中事件

00:55:23.090 --> 00:55:27.327 align:middle line:-2
我们从MapKit JS服务中
获得了行车路线

00:55:27.427 --> 00:55:30.764 align:middle line:-2
我们使用折线叠层
来显示这些驾驶路线

00:55:31.298 --> 00:55:35.169 align:middle line:-2
我们为选中叠层事件
添加了自定义的行为

00:55:35.235 --> 00:55:38.805 align:middle line:-1
因为默认情况下没有提供特定的行为

00:55:39.573 --> 00:55:40.674 align:middle line:-1
（关键要点）

00:55:40.741 --> 00:55:43.844 align:middle line:-2
关于MapKit JS
还有很多东西值得讨论

00:55:44.578 --> 00:55:45.846 align:middle line:-1
但我们只有一个小时

00:55:45.913 --> 00:55:47.915 align:middle line:-1
所以我们就谈到这里

00:55:49.650 --> 00:55:53.787 align:middle line:-2
但我希望我们为MapKit JS
做了一个很好的示例

00:55:53.854 --> 00:55:57.157 align:middle line:-2
为Web app提供了
一流的地图体验

00:55:58.292 --> 00:56:01.495 align:middle line:-1
它让你能够统一使用单个地图提供者

00:55:58.292 --> 00:56:01.495 align:middle line:-1
它让你能够统一使用单个地图提供者

00:56:01.562 --> 00:56:03.430 align:middle line:-1
并且它具有熟悉且灵活的API

00:56:03.497 --> 00:56:04.698 align:middle line:-1
所以如果你的团队

00:56:04.765 --> 00:56:07.401 align:middle line:-1
使用过原生MapKit API

00:56:07.467 --> 00:56:10.637 align:middle line:-2
这应该感觉非常熟悉
因为它们使用相同的概念

00:56:10.704 --> 00:56:12.973 align:middle line:-1
Web开发者应该也很乐意看到

00:56:13.140 --> 00:56:17.010 align:middle line:-2
这些API是为了适配
JavaScript而定制的

00:56:19.046 --> 00:56:21.682 align:middle line:-2
我要提醒你
你需要MapKit JS密钥

00:56:21.748 --> 00:56:23.884 align:middle line:-1
才能够使用MapKit JS

00:56:24.084 --> 00:56:27.621 align:middle line:-2
因此请到开发者门户获取你的密钥
然后马上开始试用

00:56:29.223 --> 00:56:30.991 align:middle line:-2
若你想了解更多
MapKit JS的知识

00:56:31.058 --> 00:56:35.662 align:middle line:-2
你可以在此URL
找到文档和示例代码

00:56:37.064 --> 00:56:39.933 align:middle line:-2
如果你想了解更多
关于本次演讲的信息

00:56:40.200 --> 00:56:42.503 align:middle line:0
这是这次演讲的URL

00:56:42.870 --> 00:56:47.140 align:middle line:0
我们附带的视频将逐步教你

00:56:47.207 --> 00:56:49.610 align:middle line:0
如何获取和使用
MapKit JS密钥

00:56:49.676 --> 00:56:51.044 align:middle line:0
（更多信息）

00:56:51.111 --> 00:56:53.814 align:middle line:0
最后 我们还有相关的实验

00:56:53.881 --> 00:56:56.016 align:middle line:0
它们分别在周三早上和周五早上

00:56:56.083 --> 00:56:59.019 align:middle line:0
届时你可以与
整个MapKit JS团队交谈

00:56:59.253 --> 00:57:01.688 align:middle line:0
并向我们询问
有关MapKit JS的问题

00:56:59.253 --> 00:57:01.688 align:middle line:0
并向我们询问
有关MapKit JS的问题

00:57:02.456 --> 00:57:03.490 align:middle line:-1
非常感谢

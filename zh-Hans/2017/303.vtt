WEBVTT

00:00:17.618 --> 00:00:20.754 align:middle line:10%
<c.magenta>（StoreKit新特性）</c>

00:00:20.954 --> 00:00:21.788 align:middle line:90%,end
<c.magenta>大家早上好</c>

00:00:27.160 --> 00:00:28.762 align:middle line:90%,end
<c.magenta>欢迎来参加</c>
<c.magenta>“StoreKit新特性”演讲</c>

00:00:29.162 --> 00:00:32.432 align:middle line:90%,end
<c.magenta>我叫Pete Hare 我是Apple App Store</c>
<c.magenta>团队的一名软件工程师</c>

00:00:33.800 --> 00:00:37.037 align:middle line:90%,end
<c.magenta>程序内购买代表了收入的一大部分</c>

00:00:37.104 --> 00:00:38.572 align:middle line:90%,end
<c.magenta>也就是由App Store中的</c>
<c.magenta>应用所产生的收入</c>

00:00:38.639 --> 00:00:42.142 align:middle line:90%,end
<c.magenta>为了实现程序内购买</c>
<c.magenta>并且将内容卖给你的用户</c>

00:00:42.209 --> 00:00:44.211 align:middle line:90%,end
<c.magenta>在这过程中</c>
<c.magenta>提供一个很棒的体验</c>

00:00:44.278 --> 00:00:47.514 align:middle line:90%,end
<c.magenta>对你和你的生意来说变得越来越重要了</c>

00:00:48.382 --> 00:00:50.350 align:middle line:90%,end
<c.magenta>我们在研究</c>
<c.magenta>可以让你们实现这些功能的方法</c>

00:00:50.417 --> 00:00:51.618 align:middle line:90%,end
<c.magenta>以更加高效的方式</c>

00:00:51.818 --> 00:00:53.120 align:middle line:90%,end
<c.magenta>我们今天会向你们介绍</c>

00:00:53.187 --> 00:00:55.222 align:middle line:90%,end
<c.magenta>一些关于StoreKit框架的改进</c>

00:00:55.756 --> 00:00:58.125 align:middle line:90%,end
<c.magenta>StoreKit就是用来</c>
<c.magenta>实现程序内购买的框架</c>

00:00:58.192 --> 00:01:00.527 align:middle line:90%,end
<c.magenta>它还可以实现其他一些</c>
<c.magenta>与商店相关的功能</c>

00:00:58.192 --> 00:01:00.527 align:middle line:90%,end
<c.magenta>它还可以实现其他一些</c>
<c.magenta>与商店相关的功能</c>

00:01:00.827 --> 00:01:02.729 align:middle line:90%,end
<c.magenta>我们还在iOS 11中</c>
<c.magenta>加入了一些新的改进</c>

00:01:03.730 --> 00:01:05.165 align:middle line:90%,end
<c.magenta>首先 你现在可以</c>

00:01:05.232 --> 00:01:08.268 align:middle line:90%,end
<c.magenta>可以直接在App Store应用中</c>
<c.magenta>推销你的程序内购买</c>

00:01:08.602 --> 00:01:12.472 align:middle line:90%,end
<c.magenta>用户可以购买程序内购买</c>
<c.magenta>然后在你自己的应用中完成交易</c>

00:01:13.740 --> 00:01:16.643 align:middle line:90%,end
<c.magenta>其次 我们会介绍一些关于订阅的改进</c>

00:01:16.743 --> 00:01:18.145 align:middle line:90%,end
<c.magenta>自动续订流</c>

00:01:18.378 --> 00:01:21.014 align:middle line:90%,end
<c.magenta>我们有了新的服务器用于订阅通知</c>

00:01:21.281 --> 00:01:22.649 align:middle line:90%,end
<c.magenta>这会让你轻松许多</c>

00:01:22.716 --> 00:01:25.052 align:middle line:90%,end
<c.magenta>如果你要处理自动续订的话</c>

00:01:29.056 --> 00:01:32.159 align:middle line:90%,end
<c.magenta>我们还会介绍一些</c>
<c.magenta>关于订阅状态信息的新功能</c>

00:01:32.326 --> 00:01:33.827 align:middle line:90%,end
<c.magenta>当你在进行服务端管理的时候</c>

00:01:33.894 --> 00:01:35.495 align:middle line:90%,end
<c.magenta>这会让你们有更深刻的见解</c>

00:01:35.562 --> 00:01:36.797 align:middle line:90%,end
<c.magenta>对于某些商业问题</c>

00:01:36.864 --> 00:01:39.533 align:middle line:90%,end
<c.magenta>像是个体用户以及他们的订阅状态</c>

00:01:40.934 --> 00:01:42.069 align:middle line:90%,end
<c.magenta>我们在今年早些时候还引入了</c>

00:01:42.135 --> 00:01:45.072 align:middle line:90%,end
<c.magenta>可以让你回复</c>
<c.magenta>App Store中用户评论的功能</c>

00:01:45.639 --> 00:01:47.407 align:middle line:90%,end
<c.magenta>除此之外 我们还有些新的改进</c>

00:01:47.541 --> 00:01:49.776 align:middle line:90%,end
<c.magenta>是关于你请求评分和评论的</c>

00:01:50.878 --> 00:01:52.846 align:middle line:90%,end
<c.magenta>在我们介绍这些新功能之前</c>

00:01:53.013 --> 00:01:56.216 align:middle line:90%,end
<c.magenta>我想先概述一下程序内购买的整个流程</c>

00:01:56.283 --> 00:01:59.086 align:middle line:90%,end
<c.magenta>让我们看下</c>
<c.magenta>如何实现你应用中的程序内购买</c>

00:02:01.355 --> 00:02:03.090 align:middle line:90%,end
<c.magenta>程序内购买没有太多的变化</c>

00:02:03.156 --> 00:02:04.725 align:middle line:90%,end
<c.magenta>它们在iOS 3中出现</c>

00:02:05.392 --> 00:02:08.529 align:middle line:90%,end
<c.magenta>程序内购买可以让你售卖数字内容</c>

00:02:08.595 --> 00:02:10.030 align:middle line:90%,end
<c.magenta>或者是你应用中的某个服务</c>

00:02:10.731 --> 00:02:12.766 align:middle line:90%,end
<c.magenta>当提到实物的产品或是服务时</c>

00:02:12.966 --> 00:02:14.601 align:middle line:90%,end
<c.magenta>那就不是太适合用程序内购买</c>

00:02:14.668 --> 00:02:16.170 align:middle line:90%,end
<c.magenta>我们提供像是</c>
<c.magenta>Apple Pay这样的工具</c>

00:02:16.336 --> 00:02:18.005 align:middle line:90%,end
<c.magenta>你也可以实现自己的支付系统</c>

00:02:18.071 --> 00:02:19.940 align:middle line:90%,end
<c.magenta>来实现出售实物产品</c>

00:02:20.073 --> 00:02:23.210 align:middle line:90%,end
<c.magenta>但是提到数字业务的时候</c>
<c.magenta>就该用程序内购买了</c>

00:02:24.945 --> 00:02:27.614 align:middle line:90%,end
<c.magenta>你可以使用四种不同类型的程序内购买</c>

00:02:28.615 --> 00:02:30.384 align:middle line:90%,end
<c.magenta>首先 我们有可消耗的产品</c>

00:02:30.817 --> 00:02:31.818 align:middle line:90%,end
<c.magenta>这类程序内购买</c>

00:02:31.885 --> 00:02:34.087 align:middle line:90%,end
<c.magenta>就是可以被消耗的程序内购买</c>

00:02:34.154 --> 00:02:36.290 align:middle line:90%,end
<c.magenta>顾名思义 并且可以被用户用尽</c>

00:02:36.356 --> 00:02:40.694 align:middle line:90%,end
<c.magenta>这可能是某个游戏中的金币</c>
<c.magenta>用户可以买来花掉</c>

00:02:40.894 --> 00:02:44.198 align:middle line:90%,end
<c.magenta>它在后续的购买恢复</c>
<c.magenta>或是在新设备上不会被保存</c>

00:02:45.199 --> 00:02:48.068 align:middle line:90%,end
<c.magenta>第二类是不可消耗的产品</c>

00:02:49.536 --> 00:02:50.871 align:middle line:90%,end
<c.magenta>它和可消耗的产品有点不同</c>

00:02:50.938 --> 00:02:52.039 align:middle line:90%,end
<c.magenta>就在于它是可保留的</c>

00:02:52.105 --> 00:02:54.374 align:middle line:90%,end
<c.magenta>它可能更适合像是</c>

00:02:54.441 --> 00:02:56.243 align:middle line:90%,end
<c.magenta>解锁你应用的专业功能</c>

00:02:56.310 --> 00:02:58.779 align:middle line:90%,end
<c.magenta>或是下载某个游戏的关卡包</c>

00:03:00.547 --> 00:03:02.816 align:middle line:90%,end
<c.magenta>我们还提供了两种不同类别的订阅产品</c>

00:03:02.883 --> 00:03:05.352 align:middle line:90%,end
<c.magenta>我们有非续订的订阅</c>

00:03:06.019 --> 00:03:06.920 align:middle line:90%,end
<c.magenta>顾名思义</c>

00:03:06.987 --> 00:03:08.255 align:middle line:90%,end
<c.magenta>这类订阅产品</c>

00:03:08.322 --> 00:03:11.558 align:middle line:90%,end
<c.magenta>不会在账单周期结束的时候</c>
<c.magenta>自动向用户扣费</c>

00:03:11.692 --> 00:03:12.659 align:middle line:90%,end
<c.magenta>你可以把这类产品看成是</c>

00:03:12.726 --> 00:03:15.529 align:middle line:90%,end
<c.magenta>某个有过期时间的可消耗产品</c>

00:03:16.630 --> 00:03:19.366 align:middle line:90%,end
<c.magenta>最后一类就是可自动续订的订阅</c>

00:03:20.133 --> 00:03:23.170 align:middle line:90%,end
<c.magenta>去年我们将可自动续订的</c>
<c.magenta>订阅种类开放到了</c>

00:03:23.237 --> 00:03:25.539 align:middle line:90%,end
<c.magenta>更广的范畴</c>

00:03:25.606 --> 00:03:26.907 align:middle line:90%,end
<c.magenta>且我们已看到一些很棒的应用了</c>

00:03:27.841 --> 00:03:30.878 align:middle line:90%,end
<c.magenta>在本次演讲中</c>
<c.magenta>我们只会关注于前两种类型</c>

00:03:30.944 --> 00:03:32.713 align:middle line:90%,end
<c.magenta>绝大部分是可消耗的和不可消耗的</c>

00:03:32.946 --> 00:03:35.449 align:middle line:90%,end
<c.magenta>我们会更详细地介绍订阅</c>

00:03:35.516 --> 00:03:37.184 align:middle line:90%,end
<c.magenta>在今天下午的高级演讲中</c>

00:03:37.351 --> 00:03:39.720 align:middle line:90%,end
<c.magenta>它会于下午1:50</c>
<c.magenta>在大宴会厅A举办</c>

00:03:39.786 --> 00:03:41.288 align:middle line:90%,end
<c.magenta>所以如果你要处理订阅</c>

00:03:41.355 --> 00:03:43.056 align:middle line:90%,end
<c.magenta>在特定的服务端环境的话</c>

00:03:43.123 --> 00:03:44.691 align:middle line:90%,end
<c.magenta>我强烈建议你去参加那场演讲</c>

00:03:44.758 --> 00:03:46.693 align:middle line:90%,end
<c.magenta>我们会在那介绍一些很棒的新改进</c>

00:03:48.095 --> 00:03:51.064 align:middle line:90%,end
<c.magenta>让我们看下如何在你的应用中</c>
<c.magenta>实现程序内购买</c>

00:03:51.932 --> 00:03:55.903 align:middle line:90%,end
<c.magenta>它会从加载你应用中的</c>
<c.magenta>程序内购买标识符开始</c>

00:03:56.303 --> 00:03:58.305 align:middle line:90%,end
<c.magenta>我们一会儿会介绍各步的更多细节</c>

00:03:58.372 --> 00:03:59.573 align:middle line:90%,end
<c.magenta>但现在我就是给你们做个大体介绍</c>

00:04:01.008 --> 00:04:02.209 align:middle line:90%,end
<c.magenta>使用这些程序内购买标识符</c>

00:04:02.276 --> 00:04:05.078 align:middle line:90%,end
<c.magenta>你就从App Store</c>
<c.magenta>获取本地化的产品信息</c>

00:04:05.679 --> 00:04:08.482 align:middle line:90%,end
<c.magenta>在你获取了产品的本地化信息之后</c>

00:04:08.916 --> 00:04:11.285 align:middle line:90%,end
<c.magenta>你就可以将程序内购买的</c>
<c.magenta>UI呈现给用户</c>

00:04:12.085 --> 00:04:15.889 align:middle line:90%,end
<c.magenta>这就可以让用户点击购买按钮</c>
<c.magenta>来同意购买它</c>

00:04:16.190 --> 00:04:18.825 align:middle line:90%,end
<c.magenta>然后就取决于你什么时候</c>
<c.magenta>要向用户请求支付</c>

00:04:20.560 --> 00:04:24.264 align:middle line:90%,end
<c.magenta>然后用户就可以选择</c>
<c.magenta>购买你的程序内购买 并验证支付</c>

00:04:24.831 --> 00:04:28.068 align:middle line:90%,end
<c.magenta>然后就由你来处理</c>
<c.magenta>来自StoreKit的交易</c>

00:04:29.903 --> 00:04:33.207 align:middle line:90%,end
<c.magenta>在交易被处理后</c>
<c.magenta>你就可以解锁相关内容</c>

00:04:33.273 --> 00:04:35.342 align:middle line:90%,end
<c.magenta>让用户可用这个程序内购买</c>

00:04:36.343 --> 00:04:39.079 align:middle line:90%,end
<c.magenta>最后一步就是要结束交易</c>

00:04:40.113 --> 00:04:43.417 align:middle line:90%,end
<c.magenta>让我们开始介绍第一步</c>
<c.magenta>加载程序内购买标识符</c>

00:04:46.019 --> 00:04:48.655 align:middle line:90%,end
<c.magenta>程序内购买标识符其实就是些产品信息</c>

00:04:48.722 --> 00:04:50.357 align:middle line:90%,end
<c.magenta>也就是你在iTunes Connect中</c>
<c.magenta>设置好的那些</c>

00:04:50.524 --> 00:04:52.593 align:middle line:90%,end
<c.magenta>每个你卖的产品都有一个自己的标识符</c>

00:04:53.227 --> 00:04:54.828 align:middle line:90%,end
<c.magenta>当提到将其加载到应用中时</c>

00:04:54.895 --> 00:04:56.163 align:middle line:90%,end
<c.magenta>你可以通过几种方式实现</c>

00:04:56.230 --> 00:04:59.166 align:middle line:90%,end
<c.magenta>首先 你可以直接将它们</c>
<c.magenta>嵌入到你的应用中</c>

00:04:59.366 --> 00:05:01.368 align:middle line:90%,end
<c.magenta>在这里 我有一个字符串数组</c>

00:04:59.366 --> 00:05:01.368 align:middle line:90%,end
<c.magenta>在这里 我有一个字符串数组</c>

00:05:02.336 --> 00:05:05.305 align:middle line:90%,end
<c.magenta>或者 当然了</c>
<c.magenta>也可以从你自己的服务器中获取它们</c>

00:05:07.441 --> 00:05:08.842 align:middle line:90%,end
<c.magenta>这些技术都可以使用</c>

00:05:08.909 --> 00:05:11.311 align:middle line:90%,end
<c.magenta>但重要的是 你只有这个字符串集</c>

00:05:11.378 --> 00:05:13.881 align:middle line:90%,end
<c.magenta>你只能使用这些程序内购买标识符</c>

00:05:13.947 --> 00:05:15.582 align:middle line:90%,end
<c.magenta>来获取产品信息</c>

00:05:16.283 --> 00:05:17.251 align:middle line:90%,end
<c.magenta>也就是下一步要做的</c>

00:05:19.052 --> 00:05:20.153 align:middle line:90%,end
<c.magenta>如果你有了这些信息</c>

00:05:21.054 --> 00:05:23.690 align:middle line:90%,end
<c.magenta>要加载产品的信息就很简单了</c>

00:05:23.757 --> 00:05:24.791 align:middle line:90%,end
<c.magenta>让我们看看它的代码</c>

00:05:26.627 --> 00:05:28.595 align:middle line:90%,end
<c.magenta>你获取了标识符集后</c>

00:05:28.762 --> 00:05:31.732 align:middle line:90%,end
<c.magenta>你要将其传给</c>
<c.magenta>SKProductsRequest初始化器</c>

00:05:32.733 --> 00:05:34.801 align:middle line:90%,end
<c.magenta>为该请求设置一个代理</c>

00:05:34.968 --> 00:05:36.737 align:middle line:90%,end
<c.magenta>然后使用这个开始方法来启动</c>

00:05:38.372 --> 00:05:40.707 align:middle line:90%,end
<c.magenta>现在你已经在它上面</c>
<c.magenta>设定了一个代理方法</c>

00:05:40.774 --> 00:05:43.644 align:middle line:90%,end
<c.magenta>所以你会在didReceiveResponse</c>
<c.magenta>回调函数中获得一个反馈</c>

00:05:45.512 --> 00:05:48.148 align:middle line:90%,end
<c.magenta>在这个回调函数中</c>
<c.magenta>你会收到一个产品的数组</c>

00:05:48.215 --> 00:05:51.818 align:middle line:90%,end
<c.magenta>这个数组会与你所发送请求的</c>
<c.magenta>程序内购买标识符相匹配</c>

00:05:52.519 --> 00:05:53.587 align:middle line:90%,end
<c.magenta>现在你可以循环遍历这些产品</c>

00:05:53.654 --> 00:05:55.122 align:middle line:90%,end
<c.magenta>我们会着重标出某些区域</c>

00:05:55.189 --> 00:05:57.758 align:middle line:90%,end
<c.magenta>这些区域是包含于产品对象中的</c>

00:05:57.824 --> 00:06:01.195 align:middle line:90%,end
<c.magenta>这里有该产品的本地化标题</c>
<c.magenta>和本地化描述</c>

00:05:57.824 --> 00:06:01.195 align:middle line:90%,end
<c.magenta>这里有该产品的本地化标题</c>
<c.magenta>和本地化描述</c>

00:06:02.296 --> 00:06:05.799 align:middle line:90%,end
<c.magenta>这还有关于商店中产品的</c>
<c.magenta>本地化价格信息</c>

00:06:05.866 --> 00:06:07.100 align:middle line:90%,end
<c.magenta>也就是用户登录后得到的</c>

00:06:08.902 --> 00:06:11.338 align:middle line:90%,end
<c.magenta>我们还有关于可下载内容的信息</c>

00:06:11.405 --> 00:06:13.373 align:middle line:90%,end
<c.magenta>也就是可能和这个产品有关的信息</c>

00:06:15.242 --> 00:06:17.311 align:middle line:90%,end
<c.magenta>而在这里更重要的一点 我要强调一下</c>

00:06:17.377 --> 00:06:20.247 align:middle line:90%,end
<c.magenta>就是不应该将这时候返回的</c>
<c.magenta>SKProduct进行缓存</c>

00:06:21.748 --> 00:06:23.984 align:middle line:90%,end
<c.magenta>重要的是你要获得最新的产品信息</c>

00:06:24.084 --> 00:06:25.786 align:middle line:90%,end
<c.magenta>通过定期执行这些请求</c>

00:06:25.986 --> 00:06:27.788 align:middle line:90%,end
<c.magenta>因为像是汇率这些东西可能会波动</c>

00:06:27.921 --> 00:06:30.424 align:middle line:90%,end
<c.magenta>用户可能会注销</c>
<c.magenta>然后登录另一个地区的商店</c>

00:06:30.490 --> 00:06:31.758 align:middle line:90%,end
<c.magenta>所以本地商店可能会变化</c>

00:06:31.859 --> 00:06:33.260 align:middle line:90%,end
<c.magenta>请确保如你所需地</c>

00:06:33.327 --> 00:06:35.963 align:middle line:90%,end
<c.magenta>从App Store</c>
<c.magenta>请求新的产品信息</c>

00:06:36.029 --> 00:06:38.532 align:middle line:90%,end
<c.magenta>且不要一直坚持使用这些</c>
<c.magenta>SKProducts的同一个实例</c>

00:06:39.900 --> 00:06:41.301 align:middle line:90%,end
<c.magenta>但现在你有了SKProduct对象</c>

00:06:41.368 --> 00:06:44.705 align:middle line:90%,end
<c.magenta>而且你已经准备好了</c>
<c.magenta>将一个程序内购买UI展现给用户</c>

00:06:45.606 --> 00:06:46.740 align:middle line:90%,end
<c.magenta>当提到显示UI的时候</c>

00:06:46.807 --> 00:06:48.475 align:middle line:90%,end
<c.magenta>当然了 这取决于你的应用</c>

00:06:48.542 --> 00:06:49.977 align:middle line:90%,end
<c.magenta>每个应用都是有点不同的</c>

00:06:50.177 --> 00:06:52.179 align:middle line:90%,end
<c.magenta>有关如何将产品呈现给用户</c>

00:06:54.448 --> 00:06:55.949 align:middle line:90%,end
<c.magenta>这对于销售会产生巨大的影响</c>

00:06:56.016 --> 00:06:58.986 align:middle line:90%,end
<c.magenta>我建议你们真的要</c>
<c.magenta>小心处理如何构造这个UI</c>

00:06:59.419 --> 00:07:00.821 align:middle line:90%,end
<c.magenta>如果你想了解关于这方面的更多信息</c>

00:06:59.419 --> 00:07:00.821 align:middle line:90%,end
<c.magenta>如果你想了解关于这方面的更多信息</c>

00:07:00.888 --> 00:07:04.224 align:middle line:90%,end
<c.magenta>在我们的开发者网站上</c>
<c.magenta>有些在线信息可供你们进行查阅</c>

00:07:04.291 --> 00:07:06.994 align:middle line:90%,end
<c.magenta>这其中有些如何格式化这个页面的技巧</c>

00:07:07.160 --> 00:07:10.430 align:middle line:90%,end
<c.magenta>以一种可以改善销售情况的方式</c>

00:07:12.399 --> 00:07:14.501 align:middle line:90%,end
<c.magenta>有一个技巧是关于格式化产品价格的</c>

00:07:14.568 --> 00:07:16.370 align:middle line:90%,end
<c.magenta>当提到产品价格的时候</c>

00:07:16.737 --> 00:07:19.473 align:middle line:90%,end
<c.magenta>这就是你用来在UI中显示价格的技术</c>

00:07:19.540 --> 00:07:21.074 align:middle line:90%,end
<c.magenta>创建一个数字格式化对象</c>

00:07:21.808 --> 00:07:24.077 align:middle line:90%,end
<c.magenta>将数字的样式设定为汇率样式</c>

00:07:25.746 --> 00:07:28.081 align:middle line:90%,end
<c.magenta>然后将本地场景</c>
<c.magenta>设定为产品价格的本地场景</c>

00:07:28.148 --> 00:07:29.683 align:middle line:90%,end
<c.magenta>这是个很重要的步骤</c>

00:07:29.850 --> 00:07:33.287 align:middle line:90%,end
<c.magenta>因为如果你不这么做的话</c>
<c.magenta>就会被默认设为系统设备的本地场景</c>

00:07:33.387 --> 00:07:35.822 align:middle line:90%,end
<c.magenta>这可能和用户所登录的商店并不吻合</c>

00:07:35.989 --> 00:07:38.358 align:middle line:90%,end
<c.magenta>用户可能登录的是中国商店</c>

00:07:38.792 --> 00:07:40.527 align:middle line:90%,end
<c.magenta>但是设备是设为美式英文的</c>

00:07:40.694 --> 00:07:42.729 align:middle line:90%,end
<c.magenta>对于所有的价格与汇率相关信息</c>

00:07:42.896 --> 00:07:44.898 align:middle line:90%,end
<c.magenta>与它们在App Store中的</c>
<c.magenta>内容匹配是很重要的</c>

00:07:45.199 --> 00:07:48.502 align:middle line:90%,end
<c.magenta>所以请确保设置了数字格式化器</c>
<c.magenta>下面的产品价格本地场景</c>

00:07:49.269 --> 00:07:50.103 align:middle line:90%,end
<c.magenta>而在你完成了操作后</c>

00:07:50.304 --> 00:07:52.372 align:middle line:90%,end
<c.magenta>你可以从数字格式化器获得一个字符串</c>

00:07:52.673 --> 00:07:55.909 align:middle line:90%,end
<c.magenta>这样你就得到了一个可以显示在</c>
<c.magenta>UI中的格式化字符串</c>

00:07:59.279 --> 00:08:02.249 align:middle line:90%,end
<c.magenta>还有一点是</c>
<c.magenta>不要自己执行任何的汇率转换</c>

00:07:59.279 --> 00:08:02.249 align:middle line:90%,end
<c.magenta>还有一点是</c>
<c.magenta>不要自己执行任何的汇率转换</c>

00:08:02.316 --> 00:08:04.585 align:middle line:90%,end
<c.magenta>你根本不需要转换汇率</c>

00:08:04.651 --> 00:08:06.553 align:middle line:90%,end
<c.magenta>你可以让StoreKit来帮你实现</c>

00:08:06.720 --> 00:08:08.989 align:middle line:90%,end
<c.magenta>你只要把数字和得到的价格本地场景</c>

00:08:09.056 --> 00:08:10.691 align:middle line:90%,end
<c.magenta>交给数字格式化器就可以了</c>

00:08:12.426 --> 00:08:15.529 align:middle line:90%,end
<c.magenta>接下来 在你显示了UI之后</c>
<c.magenta>就要请求支付了</c>

00:08:15.596 --> 00:08:18.532 align:middle line:90%,end
<c.magenta>这里我们希望用户决定要</c>
<c.magenta>购买你的程序内购买</c>

00:08:18.599 --> 00:08:19.766 align:middle line:90%,end
<c.magenta>他们点击了购买按钮</c>

00:08:20.133 --> 00:08:23.070 align:middle line:90%,end
<c.magenta>现在就轮到你来向用户请求付款了</c>

00:08:23.770 --> 00:08:25.072 align:middle line:90%,end
<c.magenta>这是个很简单的步骤</c>

00:08:25.138 --> 00:08:26.173 align:middle line:90%,end
<c.magenta>只有几行代码</c>

00:08:26.640 --> 00:08:29.009 align:middle line:90%,end
<c.magenta>你要把用户想买的SKProduct</c>

00:08:29.243 --> 00:08:33.580 align:middle line:90%,end
<c.magenta>传给一个SKPayment初始化器</c>
<c.magenta>来创建一个支付对象</c>

00:08:34.214 --> 00:08:37.818 align:middle line:90%,end
<c.magenta>然后你要把这个支付添加到</c>
<c.magenta>SKPaymentQueue的默认队列中</c>

00:08:39.385 --> 00:08:41.522 align:middle line:90%,end
<c.magenta>在你将付款加到默认队列后</c>

00:08:42.155 --> 00:08:45.926 align:middle line:90%,end
<c.magenta>用户就可以看到这个很漂亮的</c>
<c.magenta>程序内购买支付表单</c>

00:08:45.993 --> 00:08:47.327 align:middle line:10%
<c.magenta>这是iOS 11中新加入的功能</c>

00:08:53.300 --> 00:08:55.502 align:middle line:90%,end
<c.magenta>用户可以验证购买</c>

00:08:55.569 --> 00:08:58.572 align:middle line:90%,end
<c.magenta>通过使用Touch ID</c>
<c.magenta>然后接着用你的应用</c>

00:08:59.039 --> 00:09:00.607 align:middle line:90%,end
<c.magenta>我们觉得这是个有很大改进的设计</c>

00:08:59.039 --> 00:09:00.607 align:middle line:90%,end
<c.magenta>我们觉得这是个有很大改进的设计</c>

00:09:00.674 --> 00:09:03.010 align:middle line:90%,end
<c.magenta>这会极大地提升用户体验</c>

00:09:04.144 --> 00:09:05.579 align:middle line:90%,end
<c.magenta>现在我想离题</c>

00:09:05.646 --> 00:09:08.081 align:middle line:90%,end
<c.magenta>介绍一点关于检测非法活动的内容</c>

00:09:08.749 --> 00:09:12.019 align:middle line:90%,end
<c.magenta>检测非法活动功能</c>
<c.magenta>会给我们警告符号</c>

00:09:12.085 --> 00:09:15.455 align:middle line:90%,end
<c.magenta>如果在这个流程中有什么可疑情况的话</c>

00:09:15.889 --> 00:09:19.193 align:middle line:90%,end
<c.magenta>Apple有个先进的引擎来检测</c>
<c.magenta>并且预防非法活动</c>

00:09:19.259 --> 00:09:21.061 align:middle line:90%,end
<c.magenta>最理想情况就是在</c>
<c.magenta>非法活动出现之前</c>

00:09:21.461 --> 00:09:24.998 align:middle line:90%,end
<c.magenta>不过有的时候是在支付完成后</c>
<c.magenta>检测到非法活动</c>

00:09:25.065 --> 00:09:27.234 align:middle line:90%,end
<c.magenta>它只能在已经出现了</c>
<c.magenta>非法活动后才能检测到</c>

00:09:27.935 --> 00:09:31.305 align:middle line:90%,end
<c.magenta>现在对于这种情况</c>
<c.magenta>我们会为适合的开发者或用户退款</c>

00:09:31.371 --> 00:09:32.406 align:middle line:90%,end
<c.magenta>但是这不是个好办法</c>

00:09:32.472 --> 00:09:35.075 align:middle line:90%,end
<c.magenta>所以我们现在想尝试</c>
<c.magenta>从你们那里获得一些合作</c>

00:09:35.142 --> 00:09:37.911 align:middle line:90%,end
<c.magenta>来帮助我们能早一点发现这些非法活动</c>

00:09:38.478 --> 00:09:39.913 align:middle line:90%,end
<c.magenta>现在我想做一个说明</c>

00:09:39.980 --> 00:09:42.816 align:middle line:90%,end
<c.magenta>可以帮你们验证我刚才所说的内容</c>

00:09:44.418 --> 00:09:45.986 align:middle line:90%,end
<c.magenta>比方说 我现在有三台设备</c>

00:09:46.353 --> 00:09:48.789 align:middle line:10%
<c.magenta>三个用户用不同的</c>
<c.magenta>Apple ID登录账户</c>

00:09:49.489 --> 00:09:52.292 align:middle line:10%
<c.magenta>这三个用户都在购买相同的金币产品</c>

00:09:52.426 --> 00:09:54.528 align:middle line:10%
<c.magenta>从App Store中你的应用里</c>

00:09:55.295 --> 00:09:56.697 align:middle line:10%
<c.magenta>这是个很普通的场景</c>

00:09:56.763 --> 00:09:58.632 align:middle line:10%
<c.magenta>很多用户都会做很多次这样的操作</c>

00:09:58.699 --> 00:09:59.833 align:middle line:10%
<c.magenta>全世界范围每天都会</c>

00:10:00.934 --> 00:10:03.203 align:middle line:10%
<c.magenta>但是让我们再加点信息到这个问题中</c>

00:10:03.270 --> 00:10:04.771 align:middle line:10%
<c.magenta>这会让问题大为不同</c>

00:10:05.105 --> 00:10:08.342 align:middle line:10%
<c.magenta>比方说 这三个用户在你的应用中</c>
<c.magenta>购买了金币</c>

00:10:08.809 --> 00:10:12.079 align:middle line:10%
<c.magenta>但是这些独立的ID</c>
<c.magenta>其实是把这些金币存入了</c>

00:10:12.145 --> 00:10:14.748 align:middle line:10%
<c.magenta>你服务器上的一个相同的游戏账号</c>

00:10:15.449 --> 00:10:17.518 align:middle line:10%
<c.magenta>这个场景突然就变得非常可疑了</c>

00:10:18.785 --> 00:10:21.922 align:middle line:90%,end
<c.magenta>那么我们该如何在支付过程中</c>
<c.magenta>早点发现此类问题呢？</c>

00:10:22.089 --> 00:10:25.592 align:middle line:90%,end
<c.magenta>我们想让你在支付步骤中</c>
<c.magenta>提供一个账号标识符</c>

00:10:26.326 --> 00:10:28.962 align:middle line:90%,end
<c.magenta>这个标识符会用于</c>
<c.magenta>有自己账号管理系统的应用</c>

00:10:29.263 --> 00:10:30.864 align:middle line:90%,end
<c.magenta>所以如果你有服务器账号</c>

00:10:30.931 --> 00:10:32.766 align:middle line:90%,end
<c.magenta>而某个用户作为特殊用户登录</c>

00:10:33.433 --> 00:10:35.802 align:middle line:90%,end
<c.magenta>我们就会在这步中</c>
<c.magenta>请求一个不透明的标识符</c>

00:10:36.670 --> 00:10:38.472 align:middle line:90%,end
<c.magenta>什么是不透明的标识符呢？</c>

00:10:39.239 --> 00:10:41.942 align:middle line:90%,end
<c.magenta>我们不是想让你将</c>
<c.magenta>用户的实际信息给我们</c>

00:10:42.009 --> 00:10:44.545 align:middle line:90%,end
<c.magenta>我们已经知道该用户的Apple ID了</c>
<c.magenta>所以不用给我们这些信息</c>

00:10:44.745 --> 00:10:48.682 align:middle line:90%,end
<c.magenta>我们不想知道该用户的用户名或者密码</c>

00:10:48.749 --> 00:10:49.950 align:middle line:90%,end
<c.magenta>我们不想知道任何这些细节的信息</c>

00:10:50.017 --> 00:10:51.018 align:middle line:90%,end
<c.magenta>我们建议你</c>

00:10:51.084 --> 00:10:54.521 align:middle line:90%,end
<c.magenta>新建一个账户名的哈希值</c>
<c.magenta>或者是类似的东西</c>

00:10:54.588 --> 00:10:57.858 align:middle line:90%,end
<c.magenta>这样我们就可以用这个独一无二的</c>
<c.magenta>标识符来匹配这些支付行为</c>

00:10:57.991 --> 00:11:00.827 align:middle line:90%,end
<c.magenta>在不同的Apple ID之间</c>
<c.magenta>并且将它们关联到一起</c>

00:10:57.991 --> 00:11:00.827 align:middle line:90%,end
<c.magenta>在不同的Apple ID之间</c>
<c.magenta>并且将它们关联到一起</c>

00:11:01.962 --> 00:11:03.664 align:middle line:10%
<c.magenta>想要实现这个功能真的很简单</c>

00:11:03.730 --> 00:11:04.798 align:middle line:10%
<c.magenta>当你在创建SKPayment时</c>

00:11:04.865 --> 00:11:05.999 align:middle line:10%
<c.magenta>也就是我们刚才看过的那个对象</c>

00:11:06.466 --> 00:11:07.534 align:middle line:10%
<c.magenta>你只需要再多加一步</c>

00:11:07.601 --> 00:11:09.469 align:middle line:10%
<c.magenta>就是设置应用的用户名</c>

00:11:10.003 --> 00:11:11.572 align:middle line:10%
<c.magenta>这里你可以设置</c>

00:11:11.638 --> 00:11:13.607 align:middle line:10%
<c.magenta>账户名的哈希值</c>
<c.magenta>这样就可以帮助我们</c>

00:11:13.674 --> 00:11:15.809 align:middle line:10%
<c.magenta>在此过程中更早地检测出非法的活动</c>

00:11:17.611 --> 00:11:19.179 align:middle line:90%,end
<c.magenta>你只需要这么简单的一步</c>

00:11:19.246 --> 00:11:21.481 align:middle line:90%,end
<c.magenta>就可以让你应用的支付行为更加安全</c>

00:11:23.650 --> 00:11:25.419 align:middle line:90%,end
<c.magenta>在用户验证了支付行为后</c>

00:11:25.485 --> 00:11:27.588 align:middle line:90%,end
<c.magenta>尽管信用卡已扣费</c>
<c.magenta>但还是取决于你来决定</c>

00:11:27.654 --> 00:11:30.457 align:middle line:90%,end
<c.magenta>什么时候处理来自</c>
<c.magenta>StoreKit的交易行为</c>

00:11:31.225 --> 00:11:32.526 align:middle line:90%,end
<c.magenta>我们看看这是什么样子的</c>

00:11:33.026 --> 00:11:35.095 align:middle line:90%,end
<c.magenta>在你应用生命周期最开始的地方</c>

00:11:35.162 --> 00:11:36.129 align:middle line:90%,end
<c.magenta>在这里 我所做的是</c>

00:11:36.630 --> 00:11:39.967 align:middle line:90%,end
<c.magenta>实现了didFinishLaunching</c>
<c.magenta>WithOptions这个应用代理方法</c>

00:11:40.267 --> 00:11:44.204 align:middle line:90%,end
<c.magenta>重要的是你要在SKPayment</c>
<c.magenta>队列上设置一个交易观察者</c>

00:11:44.872 --> 00:11:47.274 align:middle line:90%,end
<c.magenta>这里我所添加的是应用代理本身</c>

00:11:47.341 --> 00:11:49.510 align:middle line:90%,end
<c.magenta>作为我的SKPayment</c>
<c.magenta>交易观察者</c>

00:11:49.576 --> 00:11:50.744 align:middle line:90%,end
<c.magenta>但你可以使用其他对象</c>

00:11:50.811 --> 00:11:52.713 align:middle line:90%,end
<c.magenta>如果你想监视这些交易的话</c>

00:11:52.913 --> 00:11:53.914 align:middle line:90%,end
<c.magenta>这里很重要的一点是</c>

00:11:53.981 --> 00:11:57.084 align:middle line:90%,end
<c.magenta>你要在应用的生命周期</c>
<c.magenta>尽早地实现这个功能</c>

00:11:57.584 --> 00:12:00.587 align:middle line:90%,end
<c.magenta>交易可能会在任何时间来到交易观察者</c>

00:11:57.584 --> 00:12:00.587 align:middle line:90%,end
<c.magenta>交易可能会在任何时间来到交易观察者</c>

00:12:00.654 --> 00:12:02.856 align:middle line:90%,end
<c.magenta>在你应用的生命周期中</c>

00:12:02.923 --> 00:12:04.925 align:middle line:90%,end
<c.magenta>所以请确保在开始的时候</c>
<c.magenta>你就注册好它了</c>

00:12:05.959 --> 00:12:07.160 align:middle line:90%,end
<c.magenta>在它被注册之后</c>

00:12:07.227 --> 00:12:09.897 align:middle line:90%,end
<c.magenta>你就可以开始在回调函数中接收交易了</c>

00:12:10.797 --> 00:12:12.599 align:middle line:90%,end
<c.magenta>这里是个由回调函数更新的交易</c>

00:12:12.666 --> 00:12:15.335 align:middle line:90%,end
<c.magenta>这就是功能实现的中心</c>

00:12:16.103 --> 00:12:17.838 align:middle line:90%,end
<c.magenta>你会接收到一个交易的数组</c>

00:12:17.905 --> 00:12:21.108 align:middle line:90%,end
<c.magenta>你可以检查每个交易的交易状态</c>

00:12:21.909 --> 00:12:24.478 align:middle line:90%,end
<c.magenta>你要找处于已购买状态的交易</c>

00:12:25.078 --> 00:12:27.314 align:middle line:90%,end
<c.magenta>这就是StoreKit</c>
<c.magenta>视作合适的交易</c>

00:12:27.481 --> 00:12:31.818 align:middle line:90%,end
<c.magenta>你可以检查下有效性</c>
<c.magenta>然后解锁内容</c>

00:12:33.187 --> 00:12:35.589 align:middle line:90%,end
<c.magenta>这里还有些其他状态</c>
<c.magenta>我们不在本次演讲中介绍了</c>

00:12:35.656 --> 00:12:38.392 align:middle line:90%,end
<c.magenta>不过有一个状态我想讲一下</c>
<c.magenta>就是延迟状态</c>

00:12:39.860 --> 00:12:41.128 align:middle line:90%,end
<c.magenta>某个交易会进入</c>

00:12:41.195 --> 00:12:43.964 align:middle line:90%,end
<c.magenta>延迟状态 如果用户要求这么做的话</c>

00:12:44.731 --> 00:12:47.100 align:middle line:90%,end
<c.magenta>小孩可能会请求购买某个程序内购买</c>

00:12:47.167 --> 00:12:50.838 align:middle line:90%,end
<c.magenta>就会有个请求到达他们的父母那边</c>
<c.magenta>由父母来允许本次购买</c>

00:12:51.271 --> 00:12:52.439 align:middle line:90%,end
<c.magenta>而这一过程可能会间隔</c>

00:12:52.506 --> 00:12:55.042 align:middle line:90%,end
<c.magenta>几秒 几分钟 几个星期</c>
<c.magenta>谁知道会多久呢</c>

00:12:55.108 --> 00:12:57.778 align:middle line:90%,end
<c.magenta>重要的是</c>
<c.magenta>如果进入了延迟状态</c>

00:12:57.845 --> 00:13:00.914 align:middle line:90%,end
<c.magenta>在他们等待许可的时候</c>
<c.magenta>你仍会让他们访问应用</c>

00:12:57.845 --> 00:13:00.914 align:middle line:90%,end
<c.magenta>在他们等待许可的时候</c>
<c.magenta>你仍会让他们访问应用</c>

00:13:00.981 --> 00:13:02.249 align:middle line:90%,end
<c.magenta>让他们可一直用你的应用</c>

00:13:02.316 --> 00:13:03.483 align:middle line:90%,end
<c.magenta>不要让他们卡在</c>

00:13:03.550 --> 00:13:06.253 align:middle line:90%,end
<c.magenta>某些像是加载旋转这类界面上</c>

00:13:06.887 --> 00:13:08.222 align:middle line:90%,end
<c.magenta>而这个支付会最终进入</c>

00:13:08.288 --> 00:13:09.890 align:middle line:90%,end
<c.magenta>已购买状态</c>
<c.magenta>在它得到许可之后</c>

00:13:09.957 --> 00:13:12.326 align:middle line:90%,end
<c.magenta>你可以像其他的购买交易</c>
<c.magenta>一样对它进行处理</c>

00:13:13.827 --> 00:13:16.029 align:middle line:90%,end
<c.magenta>为了测试延迟交易</c>

00:13:16.096 --> 00:13:17.497 align:middle line:90%,end
<c.magenta>我们提供了一个方法</c>
<c.magenta>来让你实现这个目的</c>

00:13:17.564 --> 00:13:19.499 align:middle line:90%,end
<c.magenta>你可以创建一个可变支付对象</c>

00:13:20.167 --> 00:13:23.136 align:middle line:90%,end
<c.magenta>你可以在这个对象上设置</c>
<c.magenta>simulatesAskToBuy旗帜</c>

00:13:23.337 --> 00:13:25.806 align:middle line:90%,end
<c.magenta>这在你用沙盒环境的时候很有效</c>

00:13:26.006 --> 00:13:27.975 align:middle line:90%,end
<c.magenta>我们不会在本次演讲中过多介绍沙盒</c>

00:13:28.475 --> 00:13:29.710 align:middle line:90%,end
<c.magenta>它在代码上是这样的</c>

00:13:31.011 --> 00:13:34.047 align:middle line:90%,end
<c.magenta>你可以把simulates</c>
<c.magenta>AskToBuyInSandbox旗帜设为真</c>

00:13:34.114 --> 00:13:37.351 align:middle line:90%,end
<c.magenta>这就意味着在你测试程序内购买的时候</c>

00:13:37.451 --> 00:13:39.586 align:middle line:90%,end
<c.magenta>这个交易就会进入</c>

00:13:39.686 --> 00:13:42.389 align:middle line:90%,end
<c.magenta>一个更新的交易状态</c>
<c.magenta>叫作延迟交易</c>

00:13:42.456 --> 00:13:45.292 align:middle line:90%,end
<c.magenta>你可以测试下如何处理这些情况</c>

00:13:47.561 --> 00:13:50.030 align:middle line:90%,end
<c.magenta>在你处理错误的时候</c>
<c.magenta>有几点是你要记住的</c>

00:13:50.097 --> 00:13:52.733 align:middle line:90%,end
<c.magenta>此过程中的错误不尽相同</c>

00:13:53.300 --> 00:13:55.302 align:middle line:90%,end
<c.magenta>这就意味着 你要仔细看错误代码</c>

00:13:55.369 --> 00:13:57.337 align:middle line:90%,end
<c.magenta>也就是在交易过程中的错误代码</c>

00:13:57.704 --> 00:13:59.239 align:middle line:90%,end
<c.magenta>所以别急着显示一个警告</c>

00:13:59.306 --> 00:14:02.576 align:middle line:90%,end
<c.magenta>除非是很有必要</c>
<c.magenta>向你的用户报告一个错误</c>

00:13:59.306 --> 00:14:02.576 align:middle line:90%,end
<c.magenta>除非是很有必要</c>
<c.magenta>向你的用户报告一个错误</c>

00:14:03.076 --> 00:14:05.879 align:middle line:90%,end
<c.magenta>我们发现过</c>
<c.magenta>有时候可能用户就是取消了一笔支付</c>

00:14:05.979 --> 00:14:07.848 align:middle line:90%,end
<c.magenta>这有个对应的错误代码</c>

00:14:08.382 --> 00:14:10.951 align:middle line:90%,end
<c.magenta>你不需要给用户显示个警告来说</c>
<c.magenta>用户取消了支付</c>

00:14:11.018 --> 00:14:13.620 align:middle line:90%,end
<c.magenta>他们既然点了取消按钮</c>
<c.magenta>肯定知道他们要取消支付</c>

00:14:13.887 --> 00:14:15.088 align:middle line:90%,end
<c.magenta>你不用再次告诉他们了</c>

00:14:16.623 --> 00:14:19.960 align:middle line:90%,end
<c.magenta>同样重要的是你要尽可能地</c>
<c.magenta>让StoreKit来处理交易流</c>

00:14:20.527 --> 00:14:22.462 align:middle line:90%,end
<c.magenta>这就意味着 你不需要请求确认</c>

00:14:22.529 --> 00:14:25.332 align:middle line:90%,end
<c.magenta>像是程序内购买这些事情</c>
<c.magenta>在他们选择购买之后</c>

00:14:25.399 --> 00:14:27.534 align:middle line:90%,end
<c.magenta>我们有个新的支付表单</c>
<c.magenta>来为你实现这个功能</c>

00:14:27.601 --> 00:14:29.002 align:middle line:90%,end
<c.magenta>你可交给StoreKit处理</c>

00:14:30.270 --> 00:14:33.407 align:middle line:90%,end
<c.magenta>在交易进入支付状态后</c>

00:14:33.774 --> 00:14:36.310 align:middle line:90%,end
<c.magenta>我提醒过你们</c>
<c.magenta>一定要验证这笔交易</c>

00:14:36.476 --> 00:14:39.713 align:middle line:90%,end
<c.magenta>我们要如何实现呢？</c>
<c.magenta>我们怎么能保证钱已经易手了呢？</c>

00:14:39.780 --> 00:14:42.850 align:middle line:90%,end
<c.magenta>我们要使用应用收据来实现这个功能</c>

00:14:44.151 --> 00:14:45.686 align:middle line:90%,end
<c.magenta>这个应用收据很像是</c>

00:14:45.752 --> 00:14:47.654 align:middle line:90%,end
<c.magenta>你从商店拿到的那种收据</c>

00:14:47.821 --> 00:14:50.357 align:middle line:90%,end
<c.magenta>它就是支付的证据</c>

00:14:50.424 --> 00:14:53.293 align:middle line:90%,end
<c.magenta>证明用户已经买了他们声称购买的东西</c>

00:14:53.961 --> 00:14:55.262 align:middle line:90%,end
<c.magenta>在本例中</c>

00:14:55.329 --> 00:14:57.798 align:middle line:90%,end
<c.magenta>它就是应用和程序内购买的可信记录</c>

00:14:57.865 --> 00:14:59.733 align:middle line:90%,end
<c.magenta>就是出现在这个应用中的可信记录</c>

00:15:00.434 --> 00:15:01.969 align:middle line:90%,end
<c.magenta>实际上每个应用都有应用收据</c>

00:15:02.035 --> 00:15:04.638 align:middle line:90%,end
<c.magenta>因为它包含了</c>
<c.magenta>有关初始应用购买的信息</c>

00:15:04.738 --> 00:15:08.275 align:middle line:90%,end
<c.magenta>甚至也包括了</c>
<c.magenta>初始免费应用下载的信息</c>

00:15:09.443 --> 00:15:11.445 align:middle line:90%,end
<c.magenta>这个文档会保存在用户的设备上</c>

00:15:11.512 --> 00:15:13.580 align:middle line:90%,end
<c.magenta>它由App Store颁布</c>
<c.magenta>并且放到那里的</c>

00:15:14.548 --> 00:15:16.383 align:middle line:90%,end
<c.magenta>它还是个签过名的 可验证的文档</c>

00:15:16.450 --> 00:15:19.119 align:middle line:90%,end
<c.magenta>所以你可以确保这个文档</c>
<c.magenta>是由Apple所签发的</c>

00:15:19.219 --> 00:15:22.556 align:middle line:90%,end
<c.magenta>你可以用证书来验证文档的真实性</c>

00:15:23.690 --> 00:15:26.260 align:middle line:90%,end
<c.magenta>最后 此收据是在该设备上</c>
<c.magenta>你的应用专用的</c>

00:15:26.326 --> 00:15:29.029 align:middle line:90%,end
<c.magenta>这个收据文档不能跨设备共享</c>

00:15:29.296 --> 00:15:32.165 align:middle line:90%,end
<c.magenta>而且它不能被一台设备上的</c>
<c.magenta>多个应用所共享</c>

00:15:33.433 --> 00:15:34.868 align:middle line:90%,end
<c.magenta>为了保证这个文档</c>

00:15:34.935 --> 00:15:37.604 align:middle line:90%,end
<c.magenta>也就是你用来检查交易的文档</c>
<c.magenta>确实是有效的</c>

00:15:37.671 --> 00:15:39.506 align:middle line:90%,end
<c.magenta>你可以进行收据有效性验证</c>

00:15:40.040 --> 00:15:42.109 align:middle line:90%,end
<c.magenta>收据有效性验证可以通过多种方法实现</c>

00:15:42.843 --> 00:15:45.879 align:middle line:90%,end
<c.magenta>你可以直接在用户的设备上</c>
<c.magenta>使用设备有效性验证</c>

00:15:45.946 --> 00:15:47.614 align:middle line:90%,end
<c.magenta>然后你可以解锁相应的功能</c>

00:15:48.382 --> 00:15:51.051 align:middle line:90%,end
<c.magenta>另一个方法是使用</c>
<c.magenta>服务器到服务器的有效性验证</c>

00:15:51.218 --> 00:15:53.287 align:middle line:90%,end
<c.magenta>你可以把加密的收据数据</c>

00:15:53.353 --> 00:15:55.088 align:middle line:90%,end
<c.magenta>发送到你的服务器上</c>

00:15:55.322 --> 00:15:57.791 align:middle line:90%,end
<c.magenta>你可从那将其发送到</c>
<c.magenta>App Store服务器上</c>

00:15:58.025 --> 00:15:59.860 align:middle line:90%,end
<c.magenta>在那我们会为你做一些检查</c>

00:16:01.261 --> 00:16:03.430 align:middle line:90%,end
<c.magenta>我们不会详细介绍</c>
<c.magenta>收据有效性验证的问题</c>

00:16:03.497 --> 00:16:04.865 align:middle line:90%,end
<c.magenta>会介绍这些内容的演讲</c>

00:16:04.932 --> 00:16:06.834 align:middle line:90%,end
<c.magenta>是在今天下午举办的高级演讲</c>

00:16:06.900 --> 00:16:10.137 align:middle line:90%,end
<c.magenta>我会介绍如何从设备读取收据数据</c>

00:16:10.204 --> 00:16:13.440 align:middle line:90%,end
<c.magenta>还有如何实现服务器到服务器的交换</c>

00:16:14.641 --> 00:16:17.945 align:middle line:90%,end
<c.magenta>一旦你确认了某个收据是真实的文档</c>

00:16:18.245 --> 00:16:19.947 align:middle line:90%,end
<c.magenta>你就可以读取交易</c>

00:16:20.047 --> 00:16:22.683 align:middle line:90%,end
<c.magenta>并且确保在此过程中的交易</c>

00:16:22.749 --> 00:16:23.917 align:middle line:90%,end
<c.magenta>会出现在收据上</c>

00:16:24.051 --> 00:16:26.086 align:middle line:90%,end
<c.magenta>这就意味着你有了有效的购买</c>

00:16:26.153 --> 00:16:27.955 align:middle line:90%,end
<c.magenta>可以接着进行下一步</c>

00:16:29.089 --> 00:16:31.625 align:middle line:90%,end
<c.magenta>也就是为你的程序内购买</c>
<c.magenta>解锁相关内容</c>

00:16:31.925 --> 00:16:33.460 align:middle line:90%,end
<c.magenta>很明显这是个重要的步骤</c>

00:16:34.027 --> 00:16:36.997 align:middle line:90%,end
<c.magenta>可以让用户使用他们所购买的功能</c>

00:16:37.431 --> 00:16:39.733 align:middle line:90%,end
<c.magenta>在这步中 你可能会下载些额外的内容</c>

00:16:39.800 --> 00:16:41.168 align:middle line:90%,end
<c.magenta>且让用户可用这些内容</c>

00:16:42.069 --> 00:16:43.904 align:middle line:90%,end
<c.magenta>如果你要下载程序内购买的内容</c>

00:16:43.971 --> 00:16:45.539 align:middle line:90%,end
<c.magenta>有几种实现的方法</c>

00:16:47.274 --> 00:16:50.511 align:middle line:90%,end
<c.magenta>Apple也给你们提供了两种</c>
<c.magenta>相关的技术来使用</c>

00:16:50.611 --> 00:16:52.212 align:middle line:90%,end
<c.magenta>我们有响应式的资源</c>

00:16:52.279 --> 00:16:54.581 align:middle line:90%,end
<c.magenta>这个API是我们在几年前引入的</c>

00:16:54.882 --> 00:16:56.383 align:middle line:90%,end
<c.magenta>还有一种是我刚才提到过的</c>

00:16:56.450 --> 00:16:58.952 align:middle line:90%,end
<c.magenta>寄存的程序内购买可下载内容</c>

00:16:59.019 --> 00:17:01.321 align:middle line:90%,end
<c.magenta>你可以把可下载内容关联到</c>

00:16:59.019 --> 00:17:01.321 align:middle line:90%,end
<c.magenta>你可以把可下载内容关联到</c>

00:17:01.421 --> 00:17:06.026 align:middle line:90%,end
<c.magenta>iTunes Connect上 这样就可以直接</c>
<c.magenta>访问SKProduct对象了</c>

00:17:06.859 --> 00:17:10.263 align:middle line:90%,end
<c.magenta>当然了 另一种方法就是</c>
<c.magenta>将内容存到你自己的服务器上</c>

00:17:10.464 --> 00:17:11.431 align:middle line:90%,end
<c.magenta>这当然是可以的</c>

00:17:11.498 --> 00:17:13.200 align:middle line:90%,end
<c.magenta>但是如果你这么做</c>
<c.magenta>我希望你们记得</c>

00:17:13.267 --> 00:17:15.602 align:middle line:90%,end
<c.magenta>要使用合适的后台下载API</c>

00:17:15.669 --> 00:17:18.305 align:middle line:90%,end
<c.magenta>这些API要使用NSURL会话</c>
<c.magenta>来确保下载</c>

00:17:18.405 --> 00:17:21.074 align:middle line:90%,end
<c.magenta>不会被中断</c>
<c.magenta>当用户退出应用的时候</c>

00:17:22.709 --> 00:17:24.111 align:middle line:90%,end
<c.magenta>在你解锁了内容之后</c>

00:17:24.178 --> 00:17:27.647 align:middle line:90%,end
<c.magenta>你可能是将专业版应用给了你的用户</c>

00:17:28.214 --> 00:17:29.917 align:middle line:90%,end
<c.magenta>你就可以结束此次交易了</c>

00:17:29.983 --> 00:17:32.252 align:middle line:90%,end
<c.magenta>这是实现程序内购买的最后一步</c>

00:17:32.786 --> 00:17:36.156 align:middle line:90%,end
<c.magenta>重要的是</c>
<c.magenta>你要结束此过程中所有的交易</c>

00:17:36.223 --> 00:17:37.791 align:middle line:90%,end
<c.magenta>即使有些是错误状态的</c>

00:17:37.891 --> 00:17:40.394 align:middle line:90%,end
<c.magenta>你必须结束流中的所有交易</c>

00:17:40.694 --> 00:17:43.096 align:middle line:90%,end
<c.magenta>其中也包括自动续订的情况</c>

00:17:43.163 --> 00:17:46.500 align:middle line:90%,end
<c.magenta>所有可续订的订阅也会出现在这个流中</c>

00:17:46.567 --> 00:17:49.736 align:middle line:90%,end
<c.magenta>对于其中任何要续订的账单周期</c>

00:17:49.803 --> 00:17:52.840 align:middle line:90%,end
<c.magenta>你必须要确保所有此过程中的</c>
<c.magenta>续订交易会被结束掉</c>

00:17:54.474 --> 00:17:57.477 align:middle line:90%,end
<c.magenta>如果你没有结束交易的话</c>
<c.magenta>它们还会保留在支付队列中</c>

00:17:57.544 --> 00:17:58.712 align:middle line:90%,end
<c.magenta>它们就会一直不停弹出</c>

00:17:58.779 --> 00:18:01.715 align:middle line:90%,end
<c.magenta>每次应用启动 调用了更新交易</c>
<c.magenta>回调函数的时候都会这样</c>

00:17:58.779 --> 00:18:01.715 align:middle line:90%,end
<c.magenta>每次应用启动 调用了更新交易</c>
<c.magenta>回调函数的时候都会这样</c>

00:18:01.815 --> 00:18:03.483 align:middle line:90%,end
<c.magenta>所以请确保你已经结束了它们</c>

00:18:03.550 --> 00:18:05.185 align:middle line:90%,end
<c.magenta>而且将它们移出了支付队列</c>

00:18:05.752 --> 00:18:07.588 align:middle line:90%,end
<c.magenta>事实上 对于自动续订的订阅</c>

00:18:07.654 --> 00:18:10.657 align:middle line:90%,end
<c.magenta>我们会介绍些关于重试支付的功能</c>

00:18:10.824 --> 00:18:12.559 align:middle line:90%,end
<c.magenta>该功能依赖于最新的知识</c>

00:18:12.626 --> 00:18:14.962 align:middle line:90%,end
<c.magenta>也就是有关所有</c>
<c.magenta>可续订交易状态的知识</c>

00:18:15.028 --> 00:18:19.399 align:middle line:90%,end
<c.magenta>重要的是 你一定要把交易结束掉</c>
<c.magenta>并且让交易是最新的状态</c>

00:18:20.701 --> 00:18:23.036 align:middle line:90%,end
<c.magenta>其实你只需要一行代码就可以结束交易</c>

00:18:23.103 --> 00:18:24.638 align:middle line:90%,end
<c.magenta>所以你们没借口不结束交易了</c>

00:18:24.771 --> 00:18:27.474 align:middle line:10%
<c.magenta>你只需要将交易传到</c>
<c.magenta>已结束交易回调函数中</c>

00:18:27.674 --> 00:18:30.477 align:middle line:10%
<c.magenta>这是SKPaymentQueue</c>
<c.magenta>的默认队列中的一个API</c>

00:18:32.312 --> 00:18:34.481 align:middle line:90%,end
<c.magenta>在你结束了交易之后</c>

00:18:34.781 --> 00:18:36.250 align:middle line:90%,end
<c.magenta>这也就是最后一步来实现</c>

00:18:36.316 --> 00:18:37.951 align:middle line:90%,end
<c.magenta>在设备上进行程序内购买</c>

00:18:38.051 --> 00:18:41.255 align:middle line:90%,end
<c.magenta>现在用户就可以访问</c>
<c.magenta>他们已经付过款的程序内购买了</c>

00:18:42.523 --> 00:18:44.291 align:middle line:90%,end
<c.magenta>这里有些小技巧</c>

00:18:44.424 --> 00:18:47.361 align:middle line:90%,end
<c.magenta>当你在进行应用审核的时候</c>
<c.magenta>你必须有一个恢复按钮</c>

00:18:47.427 --> 00:18:49.930 align:middle line:90%,end
<c.magenta>如果你有些非可消耗的</c>

00:18:49.997 --> 00:18:52.833 align:middle line:90%,end
<c.magenta>或是在你的应用中自动续订的产品</c>

00:18:53.333 --> 00:18:55.369 align:middle line:90%,end
<c.magenta>而且这个恢复按钮必须是个独立的按钮</c>

00:18:55.435 --> 00:18:57.004 align:middle line:90%,end
<c.magenta>与真正的购买按钮区别开</c>

00:18:57.137 --> 00:18:59.406 align:middle line:90%,end
<c.magenta>你可以把它放到应用中的设置里面</c>

00:18:59.473 --> 00:19:03.310 align:middle line:90%,end
<c.magenta>它就是个用来让用户</c>
<c.magenta>恢复已完成交易的工具</c>

00:18:59.473 --> 00:19:03.310 align:middle line:90%,end
<c.magenta>它就是个用来让用户</c>
<c.magenta>恢复已完成交易的工具</c>

00:19:03.377 --> 00:19:05.078 align:middle line:90%,end
<c.magenta>它不仅仅是个备份工具</c>

00:19:05.145 --> 00:19:06.647 align:middle line:90%,end
<c.magenta>人们经常用到这个功能</c>

00:19:06.713 --> 00:19:08.215 align:middle line:90%,end
<c.magenta>比如他们可能有了个新的设备</c>

00:19:08.282 --> 00:19:09.650 align:middle line:90%,end
<c.magenta>如果他们买了新的iPad</c>

00:19:09.850 --> 00:19:12.920 align:middle line:90%,end
<c.magenta>他们想解锁已经在手机上买过的内容</c>

00:19:13.120 --> 00:19:15.389 align:middle line:90%,end
<c.magenta>他们就可以使用</c>
<c.magenta>恢复功能来实现这个目的</c>

00:19:15.455 --> 00:19:17.624 align:middle line:90%,end
<c.magenta>所以你一定要有个恢复交易按钮</c>

00:19:17.691 --> 00:19:19.326 align:middle line:90%,end
<c.magenta>在你应用的某个地方</c>

00:19:20.227 --> 00:19:22.262 align:middle line:90%,end
<c.magenta>就如我所说的 它只能用于恢复</c>

00:19:22.329 --> 00:19:25.432 align:middle line:90%,end
<c.magenta>非可消耗的 或是自动续订的产品交易</c>

00:19:25.899 --> 00:19:28.936 align:middle line:90%,end
<c.magenta>如果你卖的是可消耗的产品</c>
<c.magenta>或是非续订的订阅的话</c>

00:19:29.002 --> 00:19:31.205 align:middle line:90%,end
<c.magenta>你就得坚持这一点</c>

00:19:31.371 --> 00:19:32.472 align:middle line:90%,end
<c.magenta>可能你有个游戏账户</c>

00:19:32.539 --> 00:19:34.575 align:middle line:90%,end
<c.magenta>你可能将账户信息关联到了</c>

00:19:34.641 --> 00:19:35.876 align:middle line:90%,end
<c.magenta>你自己服务器上的某处</c>

00:19:37.511 --> 00:19:40.247 align:middle line:90%,end
<c.magenta>你们就可以用这个API来恢复它们</c>

00:19:41.114 --> 00:19:42.950 align:middle line:90%,end
<c.magenta>你们要使用restore</c>
<c.magenta>CompletedTransactions这个方法</c>

00:19:43.016 --> 00:19:44.518 align:middle line:90%,end
<c.magenta>它是默认支付队列上的方法</c>

00:19:44.885 --> 00:19:48.188 align:middle line:90%,end
<c.magenta>如果你调用这个方法</c>
<c.magenta>就会让所有已完成的交易</c>

00:19:48.255 --> 00:19:51.692 align:middle line:90%,end
<c.magenta>重新出现在更新交易回调函数上</c>

00:19:51.992 --> 00:19:54.194 align:middle line:90%,end
<c.magenta>你可以使用刚才讲过的同样流程</c>

00:19:54.695 --> 00:19:56.263 align:middle line:90%,end
<c.magenta>检查它们是不是处于购买状态</c>

00:19:56.430 --> 00:19:58.999 align:middle line:90%,end
<c.magenta>做收据有效性验证</c>
<c.magenta>还有解锁所有功能</c>

00:20:00.267 --> 00:20:03.003 align:middle line:90%,end
<c.magenta>关于恢复已完成交易</c>
<c.magenta>还有很多API可用</c>

00:20:03.070 --> 00:20:04.671 align:middle line:90%,end
<c.magenta>你可以理解交易是否结束了</c>

00:20:04.738 --> 00:20:06.707 align:middle line:90%,end
<c.magenta>或者某个过程中是否有错误出现</c>

00:20:06.773 --> 00:20:08.408 align:middle line:90%,end
<c.magenta>不过这里真正要做的是</c>

00:20:08.475 --> 00:20:11.778 align:middle line:90%,end
<c.magenta>要保证将交易观察者</c>
<c.magenta>尽早地注册到你的应用中</c>

00:20:11.845 --> 00:20:13.580 align:middle line:90%,end
<c.magenta>这样你才可以处理所有交易</c>

00:20:13.647 --> 00:20:16.450 align:middle line:90%,end
<c.magenta>在这些交易传入</c>
<c.magenta>更新交易回调函数的时候</c>

00:20:18.619 --> 00:20:21.655 align:middle line:90%,end
<c.magenta>现在我们总结下刚才讲到的流程</c>

00:20:21.722 --> 00:20:22.856 align:middle line:90%,end
<c.magenta>你一直要观察支付队列</c>

00:20:22.923 --> 00:20:24.458 align:middle line:90%,end
<c.magenta>并且你要确保</c>

00:20:24.525 --> 00:20:26.393 align:middle line:90%,end
<c.magenta>在你的应用声明周期中</c>
<c.magenta>越早实现越好</c>

00:20:27.461 --> 00:20:30.664 align:middle line:90%,end
<c.magenta>使用SKProducts请求</c>
<c.magenta>来请求本地化的信息</c>

00:20:30.764 --> 00:20:32.366 align:middle line:90%,end
<c.magenta>这些本地化信息是有关</c>
<c.magenta>App Store中产品的</c>

00:20:32.533 --> 00:20:35.068 align:middle line:90%,end
<c.magenta>并且使用这些信息</c>
<c.magenta>来显示本地化的定价信息</c>

00:20:35.269 --> 00:20:37.004 align:middle line:90%,end
<c.magenta>使用这项技术还有</c>
<c.magenta>我们刚才看到的数字格式化器</c>

00:20:37.070 --> 00:20:41.875 align:middle line:90%,end
<c.magenta>来确保你的价格是以</c>
<c.magenta>用户本地商店的格式显示的</c>

00:20:43.343 --> 00:20:47.247 align:middle line:90%,end
<c.magenta>使用收据来验证支付是否真正完成了</c>

00:20:47.714 --> 00:20:49.449 align:middle line:90%,end
<c.magenta>这是个重要的安全性步骤</c>

00:20:49.516 --> 00:20:51.685 align:middle line:90%,end
<c.magenta>我们今天下午会再介绍</c>
<c.magenta>有关它的更多内容</c>

00:20:52.452 --> 00:20:54.488 align:middle line:90%,end
<c.magenta>你要记得把内容设成对用户是可用的</c>

00:20:54.555 --> 00:20:56.323 align:middle line:90%,end
<c.magenta>保证他们能得到所买的东西</c>

00:20:57.925 --> 00:21:00.360 align:middle line:90%,end
<c.magenta>然后在过程的最后结束交易</c>

00:20:57.925 --> 00:21:00.360 align:middle line:90%,end
<c.magenta>然后在过程的最后结束交易</c>

00:21:00.427 --> 00:21:01.795 align:middle line:90%,end
<c.magenta>请确保你调用了</c>
<c.magenta>finishTransaction方法</c>

00:21:01.862 --> 00:21:03.430 align:middle line:90%,end
<c.magenta>且传入了该交易对象</c>

00:21:03.764 --> 00:21:04.731 align:middle line:90%,end
<c.magenta>然后就是在你应用的某处</c>

00:21:04.831 --> 00:21:06.633 align:middle line:90%,end
<c.magenta>有个恢复按钮</c>
<c.magenta>可以让用户</c>

00:21:06.700 --> 00:21:09.837 align:middle line:90%,end
<c.magenta>在设备上恢复已完成的交易</c>

00:21:10.871 --> 00:21:14.441 align:middle line:90%,end
<c.magenta>这就是关于实现</c>
<c.magenta>程序内购买及其过程的内容</c>

00:21:14.908 --> 00:21:16.143 align:middle line:90%,end
<c.magenta>接下来 我们要讨论下</c>

00:21:16.410 --> 00:21:20.013 align:middle line:90%,end
<c.magenta>在App Store应用中</c>
<c.magenta>直接推广程序内购买的新功能</c>

00:21:20.147 --> 00:21:21.215 align:middle line:90%,end
<c.magenta>为了介绍关于这方面的更多内容</c>

00:21:21.281 --> 00:21:23.350 align:middle line:90%,end
<c.magenta>我想有请Ross LeBeau</c>
<c.magenta>上台来给你们介绍一下</c>

00:21:33.460 --> 00:21:36.430 align:middle line:90%,end
<c.magenta>大家好 我叫Ross</c>
<c.magenta>是App Store团队的工程师</c>

00:21:37.164 --> 00:21:40.434 align:middle line:90%,end
<c.magenta>我很激动今天能给你们介绍一下</c>
<c.magenta>App Store新特性</c>

00:21:41.368 --> 00:21:43.036 align:middle line:90%,end
<c.magenta>这就是推广程序内购买</c>

00:21:43.504 --> 00:21:45.205 align:middle line:90%,end
<c.magenta>它可以让你有更广泛的受众</c>

00:21:45.272 --> 00:21:46.673 align:middle line:90%,end
<c.magenta>让更多人知道你的应用</c>
<c.magenta>提供了什么功能</c>

00:21:49.176 --> 00:21:52.045 align:middle line:90%,end
<c.magenta>在今天以前</c>
<c.magenta>如果用户没有积极地使用过你的应用</c>

00:21:52.446 --> 00:21:54.214 align:middle line:90%,end
<c.magenta>你的程序内购买就很难被找到</c>

00:21:55.516 --> 00:21:57.251 align:middle line:90%,end
<c.magenta>但是从iOS 11开始</c>

00:21:57.317 --> 00:21:59.953 align:middle line:90%,end
<c.magenta>你的程序内购买可直接</c>
<c.magenta>在App Store中被找到</c>

00:22:00.854 --> 00:22:02.155 align:middle line:90%,end
<c.magenta>它们可以在你的应用页面中被看到</c>

00:22:03.223 --> 00:22:04.958 align:middle line:90%,end
<c.magenta>它们可以被编辑功能选用</c>

00:22:05.726 --> 00:22:07.461 align:middle line:90%,end
<c.magenta>它们甚至还可以出现在搜索结果中</c>

00:22:08.695 --> 00:22:09.530 align:middle line:90%,end
<c.magenta>不仅如此</c>

00:22:09.863 --> 00:22:12.966 align:middle line:90%,end
<c.magenta>用户还可以直接从</c>
<c.magenta>App Store开始购买</c>

00:22:14.468 --> 00:22:17.538 align:middle line:90%,end
<c.magenta>我们觉得这对于用户如何浏览</c>
<c.magenta>你的程序内购买 是巨大的改进</c>

00:22:19.673 --> 00:22:20.807 align:middle line:90%,end
<c.magenta>它是如何运作的呢？</c>

00:22:21.675 --> 00:22:23.977 align:middle line:90%,end
<c.magenta>推广你的程序内购买是很容易的</c>

00:22:24.378 --> 00:22:25.846 align:middle line:90%,end
<c.magenta>你只需要做两件事</c>

00:22:26.980 --> 00:22:30.784 align:middle line:90%,end
<c.magenta>首先 对于每个应用选择最多</c>
<c.magenta>20个程序内购买来推广</c>

00:22:31.018 --> 00:22:33.554 align:middle line:90%,end
<c.magenta>并且在iTunes Connect中</c>
<c.magenta>为它们设置相应的图片</c>

00:22:34.454 --> 00:22:36.823 align:middle line:90%,end
<c.magenta>然后 在你的应用中</c>
<c.magenta>实现一个单一代理方法</c>

00:22:37.024 --> 00:22:39.259 align:middle line:90%,end
<c.magenta>来处理从App Store</c>
<c.magenta>发给你的购买信息</c>

00:22:40.027 --> 00:22:43.230 align:middle line:90%,end
<c.magenta>在大多数情况下</c>
<c.magenta>你只需要一行代码就能实现</c>

00:22:43.297 --> 00:22:45.532 align:middle line:90%,end
<c.magenta>StoreKit会为你处理</c>
<c.magenta>交易剩下的操作</c>

00:22:47.134 --> 00:22:47.968 align:middle line:90%,end
<c.magenta>而且</c>

00:22:49.436 --> 00:22:50.304 align:middle line:90%,end
<c.magenta>如果你需要的话</c>

00:22:51.538 --> 00:22:55.075 align:middle line:90%,end
<c.magenta>你可以在本地重写</c>
<c.magenta>它们出现的顺序和可见性</c>

00:22:56.043 --> 00:22:59.112 align:middle line:90%,end
<c.magenta>这不是必须的操作</c>
<c.magenta>但是它在很多情况下都挺有用</c>

00:23:01.181 --> 00:23:02.316 align:middle line:90%,end
<c.magenta>我们已经介绍了很多关于</c>

00:23:02.382 --> 00:23:03.984 align:middle line:90%,end
<c.magenta>如何设置</c>
<c.magenta>iTunes Connect的内容</c>

00:23:04.051 --> 00:23:05.886 align:middle line:90%,end
<c.magenta>在“iTunes Connect</c>
<c.magenta>新特性”这场演讲中</c>

00:23:06.119 --> 00:23:08.822 align:middle line:90%,end
<c.magenta>这场演讲是昨天举办的</c>
<c.magenta>如果你错过了 可以去网上看一下</c>

00:23:09.323 --> 00:23:12.693 align:middle line:90%,end
<c.magenta>现在让我们看下如何处理你的交易信息</c>

00:23:12.759 --> 00:23:14.094 align:middle line:90%,end
<c.magenta>它从App Store送到你手中时</c>

00:23:17.331 --> 00:23:20.767 align:middle line:90%,end
<c.magenta>有个用户在App Store中</c>
<c.magenta>点击了购买你的程序内购买</c>

00:23:22.069 --> 00:23:23.971 align:middle line:90%,end
<c.magenta>StoreKit</c>
<c.magenta>会自动打开你的应用</c>

00:23:24.304 --> 00:23:26.406 align:middle line:90%,end
<c.magenta>并且将有关此次交易的信息发送给你</c>

00:23:26.673 --> 00:23:30.410 align:middle line:90%,end
<c.magenta>通过SKPaymentTransaction</c>
<c.magenta>观察者协议上的一个新代理方法</c>

00:23:30.944 --> 00:23:33.180 align:middle line:90%,end
<c.magenta>而且你已经有了一个</c>
<c.magenta>用来实现此协议的对象</c>

00:23:33.247 --> 00:23:36.517 align:middle line:90%,end
<c.magenta>该对象可以观察交易状态</c>
<c.magenta>就像Pete刚才所讲的那样</c>

00:23:37.618 --> 00:23:39.786 align:middle line:90%,end
<c.magenta>你可以将用来推广程序内购买的新代码</c>

00:23:39.853 --> 00:23:41.355 align:middle line:90%,end
<c.magenta>放到你已有的代码旁边</c>

00:23:43.156 --> 00:23:45.692 align:middle line:90%,end
<c.magenta>还有个好消息是</c>
<c.magenta>如果你的应用还没有被安装过</c>

00:23:46.760 --> 00:23:49.263 align:middle line:90%,end
<c.magenta>App Store会下载你的应用</c>
<c.magenta>或让用户购买它</c>

00:23:49.863 --> 00:23:51.598 align:middle line:90%,end
<c.magenta>在本例中 它不会自动被打开</c>

00:23:51.665 --> 00:23:54.134 align:middle line:90%,end
<c.magenta>所以用户会收到一条通知</c>

00:23:54.468 --> 00:23:55.536 align:middle line:90%,end
<c.magenta>当他们点击了通知时</c>
<c.magenta>交易信息就会被发送到你的应用中</c>

00:24:01.208 --> 00:24:02.409 align:middle line:90%,end
<c.magenta>代码是什么样的呢？</c>

00:24:05.279 --> 00:24:08.348 align:middle line:90%,end
<c.magenta>这就是所有你需要</c>
<c.magenta>开始推广程序内购买的代码了</c>

00:24:09.583 --> 00:24:13.420 align:middle line:90%,end
<c.magenta>StoreKit会发送给你SKPayment队列</c>
<c.magenta>SKPayment 还有SKProduct</c>

00:24:13.554 --> 00:24:15.355 align:middle line:90%,end
<c.magenta>也就是所有你处理交易要用的工具</c>

00:24:15.756 --> 00:24:18.292 align:middle line:90%,end
<c.magenta>而且SKPayment已经设置好了</c>
<c.magenta>SKProduct</c>

00:24:19.826 --> 00:24:20.794 align:middle line:90%,end
<c.magenta>当你返回真的时候</c>

00:24:21.628 --> 00:24:24.331 align:middle line:90%,end
<c.magenta>就会给用户显示一个很漂亮的</c>
<c.magenta>新程序内购买支付表单</c>

00:24:24.698 --> 00:24:26.066 align:middle line:90%,end
<c.magenta>他们可以通过表单来完成交易</c>

00:24:26.266 --> 00:24:27.701 align:middle line:90%,end
<c.magenta>这就是所有要做的内容了</c>
<c.magenta>我们都完成了</c>

00:24:27.901 --> 00:24:28.836 align:middle line:90%,end
<c.magenta>已经可以用这个功能了</c>

00:24:30.604 --> 00:24:33.240 align:middle line:90%,end
<c.magenta>如果用户是处于某种中间状态呢？</c>

00:24:33.841 --> 00:24:34.708 align:middle line:90%,end
<c.magenta>如果他们正在创建账户呢？</c>

00:24:34.775 --> 00:24:37.344 align:middle line:90%,end
<c.magenta>如果他们已经解锁了</c>
<c.magenta>他们想要购买的项目呢？</c>

00:24:39.980 --> 00:24:43.283 align:middle line:90%,end
<c.magenta>如果是这样 你可以先暂停支付过程</c>
<c.magenta>并返回假</c>

00:24:44.351 --> 00:24:47.087 align:middle line:90%,end
<c.magenta>然后当用户准备好了</c>
<c.magenta>或是干完了要做的事情之后</c>

00:24:47.855 --> 00:24:49.223 align:middle line:90%,end
<c.magenta>你就只需将支付添加到支付队列中</c>

00:24:49.289 --> 00:24:51.191 align:middle line:90%,end
<c.magenta>就像是对待普通的程序内购买那样</c>

00:24:52.226 --> 00:24:53.927 align:middle line:90%,end
<c.magenta>重要的是你要添加的</c>
<c.magenta>SKPayment</c>

00:24:53.994 --> 00:24:55.362 align:middle line:90%,end
<c.magenta>是在这个代理方法中发送给你的</c>

00:24:55.429 --> 00:24:57.364 align:middle line:90%,end
<c.magenta>而不是为相同的产品再创建一个新的</c>
<c.magenta>SKPayment</c>

00:24:58.699 --> 00:25:01.168 align:middle line:90%,end
<c.magenta>如果出于某种原因</c>
<c.magenta>你需要完全取消此交易</c>

00:24:58.699 --> 00:25:01.168 align:middle line:90%,end
<c.magenta>如果出于某种原因</c>
<c.magenta>你需要完全取消此交易</c>

00:25:01.768 --> 00:25:04.004 align:middle line:90%,end
<c.magenta>只需要返回假就可以了</c>
<c.magenta>不需要再进行任何操作</c>

00:25:06.406 --> 00:25:08.542 align:middle line:90%,end
<c.magenta>如果你要取消或者延迟某个支付</c>

00:25:08.909 --> 00:25:11.411 align:middle line:90%,end
<c.magenta>你应该通过某种方式让用户知道</c>

00:25:12.145 --> 00:25:12.980 align:middle line:90%,end
<c.magenta>你最好不要让这种情况发生</c>

00:25:13.046 --> 00:25:15.749 align:middle line:90%,end
<c.magenta>就是用户点击了</c>
<c.magenta>App Store中的程序内购买</c>

00:25:16.183 --> 00:25:17.985 align:middle line:90%,end
<c.magenta>来购买你的应用 然后什么都没发生</c>

00:25:18.752 --> 00:25:20.954 align:middle line:90%,end
<c.magenta>他们会认为这是个错误 那可不太好</c>

00:25:24.024 --> 00:25:27.327 align:middle line:90%,end
<c.magenta>现在你已经把这些内容都设置好了</c>
<c.magenta>你会测试一下 对吧</c>

00:25:28.595 --> 00:25:31.198 align:middle line:90%,end
<c.magenta>你的程序内购买</c>
<c.magenta>不会出现在App store中</c>

00:25:31.298 --> 00:25:34.835 align:middle line:90%,end
<c.magenta>直到你提交了一个</c>
<c.magenta>具有此代理方法的二进制</c>

00:25:34.902 --> 00:25:37.070 align:middle line:90%,end
<c.magenta>这样我们就知道你可以处理交易了</c>

00:25:38.572 --> 00:25:41.341 align:middle line:90%,end
<c.magenta>我们创建了一个</c>
<c.magenta>系统URL来供你们使用</c>

00:25:42.476 --> 00:25:45.913 align:middle line:90%,end
<c.magenta>这个URL具有ITMS业务协议</c>
<c.magenta>还有三个参数</c>

00:25:46.480 --> 00:25:49.283 align:middle line:90%,end
<c.magenta>第一个参数是动作</c>
<c.magenta>它一直都是以购买为目的</c>

00:25:50.317 --> 00:25:51.451 align:middle line:90%,end
<c.magenta>第二个参数是bundleID</c>

00:25:51.518 --> 00:25:53.387 align:middle line:90%,end
<c.magenta>也就是你应用的bundleID</c>

00:25:54.521 --> 00:25:55.856 align:middle line:90%,end
<c.magenta>最后一个参数是产品标识符</c>

00:25:55.923 --> 00:25:57.791 align:middle line:90%,end
<c.magenta>你所填入的就是产品标识符</c>

00:25:57.858 --> 00:25:59.493 align:middle line:90%,end
<c.magenta>也就是你想测试的</c>
<c.magenta>程序内购买的产品标识符</c>

00:26:01.461 --> 00:26:03.430 align:middle line:90%,end
<c.magenta>在你像这样构建了这个URL之后</c>

00:26:03.897 --> 00:26:05.933 align:middle line:90%,end
<c.magenta>你可以将它发送自己</c>
<c.magenta>用iMessage</c>

00:26:06.366 --> 00:26:08.802 align:middle line:90%,end
<c.magenta>电子邮件 或是在设备上点击它都可以</c>

00:26:09.870 --> 00:26:12.406 align:middle line:90%,end
<c.magenta>你能知道它是正常工作的</c>
<c.magenta>因为你的应用会自动打开</c>

00:26:13.240 --> 00:26:14.741 align:middle line:90%,end
<c.magenta>然后你就可以从这开始测试了</c>

00:26:19.012 --> 00:26:21.748 align:middle line:90%,end
<c.magenta>现在我们已经介绍了如何处理支付信息</c>

00:26:21.815 --> 00:26:23.016 align:middle line:90%,end
<c.magenta>当它被从App Store中</c>
<c.magenta>发给你时</c>

00:26:24.284 --> 00:26:25.886 align:middle line:90%,end
<c.magenta>让我们来看下更高级的设置</c>

00:26:28.455 --> 00:26:31.225 align:middle line:90%,end
<c.magenta>当你在iTunes Connect中</c>
<c.magenta>设置推广程序内购买时</c>

00:26:31.792 --> 00:26:35.629 align:middle line:90%,end
<c.magenta>你可以选择它们</c>
<c.magenta>出现在你应用页面的默认顺序</c>

00:26:36.129 --> 00:26:38.031 align:middle line:90%,end
<c.magenta>你还可以选择隐藏其中某些推广</c>

00:26:38.098 --> 00:26:39.233 align:middle line:90%,end
<c.magenta>这样它们就根本不会显示了</c>

00:26:40.400 --> 00:26:42.236 align:middle line:90%,end
<c.magenta>然后当你的应用在设备上运行的时候</c>

00:26:43.270 --> 00:26:46.640 align:middle line:90%,end
<c.magenta>你可以在本地重写这些内容</c>
<c.magenta>来改变可视性的顺序</c>

00:26:47.875 --> 00:26:51.044 align:middle line:90%,end
<c.magenta>例如 如果你在开发一个竞速游戏</c>

00:26:51.111 --> 00:26:52.946 align:middle line:90%,end
<c.magenta>你可能会隐藏某辆车</c>
<c.magenta>将其作为程序内购买</c>

00:26:53.013 --> 00:26:54.982 align:middle line:90%,end
<c.magenta>直到用户解锁了这辆车才显示</c>

00:26:56.016 --> 00:26:56.917 align:middle line:90%,end
<c.magenta>而当他们确实买了这辆车时</c>

00:26:58.285 --> 00:27:02.122 align:middle line:90%,end
<c.magenta>你可以把这个程序内购买移到</c>
<c.magenta>列表的最上面 并且取消对它的隐藏</c>

00:26:58.285 --> 00:27:02.122 align:middle line:90%,end
<c.magenta>你可以把这个程序内购买移到</c>
<c.magenta>列表的最上面 并且取消对它的隐藏</c>

00:27:02.756 --> 00:27:03.991 align:middle line:90%,end
<c.magenta>这样他们就解锁了这辆车</c>

00:27:04.324 --> 00:27:06.326 align:middle line:90%,end
<c.magenta>现在他们就可以看到</c>
<c.magenta>有最大关系的程序内购买</c>

00:27:06.426 --> 00:27:07.461 align:middle line:90%,end
<c.magenta>出现在了列表的前面</c>

00:27:09.162 --> 00:27:11.632 align:middle line:90%,end
<c.magenta>你要知道的是</c>
<c.magenta>它们是不会跨设备同步的</c>

00:27:11.698 --> 00:27:13.267 align:middle line:90%,end
<c.magenta>它们被本地保存在每台设备上</c>

00:27:15.836 --> 00:27:17.938 align:middle line:90%,end
<c.magenta>所以如果你需要复制相同的行为</c>

00:27:18.138 --> 00:27:21.408 align:middle line:90%,end
<c.magenta>你应该确保你的应用</c>
<c.magenta>可以本地复制这些结果</c>

00:27:24.545 --> 00:27:27.080 align:middle line:90%,end
<c.magenta>让我们看些实际的例子吧</c>

00:27:29.850 --> 00:27:31.818 align:middle line:90%,end
<c.magenta>这里我们有个叫作</c>
<c.magenta>Forest Explorer的应用</c>

00:27:32.386 --> 00:27:33.453 align:middle line:90%,end
<c.magenta>我们开发了这个应用</c>

00:27:33.520 --> 00:27:38.091 align:middle line:90%,end
<c.magenta>来帮助人们探索并到目的地去旅行</c>

00:27:40.394 --> 00:27:41.695 align:middle line:90%,end
<c.magenta>这个应用不存在于App Store</c>

00:27:41.762 --> 00:27:42.930 align:middle line:90%,end
<c.magenta>它仅为这次演示而开发</c>

00:27:43.864 --> 00:27:45.732 align:middle line:90%,end
<c.magenta>这里我们要推广三个程序内购买</c>

00:27:45.799 --> 00:27:47.067 align:middle line:90%,end
<c.magenta>我们有专业版订阅</c>

00:27:47.267 --> 00:27:49.269 align:middle line:90%,end
<c.magenta>它会升级用户能看到的细致程度</c>

00:27:49.336 --> 00:27:50.370 align:middle line:90%,end
<c.magenta>地图 还有路线</c>

00:27:51.138 --> 00:27:54.007 align:middle line:90%,end
<c.magenta>我们还有钓鱼热点 和隐藏的沙滩包</c>

00:27:54.208 --> 00:27:57.144 align:middle line:90%,end
<c.magenta>它会解锁更多相关主题的路线</c>

00:27:59.546 --> 00:28:01.114 align:middle line:90%,end
<c.magenta>你可能想实现这个功能</c>

00:27:59.546 --> 00:28:01.114 align:middle line:90%,end
<c.magenta>你可能想实现这个功能</c>

00:28:01.281 --> 00:28:04.151 align:middle line:90%,end
<c.magenta>比如说某个用户已经购买了</c>
<c.magenta>专业版订阅程序内购买</c>

00:28:05.052 --> 00:28:06.854 align:middle line:90%,end
<c.magenta>你要将这个程序内购买</c>
<c.magenta>在应用页面上隐藏</c>

00:28:07.054 --> 00:28:10.157 align:middle line:90%,end
<c.magenta>StoreKit或是App Store</c>
<c.magenta>不会自动实现这一功能</c>

00:28:10.724 --> 00:28:12.860 align:middle line:90%,end
<c.magenta>如果他们购买了这个程序内购买</c>
<c.magenta>然后进入App Store</c>

00:28:12.926 --> 00:28:14.494 align:middle line:90%,end
<c.magenta>他们还是会在你的列表中看到它</c>

00:28:15.229 --> 00:28:16.263 align:middle line:90%,end
<c.magenta>这可能不太合情理</c>

00:28:16.330 --> 00:28:17.464 align:middle line:90%,end
<c.magenta>因为他们不能再买一次了</c>

00:28:18.599 --> 00:28:21.034 align:middle line:90%,end
<c.magenta>你可以使用本地可视化</c>

00:28:21.101 --> 00:28:24.271 align:middle line:90%,end
<c.magenta>重写来隐藏这个程序内购买</c>

00:28:24.338 --> 00:28:27.107 align:middle line:90%,end
<c.magenta>然后他们就只能在你的应用页面中</c>
<c.magenta>看到跟他们有关的项目了</c>

00:28:29.877 --> 00:28:31.144 align:middle line:90%,end
<c.magenta>该功能的代码是什么样的呢？</c>

00:28:34.815 --> 00:28:38.552 align:middle line:90%,end
<c.magenta>就像是这样 首先</c>
<c.magenta>你要获取SKProduct</c>

00:28:38.619 --> 00:28:40.754 align:middle line:90%,end
<c.magenta>这样你就从服务器获得了最新的信息</c>

00:28:41.255 --> 00:28:43.957 align:middle line:90%,end
<c.magenta>这里我们要获取的是关于</c>
<c.magenta>专业版订阅程序内购买的信息</c>

00:28:45.626 --> 00:28:49.363 align:middle line:90%,end
<c.magenta>然后 我们有个新的</c>
<c.magenta>用来处理这些本地重写的类</c>

00:28:49.429 --> 00:28:51.965 align:middle line:90%,end
<c.magenta>叫作</c>
<c.magenta>SKProductStorePromotionController</c>

00:28:52.900 --> 00:28:54.468 align:middle line:90%,end
<c.magenta>你要获取默认的控制器</c>

00:28:56.136 --> 00:28:57.504 align:middle line:90%,end
<c.magenta>然后将你的SKProduct传到</c>

00:28:57.571 --> 00:29:00.474 align:middle line:90%,end
<c.magenta>updateStorePromotionVisibility</c>
<c.magenta>ForProduct方法中</c>

00:28:57.571 --> 00:29:00.474 align:middle line:90%,end
<c.magenta>updateStorePromotionVisibility</c>
<c.magenta>ForProduct方法中</c>

00:29:00.908 --> 00:29:02.776 align:middle line:90%,end
<c.magenta>还有你想设置的新可视性</c>

00:29:03.510 --> 00:29:05.179 align:middle line:90%,end
<c.magenta>这里我们想将专业版订阅进行隐藏</c>

00:29:05.245 --> 00:29:06.547 align:middle line:90%,end
<c.magenta>因为用户刚刚买了它</c>

00:29:08.482 --> 00:29:10.050 align:middle line:90%,end
<c.magenta>就是这样了</c>
<c.magenta>这很简单</c>

00:29:11.451 --> 00:29:13.887 align:middle line:90%,end
<c.magenta>如果现在你想看看</c>
<c.magenta>你已经设置了哪些重写</c>

00:29:16.423 --> 00:29:18.325 align:middle line:90%,end
<c.magenta>还是要从获取SKProduct开始</c>

00:29:18.525 --> 00:29:20.093 align:middle line:90%,end
<c.magenta>这里让我们看下隐藏沙滩包</c>

00:29:21.428 --> 00:29:23.764 align:middle line:90%,end
<c.magenta>把它传到fetch</c>
<c.magenta>StorePromotionVisibility</c>

00:29:23.830 --> 00:29:24.831 align:middle line:90%,end
<c.magenta>forProduct这个方法中</c>

00:29:25.832 --> 00:29:28.836 align:middle line:90%,end
<c.magenta>我们可以发现 可视化被默认实现了</c>

00:29:29.136 --> 00:29:31.138 align:middle line:90%,end
<c.magenta>这是因为我们还没有设置任何的重写</c>

00:29:31.738 --> 00:29:33.507 align:middle line:90%,end
<c.magenta>这就意味着 它会隐藏或是显示</c>

00:29:33.574 --> 00:29:35.909 align:middle line:90%,end
<c.magenta>取决于你在iTunes Connect</c>
<c.magenta>上的默认设置</c>

00:29:39.780 --> 00:29:42.282 align:middle line:90%,end
<c.magenta>我们已经介绍了重写可视性</c>

00:29:42.616 --> 00:29:43.717 align:middle line:90%,end
<c.magenta>改变下顺序怎么样</c>

00:29:43.784 --> 00:29:45.819 align:middle line:90%,end
<c.magenta>就是改变下你的程序内购买</c>
<c.magenta>出现在应用页面上的顺序</c>

00:29:47.821 --> 00:29:49.323 align:middle line:90%,end
<c.magenta>让我们回到</c>
<c.magenta>Forest Explorer</c>

00:29:51.225 --> 00:29:53.527 align:middle line:90%,end
<c.magenta>你可能一直在看你的调查数据</c>

00:29:53.594 --> 00:29:56.363 align:middle line:90%,end
<c.magenta>就会发现用户会去很多的沙滩</c>

00:29:57.431 --> 00:29:59.132 align:middle line:90%,end
<c.magenta>这时候就可以把隐藏的沙滩移</c>

00:29:59.199 --> 00:30:02.569 align:middle line:90%,end
<c.magenta>回列表的前面</c>
<c.magenta>这样他们就更有可能看到它了</c>

00:29:59.199 --> 00:30:02.569 align:middle line:90%,end
<c.magenta>回列表的前面</c>
<c.magenta>这样他们就更有可能看到它了</c>

00:30:03.036 --> 00:30:04.905 align:middle line:90%,end
<c.magenta>由于这是些他们感兴趣的东西</c>

00:30:04.972 --> 00:30:06.106 align:middle line:90%,end
<c.magenta>他们可能会买它</c>

00:30:10.444 --> 00:30:14.281 align:middle line:90%,end
<c.magenta>它的代码看起来和</c>
<c.magenta>更新可视化重写的代码很相似</c>

00:30:15.449 --> 00:30:18.886 align:middle line:90%,end
<c.magenta>你要为每个想要重写的</c>
<c.magenta>程序内购买获取SKProduct</c>

00:30:18.952 --> 00:30:20.521 align:middle line:90%,end
<c.magenta>你想重写的是顺序</c>
<c.magenta>这里我们会重写全部三个</c>

00:30:20.587 --> 00:30:23.824 align:middle line:90%,end
<c.magenta>我们会重写专业版订阅</c>
<c.magenta>钓鱼热点 还有隐藏的沙滩</c>

00:30:24.858 --> 00:30:27.895 align:middle line:90%,end
<c.magenta>然后创建一个</c>
<c.magenta>包含这些程序内购买的数组</c>

00:30:27.961 --> 00:30:30.163 align:middle line:90%,end
<c.magenta>其顺序就是你想将它们重写的顺序</c>

00:30:30.631 --> 00:30:32.099 align:middle line:90%,end
<c.magenta>我要把隐藏的沙滩移到最前面</c>

00:30:33.800 --> 00:30:37.404 align:middle line:90%,end
<c.magenta>最后把这个数组传到</c>
<c.magenta>updateStorePromotionOrder方法中</c>

00:30:38.872 --> 00:30:40.107 align:middle line:90%,end
<c.magenta>这样就可以了 已经更新好了</c>

00:30:42.843 --> 00:30:45.179 align:middle line:90%,end
<c.magenta>现在如果我们想看下已经设置好的重写</c>

00:30:46.213 --> 00:30:47.514 align:middle line:90%,end
<c.magenta>这也是非常类似的</c>

00:30:48.448 --> 00:30:50.384 align:middle line:90%,end
<c.magenta>你要获取storePromotionController</c>

00:30:50.651 --> 00:30:52.719 align:middle line:90%,end
<c.magenta>还要使用</c>
<c.magenta>fetchStorePromotionalOrder方法</c>

00:30:54.388 --> 00:30:58.192 align:middle line:90%,end
<c.magenta>这样我们就有了一个数组</c>
<c.magenta>隐藏的沙滩是在最前面的</c>

00:30:58.258 --> 00:30:59.793 align:middle line:90%,end
<c.magenta>因为我们刚刚设置了它的重写</c>

00:31:01.828 --> 00:31:04.865 align:middle line:90%,end
<c.magenta>你不需要用到数组中的每个程序内购买</c>

00:31:04.932 --> 00:31:06.233 align:middle line:90%,end
<c.magenta>在你设置重写的时候</c>

00:31:06.333 --> 00:31:08.335 align:middle line:90%,end
<c.magenta>你可以随意使用它们的子集</c>

00:31:09.002 --> 00:31:12.906 align:middle line:90%,end
<c.magenta>如果你这么做的话</c>
<c.magenta>该子集就会出现在列表的最前面</c>

00:31:13.674 --> 00:31:15.742 align:middle line:90%,end
<c.magenta>以你表述重写的顺序进行排列</c>

00:31:16.176 --> 00:31:19.146 align:middle line:90%,end
<c.magenta>你剩下的程序内购买会出现在它们后面</c>

00:31:19.213 --> 00:31:21.448 align:middle line:90%,end
<c.magenta>跟你在iTunes Connect中</c>
<c.magenta>设置的顺序一样</c>

00:31:23.116 --> 00:31:25.319 align:middle line:90%,end
<c.magenta>你还可以从这个方法接收一个空数组</c>

00:31:25.719 --> 00:31:28.255 align:middle line:90%,end
<c.magenta>这就意味着</c>
<c.magenta>你根本没有设置任何的顺序重写</c>

00:31:29.022 --> 00:31:32.726 align:middle line:90%,end
<c.magenta>同样地</c>
<c.magenta>你可以将一个空数组传入更新方法中</c>

00:31:32.926 --> 00:31:35.963 align:middle line:90%,end
<c.magenta>这就相当于取消了所有的重写</c>

00:31:36.363 --> 00:31:39.466 align:middle line:90%,end
<c.magenta>你可以将其看成是用了个重写的空集</c>

00:31:42.703 --> 00:31:45.272 align:middle line:90%,end
<c.magenta>这就是用于推广程序内购买的所有代码</c>

00:31:46.139 --> 00:31:49.309 align:middle line:90%,end
<c.magenta>新的代理方法和</c>
<c.magenta>测试URL现在就已经可用了</c>

00:31:49.376 --> 00:31:51.478 align:middle line:90%,end
<c.magenta>它们就在我们本周早些时候</c>
<c.magenta>发出的Seed中</c>

00:31:52.880 --> 00:31:55.883 align:middle line:90%,end
<c.magenta>而顺序和可视性重写</c>
<c.magenta>会在后面的Seed中可用</c>

00:31:59.019 --> 00:32:00.888 align:middle line:90%,end
<c.magenta>总结下推广程序内购买</c>

00:31:59.019 --> 00:32:00.888 align:middle line:90%,end
<c.magenta>总结下推广程序内购买</c>

00:32:02.289 --> 00:32:03.657 align:middle line:90%,end
<c.magenta>它可以让程序内购买更容易被找到</c>

00:32:03.724 --> 00:32:05.025 align:middle line:90%,end
<c.magenta>通过将它们推广到</c>
<c.magenta>App Store中</c>

00:32:06.293 --> 00:32:08.428 align:middle line:90%,end
<c.magenta>你可以为每个应用选择最多20</c>
<c.magenta>个进行推广</c>

00:32:08.495 --> 00:32:09.897 align:middle line:90%,end
<c.magenta>并在iTunes Connect中对它们进行设置</c>

00:32:11.265 --> 00:32:14.568 align:middle line:90%,end
<c.magenta>然后用户就可在App Store中</c>
<c.magenta>点击来进行购买</c>

00:32:16.637 --> 00:32:18.639 align:middle line:90%,end
<c.magenta>交易信息会被送到你的应用中</c>

00:32:18.705 --> 00:32:21.308 align:middle line:90%,end
<c.magenta>在它通过新的代理方法自动打开的时候</c>

00:32:21.375 --> 00:32:23.844 align:middle line:90%,end
<c.magenta>这些都发生在SKPayment</c>
<c.magenta>的交易观察者协议上</c>

00:32:25.646 --> 00:32:29.149 align:middle line:90%,end
<c.magenta>最后 如果你想的话 你可以重写</c>

00:32:29.216 --> 00:32:32.186 align:middle line:90%,end
<c.magenta>它们出现在应用页面上的顺序和可视性</c>
<c.magenta>这会在运行时间本地完成</c>

00:32:33.453 --> 00:32:34.488 align:middle line:90%,end
<c.magenta>我很激动地想看看</c>

00:32:34.555 --> 00:32:36.657 align:middle line:90%,end
<c.magenta>你们所有人会如何在应用中</c>
<c.magenta>使用推广程序内购买</c>

00:32:37.191 --> 00:32:39.193 align:middle line:90%,end
<c.magenta>不过现在我还是将讲台交回给Pete</c>
<c.magenta>他将介绍更多关于用户评论的内容</c>

00:32:48.068 --> 00:32:51.738 align:middle line:90%,end
<c.magenta>谢谢 Ross 我迫不及待想试试</c>
<c.magenta>Forest Explorer了</c>

00:32:51.805 --> 00:32:52.840 align:middle line:90%,end
<c.magenta>看似是个不错的应用</c>

00:32:53.674 --> 00:32:56.310 align:middle line:90%,end
<c.magenta>现在我们已经介绍了</c>
<c.magenta>一些关于实现程序内购买</c>

00:32:56.376 --> 00:32:58.011 align:middle line:90%,end
<c.magenta>以及如何在App Store中</c>
<c.magenta>推广它们的内容</c>

00:32:58.278 --> 00:33:01.281 align:middle line:90%,end
<c.magenta>让我们看下你可以用来跟</c>
<c.magenta>用户交流的一些方式</c>

00:32:58.278 --> 00:33:01.281 align:middle line:90%,end
<c.magenta>让我们看下你可以用来跟</c>
<c.magenta>用户交流的一些方式</c>

00:33:02.549 --> 00:33:05.586 align:middle line:90%,end
<c.magenta>在iOS 11中 我们有了这个</c>
<c.magenta>看似非常棒的App Store设计</c>

00:33:06.186 --> 00:33:07.187 align:middle line:90%,end
<c.magenta>这是个产品页面</c>

00:33:07.254 --> 00:33:11.358 align:middle line:90%,end
<c.magenta>如果你向下滚动产品页面</c>
<c.magenta>就会看到这个新的评分和评分区域</c>

00:33:11.425 --> 00:33:13.327 align:middle line:90%,end
<c.magenta>这里有个统一的评分</c>

00:33:13.794 --> 00:33:16.530 align:middle line:90%,end
<c.magenta>用户可以滑动来切换不同的评论</c>

00:33:16.730 --> 00:33:20.534 align:middle line:90%,end
<c.magenta>这样就可以阅读关于你</c>
<c.magenta>应用用户体验的信息</c>

00:33:20.667 --> 00:33:21.902 align:middle line:90%,end
<c.magenta>这里有什么新东西呢？</c>

00:33:21.969 --> 00:33:23.904 align:middle line:90%,end
<c.magenta>我们在这有一些新功能要介绍</c>

00:33:23.971 --> 00:33:27.341 align:middle line:90%,end
<c.magenta>首先第一个 就是你现在可以选择</c>
<c.magenta>你想让评分重置的时间</c>

00:33:27.541 --> 00:33:28.876 align:middle line:90%,end
<c.magenta>当你发布应用的时候</c>

00:33:28.942 --> 00:33:30.844 align:middle line:90%,end
<c.magenta>你可以选择要不要重置评分</c>

00:33:30.911 --> 00:33:33.914 align:middle line:90%,end
<c.magenta>在原来 这样做会每次都重置你的评分</c>

00:33:33.981 --> 00:33:35.749 align:middle line:90%,end
<c.magenta>而现在就完全取决于你了</c>
<c.magenta>不错吧</c>

00:33:40.554 --> 00:33:42.523 align:middle line:90%,end
<c.magenta>我们最近还加入了可以让你</c>

00:33:42.589 --> 00:33:44.157 align:middle line:90%,end
<c.magenta>在App Store中</c>
<c.magenta>回复评论的功能</c>

00:33:44.224 --> 00:33:46.727 align:middle line:90%,end
<c.magenta>现在你就可以和用户进行对话了</c>

00:33:47.561 --> 00:33:49.897 align:middle line:90%,end
<c.magenta>还有些新的方法让你请求评分和评论</c>

00:33:49.963 --> 00:33:52.065 align:middle line:90%,end
<c.magenta>它是通过SKStoreReviewController</c>
<c.magenta>实现的</c>

00:33:52.833 --> 00:33:56.270 align:middle line:90%,end
<c.magenta>最后就是 我们在iOS 10.3中</c>
<c.magenta>加入了一个新的深度链接</c>

00:33:56.336 --> 00:33:59.273 align:middle line:90%,end
<c.magenta>打开该链接就可以直接在</c>
<c.magenta>App Store中写评论</c>

00:34:00.507 --> 00:34:04.478 align:middle line:90%,end
<c.magenta>我们还在iOS中加入了</c>
<c.magenta>帮助和报告担心的问题</c>

00:34:04.745 --> 00:34:05.746 align:middle line:90%,end
<c.magenta>这看起来是什么样呢？</c>

00:34:06.013 --> 00:34:09.049 align:middle line:90%,end
<c.magenta>现在用户可以在评论上</c>
<c.magenta>使用3D Touch</c>

00:34:09.116 --> 00:34:12.052 align:middle line:90%,end
<c.magenta>这样他们就可以看到</c>
<c.magenta>这个有帮助或是没有帮助菜单</c>

00:34:12.119 --> 00:34:13.920 align:middle line:90%,end
<c.magenta>他们可将其标记为有帮助</c>
<c.magenta>或没帮助的</c>

00:34:13.987 --> 00:34:17.024 align:middle line:90%,end
<c.magenta>他们甚至可以直接在iOS 应用中</c>
<c.magenta>报告一个担心的问题</c>

00:34:19.359 --> 00:34:23.197 align:middle line:90%,end
<c.magenta>我们是在iOS 10.3中</c>
<c.magenta>引入反馈评论的</c>

00:34:23.263 --> 00:34:24.864 align:middle line:90%,end
<c.magenta>而这个功能的反响是非常不错的</c>

00:34:25.264 --> 00:34:26.667 align:middle line:90%,end
<c.magenta>我们觉得用户很喜欢该功能</c>

00:34:26.733 --> 00:34:29.536 align:middle line:90%,end
<c.magenta>而且我们看到开发者真的</c>
<c.magenta>很好地运用了这个功能</c>

00:34:29.703 --> 00:34:31.438 align:middle line:90%,end
<c.magenta>当你回复某个用户评论时</c>

00:34:31.505 --> 00:34:33.507 align:middle line:90%,end
<c.magenta>用户会在他们的设备上获得一条通知</c>

00:34:33.574 --> 00:34:35.708 align:middle line:90%,end
<c.magenta>通知他们你有回复了</c>

00:34:36.143 --> 00:34:37.710 align:middle line:90%,end
<c.magenta>他们还会收到一封邮件</c>

00:34:38.011 --> 00:34:40.647 align:middle line:90%,end
<c.magenta>其中详细地写了关于他们评论的回复</c>

00:34:41.114 --> 00:34:42.114 align:middle line:90%,end
<c.magenta>在这封邮件的最下面</c>

00:34:42.181 --> 00:34:43.417 align:middle line:10%
<c.magenta>有一个链接</c>

00:34:43.516 --> 00:34:44.818 align:middle line:10%
<c.magenta>可以让他们更新评论</c>

00:34:44.885 --> 00:34:45.953 align:middle line:10%
<c.magenta>我们给了他们这个机会</c>

00:34:46.018 --> 00:34:47.254 align:middle line:10%
<c.magenta>来点击该链接</c>

00:34:47.454 --> 00:34:49.590 align:middle line:90%,end
<c.magenta>他们就有机会编辑他们的评分</c>

00:34:49.656 --> 00:34:51.525 align:middle line:90%,end
<c.magenta>或者还会更改他们的评论</c>

00:34:52.092 --> 00:34:53.893 align:middle line:90%,end
<c.magenta>并且我们发现在用户这么做的时候</c>

00:34:53.960 --> 00:34:56.597 align:middle line:90%,end
<c.magenta>当他们在收到回复后更新评论的时候</c>

00:34:56.730 --> 00:35:00.434 align:middle line:90%,end
<c.magenta>我们发现评论会平均增加</c>
<c.magenta>1.5星的评分</c>

00:34:56.730 --> 00:35:00.434 align:middle line:90%,end
<c.magenta>我们发现评论会平均增加</c>
<c.magenta>1.5星的评分</c>

00:35:00.701 --> 00:35:04.238 align:middle line:90%,end
<c.magenta>正如你所见</c>
<c.magenta>这是个不错的机会来获得更好的评分</c>

00:35:04.304 --> 00:35:05.806 align:middle line:90%,end
<c.magenta>这会让你的用户获得更棒的体验</c>

00:35:05.873 --> 00:35:08.876 align:middle line:90%,end
<c.magenta>也会让你的应用</c>
<c.magenta>在App Store中获得更好评分</c>

00:35:09.776 --> 00:35:13.380 align:middle line:90%,end
<c.magenta>有关这方面的更多信息</c>
<c.magenta>我们有个在线指南 讲的是</c>

00:35:13.614 --> 00:35:16.750 align:middle line:90%,end
<c.magenta>回复评分 还有跟用户进行交流的</c>
<c.magenta>好方法和技术</c>

00:35:17.184 --> 00:35:18.085 align:middle line:90%,end
<c.magenta>我们也在</c>

00:35:18.151 --> 00:35:19.987 align:middle line:90%,end
<c.magenta>昨天举办的“iTunes Connect</c>
<c.magenta>新特性”这场演讲中提到过相关的内容</c>

00:35:20.053 --> 00:35:22.422 align:middle line:90%,end
<c.magenta>如果你没有去听的话 我建议你们</c>

00:35:22.489 --> 00:35:23.891 align:middle line:90%,end
<c.magenta>去看下那场演讲的视频</c>

00:35:25.826 --> 00:35:27.361 align:middle line:90%,end
<c.magenta>在提到接收评论的时候</c>

00:35:27.427 --> 00:35:29.129 align:middle line:90%,end
<c.magenta>现在你有几种方法可以实现这个功能</c>

00:35:29.196 --> 00:35:33.700 align:middle line:90%,end
<c.magenta>你可以在SKStoreReviewController</c>
<c.magenta>类中提醒用户进行评论</c>

00:35:34.101 --> 00:35:35.302 align:middle line:90%,end
<c.magenta>我们还提供了这个深度链接</c>

00:35:35.369 --> 00:35:37.938 align:middle line:90%,end
<c.magenta>来让你直接在App Store中</c>
<c.magenta>写评论</c>

00:35:38.772 --> 00:35:41.341 align:middle line:90%,end
<c.magenta>首先让我们看下</c>
<c.magenta>SKStoreReviewController</c>

00:35:41.408 --> 00:35:44.211 align:middle line:90%,end
<c.magenta>这是我们在iOS 10.3中</c>
<c.magenta>引入的一个类</c>

00:35:44.278 --> 00:35:46.947 align:middle line:90%,end
<c.magenta>它提供了一个非常简洁美观的界面</c>

00:35:47.014 --> 00:35:49.950 align:middle line:90%,end
<c.magenta>让用户可以不用离开你的应用就能评分</c>

00:35:50.017 --> 00:35:52.352 align:middle line:90%,end
<c.magenta>现在他们可以点击星数</c>
<c.magenta>点击提交就行了</c>

00:35:52.519 --> 00:35:55.122 align:middle line:90%,end
<c.magenta>对你的应用进行评分</c>
<c.magenta>就成了一个无缝的体验</c>

00:35:55.189 --> 00:35:57.791 align:middle line:90%,end
<c.magenta>他们现在甚至不用离开你的应用</c>
<c.magenta>就可以写评论了</c>

00:35:58.859 --> 00:36:02.829 align:middle line:90%,end
<c.magenta>如果你现在还在用其他的警告</c>
<c.magenta>或是弹出框来请求评论的话</c>

00:35:58.859 --> 00:36:02.829 align:middle line:90%,end
<c.magenta>如果你现在还在用其他的警告</c>
<c.magenta>或是弹出框来请求评论的话</c>

00:36:02.896 --> 00:36:05.332 align:middle line:90%,end
<c.magenta>我强烈建议你们开始使用这个API</c>

00:36:05.399 --> 00:36:06.400 align:middle line:90%,end
<c.magenta>因为在未来某个时候</c>

00:36:06.466 --> 00:36:09.236 align:middle line:90%,end
<c.magenta>我们会开始要求任何弹出框显示</c>

00:36:09.303 --> 00:36:13.106 align:middle line:90%,end
<c.magenta>任何弹出请求评论</c>
<c.magenta>都要使用这个API</c>

00:36:13.440 --> 00:36:16.243 align:middle line:90%,end
<c.magenta>对于使用这个API还有几个限制</c>

00:36:17.711 --> 00:36:19.680 align:middle line:90%,end
<c.magenta>对于每台设备请求数是有限制的</c>

00:36:19.746 --> 00:36:23.717 align:middle line:90%,end
<c.magenta>我们会限制用户被这些提醒轰炸的次数</c>

00:36:23.784 --> 00:36:26.787 align:middle line:10%
<c.magenta>现在iOS 11中 用户可在</c>
<c.magenta>设置应用中关闭请求评论功能</c>

00:36:26.854 --> 00:36:28.388 align:middle line:10%
<c.magenta>他们可以进入App store设置</c>

00:36:28.755 --> 00:36:31.558 align:middle line:10%
<c.magenta>点击下开关就可以将</c>
<c.magenta>这些请求评分的弹出框功能关闭</c>

00:36:31.825 --> 00:36:33.560 align:middle line:90%,end
<c.magenta>我们觉得这会是个不错的体验</c>

00:36:33.627 --> 00:36:35.295 align:middle line:90%,end
<c.magenta>对于用户和开发者来说都是</c>

00:36:36.930 --> 00:36:39.099 align:middle line:90%,end
<c.magenta>这里有些如何实现此功能的小技巧</c>

00:36:40.334 --> 00:36:43.537 align:middle line:90%,end
<c.magenta>SKStoreReviewController是个弹出框</c>
<c.magenta>所以它自然而然就带有中断性</c>

00:36:43.604 --> 00:36:46.206 align:middle line:90%,end
<c.magenta>所以你最好实现这个功能的时候</c>

00:36:46.273 --> 00:36:47.608 align:middle line:90%,end
<c.magenta>是在某些用户交互的尾声</c>

00:36:47.674 --> 00:36:49.743 align:middle line:90%,end
<c.magenta>可能是在用户已经完成了某项任务之后</c>

00:36:50.010 --> 00:36:52.746 align:middle line:90%,end
<c.magenta>就可以借此机会</c>
<c.magenta>请求他们进行评分或是评论</c>

00:36:52.813 --> 00:36:54.982 align:middle line:90%,end
<c.magenta>不要在他们正在做什么事情时</c>
<c.magenta>去打扰他们</c>

00:36:55.949 --> 00:36:58.719 align:middle line:90%,end
<c.magenta>你也不适合用按钮来使用这个API</c>

00:36:58.785 --> 00:37:01.655 align:middle line:90%,end
<c.magenta>因为你不能保证会有UI能呈现给用户</c>

00:36:58.785 --> 00:37:01.655 align:middle line:90%,end
<c.magenta>因为你不能保证会有UI能呈现给用户</c>

00:37:01.855 --> 00:37:03.524 align:middle line:90%,end
<c.magenta>基于我们刚才看到的那些限制</c>

00:37:04.024 --> 00:37:08.028 align:middle line:90%,end
<c.magenta>所以通过你的应用中的嵌入式链接</c>
<c.magenta>来使用这个API也是不合适的</c>

00:37:08.929 --> 00:37:11.031 align:middle line:90%,end
<c.magenta>不过如果你真要这么做</c>
<c.magenta>其代码是这样的</c>

00:37:11.098 --> 00:37:12.366 align:middle line:90%,end
<c.magenta>就是一行代码</c>

00:37:12.699 --> 00:37:14.434 align:middle line:90%,end
<c.magenta>但你可把它包含到</c>
<c.magenta>你自己的业务逻辑里去</c>

00:37:14.501 --> 00:37:17.471 align:middle line:90%,end
<c.magenta>在本例中 我们在检查这个用户是不是</c>

00:37:17.538 --> 00:37:20.073 align:middle line:90%,end
<c.magenta>那种我们想要请求写评论的用户</c>

00:37:21.074 --> 00:37:22.676 align:middle line:90%,end
<c.magenta>如果我们确定他们是的话</c>

00:37:22.976 --> 00:37:25.279 align:middle line:90%,end
<c.magenta>我们就可以调用</c>
<c.magenta>SKStoreReviewController上</c>

00:37:25.345 --> 00:37:27.047 align:middle line:90%,end
<c.magenta>的requestReview方法了</c>

00:37:27.281 --> 00:37:28.482 align:middle line:90%,end
<c.magenta>你只需要调用这个方法</c>

00:37:28.549 --> 00:37:30.317 align:middle line:90%,end
<c.magenta>该方法会将评分弹出框呈现给用户</c>

00:37:30.384 --> 00:37:32.252 align:middle line:90%,end
<c.magenta>当他们在使用你的应用时</c>

00:37:34.855 --> 00:37:37.824 align:middle line:90%,end
<c.magenta>另一种方法当然就是我刚才提到的</c>
<c.magenta>用来写评论的新深度链接</c>

00:37:39.059 --> 00:37:41.528 align:middle line:90%,end
<c.magenta>它其实也是在</c>
<c.magenta>iOS 10.3中被引入的</c>

00:37:41.595 --> 00:37:42.963 align:middle line:90%,end
<c.magenta>不过我们现在会介绍一下它</c>

00:37:43.163 --> 00:37:46.133 align:middle line:90%,end
<c.magenta>它会为你提供一个可以打开</c>
<c.magenta>App Store中应用页面链接</c>

00:37:46.266 --> 00:37:48.702 align:middle line:90%,end
<c.magenta>该链接可以立刻给你显示写评论的表单</c>

00:37:48.769 --> 00:37:51.004 align:middle line:90%,end
<c.magenta>或是本例中这样对评论进行编辑</c>
<c.magenta>如果他们已经写过评论</c>

00:37:51.638 --> 00:37:54.174 align:middle line:90%,end
<c.magenta>它对于像是用户初始化动作</c>
<c.magenta>这类操作更为适合</c>

00:37:54.241 --> 00:37:57.077 align:middle line:90%,end
<c.magenta>在这里你可能想在应用中</c>
<c.magenta>建立一个长期存在的链接</c>

00:37:57.144 --> 00:37:59.980 align:middle line:90%,end
<c.magenta>可能是你设置里的一个用来在</c>
<c.magenta>App Store中为你的应用写评论的按钮</c>

00:38:00.314 --> 00:38:03.317 align:middle line:90%,end
<c.magenta>这对于SKStoreReviewController</c>
<c.magenta>来说有一点不同之处</c>

00:38:03.383 --> 00:38:05.352 align:middle line:90%,end
<c.magenta>你可以当它想成是完全相反的</c>

00:38:05.586 --> 00:38:07.788 align:middle line:90%,end
<c.magenta>所以设置中的按钮更为合适</c>

00:38:07.855 --> 00:38:10.357 align:middle line:90%,end
<c.magenta>或者是你应用中的某些嵌入内容</c>

00:38:10.424 --> 00:38:12.793 align:middle line:90%,end
<c.magenta>因为它提供的是持续的体验</c>

00:38:12.860 --> 00:38:14.628 align:middle line:90%,end
<c.magenta>可以保证会发生的操作</c>

00:38:15.529 --> 00:38:17.531 align:middle line:90%,end
<c.magenta>然而 通过警告来使用并不合适</c>

00:38:17.598 --> 00:38:20.601 align:middle line:90%,end
<c.magenta>我刚才提过</c>
<c.magenta>如果你要使用警告来提示用户进行评论</c>

00:38:20.667 --> 00:38:23.670 align:middle line:90%,end
<c.magenta>请确保你已经开始用</c>
<c.magenta>SKStoreReviewController来替代了</c>

00:38:26.540 --> 00:38:28.475 align:middle line:90%,end
<c.magenta>这就是你生成深度链接的方法</c>

00:38:29.443 --> 00:38:31.578 align:middle line:90%,end
<c.magenta>这里你有应用页面的URL</c>

00:38:31.645 --> 00:38:33.514 align:middle line:90%,end
<c.magenta>你可以从链接制作网站来在线获取</c>

00:38:33.580 --> 00:38:34.848 align:middle line:90%,end
<c.magenta>如果你还不知道的话</c>

00:38:35.282 --> 00:38:37.084 align:middle line:90%,end
<c.magenta>你可以把查询参数操作</c>

00:38:37.150 --> 00:38:38.986 align:middle line:90%,end
<c.magenta>等于写评论</c>
<c.magenta>加到它的末尾</c>

00:38:39.453 --> 00:38:41.388 align:middle line:90%,end
<c.magenta>这就意味着</c>
<c.magenta>在用户看到你的应用页面时</c>

00:38:41.488 --> 00:38:43.257 align:middle line:90%,end
<c.magenta>他们会看到这个写评论表单</c>

00:38:46.093 --> 00:38:48.195 align:middle line:90%,end
<c.magenta>有关评分和评论的更多信息</c>

00:38:48.262 --> 00:38:49.696 align:middle line:90%,end
<c.magenta>还有我们之前介绍过的今年的一些改变</c>

00:38:49.763 --> 00:38:52.432 align:middle line:90%,end
<c.magenta>我建议你们去看下</c>
<c.magenta>这里列出的开发者网站</c>

00:38:52.766 --> 00:38:54.001 align:middle line:90%,end
<c.magenta>我们在那有更多关于这方面的信息</c>

00:38:55.736 --> 00:38:57.771 align:middle line:90%,end
<c.magenta>我们今天介绍了几个新功能</c>

00:38:57.838 --> 00:38:59.239 align:middle line:90%,end
<c.magenta>包括StoreKit新特性</c>

00:38:59.506 --> 00:39:01.708 align:middle line:90%,end
<c.magenta>总结一下 我们介绍了</c>

00:38:59.506 --> 00:39:01.708 align:middle line:90%,end
<c.magenta>总结一下 我们介绍了</c>

00:39:01.775 --> 00:39:03.810 align:middle line:90%,end
<c.magenta>在你的应用中实现程序内购买的方法</c>

00:39:03.877 --> 00:39:06.246 align:middle line:90%,end
<c.magenta>也就是实现程序内购买的七步流程</c>

00:39:06.580 --> 00:39:08.348 align:middle line:90%,end
<c.magenta>Ross上台给你们介绍了</c>
<c.magenta>一些最新的方法</c>

00:39:08.415 --> 00:39:10.117 align:middle line:90%,end
<c.magenta>你们可以用这些方法来推广程序内购买</c>

00:39:10.184 --> 00:39:11.285 align:middle line:90%,end
<c.magenta>直接在App Store中</c>

00:39:11.351 --> 00:39:14.354 align:middle line:90%,end
<c.magenta>你现就可以在用户浏览App Store</c>
<c.magenta>应用时出售你的内容了</c>

00:39:15.355 --> 00:39:16.924 align:middle line:90%,end
<c.magenta>我们介绍了新的</c>
<c.magenta>App Store设计</c>

00:39:16.990 --> 00:39:19.293 align:middle line:90%,end
<c.magenta>新的评分和评论区域</c>

00:39:19.393 --> 00:39:20.794 align:middle line:90%,end
<c.magenta>包括开发者的回复</c>

00:39:21.028 --> 00:39:22.930 align:middle line:90%,end
<c.magenta>并且我们发现 使用了开发者回复后</c>

00:39:22.996 --> 00:39:24.398 align:middle line:90%,end
<c.magenta>我们就会有很大的机会</c>

00:39:24.464 --> 00:39:27.201 align:middle line:90%,end
<c.magenta>可以看到你的评分和评论有了改善</c>

00:39:27.367 --> 00:39:29.536 align:middle line:90%,end
<c.magenta>同时还会获得更好的用户体验</c>

00:39:31.538 --> 00:39:35.108 align:middle line:90%,end
<c.magenta>有关本场演讲的更多信息</c>
<c.magenta>我们把网址链接放到了这里</c>

00:39:35.175 --> 00:39:36.577 align:middle line:90%,end
<c.magenta>这是演讲303</c>

00:39:37.678 --> 00:39:40.280 align:middle line:90%,end
<c.magenta>本场演讲还有一些相关的演讲</c>
<c.magenta>特别是今天下午的</c>

00:39:40.347 --> 00:39:42.049 align:middle line:90%,end
<c.magenta>“高级StoreKit”演讲</c>

00:39:42.149 --> 00:39:44.651 align:middle line:90%,end
<c.magenta>我希望能在那场演讲上看到你们</c>

00:39:44.718 --> 00:39:47.588 align:middle line:90%,end
<c.magenta>我们还介绍了关于</c>
<c.magenta>收据有效性验证的内容</c>

00:39:47.654 --> 00:39:50.090 align:middle line:90%,end
<c.magenta>我们会深入介绍订阅管理</c>

00:39:50.157 --> 00:39:52.559 align:middle line:90%,end
<c.magenta>跨服务器环境的持续性状态</c>
<c.magenta>诸如此类的东西</c>

00:39:52.626 --> 00:39:56.230 align:middle line:90%,end
<c.magenta>所以请来参加一下那场演讲</c>
<c.magenta>我们还有更多的内容等着给你们介绍</c>

00:39:56.563 --> 00:39:57.831 align:middle line:90%,end
<c.magenta>不过今天就是这些内容了</c>

00:39:57.898 --> 00:39:59.132 align:middle line:90%,end
<c.magenta>感谢你们来参加本场演讲</c>

00:39:59.199 --> 00:40:00.200 align:middle line:90%,end
<c.magenta>希望你们享用很棒的午餐</c>

WEBVTT

00:00:16.917 --> 00:00:21.021 align:middle line:10%
<c.magenta>（掌握拖放功能）</c>

00:00:22.222 --> 00:00:23.056 align:middle line:90%,end
<c.magenta>上午好</c>

00:00:25.092 --> 00:00:26.326 align:middle line:90%,end
<c.magenta>很高兴见到你们</c>

00:00:26.393 --> 00:00:27.227 align:middle line:90%,end
<c.magenta>我是罗布</c>

00:00:27.294 --> 00:00:28.996 align:middle line:90%,end
<c.magenta>另外还有我的同事</c>
<c.magenta>文森和汤姆</c>

00:00:29.062 --> 00:00:30.964 align:middle line:90%,end
<c.magenta>今天我将与大家一起深入探讨</c>

00:00:31.031 --> 00:00:34.668 align:middle line:90%,end
<c.magenta>八个新拖放API</c>
<c.magenta>这是我们在iOS 11中推出</c>

00:00:35.135 --> 00:00:37.371 align:middle line:90%,end
<c.magenta>我们推出了一系列的新API</c>

00:00:37.437 --> 00:00:39.206 align:middle line:90%,end
<c.magenta>但是不要被吓倒了</c>

00:00:39.273 --> 00:00:41.108 align:middle line:90%,end
<c.magenta>我们将会讲解</c>
<c.magenta>许多的基础知识</c>

00:00:41.475 --> 00:00:43.644 align:middle line:90%,end
<c.magenta>让你们逐步接受这些API</c>

00:00:43.710 --> 00:00:44.678 align:middle line:90%,end
<c.magenta>事实上</c>

00:00:44.745 --> 00:00:47.915 align:middle line:90%,end
<c.magenta>如果你们使用</c>
<c.magenta>集合视图或表格视图</c>

00:00:47.981 --> 00:00:50.584 align:middle line:10%
<c.magenta>可以参加</c>
<c.magenta>明天在2号大厅举行的</c>

00:00:51.185 --> 00:00:52.586 align:middle line:10%
<c.magenta>专门演讲</c>

00:00:52.653 --> 00:00:55.722 align:middle line:10%
<c.magenta>然后接下来还有一个</c>
<c.magenta>NSItemProvider演讲</c>

00:00:55.789 --> 00:00:59.626 align:middle line:10%
<c.magenta>如果你想知道UDI中的U</c>
<c.magenta>代表什么 请不要错过此演讲</c>

00:00:59.826 --> 00:01:03.330 align:middle line:10%
<c.magenta>本演讲分为两个部分</c>

00:00:59.826 --> 00:01:03.330 align:middle line:10%
<c.magenta>本演讲分为两个部分</c>

00:01:03.397 --> 00:01:05.399 align:middle line:90%,end
<c.magenta>首先 我们将讨论拖动操作</c>

00:01:05.465 --> 00:01:07.835 align:middle line:90%,end
<c.magenta>包括拖动交互委托</c>

00:01:07.901 --> 00:01:10.137 align:middle line:90%,end
<c.magenta>会话、相关拖放项目和预览</c>

00:01:10.204 --> 00:01:12.206 align:middle line:90%,end
<c.magenta>然后 汤姆将负责</c>
<c.magenta>第二部分的演讲</c>

00:01:12.272 --> 00:01:14.308 align:middle line:90%,end
<c.magenta>介绍放入操作</c>

00:01:14.374 --> 00:01:17.277 align:middle line:90%,end
<c.magenta>今天的内容有很多</c>

00:01:17.344 --> 00:01:20.314 align:middle line:90%,end
<c.magenta>首先 我们将介绍</c>
<c.magenta>高级拖动交互</c>

00:01:21.148 --> 00:01:22.316 align:middle line:90%,end
<c.magenta>你们已经知道</c>

00:01:23.617 --> 00:01:26.653 align:middle line:90%,end
<c.magenta>iOS中的拖动与放入操作不仅</c>
<c.magenta>用于在应用之间共享数据</c>

00:01:26.720 --> 00:01:28.822 align:middle line:90%,end
<c.magenta>而且是一种流畅的用户交互</c>

00:01:28.889 --> 00:01:32.759 align:middle line:90%,end
<c.magenta>这些复杂的用户交互</c>

00:01:32.826 --> 00:01:34.127 align:middle line:90%,end
<c.magenta>要求我们必须确保一致性</c>

00:01:34.194 --> 00:01:37.130 align:middle line:90%,end
<c.magenta>你可以使用UIDragInteraction</c>
<c.magenta>来实现这种一致性</c>

00:01:37.197 --> 00:01:39.833 align:middle line:90%,end
<c.magenta>你可以使用它们</c>
<c.magenta>在任何视图中安装它们</c>

00:01:39.900 --> 00:01:41.869 align:middle line:90%,end
<c.magenta>你不必自己编写子类</c>

00:01:41.935 --> 00:01:45.405 align:middle line:90%,end
<c.magenta>更不必进入和更改</c>
<c.magenta>自定义视图的现有超类</c>

00:01:45.472 --> 00:01:49.042 align:middle line:90%,end
<c.magenta>只需要安装其中一个</c>
<c.magenta>它将会为你完成必要的手势记录</c>

00:01:49.109 --> 00:01:50.310 align:middle line:90%,end
<c.magenta>但是你必须</c>

00:01:50.377 --> 00:01:52.913 align:middle line:90%,end
<c.magenta>自己实现</c>
<c.magenta>UIDragInteractionDelegate</c>

00:01:53.447 --> 00:01:55.782 align:middle line:90%,end
<c.magenta>至少返回一个UIDragItem</c>

00:01:55.849 --> 00:01:59.786 align:middle line:90%,end
<c.magenta>你可以 [听不清]</c>
<c.magenta>获得一系列的生命周期通知</c>

00:01:59.853 --> 00:02:03.423 align:middle line:90%,end
<c.magenta>进行一些动画显示</c>
<c.magenta>后面我们将会讨论这些内容</c>

00:01:59.853 --> 00:02:03.423 align:middle line:90%,end
<c.magenta>进行一些动画显示</c>
<c.magenta>后面我们将会讨论这些内容</c>

00:02:03.857 --> 00:02:06.860 align:middle line:90%,end
<c.magenta>如果你不明白这些内容</c>
<c.magenta>我建议你们观看</c>

00:02:06.927 --> 00:02:09.696 align:middle line:90%,end
<c.magenta>昨天已经举行的</c>
<c.magenta>“拖动与放入操作简介”演讲</c>

00:02:09.763 --> 00:02:13.200 align:middle line:90%,end
<c.magenta>如果你们没有参加此演讲</c>
<c.magenta>就只能看视频</c>

00:02:13.800 --> 00:02:15.602 align:middle line:90%,end
<c.magenta>那个演讲介绍一些基础知识</c>

00:02:15.669 --> 00:02:19.039 align:middle line:90%,end
<c.magenta>但是这些基础知识不够全面</c>
<c.magenta>所以你们还需要参加本演讲</c>

00:02:19.106 --> 00:02:24.344 align:middle line:90%,end
<c.magenta>让我们来看iOS 11中的</c>
<c.magenta>一些应用使用的行为</c>

00:02:24.411 --> 00:02:27.447 align:middle line:90%,end
<c.magenta>以及用户将会期望</c>
<c.magenta>你的应用如何做出响应</c>

00:02:28.482 --> 00:02:31.151 align:middle line:90%,end
<c.magenta>在Mail应用中</c>
<c.magenta>你可以看到</c>

00:02:31.218 --> 00:02:33.754 align:middle line:90%,end
<c.magenta>当我长时期按住邮件</c>
<c.magenta>开始拖动时</c>

00:02:33.820 --> 00:02:36.056 align:middle line:90%,end
<c.magenta>我可以轻按后面的邮件</c>

00:02:36.123 --> 00:02:40.327 align:middle line:90%,end
<c.magenta>它们将会加入</c>
<c.magenta>我正在进行的拖动</c>

00:02:40.394 --> 00:02:42.829 align:middle line:90%,end
<c.magenta>加入拖动的邮件</c>
<c.magenta>数量在增加</c>

00:02:42.896 --> 00:02:45.165 align:middle line:90%,end
<c.magenta>这种功能并不是唾手可得的</c>

00:02:45.232 --> 00:02:47.935 align:middle line:90%,end
<c.magenta>但也不是很难实现</c>
<c.magenta>让我演示给你们看</c>

00:02:48.669 --> 00:02:49.570 align:middle line:90%,end
<c.magenta>在本例中</c>

00:02:49.636 --> 00:02:52.139 align:middle line:90%,end
<c.magenta>我已经实现</c>
<c.magenta>UIDragInteractionDelegate</c>

00:02:52.439 --> 00:02:56.877 align:middle line:90%,end
<c.magenta>尤其是必要的方法 dragInteraction</c>
<c.magenta>itemsForBeginning session</c>

00:02:56.944 --> 00:03:01.281 align:middle line:90%,end
<c.magenta>在其中 我为想要拖动的邮件</c>
<c.magenta>创建一个NSItemProvider</c>

00:02:56.944 --> 00:03:01.281 align:middle line:90%,end
<c.magenta>在其中 我为想要拖动的邮件</c>
<c.magenta>创建一个NSItemProvider</c>

00:03:01.949 --> 00:03:05.419 align:middle line:90%,end
<c.magenta>然后利用前面的itemProvider</c>
<c.magenta>创建一个UIDragItem</c>

00:03:05.619 --> 00:03:07.521 align:middle line:90%,end
<c.magenta>将localObject设置为该邮件</c>

00:03:07.588 --> 00:03:10.457 align:middle line:90%,end
<c.magenta>稍后 我可以</c>
<c.magenta>引用这个邮件</c>

00:03:10.524 --> 00:03:12.526 align:middle line:90%,end
<c.magenta>然后 我返回放入数组</c>

00:03:13.227 --> 00:03:14.328 align:middle line:90%,end
<c.magenta>现在 你可以使用</c>

00:03:14.394 --> 00:03:17.664 align:middle line:90%,end
<c.magenta>dragInteraction itemsForAddingTo</c>
<c.magenta>session withTouchAt point</c>

00:03:17.731 --> 00:03:18.832 align:middle line:90%,end
<c.magenta>使用同样的实现</c>

00:03:18.899 --> 00:03:20.067 align:middle line:90%,end
<c.magenta>这是可行的</c>

00:03:20.367 --> 00:03:23.170 align:middle line:90%,end
<c.magenta>但是 你们需要一些边界例子</c>

00:03:23.237 --> 00:03:26.039 align:middle line:90%,end
<c.magenta>当你实现这种方法</c>
<c.magenta>来实现群组拖动时</c>

00:03:26.773 --> 00:03:28.575 align:middle line:90%,end
<c.magenta>首先 如果实现这个方法</c>

00:03:28.642 --> 00:03:30.077 align:middle line:90%,end
<c.magenta>你的拖动交互可能</c>

00:03:30.143 --> 00:03:33.080 align:middle line:90%,end
<c.magenta>与应用中的</c>
<c.magenta>其它拖动交互组合在一起</c>

00:03:33.146 --> 00:03:34.781 align:middle line:90%,end
<c.magenta>而不会与其它应用中的</c>
<c.magenta>拖动交互组合在一起</c>

00:03:34.848 --> 00:03:37.518 align:middle line:90%,end
<c.magenta>因此我们目前不允许跨应用组合</c>

00:03:37.584 --> 00:03:38.819 align:middle line:90%,end
<c.magenta>但是鲍勃在其它部门</c>

00:03:38.886 --> 00:03:40.988 align:middle line:90%,end
<c.magenta>实现的dragInteractionDelegate</c>

00:03:41.622 --> 00:03:44.224 align:middle line:90%,end
<c.magenta>支持这种组合</c>
<c.magenta>你应该认识到这一点</c>

00:03:44.291 --> 00:03:47.194 align:middle line:90%,end
<c.magenta>在本例中 我决定</c>
<c.magenta>只组合我的邮件</c>

00:03:47.261 --> 00:03:50.531 align:middle line:90%,end
<c.magenta>和其它邮件</c>

00:03:50.597 --> 00:03:53.000 align:middle line:90%,end
<c.magenta>因此 我迭代此会话中的所有项目</c>

00:03:53.066 --> 00:03:56.937 align:middle line:90%,end
<c.magenta>如果任何项目没有</c>
<c.magenta>一个NSItemProvider</c>

00:03:57.004 --> 00:04:00.073 align:middle line:90%,end
<c.magenta>并且含有符合此类型的UDI</c>
<c.magenta>在本例中</c>

00:03:57.004 --> 00:04:00.073 align:middle line:90%,end
<c.magenta>并且含有符合此类型的UDI</c>
<c.magenta>在本例中</c>

00:04:00.140 --> 00:04:01.408 align:middle line:90%,end
<c.magenta>它是private.example.mail</c>

00:04:01.475 --> 00:04:03.710 align:middle line:90%,end
<c.magenta>我将取消返回空数组</c>

00:04:03.777 --> 00:04:06.980 align:middle line:90%,end
<c.magenta>这将提供其它手势识别</c>
<c.magenta>以识别</c>

00:04:07.047 --> 00:04:09.449 align:middle line:90%,end
<c.magenta>触发这种组合的点击操作</c>

00:04:09.516 --> 00:04:10.484 align:middle line:90%,end
<c.magenta>同样地</c>

00:04:11.118 --> 00:04:13.820 align:middle line:90%,end
<c.magenta>默认情况下 相同的拖动交互</c>

00:04:13.887 --> 00:04:16.390 align:middle line:90%,end
<c.magenta>相同的UI视图</c>
<c.magenta>可以组合多个项目</c>

00:04:16.456 --> 00:04:19.993 align:middle line:90%,end
<c.magenta>我们不知道</c>
<c.magenta>这对你的应用是否有意义</c>

00:04:20.060 --> 00:04:22.763 align:middle line:90%,end
<c.magenta>或者视图内的不同区域</c>

00:04:22.829 --> 00:04:25.566 align:middle line:90%,end
<c.magenta>对于不同的拖动项目</c>
<c.magenta>因此你必须告诉我们</c>

00:04:25.632 --> 00:04:27.534 align:middle line:90%,end
<c.magenta>在本例中</c>
<c.magenta>我检查会话中</c>

00:04:27.601 --> 00:04:30.103 align:middle line:90%,end
<c.magenta>任何其它项目的</c>
<c.magenta>本地对象</c>

00:04:30.170 --> 00:04:32.439 align:middle line:90%,end
<c.magenta>是否对应于想要选中的邮件</c>

00:04:32.506 --> 00:04:33.640 align:middle line:90%,end
<c.magenta>如果是</c>

00:04:33.707 --> 00:04:35.576 align:middle line:90%,end
<c.magenta>我也会使用空数组来终止</c>

00:04:35.943 --> 00:04:37.578 align:middle line:90%,end
<c.magenta>你可以这样进行组合</c>

00:04:38.779 --> 00:04:42.749 align:middle line:90%,end
<c.magenta>Mail的另一个行为是这样的</c>

00:04:42.816 --> 00:04:45.886 align:middle line:90%,end
<c.magenta>如果我长时间按住一个邮件线索</c>
<c.magenta>而不是移动</c>

00:04:45.953 --> 00:04:48.388 align:middle line:90%,end
<c.magenta>代表邮件线索的一个项目</c>

00:04:48.522 --> 00:04:53.026 align:middle line:90%,end
<c.magenta>我移动三个邮件线索</c>
<c.magenta>每个都含有一份邮件</c>

00:04:53.093 --> 00:04:55.295 align:middle line:90%,end
<c.magenta>用这个蓝色的泡泡表示</c>

00:04:57.130 --> 00:04:58.532 align:middle line:90%,end
<c.magenta>我们已经看到</c>

00:04:58.832 --> 00:05:00.534 align:middle line:90%,end
<c.magenta>UIDragInteractionDelegates</c>

00:04:58.832 --> 00:05:00.534 align:middle line:90%,end
<c.magenta>UIDragInteractionDelegates</c>

00:05:00.601 --> 00:05:03.036 align:middle line:90%,end
<c.magenta>拖动项目itemsForBeginning</c>
<c.magenta>会话返回一个数组</c>

00:05:03.103 --> 00:05:06.273 align:middle line:90%,end
<c.magenta>在这里可以返回多个项目</c>

00:05:06.340 --> 00:05:08.742 align:middle line:90%,end
<c.magenta>这正是我想要的</c>

00:05:08.809 --> 00:05:12.312 align:middle line:90%,end
<c.magenta>因此我获得邮件线索中的所有邮件</c>

00:05:12.779 --> 00:05:14.848 align:middle line:90%,end
<c.magenta>我对它们进行排序</c>
<c.magenta>稍后将会解释为什么这样做</c>

00:05:14.915 --> 00:05:18.652 align:middle line:90%,end
<c.magenta>然后 为每个邮件返回一个UIDragItem</c>

00:05:18.719 --> 00:05:20.754 align:middle line:90%,end
<c.magenta>这与前面的做法完全相同</c>

00:05:20.821 --> 00:05:21.889 align:middle line:90%,end
<c.magenta>我对它们排序的原因是</c>

00:05:21.955 --> 00:05:24.992 align:middle line:90%,end
<c.magenta>这里返回的数组的顺序很重要</c>

00:05:25.058 --> 00:05:27.294 align:middle line:90%,end
<c.magenta>因为数组中的最后一个项目</c>

00:05:27.361 --> 00:05:29.530 align:middle line:90%,end
<c.magenta>将成为你提升的</c>
<c.magenta>最上方对象</c>

00:05:29.596 --> 00:05:31.465 align:middle line:90%,end
<c.magenta>由于我想最先获取最新的邮件</c>

00:05:31.532 --> 00:05:35.002 align:middle line:90%,end
<c.magenta>因此我对它们进行排序</c>
<c.magenta>使最旧邮件成为数组中的第一个项目</c>

00:05:35.335 --> 00:05:36.170 align:middle line:90%,end
<c.magenta>这行得通</c>

00:05:36.236 --> 00:05:38.472 align:middle line:90%,end
<c.magenta>但是 如果我们这样实现</c>

00:05:39.606 --> 00:05:42.809 align:middle line:90%,end
<c.magenta>所有项目都会提升</c>
<c.magenta>并且具有相同的预览</c>

00:05:43.177 --> 00:05:45.179 align:middle line:90%,end
<c.magenta>这意味着</c>
<c.magenta>它们将具有相同的视觉表示</c>

00:05:45.245 --> 00:05:47.714 align:middle line:90%,end
<c.magenta>默认情况下 我们创建的预览</c>

00:05:47.781 --> 00:05:50.417 align:middle line:90%,end
<c.magenta>基于已经设定交互模式的视图</c>

00:05:50.484 --> 00:05:53.153 align:middle line:90%,end
<c.magenta>这意味着</c>
<c.magenta>所有三份邮件使用线索</c>

00:05:53.220 --> 00:05:54.788 align:middle line:90%,end
<c.magenta>作为它们的视觉表示</c>

00:05:54.855 --> 00:05:56.023 align:middle line:90%,end
<c.magenta>这并不是我想要的</c>

00:05:56.089 --> 00:05:59.760 align:middle line:90%,end
<c.magenta>我实现可选的dragInteraction</c>
<c.magenta>previewForLifting项目会话</c>

00:05:59.826 --> 00:06:01.862 align:middle line:90%,end
<c.magenta>返回我自己的拖动预览</c>

00:05:59.826 --> 00:06:01.862 align:middle line:90%,end
<c.magenta>返回我自己的拖动预览</c>

00:06:02.095 --> 00:06:03.630 align:middle line:90%,end
<c.magenta>因此 我所做的事情是</c>

00:06:03.697 --> 00:06:07.801 align:middle line:90%,end
<c.magenta>首先我尝试找到</c>
<c.magenta>与项目关联的邮件</c>

00:06:08.368 --> 00:06:09.403 align:middle line:90%,end
<c.magenta>如果找到</c>

00:06:09.469 --> 00:06:11.505 align:middle line:90%,end
<c.magenta>我通过它的helper方法</c>

00:06:11.572 --> 00:06:13.373 align:middle line:90%,end
<c.magenta>获取它的相关邮件视图</c>

00:06:13.440 --> 00:06:16.476 align:middle line:90%,end
<c.magenta>然后使用它初始化</c>
<c.magenta>我的UITargetedDragPreview</c>

00:06:16.543 --> 00:06:20.214 align:middle line:90%,end
<c.magenta>这意味着</c>
<c.magenta>我提升的所有邮件</c>

00:06:20.280 --> 00:06:21.882 align:middle line:90%,end
<c.magenta>将具有它自己的表示</c>

00:06:21.949 --> 00:06:24.117 align:middle line:90%,end
<c.magenta>这些表示基于</c>
<c.magenta>它们自己的邮件视图</c>

00:06:24.918 --> 00:06:25.786 align:middle line:90%,end
<c.magenta>最后这点也很重要</c>

00:06:25.853 --> 00:06:30.090 align:middle line:90%,end
<c.magenta>Mail还具有另外一项微妙的功能</c>

00:06:30.958 --> 00:06:34.361 align:middle line:90%,end
<c.magenta>你可以看到 我将照片</c>
<c.magenta>从Photos拖到Mail</c>

00:06:34.428 --> 00:06:35.996 align:middle line:90%,end
<c.magenta>如果你注意</c>

00:06:36.063 --> 00:06:41.201 align:middle line:90%,end
<c.magenta>你会发现</c>
<c.magenta>被拖动照片的大小发生变化</c>

00:06:41.268 --> 00:06:43.737 align:middle line:90%,end
<c.magenta>以适应正文撰写表单的宽度</c>

00:06:43.804 --> 00:06:47.040 align:middle line:90%,end
<c.magenta>那么 Mail如何已经知道</c>
<c.magenta>应该为照片留出多大空间</c>

00:06:47.107 --> 00:06:48.675 align:middle line:90%,end
<c.magenta>并在何处显示预览？</c>

00:06:48.742 --> 00:06:51.445 align:middle line:90%,end
<c.magenta>还是因为</c>
<c.magenta>数据非常快速地到达？</c>

00:06:51.512 --> 00:06:54.114 align:middle line:90%,end
<c.magenta>不是 你不应该进行任何推测</c>

00:06:54.181 --> 00:06:57.417 align:middle line:90%,end
<c.magenta>在我的演示中</c>
<c.magenta>数据及时到达</c>

00:06:57.484 --> 00:06:59.553 align:middle line:90%,end
<c.magenta>但在用户的实际应用中</c>
<c.magenta>情况可能并非如此</c>

00:06:59.620 --> 00:07:02.122 align:middle line:90%,end
<c.magenta>有更好的方法</c>
<c.magenta>来处理这种情况</c>

00:06:59.620 --> 00:07:02.122 align:middle line:90%,end
<c.magenta>有更好的方法</c>
<c.magenta>来处理这种情况</c>

00:07:02.189 --> 00:07:04.558 align:middle line:90%,end
<c.magenta>我们发现NSItemProvider</c>

00:07:05.092 --> 00:07:08.095 align:middle line:90%,end
<c.magenta>有一个属性 名为</c>
<c.magenta>preferredPresentationSize</c>

00:07:08.161 --> 00:07:11.532 align:middle line:90%,end
<c.magenta>允许你告知</c>
<c.magenta>你想要显示的内容的大小</c>

00:07:11.598 --> 00:07:13.634 align:middle line:90%,end
<c.magenta>这类似于管道方法</c>

00:07:13.700 --> 00:07:16.803 align:middle line:90%,end
<c.magenta>在这里 即使我使用文件</c>
<c.magenta>初始化NSItemProvider</c>

00:07:16.870 --> 00:07:18.005 align:middle line:90%,end
<c.magenta>我也知道大小</c>

00:07:18.071 --> 00:07:20.707 align:middle line:90%,end
<c.magenta>因此 我可以相应地设置它的</c>
<c.magenta>preferredPresentationSize</c>

00:07:20.774 --> 00:07:23.377 align:middle line:90%,end
<c.magenta>然后Mail能够在后台读取它</c>

00:07:23.443 --> 00:07:25.345 align:middle line:90%,end
<c.magenta>其余的工作是相同的</c>

00:07:25.612 --> 00:07:28.215 align:middle line:90%,end
<c.magenta>我可以向你们保证</c>

00:07:28.282 --> 00:07:30.417 align:middle line:90%,end
<c.magenta>这个方法完全可行</c>

00:07:30.484 --> 00:07:33.954 align:middle line:90%,end
<c.magenta>现在文森将会为大家演示</c>

00:07:42.129 --> 00:07:43.664 align:middle line:90%,end
<c.magenta>谢谢 罗布</c>

00:07:48.035 --> 00:07:49.570 align:middle line:90%,end
<c.magenta>在进行演示之前</c>

00:07:49.636 --> 00:07:51.638 align:middle line:90%,end
<c.magenta>我要讲一些事情</c>

00:07:51.705 --> 00:07:54.041 align:middle line:90%,end
<c.magenta>我演示的所有代码</c>

00:07:54.107 --> 00:07:55.809 align:middle line:90%,end
<c.magenta>都可以从网上下载</c>

00:07:55.876 --> 00:07:57.978 align:middle line:90%,end
<c.magenta>建议你去查看</c>

00:07:58.045 --> 00:07:58.879 align:middle line:90%,end
<c.magenta>其次</c>

00:07:58.946 --> 00:08:01.915 align:middle line:90%,end
<c.magenta>今天我们将会演示两个应用</c>
<c.magenta>而不是一个</c>

00:07:58.946 --> 00:08:01.915 align:middle line:90%,end
<c.magenta>今天我们将会演示两个应用</c>
<c.magenta>而不是一个</c>

00:08:01.982 --> 00:08:03.450 align:middle line:90%,end
<c.magenta>第一个应用名称为Drag Source</c>

00:08:03.517 --> 00:08:05.552 align:middle line:90%,end
<c.magenta>其重点是拖动交互</c>

00:08:05.619 --> 00:08:07.321 align:middle line:90%,end
<c.magenta>第二个是Drop Destination</c>

00:08:07.387 --> 00:08:10.257 align:middle line:90%,end
<c.magenta>其重点是放入操作</c>

00:08:10.457 --> 00:08:14.294 align:middle line:90%,end
<c.magenta>让我们来看</c>
<c.magenta>第一个演示应用</c>

00:08:15.495 --> 00:08:20.701 align:middle line:90%,end
<c.magenta>在这里 我们看到四组图片</c>

00:08:20.767 --> 00:08:25.772 align:middle line:90%,end
<c.magenta>我们已经实现</c>
<c.magenta>一些基本拖动与放入操作</c>

00:08:25.839 --> 00:08:30.043 align:middle line:90%,end
<c.magenta>可以拖动每个</c>
<c.magenta>图片组中的单张图片</c>

00:08:30.110 --> 00:08:31.311 align:middle line:90%,end
<c.magenta>看上去还不错</c>

00:08:31.545 --> 00:08:35.682 align:middle line:90%,end
<c.magenta>如果我们能够</c>
<c.magenta>将整组图片</c>

00:08:35.749 --> 00:08:38.352 align:middle line:90%,end
<c.magenta>作为单个项目拖动就更好了</c>

00:08:38.751 --> 00:08:41.221 align:middle line:90%,end
<c.magenta>让我们来看代码</c>
<c.magenta>弄清楚应该怎么做</c>

00:08:41.922 --> 00:08:44.324 align:middle line:90%,end
<c.magenta>请看这个代码</c>

00:08:44.391 --> 00:08:49.429 align:middle line:90%,end
<c.magenta>这是上张图像视图</c>
<c.magenta>使用它创建一个新拖动项目</c>

00:08:49.496 --> 00:08:51.164 align:middle line:90%,end
<c.magenta>使用上张图像视图</c>

00:08:51.431 --> 00:08:53.534 align:middle line:90%,end
<c.magenta>一个简单的方法是</c>

00:08:54.168 --> 00:08:56.904 align:middle line:90%,end
<c.magenta>枚举所有的可用图片视图</c>

00:08:57.504 --> 00:08:59.573 align:middle line:90%,end
<c.magenta>然后为每个视图返回拖动项目</c>

00:08:59.973 --> 00:09:01.341 align:middle line:90%,end
<c.magenta>我们将这样做</c>

00:08:59.973 --> 00:09:01.341 align:middle line:90%,end
<c.magenta>我们将这样做</c>

00:09:01.408 --> 00:09:03.477 align:middle line:90%,end
<c.magenta>让我们来看它的行为</c>

00:09:04.511 --> 00:09:08.315 align:middle line:90%,end
<c.magenta>请观察 当我拖动第二组图片时</c>
<c.magenta>将会发生什么</c>

00:09:09.383 --> 00:09:11.885 align:middle line:90%,end
<c.magenta>你会注意到</c>
<c.magenta>这次显示一个计数图标 上面显示3</c>

00:09:11.952 --> 00:09:14.221 align:middle line:90%,end
<c.magenta>这表示</c>
<c.magenta>我们拖动三个项目</c>

00:09:14.288 --> 00:09:16.523 align:middle line:90%,end
<c.magenta>对应于图片组中的</c>
<c.magenta>三幅图片</c>

00:09:16.823 --> 00:09:19.259 align:middle line:90%,end
<c.magenta>我在右侧调出Photos</c>

00:09:19.927 --> 00:09:25.165 align:middle line:90%,end
<c.magenta>你会注意到 我可以</c>
<c.magenta>将这三幅图片拖入Photos</c>

00:09:25.232 --> 00:09:28.669 align:middle line:90%,end
<c.magenta>像保存单幅图片一样保存它们</c>

00:09:29.269 --> 00:09:30.304 align:middle line:90%,end
<c.magenta>在Photos中</c>

00:09:30.370 --> 00:09:32.072 align:middle line:90%,end
<c.magenta>让我展示另一个操作</c>

00:09:33.307 --> 00:09:35.542 align:middle line:90%,end
<c.magenta>我已经对其中</c>
<c.magenta>一幅图片进行拖动</c>

00:09:35.609 --> 00:09:38.412 align:middle line:90%,end
<c.magenta>如果我点击</c>
<c.magenta>另外两幅图片</c>

00:09:38.478 --> 00:09:41.815 align:middle line:10%
<c.magenta>你会看到 它们</c>
<c.magenta>也被加入到现有拖动会话之中</c>

00:09:42.282 --> 00:09:45.252 align:middle line:90%,end
<c.magenta>罗布前面说过</c>
<c.magenta>这样的行为需要编码实现</c>

00:09:45.452 --> 00:09:48.422 align:middle line:90%,end
<c.magenta>幸运的是 这很容易实现</c>
<c.magenta>让我展示给你们看</c>

00:09:48.956 --> 00:09:50.324 align:middle line:90%,end
<c.magenta>我们回到代码之中</c>

00:09:50.958 --> 00:09:53.694 align:middle line:90%,end
<c.magenta>我需要实现</c>
<c.magenta>itemsForAddingTo session</c>

00:09:54.494 --> 00:09:56.330 align:middle line:90%,end
<c.magenta>在这里 需要注意的是</c>

00:09:56.396 --> 00:09:58.332 align:middle line:90%,end
<c.magenta>我们可以在</c>
<c.magenta>itemsForAddingTo session中</c>

00:09:58.732 --> 00:10:01.768 align:middle line:90%,end
<c.magenta>使用与itemsForBeginning session中</c>
<c.magenta>相同的逻辑</c>

00:09:58.732 --> 00:10:01.768 align:middle line:90%,end
<c.magenta>使用与itemsForBeginning session中</c>
<c.magenta>相同的逻辑</c>

00:10:01.835 --> 00:10:03.837 align:middle line:90%,end
<c.magenta>来构建拖动项目</c>

00:10:03.904 --> 00:10:06.473 align:middle line:90%,end
<c.magenta>这可以简化工作</c>

00:10:06.540 --> 00:10:10.010 align:middle line:90%,end
<c.magenta>我们只需调用 在itemsForBeginning</c>
<c.magenta>session中使用的逻辑</c>

00:10:10.077 --> 00:10:11.979 align:middle line:90%,end
<c.magenta>然后引入新helper方法</c>

00:10:12.045 --> 00:10:14.114 align:middle line:90%,end
<c.magenta>我调用这个</c>
<c.magenta>dragItems for session</c>

00:10:15.782 --> 00:10:19.653 align:middle line:90%,end
<c.magenta>在两个位置中 当我们添加</c>
<c.magenta>现有会话 在这里</c>

00:10:20.854 --> 00:10:25.492 align:middle line:90%,end
<c.magenta>当我们在itemsForBeginning</c>
<c.magenta>session中创建一个新会话时</c>

00:10:25.559 --> 00:10:27.928 align:middle line:90%,end
<c.magenta>我们只需要调用</c>
<c.magenta>这个新helper方法</c>

00:10:29.997 --> 00:10:31.932 align:middle line:90%,end
<c.magenta>这让我们能够</c>

00:10:31.999 --> 00:10:36.003 align:middle line:90%,end
<c.magenta>添加更多图片</c>
<c.magenta>到现有拖动会话中</c>

00:10:36.069 --> 00:10:36.937 align:middle line:10%
<c.magenta>你可以看到</c>

00:10:37.004 --> 00:10:39.206 align:middle line:10%
<c.magenta>当我点击其它三个</c>
<c.magenta>视图中的任何一个时</c>

00:10:39.740 --> 00:10:43.777 align:middle line:90%,end
<c.magenta>我们能够</c>
<c.magenta>将所有10张图片添加到拖动会话</c>

00:10:43.944 --> 00:10:47.214 align:middle line:90%,end
<c.magenta>这工作正常</c>
<c.magenta>但是需要注意</c>

00:10:47.281 --> 00:10:51.051 align:middle line:90%,end
<c.magenta>在这里 我要开始</c>
<c.magenta>拖动第一组图片</c>

00:10:51.118 --> 00:10:53.587 align:middle line:90%,end
<c.magenta>我保持点击</c>
<c.magenta>第一组图片</c>

00:10:54.188 --> 00:10:57.591 align:middle line:90%,end
<c.magenta>你可以看到 我能够</c>
<c.magenta>任意地添加所有图片</c>

00:10:57.658 --> 00:10:59.459 align:middle line:90%,end
<c.magenta>而有些图片应该是不能添加的</c>

00:10:59.526 --> 00:11:01.128 align:middle line:90%,end
<c.magenta>这看起来像是一个漏洞</c>

00:10:59.526 --> 00:11:01.128 align:middle line:90%,end
<c.magenta>这看起来像是一个漏洞</c>

00:11:01.195 --> 00:11:04.364 align:middle line:90%,end
<c.magenta>现在拖动会话中</c>
<c.magenta>已经有26张图片</c>

00:11:04.431 --> 00:11:07.100 align:middle line:90%,end
<c.magenta>让我们来看应该如何解决</c>

00:11:07.701 --> 00:11:10.470 align:middle line:90%,end
<c.magenta>这是刚才介绍的helper</c>

00:11:11.371 --> 00:11:12.406 align:middle line:90%,end
<c.magenta>我们能做的事情是</c>

00:11:12.472 --> 00:11:14.908 align:middle line:90%,end
<c.magenta>我们不使用所有</c>
<c.magenta>imageViews来创建拖动项目</c>

00:11:14.975 --> 00:11:16.877 align:middle line:90%,end
<c.magenta>我们每次点击时</c>

00:11:16.944 --> 00:11:18.846 align:middle line:90%,end
<c.magenta>我们要做的是</c>
<c.magenta>过滤出imageView</c>

00:11:18.912 --> 00:11:22.482 align:middle line:90%,end
<c.magenta>我们不使用一个imageView</c>
<c.magenta>来创建多个dragItem</c>

00:11:24.251 --> 00:11:26.386 align:middle line:90%,end
<c.magenta>因此 使用这三行代码</c>

00:11:26.453 --> 00:11:29.456 align:middle line:90%,end
<c.magenta>让我返回应用</c>
<c.magenta>看看其运行效果</c>

00:11:31.091 --> 00:11:34.595 align:middle line:90%,end
<c.magenta>现在 我开始拖动</c>
<c.magenta>第一组图片</c>

00:11:34.661 --> 00:11:36.463 align:middle line:90%,end
<c.magenta>然后我点击</c>
<c.magenta>第三组图片</c>

00:11:36.530 --> 00:11:39.299 align:middle line:90%,end
<c.magenta>请看 当我尝试添加更多项目时</c>
<c.magenta>将会发生什么</c>

00:11:40.067 --> 00:11:41.435 align:middle line:90%,end
<c.magenta>漏洞似乎不见了</c>

00:11:41.502 --> 00:11:44.438 align:middle line:90%,end
<c.magenta>我不再能够添加多余的项目</c>
<c.magenta>到拖动会话</c>

00:11:44.905 --> 00:11:47.341 align:middle line:90%,end
<c.magenta>这是一些基本的拖动操作</c>

00:11:47.407 --> 00:11:49.276 align:middle line:90%,end
<c.magenta>它们通过委托来完成</c>

00:11:49.376 --> 00:11:51.178 align:middle line:90%,end
<c.magenta>接下来 罗布将会为我们介绍</c>

00:11:51.245 --> 00:11:53.947 align:middle line:90%,end
<c.magenta>一些更高级的技术</c>

00:11:54.014 --> 00:11:56.817 align:middle line:90%,end
<c.magenta>例如 自定义动画效果</c>
<c.magenta>和拖动预览</c>

00:12:04.958 --> 00:12:08.095 align:middle line:90%,end
<c.magenta>让我们为预览增加一些效果</c>

00:12:09.129 --> 00:12:10.964 align:middle line:90%,end
<c.magenta>一种常见的情况是</c>

00:12:11.031 --> 00:12:13.534 align:middle line:90%,end
<c.magenta>你想要移动的视图</c>

00:12:13.600 --> 00:12:15.569 align:middle line:90%,end
<c.magenta>并不支持特殊效果</c>

00:12:15.636 --> 00:12:17.371 align:middle line:90%,end
<c.magenta>你可能需要一些突出显示状态</c>

00:12:17.437 --> 00:12:19.806 align:middle line:90%,end
<c.magenta>或者需要覆盖层淡出效果</c>

00:12:19.873 --> 00:12:22.442 align:middle line:90%,end
<c.magenta>拖动操作可以很好地</c>
<c.magenta>实现这些效果</c>

00:12:22.509 --> 00:12:25.512 align:middle line:90%,end
<c.magenta>因为在拖动过程中</c>
<c.magenta>视图仍然处于活动状态</c>

00:12:25.579 --> 00:12:27.714 align:middle line:90%,end
<c.magenta>你在视图中</c>
<c.magenta>进行的任何更改</c>

00:12:27.781 --> 00:12:30.817 align:middle line:90%,end
<c.magenta>在动画期间将会反映出来</c>

00:12:30.884 --> 00:12:34.521 align:middle line:90%,end
<c.magenta>当用户开始移动手指时</c>

00:12:34.588 --> 00:12:35.923 align:middle line:90%,end
<c.magenta>才会开始这些效果</c>

00:12:35.989 --> 00:12:39.626 align:middle line:90%,end
<c.magenta>在拖动交互的过程中</c>
<c.magenta>将会保持这些效果</c>

00:12:41.128 --> 00:12:46.033 align:middle line:90%,end
<c.magenta>拖动过程中的动画效果</c>
<c.magenta>就是这样的</c>

00:12:46.266 --> 00:12:47.634 align:middle line:90%,end
<c.magenta>这里有一个委托方法选项</c>

00:12:47.701 --> 00:12:50.737 align:middle line:90%,end
<c.magenta>dragInteraction willAnimateLiftWith</c>
<c.magenta>animator session</c>

00:12:50.804 --> 00:12:53.907 align:middle line:90%,end
<c.magenta>你将得到一个动画器对象</c>

00:12:53.974 --> 00:12:58.011 align:middle line:90%,end
<c.magenta>我要抓取所有邮件</c>

00:12:58.078 --> 00:12:59.613 align:middle line:90%,end
<c.magenta>我已经把它设置为拖动项目</c>

00:12:59.680 --> 00:13:01.315 align:middle line:90%,end
<c.magenta>然后找到它们的相关messageView</c>

00:12:59.680 --> 00:13:01.315 align:middle line:90%,end
<c.magenta>然后找到它们的相关messageView</c>

00:13:01.381 --> 00:13:03.750 align:middle line:90%,end
<c.magenta>现在我有一个messageView数组</c>

00:13:03.817 --> 00:13:04.985 align:middle line:90%,end
<c.magenta>对于其中的每个元素</c>

00:13:05.519 --> 00:13:08.188 align:middle line:90%,end
<c.magenta>我将一个动画</c>
<c.magenta>添加到动画生成器</c>

00:13:08.255 --> 00:13:11.558 align:middle line:90%,end
<c.magenta>我将alpha设置为0</c>
<c.magenta>实现覆盖层淡出效果</c>

00:13:11.625 --> 00:13:15.162 align:middle line:90%,end
<c.magenta>在completion代码块</c>
<c.magenta>我将alpha重新设置为1</c>

00:13:15.229 --> 00:13:18.332 align:middle line:90%,end
<c.magenta>其效果是</c>
<c.magenta>当视图移动时</c>

00:13:18.398 --> 00:13:19.566 align:middle line:90%,end
<c.magenta>覆盖层将会淡出</c>

00:13:19.633 --> 00:13:22.402 align:middle line:90%,end
<c.magenta>如果用户让其继续</c>
<c.magenta>视图将会归位</c>

00:13:22.469 --> 00:13:23.403 align:middle line:90%,end
<c.magenta>覆盖层将会淡入</c>

00:13:23.470 --> 00:13:26.974 align:middle line:90%,end
<c.magenta>因为动画器能够自动反转动画效果</c>

00:13:27.040 --> 00:13:29.977 align:middle line:90%,end
<c.magenta>当拖动开始时</c>
<c.magenta>将开始视图的动画效果</c>

00:13:30.043 --> 00:13:32.312 align:middle line:90%,end
<c.magenta>在此之后</c>
<c.magenta>将会调用completion代码块</c>

00:13:32.379 --> 00:13:35.916 align:middle line:90%,end
<c.magenta>覆盖层将会恢复原状</c>

00:13:35.983 --> 00:13:38.485 align:middle line:90%,end
<c.magenta>这意味着 在动画过程中</c>
<c.magenta>将不会有覆盖层</c>

00:13:38.552 --> 00:13:41.121 align:middle line:90%,end
<c.magenta>但是在视图中</c>
<c.magenta>它仍然保留在应用中</c>

00:13:41.555 --> 00:13:43.957 align:middle line:90%,end
<c.magenta>如果移动的视图</c>

00:13:44.458 --> 00:13:47.661 align:middle line:90%,end
<c.magenta>进行交互操作的视图</c>
<c.magenta>不是已经设置交互的视图</c>

00:13:47.728 --> 00:13:51.899 align:middle line:90%,end
<c.magenta>或者视图不是方形的</c>
<c.magenta>我们应该怎么做？</c>

00:13:51.965 --> 00:13:55.202 align:middle line:90%,end
<c.magenta>我们已经看到</c>
<c.magenta>可以使用视图初始化UIDragPreview</c>

00:13:55.269 --> 00:13:56.670 align:middle line:90%,end
<c.magenta>但是这里有另外两个参数</c>

00:13:56.737 --> 00:13:59.072 align:middle line:90%,end
<c.magenta>让我们来逐个研究</c>

00:13:59.139 --> 00:14:03.443 align:middle line:90%,end
<c.magenta>第一个参数对象</c>
<c.magenta>让你能够自定义外观</c>

00:13:59.139 --> 00:14:03.443 align:middle line:90%,end
<c.magenta>第一个参数对象</c>
<c.magenta>让你能够自定义外观</c>

00:14:03.510 --> 00:14:05.846 align:middle line:90%,end
<c.magenta>第二个是用于定位的对象</c>

00:14:06.480 --> 00:14:07.981 align:middle line:90%,end
<c.magenta>首先来看参数</c>

00:14:08.048 --> 00:14:10.484 align:middle line:90%,end
<c.magenta>它是</c>
<c.magenta>UIDragPreviewParameters的一个实例</c>

00:14:10.551 --> 00:14:11.685 align:middle line:90%,end
<c.magenta>有两个属性</c>

00:14:11.985 --> 00:14:14.254 align:middle line:90%,end
<c.magenta>第一个是color</c>
<c.magenta>是位于你的视图背后的</c>

00:14:14.321 --> 00:14:16.890 align:middle line:90%,end
<c.magenta>视图的背景颜色</c>

00:14:16.957 --> 00:14:18.625 align:middle line:90%,end
<c.magenta>由于许多视图</c>
<c.magenta>并不是完全不透明的</c>

00:14:18.692 --> 00:14:22.596 align:middle line:90%,end
<c.magenta>如果我们按照原样进行移动</c>
<c.magenta>可能效果并不会好</c>

00:14:22.663 --> 00:14:25.699 align:middle line:90%,end
<c.magenta>但是 你可以</c>
<c.magenta>自定义想要的颜色</c>

00:14:25.766 --> 00:14:29.903 align:middle line:90%,end
<c.magenta>可以设置为黑色或透明</c>

00:14:29.970 --> 00:14:32.172 align:middle line:90%,end
<c.magenta>第二个属性</c>
<c.magenta>更复杂一些</c>

00:14:32.239 --> 00:14:35.542 align:middle line:90%,end
<c.magenta>它是UIBezierPath 让我们知道</c>

00:14:35.609 --> 00:14:38.812 align:middle line:90%,end
<c.magenta>视图的可见区域是什么</c>

00:14:38.879 --> 00:14:40.547 align:middle line:90%,end
<c.magenta>如果你的视图不是方形</c>

00:14:40.614 --> 00:14:42.816 align:middle line:90%,end
<c.magenta>可以设置成圆角矩形</c>

00:14:42.883 --> 00:14:45.152 align:middle line:90%,end
<c.magenta>但是 我们必须知道</c>

00:14:45.219 --> 00:14:48.222 align:middle line:90%,end
<c.magenta>默认情况下 并不提供</c>
<c.magenta>拖动预览参数</c>

00:14:48.288 --> 00:14:52.759 align:middle line:90%,end
<c.magenta>如果你不为拖动预览参数</c>
<c.magenta>设置一个路径</c>

00:14:52.826 --> 00:14:54.161 align:middle line:90%,end
<c.magenta>将会移动整个视图</c>

00:14:54.228 --> 00:14:56.897 align:middle line:90%,end
<c.magenta>如果你想要裁剪出小矩形</c>

00:14:56.964 --> 00:14:59.633 align:middle line:90%,end
<c.magenta>在本例中</c>
<c.magenta>圆角矩形中有一个小孩</c>

00:14:59.700 --> 00:15:01.235 align:middle line:90%,end
<c.magenta>可以提供一个Bezier路径</c>

00:14:59.700 --> 00:15:01.235 align:middle line:90%,end
<c.magenta>可以提供一个Bezier路径</c>

00:15:01.301 --> 00:15:03.537 align:middle line:90%,end
<c.magenta>将会得到这样的结果</c>

00:15:03.604 --> 00:15:05.305 align:middle line:90%,end
<c.magenta>但是很重要的一点是</c>

00:15:05.372 --> 00:15:08.275 align:middle line:90%,end
<c.magenta>你提供的Bezier路径</c>

00:15:08.342 --> 00:15:10.744 align:middle line:90%,end
<c.magenta>必须在视图的坐标空间</c>
<c.magenta>具有意义</c>

00:15:10.811 --> 00:15:14.047 align:middle line:10%
<c.magenta>在本例中 用于初始化</c>
<c.magenta>圆角矩形的边界</c>

00:15:14.114 --> 00:15:17.784 align:middle line:10%
<c.magenta>具有一个原点</c>
<c.magenta>它相对于容器的原点</c>

00:15:17.851 --> 00:15:19.686 align:middle line:90%,end
<c.magenta>用灰色显示</c>

00:15:19.753 --> 00:15:22.389 align:middle line:90%,end
<c.magenta>视图的原点</c>
<c.magenta>用灰色显示</c>

00:15:22.456 --> 00:15:24.124 align:middle line:90%,end
<c.magenta>那是左上角</c>

00:15:24.525 --> 00:15:26.727 align:middle line:10%
<c.magenta>你还想要标记中点</c>

00:15:26.793 --> 00:15:28.462 align:middle line:10%
<c.magenta>因为它是可见路径的中点</c>

00:15:28.529 --> 00:15:31.665 align:middle line:10%
<c.magenta>将用于定位</c>

00:15:31.965 --> 00:15:35.202 align:middle line:10%
<c.magenta>这种预览的原理</c>
<c.magenta>就是这样的</c>

00:15:35.636 --> 00:15:39.540 align:middle line:90%,end
<c.magenta>设置的路径不仅</c>
<c.magenta>可以小于视图</c>

00:15:39.606 --> 00:15:41.608 align:middle line:90%,end
<c.magenta>也可以设置更大的路径</c>

00:15:41.675 --> 00:15:44.344 align:middle line:90%,end
<c.magenta>在本例中</c>
<c.magenta>原点是负值</c>

00:15:44.411 --> 00:15:46.680 align:middle line:90%,end
<c.magenta>它在视图中的</c>
<c.magenta>工作[听不清]</c>

00:15:46.747 --> 00:15:49.483 align:middle line:90%,end
<c.magenta>从而形成</c>
<c.magenta>这样的相框效果</c>

00:15:49.550 --> 00:15:50.751 align:middle line:90%,end
<c.magenta>你在这里看到的颜色</c>

00:15:50.817 --> 00:15:53.020 align:middle line:90%,end
<c.magenta>实际上是背景颜色</c>
<c.magenta>默认为白色</c>

00:15:53.320 --> 00:15:55.989 align:middle line:90%,end
<c.magenta>如果你想要</c>
<c.magenta>实现自己的文本呈现效果</c>

00:15:56.056 --> 00:16:00.527 align:middle line:90%,end
<c.magenta>可以使用一些</c>
<c.magenta>专用的样式</c>

00:15:56.056 --> 00:16:00.527 align:middle line:90%,end
<c.magenta>可以使用一些</c>
<c.magenta>专用的样式</c>

00:16:00.594 --> 00:16:02.629 align:middle line:90%,end
<c.magenta>实现同样出色的文本移动效果</c>

00:16:02.696 --> 00:16:05.465 align:middle line:90%,end
<c.magenta>你可以参考</c>
<c.magenta>这方面的文档</c>

00:16:06.300 --> 00:16:07.401 align:middle line:90%,end
<c.magenta>再来看target</c>

00:16:07.467 --> 00:16:10.871 align:middle line:90%,end
<c.magenta>target 用于定位</c>
<c.magenta>过渡视图</c>

00:16:10.938 --> 00:16:14.208 align:middle line:90%,end
<c.magenta>我们用它在视图层次结构中</c>
<c.magenta>执行动画效果</c>

00:16:14.274 --> 00:16:16.043 align:middle line:90%,end
<c.magenta>如果你不提供target</c>

00:16:16.109 --> 00:16:18.812 align:middle line:90%,end
<c.magenta>将会根据你提供的</c>
<c.magenta>视图的超类进行推算</c>

00:16:18.879 --> 00:16:23.050 align:middle line:90%,end
<c.magenta>这意味着</c>
<c.magenta>你提供的视图</c>

00:16:23.116 --> 00:16:25.252 align:middle line:90%,end
<c.magenta>与目标直接预览相同</c>

00:16:25.919 --> 00:16:29.323 align:middle line:90%,end
<c.magenta>如果视图不在视图层次结构中</c>
<c.magenta>则必须提供target</c>

00:16:29.389 --> 00:16:30.591 align:middle line:90%,end
<c.magenta>否则将会推算target</c>

00:16:30.657 --> 00:16:34.361 align:middle line:90%,end
<c.magenta>这个UIDragPreviewTarget</c>
<c.magenta>有三个参数</c>

00:16:34.428 --> 00:16:35.329 align:middle line:90%,end
<c.magenta>第一个是container</c>

00:16:35.429 --> 00:16:36.763 align:middle line:90%,end
<c.magenta>我们在这个容器中</c>
<c.magenta>载入视图</c>

00:16:36.830 --> 00:16:41.134 align:middle line:90%,end
<c.magenta>因此你需要知道</c>
<c.magenta>该容器中的任何添加或复查子视图调用</c>

00:16:42.069 --> 00:16:44.538 align:middle line:90%,end
<c.magenta>第二个参数是position</c>
<c.magenta>第三个参数是transform</c>

00:16:44.605 --> 00:16:46.006 align:middle line:90%,end
<c.magenta>transform仅用于放入操作</c>

00:16:46.073 --> 00:16:49.610 align:middle line:90%,end
<c.magenta>它允许旋转或</c>
<c.magenta>比例缩放</c>

00:16:49.676 --> 00:16:51.712 align:middle line:90%,end
<c.magenta>position参数</c>
<c.magenta>有一点复杂</c>

00:16:52.079 --> 00:16:53.580 align:middle line:90%,end
<c.magenta>前面我说过</c>

00:16:53.981 --> 00:16:56.817 align:middle line:90%,end
<c.magenta>它是容器中的一个点</c>
<c.magenta>用灰色表示</c>

00:16:56.884 --> 00:17:00.888 align:middle line:90%,end
<c.magenta>默认情况下 视图的中心</c>
<c.magenta>位于此位置</c>

00:16:56.884 --> 00:17:00.888 align:middle line:90%,end
<c.magenta>默认情况下 视图的中心</c>
<c.magenta>位于此位置</c>

00:17:01.255 --> 00:17:04.657 align:middle line:90%,end
<c.magenta>如果你不提供可视路径</c>
<c.magenta>看上去将会是这样的</c>

00:17:04.790 --> 00:17:08.095 align:middle line:90%,end
<c.magenta>但是 如果你提供</c>
<c.magenta>一个可视路径</c>

00:17:08.228 --> 00:17:12.766 align:middle line:90%,end
<c.magenta>此路径的边界的中点</c>
<c.magenta>将是这个位置</c>

00:17:12.833 --> 00:17:14.701 align:middle line:90%,end
<c.magenta>因此 它不再是</c>
<c.magenta>视图的中点</c>

00:17:14.768 --> 00:17:16.770 align:middle line:90%,end
<c.magenta>它是可见路径的中点</c>

00:17:16.837 --> 00:17:19.772 align:middle line:90%,end
<c.magenta>这意味着 如果你的</c>
<c.magenta>路径比较复杂</c>

00:17:19.839 --> 00:17:21.208 align:middle line:90%,end
<c.magenta>比如像这个</c>

00:17:21.275 --> 00:17:24.077 align:middle line:90%,end
<c.magenta>我将两个圆角矩形</c>
<c.magenta>联合在一起</c>

00:17:24.144 --> 00:17:27.481 align:middle line:90%,end
<c.magenta>中点甚至不在</c>
<c.magenta>两个矩形之中</c>

00:17:27.548 --> 00:17:30.851 align:middle line:90%,end
<c.magenta>它是这些形状的</c>
<c.magenta>封闭边界的中点</c>

00:17:31.852 --> 00:17:34.521 align:middle line:90%,end
<c.magenta>在iOS 11中</c>

00:17:34.588 --> 00:17:37.257 align:middle line:90%,end
<c.magenta>你会注意到</c>
<c.magenta>系统中的许多应用</c>

00:17:37.324 --> 00:17:40.194 align:middle line:90%,end
<c.magenta>在移动之后</c>
<c.magenta>能够更新预览</c>

00:17:40.260 --> 00:17:41.361 align:middle line:90%,end
<c.magenta>在Maps中可以看到</c>

00:17:41.428 --> 00:17:46.033 align:middle line:90%,end
<c.magenta>当我移动这个</c>
<c.magenta>Apple Park单元格时</c>

00:17:46.099 --> 00:17:49.937 align:middle line:90%,end
<c.magenta>它会被这个小地图块代替</c>

00:17:50.003 --> 00:17:51.104 align:middle line:90%,end
<c.magenta>我们如何做到这一点？</c>

00:17:51.171 --> 00:17:54.141 align:middle line:90%,end
<c.magenta>系统中的有一个</c>
<c.magenta>第二预览类</c>

00:17:54.208 --> 00:17:57.878 align:middle line:90%,end
<c.magenta>除了 UITargetedDragPreview之外</c>
<c.magenta>还有UIDragPreview</c>

00:17:57.945 --> 00:18:01.181 align:middle line:90%,end
<c.magenta>与你们的预料一样</c>
<c.magenta>它类似于UITargetedDragPreview</c>

00:17:57.945 --> 00:18:01.181 align:middle line:90%,end
<c.magenta>与你们的预料一样</c>
<c.magenta>它类似于UITargetedDragPreview</c>

00:18:01.248 --> 00:18:02.549 align:middle line:90%,end
<c.magenta>但是没有target</c>

00:18:02.950 --> 00:18:05.018 align:middle line:90%,end
<c.magenta>其它的语义是相同的</c>

00:18:05.085 --> 00:18:08.488 align:middle line:90%,end
<c.magenta>用于初始化这个预览的视图</c>

00:18:08.555 --> 00:18:11.825 align:middle line:90%,end
<c.magenta>可能位于视图层次结构中</c>
<c.magenta>也可能不是 但这并不重要</c>

00:18:12.693 --> 00:18:14.695 align:middle line:90%,end
<c.magenta>那么如何更新这个预览呢？</c>

00:18:15.128 --> 00:18:19.900 align:middle line:90%,end
<c.magenta>首先 应该在会话生命周期中</c>
<c.magenta>中找到一个合适的点</c>

00:18:19.967 --> 00:18:22.135 align:middle line:90%,end
<c.magenta>在本例中 我选择sessionDidMove</c>

00:18:22.202 --> 00:18:23.837 align:middle line:90%,end
<c.magenta>在这里 我要做的是</c>

00:18:23.904 --> 00:18:28.308 align:middle line:90%,end
<c.magenta>当用户在我的Mail程序中</c>
<c.magenta>移出列表视图时</c>

00:18:28.375 --> 00:18:31.512 align:middle line:90%,end
<c.magenta>我想使用一个信封图片</c>
<c.magenta>代替他们正在拖动的内容</c>

00:18:31.578 --> 00:18:34.748 align:middle line:90%,end
<c.magenta>首先 我进行点击检查</c>
<c.magenta>查看焦点是否仍然在列表视图中</c>

00:18:34.815 --> 00:18:37.284 align:middle line:90%,end
<c.magenta>如果是 就取消操作</c>
<c.magenta>不返回任何内容</c>

00:18:38.118 --> 00:18:43.323 align:middle line:90%,end
<c.magenta>然后 我迭代所有项目</c>
<c.magenta>这些项目将邮件作为它们的本地对象</c>

00:18:44.324 --> 00:18:46.326 align:middle line:90%,end
<c.magenta>我检查是否</c>
<c.magenta>已经更新此项目</c>

00:18:46.393 --> 00:18:47.628 align:middle line:90%,end
<c.magenta>因为这项操作会占用资源</c>

00:18:47.694 --> 00:18:50.864 align:middle line:90%,end
<c.magenta>可能会频繁调用sessionDidMove</c>

00:18:50.931 --> 00:18:52.232 align:middle line:90%,end
<c.magenta>如果没有更新</c>

00:18:52.299 --> 00:18:54.468 align:middle line:90%,end
<c.magenta>我将设置previewProvider</c>

00:18:54.535 --> 00:18:57.638 align:middle line:90%,end
<c.magenta>后面我将会调用这个代码块</c>
<c.magenta>以更新视图</c>

00:18:57.704 --> 00:19:00.974 align:middle line:90%,end
<c.magenta>在代码块内 我首先</c>
<c.magenta>使用我喜欢的图片创建一个图像视图</c>

00:18:57.704 --> 00:19:00.974 align:middle line:90%,end
<c.magenta>在代码块内 我首先</c>
<c.magenta>使用我喜欢的图片创建一个图像视图</c>

00:19:01.441 --> 00:19:03.810 align:middle line:90%,end
<c.magenta>然后用它初始化</c>
<c.magenta>一个新的拖动预览</c>

00:19:03.877 --> 00:19:07.681 align:middle line:90%,end
<c.magenta>很重要的一点是 应该认识到</c>
<c.magenta>我们可能不会调用这个代码块</c>

00:19:07.748 --> 00:19:11.151 align:middle line:90%,end
<c.magenta>因此 如果要移动许多邮件</c>

00:19:11.218 --> 00:19:12.886 align:middle line:90%,end
<c.magenta>我们可能会决定</c>
<c.magenta>不显示所有邮件</c>

00:19:12.953 --> 00:19:14.821 align:middle line:90%,end
<c.magenta>对于不会在屏幕上</c>
<c.magenta>显示的视图</c>

00:19:14.888 --> 00:19:16.790 align:middle line:90%,end
<c.magenta>不需要调用它们的预览代码块</c>

00:19:17.524 --> 00:19:19.593 align:middle line:90%,end
<c.magenta>最后这点也很重要</c>
<c.magenta>我必须进行一些记录</c>

00:19:19.660 --> 00:19:22.329 align:middle line:90%,end
<c.magenta>实践比理论更重要</c>

00:19:22.396 --> 00:19:23.864 align:middle line:90%,end
<c.magenta>文森将为大家</c>
<c.magenta>进行另外一项演示</c>

00:19:23.931 --> 00:19:25.465 align:middle line:90%,end
<c.magenta>稍后再见 谢谢</c>

00:19:30.938 --> 00:19:32.739 align:middle line:90%,end
<c.magenta>谢谢 罗布</c>

00:19:32.806 --> 00:19:35.843 align:middle line:90%,end
<c.magenta>我们来看第二个例子</c>

00:19:35.909 --> 00:19:37.711 align:middle line:90%,end
<c.magenta>接下来的例子是Drag Source</c>

00:19:38.545 --> 00:19:39.613 align:middle line:90%,end
<c.magenta>请看</c>

00:19:40.314 --> 00:19:43.016 align:middle line:90%,end
<c.magenta>当我拖动这张含有两个二维码的图片时</c>

00:19:43.083 --> 00:19:45.853 align:middle line:90%,end
<c.magenta>我们获得一个拖动会话</c>
<c.magenta>它含有两个项目</c>

00:19:45.919 --> 00:19:48.422 align:middle line:90%,end
<c.magenta>这两个项目是什么？</c>
<c.magenta>如果我把它放入Photos</c>

00:19:48.488 --> 00:19:51.124 align:middle line:90%,end
<c.magenta>我们看到 它实际是</c>
<c.magenta>二维码的裁剪图片</c>

00:19:51.191 --> 00:19:54.895 align:middle line:90%,end
<c.magenta>然后 我检查到</c>
<c.magenta>二维码在图片中的位置</c>

00:19:55.362 --> 00:19:58.732 align:middle line:90%,end
<c.magenta>我们可以修饰</c>
<c.magenta>这个拖动预览</c>

00:19:58.799 --> 00:20:00.567 align:middle line:90%,end
<c.magenta>我们还没有进行任何自定义</c>

00:19:58.799 --> 00:20:00.567 align:middle line:90%,end
<c.magenta>我们还没有进行任何自定义</c>

00:20:00.634 --> 00:20:04.238 align:middle line:90%,end
<c.magenta>默认情况下</c>
<c.magenta>我们使用整个图像视图</c>

00:20:04.304 --> 00:20:07.641 align:middle line:90%,end
<c.magenta>展示项目或二维码</c>

00:20:07.708 --> 00:20:11.411 align:middle line:90%,end
<c.magenta>实际上 我们两次看到整个图像视图</c>

00:20:11.478 --> 00:20:13.413 align:middle line:90%,end
<c.magenta>两个项目互相重叠</c>

00:20:13.480 --> 00:20:16.717 align:middle line:90%,end
<c.magenta>这是一个不错的做法</c>
<c.magenta>如果在提升和拖动时</c>

00:20:16.783 --> 00:20:20.521 align:middle line:90%,end
<c.magenta>能够将二维码</c>
<c.magenta>作为拖动预览</c>

00:20:21.088 --> 00:20:24.258 align:middle line:90%,end
<c.magenta>让我们来看应该怎么做</c>

00:20:25.125 --> 00:20:28.328 align:middle line:90%,end
<c.magenta>首先我们要做的是</c>
<c.magenta>实现previewForLifting item</c>

00:20:28.529 --> 00:20:31.665 align:middle line:90%,end
<c.magenta>在这里 我们需要获取</c>
<c.magenta>二维码的一些信息</c>

00:20:31.732 --> 00:20:33.834 align:middle line:90%,end
<c.magenta>主要是二维码的裁剪图像</c>

00:20:33.901 --> 00:20:36.904 align:middle line:90%,end
<c.magenta>以及一些几何信息</c>
<c.magenta>描述其在图片中的位置</c>

00:20:36.970 --> 00:20:39.573 align:middle line:90%,end
<c.magenta>我们使用这些信息</c>
<c.magenta>创建一个新UIImageView</c>

00:20:40.374 --> 00:20:42.743 align:middle line:90%,end
<c.magenta>然后创建DragPreviewTarget</c>

00:20:42.910 --> 00:20:44.545 align:middle line:90%,end
<c.magenta>和DragPreviewParameters</c>

00:20:44.611 --> 00:20:46.780 align:middle line:90%,end
<c.magenta>请注意 在这里</c>
<c.magenta>我们将visiblePath</c>

00:20:46.847 --> 00:20:49.049 align:middle line:90%,end
<c.magenta>设置为新UIBezierPath</c>
<c.magenta>它是一个roundedRect</c>

00:20:49.116 --> 00:20:51.285 align:middle line:90%,end
<c.magenta>这将提供一个</c>
<c.magenta>美观的圆角预览</c>

00:20:51.552 --> 00:20:52.819 align:middle line:10%
<c.magenta>然后我们将这些信息</c>

00:20:52.886 --> 00:20:54.888 align:middle line:10%
<c.magenta>组合到新的</c>
<c.magenta>targeted drag preview之中</c>

00:20:55.522 --> 00:20:56.757 align:middle line:90%,end
<c.magenta>进行这些修改之后</c>

00:20:57.691 --> 00:21:01.862 align:middle line:90%,end
<c.magenta>当我们移动时</c>
<c.magenta>可以看到更美观的拖动预览</c>

00:20:57.691 --> 00:21:01.862 align:middle line:90%,end
<c.magenta>当我们移动时</c>
<c.magenta>可以看到更美观的拖动预览</c>

00:21:02.462 --> 00:21:04.765 align:middle line:90%,end
<c.magenta>现在来看 当我进行移动时</c>
<c.magenta>会发生什么</c>

00:21:04.965 --> 00:21:07.467 align:middle line:90%,end
<c.magenta>这次并没有弹出</c>
<c.magenta>整个图片</c>

00:21:07.534 --> 00:21:12.673 align:middle line:90%,end
<c.magenta>我们看到两个二维码的</c>
<c.magenta>矩形图像被提升</c>

00:21:12.739 --> 00:21:13.707 align:middle line:90%,end
<c.magenta>当我进行拖动时</c>

00:21:13.774 --> 00:21:17.978 align:middle line:90%,end
<c.magenta>可以看到两个二维码</c>
<c.magenta>随之移动</c>

00:21:18.045 --> 00:21:19.479 align:middle line:90%,end
<c.magenta>看上去很不错</c>

00:21:19.546 --> 00:21:22.182 align:middle line:90%,end
<c.magenta>有一个地方看上去比较奇怪</c>
<c.magenta>让我展示给你们看</c>

00:21:22.249 --> 00:21:24.985 align:middle line:90%,end
<c.magenta>当我放开二维码时</c>
<c.magenta>请看会发生什么</c>

00:21:25.052 --> 00:21:27.421 align:middle line:90%,end
<c.magenta>没有地方接受放入操作</c>

00:21:27.487 --> 00:21:29.189 align:middle line:90%,end
<c.magenta>因此 我们需要做一个取消动画</c>

00:21:29.256 --> 00:21:31.959 align:middle line:90%,end
<c.magenta>问题在于</c>
<c.magenta>我们实际上并没有告诉UIKit</c>

00:21:32.025 --> 00:21:35.329 align:middle line:90%,end
<c.magenta>当我们取消拖动时</c>
<c.magenta>拖动预览动画应该显示到何处</c>

00:21:35.395 --> 00:21:36.797 align:middle line:90%,end
<c.magenta>让我们来解决这个问题</c>

00:21:37.464 --> 00:21:40.801 align:middle line:90%,end
<c.magenta>为此 我们实现</c>
<c.magenta>previewForCancelling item</c>

00:21:41.168 --> 00:21:44.071 align:middle line:90%,end
<c.magenta>它看上去很像 previewForLifting</c>
<c.magenta>item 而且工作原理相似</c>

00:21:44.137 --> 00:21:45.639 align:middle line:90%,end
<c.magenta>我们希望</c>

00:21:45.706 --> 00:21:48.008 align:middle line:90%,end
<c.magenta>二维码返回其初始位置</c>

00:21:48.075 --> 00:21:49.376 align:middle line:90%,end
<c.magenta>我们所做的工作</c>

00:21:49.443 --> 00:21:51.311 align:middle line:90%,end
<c.magenta>与第一个例子相以</c>

00:21:51.378 --> 00:21:55.015 align:middle line:90%,end
<c.magenta>调用</c>
<c.magenta>previewForLifting item中使用的代码</c>

00:21:55.082 --> 00:21:57.184 align:middle line:90%,end
<c.magenta>把它放入单独的helper</c>

00:21:57.251 --> 00:21:59.419 align:middle line:90%,end
<c.magenta>我们将它命名为</c>
<c.magenta>dragPreview for item</c>

00:21:59.486 --> 00:22:00.954 align:middle line:90%,end
<c.magenta>它所做的工作是</c>

00:21:59.486 --> 00:22:00.954 align:middle line:90%,end
<c.magenta>它所做的工作是</c>

00:22:01.688 --> 00:22:06.093 align:middle line:90%,end
<c.magenta>返回二维码的初始位置</c>

00:22:06.527 --> 00:22:10.564 align:middle line:90%,end
<c.magenta>也就是我们开始移动时的位置</c>
<c.magenta>当取消移动时</c>

00:22:11.164 --> 00:22:14.902 align:middle line:90%,end
<c.magenta>将会在这两个位置</c>
<c.magenta>调用helper 速度很快</c>

00:22:15.202 --> 00:22:18.972 align:middle line:90%,end
<c.magenta>然后返回程序</c>

00:22:21.241 --> 00:22:23.777 align:middle line:90%,end
<c.magenta>当我们来看 当取消移动时</c>
<c.magenta>会发生什么</c>

00:22:24.444 --> 00:22:27.848 align:middle line:90%,end
<c.magenta>可以看到 它们快速地</c>
<c.magenta>回到初始位置</c>

00:22:28.348 --> 00:22:30.350 align:middle line:90%,end
<c.magenta>看上去比刚才好多了</c>

00:22:30.417 --> 00:22:32.319 align:middle line:90%,end
<c.magenta>但是还有另外一个问题</c>

00:22:32.619 --> 00:22:37.591 align:middle line:90%,end
<c.magenta>我们想要跳转到右侧</c>
<c.magenta>也就是Photos所在的位置</c>

00:22:37.858 --> 00:22:40.327 align:middle line:90%,end
<c.magenta>你会注意到</c>
<c.magenta>当我拖动图片时</c>

00:22:40.394 --> 00:22:42.763 align:middle line:90%,end
<c.magenta>图像视图的背景会淡出</c>

00:22:42.829 --> 00:22:46.300 align:middle line:90%,end
<c.magenta>以指示我们当前正在</c>
<c.magenta>从那个视图拖动一张图片</c>

00:22:46.700 --> 00:22:49.036 align:middle line:90%,end
<c.magenta>系统中的很多应用</c>
<c.magenta>都会这样做</c>

00:22:49.102 --> 00:22:52.072 align:middle line:90%,end
<c.magenta>我们的演示应用</c>
<c.magenta>也具有这样的效果</c>

00:22:53.073 --> 00:22:54.208 align:middle line:90%,end
<c.magenta>让我展示给你们看</c>

00:22:55.943 --> 00:22:59.079 align:middle line:90%,end
<c.magenta>我们要做的是</c>
<c.magenta>实现一些伴随动画</c>

00:22:59.146 --> 00:23:00.647 align:middle line:90%,end
<c.magenta>我们为提升设置动画效果</c>

00:22:59.146 --> 00:23:00.647 align:middle line:90%,end
<c.magenta>我们为提升设置动画效果</c>

00:23:00.714 --> 00:23:04.818 align:middle line:90%,end
<c.magenta>得到这个动画器对象</c>
<c.magenta>可以将它关联到伴随动画</c>

00:23:04.885 --> 00:23:08.522 align:middle line:90%,end
<c.magenta>我们添加这个新代码块</c>
<c.magenta>将alpha设置为0.5</c>

00:23:08.689 --> 00:23:11.825 align:middle line:90%,end
<c.magenta>此alpha值成为</c>
<c.magenta>总体图像视图的alpha值</c>

00:23:12.025 --> 00:23:14.528 align:middle line:90%,end
<c.magenta>当进行提升时</c>
<c.magenta>图像视图将会淡出</c>

00:23:14.595 --> 00:23:18.232 align:middle line:90%,end
<c.magenta>当取消拖动预览时</c>

00:23:18.298 --> 00:23:21.902 align:middle line:90%,end
<c.magenta>会将alpha还原为1</c>
<c.magenta>然后视图重新淡入</c>

00:23:22.236 --> 00:23:24.004 align:middle line:90%,end
<c.magenta>如果alpha值始终是0.5</c>

00:23:24.071 --> 00:23:27.007 align:middle line:90%,end
<c.magenta>效果并不好</c>

00:23:27.074 --> 00:23:28.475 align:middle line:90%,end
<c.magenta>当拖动会话结束时</c>

00:23:28.542 --> 00:23:31.879 align:middle line:90%,end
<c.magenta>我们应该小心地</c>
<c.magenta>将alpha还原为1</c>

00:23:31.945 --> 00:23:35.249 align:middle line:90%,end
<c.magenta>确保拖动结束时</c>
<c.magenta>还原为完全不透明状态</c>

00:23:37.184 --> 00:23:39.453 align:middle line:90%,end
<c.magenta>进行这些修改之后</c>

00:23:39.520 --> 00:23:40.854 align:middle line:90%,end
<c.magenta>我返回应用</c>

00:23:41.588 --> 00:23:43.590 align:middle line:90%,end
<c.magenta>注意到 当我开始提升时</c>
<c.magenta>会发生什么</c>

00:23:44.224 --> 00:23:47.561 align:middle line:90%,end
<c.magenta>可以看到 这很好地显示出</c>
<c.magenta>二维码所在的位置</c>

00:23:47.628 --> 00:23:49.563 align:middle line:90%,end
<c.magenta>图像视图的其余部分淡出</c>

00:23:50.430 --> 00:23:51.932 align:middle line:90%,end
<c.magenta>当我取消时</c>

00:23:51.999 --> 00:23:55.068 align:middle line:90%,end
<c.magenta>图像视图的其余部分</c>
<c.magenta>平滑地淡入</c>

00:23:56.303 --> 00:23:59.173 align:middle line:90%,end
<c.magenta>看上去很不错</c>
<c.magenta>让我们来看第三个例子</c>

00:23:59.339 --> 00:24:01.074 align:middle line:90%,end
<c.magenta>这是可拖动位置图像视图</c>

00:23:59.339 --> 00:24:01.074 align:middle line:90%,end
<c.magenta>这是可拖动位置图像视图</c>

00:24:01.508 --> 00:24:05.212 align:middle line:90%,end
<c.magenta>在这里 比较复杂的是</c>

00:24:05.279 --> 00:24:08.248 align:middle line:90%,end
<c.magenta>当我们开始拖动时</c>
<c.magenta>不仅要将图像</c>

00:24:08.315 --> 00:24:10.250 align:middle line:90%,end
<c.magenta>作为表示</c>
<c.magenta>添加到项目提供器</c>

00:24:10.317 --> 00:24:12.753 align:middle line:90%,end
<c.magenta>而且还要添加位置</c>

00:24:13.854 --> 00:24:17.191 align:middle line:90%,end
<c.magenta>这意味着 我能够将内容放入</c>
<c.magenta>接受位置的应用</c>

00:24:17.257 --> 00:24:18.525 align:middle line:90%,end
<c.magenta>比如Maps</c>

00:24:18.926 --> 00:24:20.227 align:middle line:90%,end
<c.magenta>而且将会为我导航</c>

00:24:20.294 --> 00:24:23.430 align:middle line:90%,end
<c.magenta>并在地图上标记</c>
<c.magenta>照片的拍摄位置</c>

00:24:23.497 --> 00:24:25.432 align:middle line:90%,end
<c.magenta>很明显 这个位置是</c>
<c.magenta>金门大桥</c>

00:24:25.499 --> 00:24:28.135 align:middle line:90%,end
<c.magenta>看上去很漂亮</c>
<c.magenta>有一点除外</c>

00:24:29.002 --> 00:24:29.903 align:middle line:90%,end
<c.magenta>当我开始拖动时</c>

00:24:29.970 --> 00:24:32.472 align:middle line:90%,end
<c.magenta>还没有对拖动预览</c>
<c.magenta>进行任何自定义</c>

00:24:32.539 --> 00:24:35.475 align:middle line:90%,end
<c.magenta>因此这个默认拖动预览</c>
<c.magenta>也就是整个图像视图</c>

00:24:35.542 --> 00:24:36.743 align:middle line:90%,end
<c.magenta>并不能表明</c>

00:24:36.810 --> 00:24:40.848 align:middle line:90%,end
<c.magenta>我们有一个位置</c>
<c.magenta>而不仅是一张图片</c>

00:24:40.914 --> 00:24:43.083 align:middle line:90%,end
<c.magenta>现在看起来</c>
<c.magenta>我们只是在拖动一张图片</c>

00:24:43.483 --> 00:24:44.852 align:middle line:90%,end
<c.magenta>让我们来解决这个问题</c>

00:24:45.085 --> 00:24:47.120 align:middle line:90%,end
<c.magenta>我们进入</c>
<c.magenta>可拖动位置图像视图</c>

00:24:47.187 --> 00:24:48.789 align:middle line:90%,end
<c.magenta>这是将要执行的逻辑</c>

00:24:49.189 --> 00:24:51.625 align:middle line:90%,end
<c.magenta>我们将要实现</c>
<c.magenta>sessionWillBegin</c>

00:24:51.692 --> 00:24:54.761 align:middle line:90%,end
<c.magenta>那么 当这个会话开始时</c>
<c.magenta>我们想要做什么呢？</c>

00:24:55.329 --> 00:24:57.798 align:middle line:90%,end
<c.magenta>我们想要获取</c>
<c.magenta>已创建的拖动项目</c>

00:24:57.865 --> 00:24:59.900 align:middle line:90%,end
<c.magenta>我们需要</c>
<c.magenta>将previewProvider属性设置为</c>

00:24:59.967 --> 00:25:01.168 align:middle line:90%,end
<c.magenta>新代码块</c>

00:24:59.967 --> 00:25:01.168 align:middle line:90%,end
<c.magenta>新代码块</c>

00:25:01.235 --> 00:25:04.505 align:middle line:90%,end
<c.magenta>在这个代码块中</c>
<c.magenta>我们创建一个新LocationPlatterView</c>

00:25:04.571 --> 00:25:07.908 align:middle line:90%,end
<c.magenta>这是我编写的一个自定义视图</c>
<c.magenta>它知道如何表示图像</c>

00:25:07.975 --> 00:25:11.812 align:middle line:90%,end
<c.magenta>和图像位置描述文本</c>

00:25:11.879 --> 00:25:15.949 align:middle line:90%,end
<c.magenta>我要使用这些信息</c>
<c.magenta>创建新的UIDragPreview</c>

00:25:18.018 --> 00:25:18.886 align:middle line:90%,end
<c.magenta>好了</c>

00:25:19.086 --> 00:25:20.187 align:middle line:90%,end
<c.magenta>在进行这些修改之后</c>

00:25:20.254 --> 00:25:22.356 align:middle line:90%,end
<c.magenta>应该能够看到</c>

00:25:22.422 --> 00:25:25.192 align:middle line:90%,end
<c.magenta>更美观的</c>
<c.magenta>拖动预览表示</c>

00:25:25.859 --> 00:25:27.761 align:middle line:90%,end
<c.magenta>请观看 当我提升时</c>
<c.magenta>会发生什么</c>

00:25:27.995 --> 00:25:31.098 align:middle line:90%,end
<c.magenta>有意思的是</c>
<c.magenta>实际上并没有什么区别</c>

00:25:31.331 --> 00:25:34.701 align:middle line:90%,end
<c.magenta>原因是我们将逻辑</c>
<c.magenta>放入了sessionWillBegin</c>

00:25:34.768 --> 00:25:39.072 align:middle line:90%,end
<c.magenta>当我移动手指时</c>
<c.magenta>会话才开始</c>

00:25:39.273 --> 00:25:41.975 align:middle line:90%,end
<c.magenta>我开始移动 请看</c>

00:25:42.042 --> 00:25:45.112 align:middle line:90%,end
<c.magenta>拖动预览变成了</c>
<c.magenta>这个唱片图案</c>

00:25:45.179 --> 00:25:47.014 align:middle line:90%,end
<c.magenta>显示图像…</c>

00:25:50.117 --> 00:25:52.386 align:middle line:90%,end
<c.magenta>显示图像和位置</c>

00:25:52.452 --> 00:25:54.188 align:middle line:90%,end
<c.magenta>我可以将它放入Maps</c>

00:25:54.254 --> 00:25:56.757 align:middle line:90%,end
<c.magenta>将为我导航 在这里进行标记</c>

00:25:57.157 --> 00:25:59.960 align:middle line:90%,end
<c.magenta>我们已经讨论</c>
<c.magenta>关于一些拖动操作的</c>

00:26:00.027 --> 00:26:02.296 align:middle line:90%,end
<c.magenta>高级技术</c>

00:26:02.362 --> 00:26:04.898 align:middle line:90%,end
<c.magenta>接下来 我想要</c>
<c.magenta>把讲台交给我的同事汤姆</c>

00:26:04.965 --> 00:26:11.638 align:middle line:90%,end
<c.magenta>他讨论一些用于</c>
<c.magenta>自定义放入交互的API</c>

00:26:15.509 --> 00:26:19.079 align:middle line:90%,end
<c.magenta>谢谢 文森</c>
<c.magenta>把我拖进来</c>

00:26:19.479 --> 00:26:20.881 align:middle line:90%,end
<c.magenta>很高兴来到这里</c>

00:26:22.282 --> 00:26:24.284 align:middle line:90%,end
<c.magenta>现在我们来讨论放入</c>

00:26:24.451 --> 00:26:26.987 align:middle line:90%,end
<c.magenta>让我们来深入了解</c>

00:26:27.754 --> 00:26:30.090 align:middle line:90%,end
<c.magenta>首先讨论放入会话</c>

00:26:30.157 --> 00:26:32.993 align:middle line:90%,end
<c.magenta>然后 我将进行放入操作演示</c>

00:26:33.961 --> 00:26:36.830 align:middle line:90%,end
<c.magenta>那么 什么是放入会话？</c>
<c.magenta>它是拖动会话的对应部分</c>

00:26:36.897 --> 00:26:39.466 align:middle line:90%,end
<c.magenta>让你访问</c>
<c.magenta>与放入相关的所有内容</c>

00:26:39.800 --> 00:26:41.902 align:middle line:90%,end
<c.magenta>可以访问拖动位置</c>

00:26:41.969 --> 00:26:44.438 align:middle line:90%,end
<c.magenta>用户将在视图内进行拖动</c>

00:26:44.838 --> 00:26:47.174 align:middle line:90%,end
<c.magenta>让你访问视图中的项目</c>

00:26:47.541 --> 00:26:51.378 align:middle line:90%,end
<c.magenta>查看数据类型</c>
<c.magenta>放入他们的数据</c>

00:26:51.845 --> 00:26:55.382 align:middle line:90%,end
<c.magenta>也可以访问配置</c>
<c.magenta>以进行适当的设置</c>

00:26:55.849 --> 00:26:58.218 align:middle line:90%,end
<c.magenta>最后 还可以访问</c>
<c.magenta>拖动会话本身</c>

00:26:58.285 --> 00:27:00.988 align:middle line:90%,end
<c.magenta>当你进行拖动时</c>
<c.magenta>另外还有更多功能</c>

00:26:58.285 --> 00:27:00.988 align:middle line:90%,end
<c.magenta>当你进行拖动时</c>
<c.magenta>另外还有更多功能</c>

00:27:04.791 --> 00:27:07.060 align:middle line:90%,end
<c.magenta>关于放入操作</c>
<c.magenta>应该记住的一点是</c>

00:27:07.127 --> 00:27:10.831 align:middle line:90%,end
<c.magenta>在同一时间</c>
<c.magenta>只有一个交互</c>

00:27:10.898 --> 00:27:12.099 align:middle line:90%,end
<c.magenta>处理一个活跃的放入会话</c>

00:27:12.799 --> 00:27:16.837 align:middle line:90%,end
<c.magenta>原因是什么？</c>
<c.magenta>因为这适用于大多数应用情况</c>

00:27:17.070 --> 00:27:19.873 align:middle line:90%,end
<c.magenta>这意味着</c>
<c.magenta>当用户进行拖动</c>

00:27:19.940 --> 00:27:21.675 align:middle line:90%,end
<c.magenta>进入交互之后</c>

00:27:21.808 --> 00:27:23.677 align:middle line:90%,end
<c.magenta>任何其它会话</c>

00:27:23.744 --> 00:27:27.014 align:middle line:90%,end
<c.magenta>并尝试进入交互的其它会话</c>
<c.magenta>将不会被拾取</c>

00:27:27.748 --> 00:27:31.118 align:middle line:90%,end
<c.magenta>记住 你可以</c>
<c.magenta>同时使用多根手指进行拖动</c>

00:27:31.818 --> 00:27:33.220 align:middle line:90%,end
<c.magenta>如果你不想要这样的行为</c>

00:27:33.287 --> 00:27:37.257 align:middle line:90%,end
<c.magenta>而且不需要同时</c>
<c.magenta>在视图上有多个活跃会话</c>

00:27:37.324 --> 00:27:38.358 align:middle line:90%,end
<c.magenta>也可以使用其它的方案</c>

00:27:38.825 --> 00:27:40.160 align:middle line:90%,end
<c.magenta>可以添加多个交互</c>

00:27:40.227 --> 00:27:41.728 align:middle line:90%,end
<c.magenta>并添加更多的放入交互</c>

00:27:41.795 --> 00:27:44.031 align:middle line:90%,end
<c.magenta>同时处理所有这些交互</c>

00:27:44.097 --> 00:27:46.834 align:middle line:90%,end
<c.magenta>它们可以具有相同的逻辑</c>
<c.magenta>或不同的逻辑</c>

00:27:46.900 --> 00:27:48.001 align:middle line:90%,end
<c.magenta>这并不重要</c>

00:27:48.402 --> 00:27:50.404 align:middle line:90%,end
<c.magenta>可以设置交互属性</c>

00:27:50.470 --> 00:27:52.673 align:middle line:90%,end
<c.magenta>此属性名称为</c>
<c.magenta>allowSimultaneousDropSessions</c>

00:27:52.840 --> 00:27:53.841 align:middle line:90%,end
<c.magenta>将它设置为真</c>

00:27:53.907 --> 00:27:59.546 align:middle line:90%,end
<c.magenta>将可以同时处理多个会话</c>

00:27:59.613 --> 00:28:02.416 align:middle line:90%,end
<c.magenta>但是 你的委托必须进行正确的处理</c>

00:27:59.613 --> 00:28:02.416 align:middle line:90%,end
<c.magenta>但是 你的委托必须进行正确的处理</c>

00:28:04.017 --> 00:28:05.786 align:middle line:90%,end
<c.magenta>让我们来看放入是如何工作的</c>

00:28:05.853 --> 00:28:07.955 align:middle line:90%,end
<c.magenta>昨天的演讲简要地谈到了这一点</c>

00:28:08.021 --> 00:28:09.623 align:middle line:90%,end
<c.magenta>让我们来看看</c>

00:28:09.823 --> 00:28:12.726 align:middle line:90%,end
<c.magenta>用户拖动一个对象</c>
<c.magenta>它接近你的视图</c>

00:28:13.126 --> 00:28:14.261 align:middle line:10%
<c.magenta>在进行任何处理</c>

00:28:14.328 --> 00:28:17.931 align:middle line:10%
<c.magenta>我们在你的交互委托上</c>
<c.magenta>调用canHandle session</c>

00:28:18.098 --> 00:28:21.068 align:middle line:10%
<c.magenta>根据你返回的内容</c>
<c.magenta>这将触发</c>

00:28:21.134 --> 00:28:23.537 align:middle line:10%
<c.magenta>允许处理会话</c>
<c.magenta>或禁止处理会话</c>

00:28:23.604 --> 00:28:25.005 align:middle line:10%
<c.magenta>如果返回假</c>

00:28:25.072 --> 00:28:27.608 align:middle line:10%
<c.magenta>视图将不会响应放入会话</c>

00:28:27.674 --> 00:28:28.976 align:middle line:10%
<c.magenta>什么也不会发生</c>

00:28:29.610 --> 00:28:31.345 align:middle line:10%
<c.magenta>如果返回真</c>
<c.magenta>或实现这个 方法</c>

00:28:31.411 --> 00:28:33.180 align:middle line:10%
<c.magenta>将会继续并调用sessionDidEnter</c>

00:28:33.247 --> 00:28:36.750 align:middle line:10%
<c.magenta>表示拖动操作</c>
<c.magenta>已经进入你的视图</c>

00:28:37.951 --> 00:28:41.955 align:middle line:10%
<c.magenta>然后用户移动手指</c>
<c.magenta>这时会反复调用sessionDidUpdate</c>

00:28:42.222 --> 00:28:44.057 align:middle line:10%
<c.magenta>你必须返回一个DropProposal</c>

00:28:44.124 --> 00:28:47.528 align:middle line:10%
<c.magenta>请记住</c>
<c.magenta>它将会被多次调用</c>

00:28:47.594 --> 00:28:50.197 align:middle line:90%,end
<c.magenta>因此应该减少这里的工作量</c>

00:28:50.264 --> 00:28:51.198 align:middle line:90%,end
<c.magenta>不要加入过多操作</c>

00:28:51.265 --> 00:28:54.568 align:middle line:90%,end
<c.magenta>这将会降低帧率</c>
<c.magenta>用户可能会不满</c>

00:28:56.170 --> 00:28:58.438 align:middle line:90%,end
<c.magenta>当用户抬起手指时</c>
<c.magenta>将会执行放入</c>

00:28:58.505 --> 00:29:00.007 align:middle line:90%,end
<c.magenta>这里有很多的细节</c>

00:28:58.505 --> 00:29:00.007 align:middle line:90%,end
<c.magenta>这里有很多的细节</c>

00:29:00.140 --> 00:29:04.111 align:middle line:10%
<c.magenta>最后 将会调用sessionDidEnd</c>
<c.magenta>表示会话已经结束</c>

00:29:04.178 --> 00:29:08.515 align:middle line:10%
<c.magenta>默认情况下 你的交互</c>
<c.magenta>准备再次接受新会话</c>

00:29:09.183 --> 00:29:14.655 align:middle line:10%
<c.magenta>现在 假设用户没有抬起手指</c>
<c.magenta>而是把手指收回去</c>

00:29:15.322 --> 00:29:16.390 align:middle line:10%
<c.magenta>如果移出视图之外</c>

00:29:16.456 --> 00:29:20.360 align:middle line:10%
<c.magenta>将会调用sessionDidExit</c>
<c.magenta>会话已经离开视图</c>

00:29:20.427 --> 00:29:22.963 align:middle line:10%
<c.magenta>这并不意味着</c>
<c.magenta>会话已经结束</c>

00:29:23.030 --> 00:29:27.501 align:middle line:10%
<c.magenta>会话仍然继续</c>
<c.magenta>如果用户没有在你的视图之外抬起手指</c>

00:29:27.568 --> 00:29:31.538 align:middle line:90%,end
<c.magenta>将会再次调用sessionDidEnd</c>
<c.magenta>表明会话确实已经结束</c>

00:29:32.639 --> 00:29:35.509 align:middle line:90%,end
<c.magenta>现在 我们假设</c>
<c.magenta>没有抬起手指</c>

00:29:35.576 --> 00:29:36.777 align:middle line:90%,end
<c.magenta>而又重新移回</c>

00:29:37.110 --> 00:29:39.580 align:middle line:90%,end
<c.magenta>从视图之外</c>
<c.magenta>重新移回视图</c>

00:29:39.646 --> 00:29:43.417 align:middle line:90%,end
<c.magenta>将再次调用sessionDidEnter</c>
<c.magenta>并开始调用sessionDidUpdate</c>

00:29:43.483 --> 00:29:46.286 align:middle line:90%,end
<c.magenta>更新会话</c>
<c.magenta>获取一个DropProposal</c>

00:29:47.187 --> 00:29:50.824 align:middle line:90%,end
<c.magenta>假设用户的手指</c>
<c.magenta>停留在视图之外</c>

00:29:50.891 --> 00:29:52.626 align:middle line:90%,end
<c.magenta>不能接受放入的位置</c>

00:29:52.693 --> 00:29:56.096 align:middle line:90%,end
<c.magenta>将会返回操作取消或禁止</c>

00:29:56.363 --> 00:29:58.465 align:middle line:90%,end
<c.magenta>如果用户抬起手指</c>

00:29:59.666 --> 00:30:01.235 align:middle line:90%,end
<c.magenta>将会立即调用sessionDidEnd</c>

00:29:59.666 --> 00:30:01.235 align:middle line:90%,end
<c.magenta>将会立即调用sessionDidEnd</c>

00:30:01.301 --> 00:30:05.072 align:middle line:90%,end
<c.magenta>什么也不发生 不会执行放入</c>
<c.magenta>而是取消放入</c>

00:30:06.840 --> 00:30:09.042 align:middle line:90%,end
<c.magenta>让我们来看DropProposal</c>

00:30:09.610 --> 00:30:11.311 align:middle line:90%,end
<c.magenta>我不重复讨论</c>

00:30:11.378 --> 00:30:13.847 align:middle line:90%,end
<c.magenta>昨天的演讲已经介绍放入操作</c>

00:30:13.914 --> 00:30:16.416 align:middle line:90%,end
<c.magenta>让我们来看一些更有趣的属性</c>

00:30:16.483 --> 00:30:17.885 align:middle line:90%,end
<c.magenta>第一个是精度模式</c>

00:30:18.151 --> 00:30:21.688 align:middle line:90%,end
<c.magenta>如果你设置精度模式</c>
<c.magenta>将setting isPrecise设置为真</c>

00:30:21.855 --> 00:30:27.361 align:middle line:90%,end
<c.magenta>视图的点击测试区域</c>
<c.magenta>将略高于用户触摸位置</c>

00:30:27.427 --> 00:30:30.130 align:middle line:90%,end
<c.magenta>因此 视图中的实际点击测试位置</c>

00:30:30.197 --> 00:30:33.467 align:middle line:90%,end
<c.magenta>不是在用户手指下方</c>
<c.magenta>而是略高的位置</c>

00:30:33.667 --> 00:30:36.637 align:middle line:90%,end
<c.magenta>这能够在视图中</c>
<c.magenta>进入更精确的放入</c>

00:30:36.703 --> 00:30:39.806 align:middle line:90%,end
<c.magenta>因为用户可以清楚地</c>
<c.magenta>看到他们的放入位置</c>

00:30:39.873 --> 00:30:42.075 align:middle line:90%,end
<c.magenta>一个典型的例子是这个文本控件</c>

00:30:42.142 --> 00:30:44.711 align:middle line:90%,end
<c.magenta>这些控件使用精确模式</c>
<c.magenta>显示插入点</c>

00:30:44.778 --> 00:30:48.515 align:middle line:90%,end
<c.magenta>便于用户将内容放入文本视图</c>

00:30:49.249 --> 00:30:52.553 align:middle line:90%,end
<c.magenta>这里可以看到 插入点</c>
<c.magenta>位于用户的屏幕触摸点</c>

00:30:52.619 --> 00:30:54.087 align:middle line:90%,end
<c.magenta>的上方位置</c>

00:30:54.588 --> 00:30:57.157 align:middle line:90%,end
<c.magenta>如果不这样做</c>
<c.magenta>插入点将位于手指正下方</c>

00:30:57.224 --> 00:31:02.863 align:middle line:90%,end
<c.magenta>这样就比较不容易</c>
<c.magenta>精确地放入文本中的特定位置点</c>

00:30:57.224 --> 00:31:02.863 align:middle line:90%,end
<c.magenta>这样就比较不容易</c>
<c.magenta>精确地放入文本中的特定位置点</c>

00:31:02.930 --> 00:31:04.932 align:middle line:90%,end
<c.magenta>因此 如果实现精确模式</c>

00:31:04.998 --> 00:31:08.569 align:middle line:90%,end
<c.magenta>请在放入点显示一些UI元素</c>

00:31:08.869 --> 00:31:12.372 align:middle line:90%,end
<c.magenta>向用户指示放入位置</c>

00:31:14.041 --> 00:31:16.643 align:middle line:90%,end
<c.magenta>接下来是prefersFullSizePreview</c>

00:31:17.744 --> 00:31:19.213 align:middle line:90%,end
<c.magenta>此属性提供预览缩放功能</c>

00:31:19.279 --> 00:31:22.382 align:middle line:90%,end
<c.magenta>在使用iOS11时</c>
<c.magenta>你可能注意到</c>

00:31:22.449 --> 00:31:24.952 align:middle line:90%,end
<c.magenta>如果拖动项目</c>
<c.magenta>项目将会缩小</c>

00:31:25.018 --> 00:31:27.287 align:middle line:90%,end
<c.magenta>系统始终会缩小项目</c>

00:31:27.487 --> 00:31:29.723 align:middle line:90%,end
<c.magenta>我们为什么要这样做呢？</c>
<c.magenta>因为屏幕和你的UI上显示</c>

00:31:29.790 --> 00:31:34.194 align:middle line:90%,end
<c.magenta>较大的预览并没有意义</c>
<c.magenta>因为UI是交互性的</c>

00:31:34.361 --> 00:31:37.431 align:middle line:90%,end
<c.magenta>如果用过大的预览</c>
<c.magenta>遮盖屏幕</c>

00:31:37.497 --> 00:31:40.467 align:middle line:90%,end
<c.magenta>将难以进行导航</c>
<c.magenta>因此我们进行比例缩小</c>

00:31:41.068 --> 00:31:42.569 align:middle line:90%,end
<c.magenta>但是在某些情况下</c>

00:31:42.636 --> 00:31:45.939 align:middle line:90%,end
<c.magenta>可能需要全尺寸预览</c>

00:31:46.006 --> 00:31:49.343 align:middle line:90%,end
<c.magenta>比如 你有一个列表</c>
<c.magenta>可以重新排序这个列表</c>

00:31:49.409 --> 00:31:51.979 align:middle line:90%,end
<c.magenta>如果拾取某个项目</c>
<c.magenta>尝试移动它</c>

00:31:52.079 --> 00:31:54.948 align:middle line:90%,end
<c.magenta>缩小整个项目将没有意义</c>

00:31:55.015 --> 00:31:58.285 align:middle line:90%,end
<c.magenta>在这里 可以添加</c>
<c.magenta>prefersFullSizePreviews</c>

00:31:58.452 --> 00:31:59.653 align:middle line:10%
<c.magenta>这有两种方法</c>

00:31:59.720 --> 00:32:03.924 align:middle line:10%
<c.magenta>在拖动位置 有一个拖动DragInteraction</c>
<c.magenta>prefersFullSizePreviewsFor session</c>

00:31:59.720 --> 00:32:03.924 align:middle line:10%
<c.magenta>在拖动位置 有一个拖动DragInteraction</c>
<c.magenta>prefersFullSizePreviewsFor session</c>

00:32:04.191 --> 00:32:08.395 align:middle line:10%
<c.magenta>这里返回真</c>
<c.magenta>将保持全尺寸预览</c>

00:32:08.462 --> 00:32:12.499 align:middle line:10%
<c.magenta>在放入位置</c>
<c.magenta>可以在DropProposal上将标记设置为真</c>

00:32:13.367 --> 00:32:15.469 align:middle line:10%
<c.magenta>请注意这是一个偏好项</c>

00:32:15.869 --> 00:32:20.841 align:middle line:90%,end
<c.magenta>可以缩放 也可以不缩放</c>

00:32:20.908 --> 00:32:24.545 align:middle line:90%,end
<c.magenta>在有些情况下</c>
<c.magenta>系统始终会进行缩小</c>

00:32:25.312 --> 00:32:29.850 align:middle line:90%,end
<c.magenta>一种情况是组合拖动</c>
<c.magenta>如果添加多个项目以进行拖动</c>

00:32:29.917 --> 00:32:34.087 align:middle line:90%,end
<c.magenta>将始终会缩小这些项目</c>
<c.magenta>即使你选择全尺寸</c>

00:32:35.088 --> 00:32:40.827 align:middle line:90%,end
<c.magenta>对于单预览 如果拖动项目</c>
<c.magenta>并将它拖到你的应用之外</c>

00:32:40.894 --> 00:32:42.963 align:middle line:90%,end
<c.magenta>也始终会进行缩小</c>

00:32:43.964 --> 00:32:45.999 align:middle line:90%,end
<c.magenta>最后 项目缩小之后</c>

00:32:46.066 --> 00:32:47.434 align:middle line:90%,end
<c.magenta>将不会还原比例</c>

00:32:47.501 --> 00:32:48.368 align:middle line:90%,end
<c.magenta>因此请注意</c>

00:32:48.435 --> 00:32:51.371 align:middle line:90%,end
<c.magenta>它是一个偏好项</c>
<c.magenta>但并不是始终不变的</c>

00:32:52.406 --> 00:32:54.174 align:middle line:90%,end
<c.magenta>让我们来进行放入</c>

00:32:54.241 --> 00:32:57.177 align:middle line:10%
<c.magenta>当开始执行放入时</c>
<c.magenta>用户抬起手指</c>

00:32:57.244 --> 00:33:01.348 align:middle line:10%
<c.magenta>此时必须开始载入数据</c>

00:32:57.244 --> 00:33:01.348 align:middle line:10%
<c.magenta>此时必须开始载入数据</c>

00:33:01.415 --> 00:33:03.784 align:middle line:10%
<c.magenta>事实上 只有在此时</c>

00:33:03.851 --> 00:33:08.188 align:middle line:10%
<c.magenta>才能请求数据 并进行放入</c>

00:33:08.255 --> 00:33:11.158 align:middle line:10%
<c.magenta>因为如果在任何其它</c>
<c.magenta>生命周期调用中</c>

00:33:11.225 --> 00:33:13.126 align:middle line:10%
<c.magenta>尝试这样做 都将会失败</c>

00:33:13.193 --> 00:33:16.196 align:middle line:10%
<c.magenta>只有在performDrop中</c>
<c.magenta>才能获取数据</c>

00:33:16.363 --> 00:33:17.898 align:middle line:10%
<c.magenta>需要在另一侧合作</c>

00:33:17.965 --> 00:33:19.800 align:middle line:10%
<c.magenta>因此我说</c>
<c.magenta>只有一个机会</c>

00:33:19.867 --> 00:33:22.102 align:middle line:10%
<c.magenta>但是通常你会获得一些数据</c>

00:33:22.302 --> 00:33:25.539 align:middle line:10%
<c.magenta>数据加载始终是异步的</c>
<c.magenta>因此请不要阻止</c>

00:33:25.606 --> 00:33:28.108 align:middle line:10%
<c.magenta>如果阻止过长时间</c>
<c.magenta>就不会知道</c>

00:33:28.175 --> 00:33:31.478 align:middle line:10%
<c.magenta>数据需要多长时间才会到达</c>

00:33:31.545 --> 00:33:34.948 align:middle line:10%
<c.magenta>系统可能终止你的应用</c>
<c.magenta>这会极大地影响用户体验</c>

00:33:35.015 --> 00:33:36.350 align:middle line:10%
<c.magenta>因此请不要这样做</c>

00:33:37.684 --> 00:33:41.054 align:middle line:10%
<c.magenta>在后台加载数据</c>
<c.magenta>将会导致在你的视图中动画显示项目</c>

00:33:41.121 --> 00:33:42.956 align:middle line:10%
<c.magenta>因此用户看到进行放入</c>

00:33:43.023 --> 00:33:45.859 align:middle line:10%
<c.magenta>最后 调用concludeDrop</c>
<c.magenta>指示动画已经结束</c>

00:33:45.926 --> 00:33:48.829 align:middle line:10%
<c.magenta>在用户注意到时</c>
<c.magenta>放入已经结束</c>

00:33:51.698 --> 00:33:53.901 align:middle line:90%,end
<c.magenta>但是这并不意味着</c>
<c.magenta>数据已经到达</c>

00:33:53.967 --> 00:33:56.703 align:middle line:90%,end
<c.magenta>你可以看到</c>
<c.magenta>这里的第一个调用仍然在继续</c>

00:33:56.770 --> 00:33:58.172 align:middle line:90%,end
<c.magenta>后面我们将会讲到</c>

00:33:58.906 --> 00:34:03.644 align:middle line:90%,end
<c.magenta>如何加载数据？</c>
<c.magenta>有一个非常有用的调用方法</c>

00:33:58.906 --> 00:34:03.644 align:middle line:90%,end
<c.magenta>如何加载数据？</c>
<c.magenta>有一个非常有用的调用方法</c>

00:34:03.710 --> 00:34:06.146 align:middle line:90%,end
<c.magenta>名为loadObjects</c>
<c.magenta>of class completion</c>

00:34:06.213 --> 00:34:07.748 align:middle line:90%,end
<c.magenta>十分适合调用同类数据</c>

00:34:07.814 --> 00:34:11.284 align:middle line:90%,end
<c.magenta>如果你只拖动</c>
<c.magenta>或放入图片</c>

00:34:11.351 --> 00:34:14.821 align:middle line:90%,end
<c.magenta>而且只接受图片</c>
<c.magenta>请使用URImage类</c>

00:34:14.888 --> 00:34:18.792 align:middle line:90%,end
<c.magenta>将提供一个数组</c>
<c.magenta>其排序</c>

00:34:18.859 --> 00:34:20.561 align:middle line:90%,end
<c.magenta>与会话项目数组中的排序相同</c>

00:34:20.627 --> 00:34:23.030 align:middle line:90%,end
<c.magenta>我们将展示给你看</c>

00:34:23.096 --> 00:34:24.598 align:middle line:90%,end
<c.magenta>由于没有在后面进行提升操作</c>

00:34:24.665 --> 00:34:26.132 align:middle line:90%,end
<c.magenta>因此将会返回一个数组</c>

00:34:26.199 --> 00:34:28.502 align:middle line:90%,end
<c.magenta>将会对主队列</c>
<c.magenta>调用Completion代码块</c>

00:34:28.569 --> 00:34:30.670 align:middle line:90%,end
<c.magenta>因此可以立即更新URI</c>

00:34:31.271 --> 00:34:34.507 align:middle line:90%,end
<c.magenta>如果有更多的混合数据</c>
<c.magenta>或者想要进行更多的控制</c>

00:34:34.574 --> 00:34:36.844 align:middle line:90%,end
<c.magenta>可以迭代会话项目</c>

00:34:36.909 --> 00:34:39.213 align:middle line:90%,end
<c.magenta>可以单独加载每个项目</c>

00:34:39.279 --> 00:34:41.849 align:middle line:90%,end
<c.magenta>在ItemProvider上</c>
<c.magenta>使用Use loadObject</c>

00:34:41.915 --> 00:34:45.252 align:middle line:90%,end
<c.magenta>或loadDataRepresentation</c>
<c.magenta>loadFileRepresentation</c>

00:34:45.319 --> 00:34:48.554 align:middle line:90%,end
<c.magenta>让你能够更精细地控制</c>
<c.magenta>想要加载的内容</c>

00:34:48.621 --> 00:34:53.060 align:middle line:90%,end
<c.magenta>甚至允许你为每个项目</c>
<c.magenta>加载多个文件表示</c>

00:34:53.126 --> 00:34:54.393 align:middle line:90%,end
<c.magenta>如果你选择这样做</c>

00:34:54.962 --> 00:34:57.664 align:middle line:90%,end
<c.magenta>请注意 将在后台队列上</c>
<c.magenta>调用这个completion代码块</c>

00:34:58.298 --> 00:35:02.236 align:middle line:90%,end
<c.magenta>如果想要执行URI 工作</c>
<c.magenta>分发到主队列</c>

00:34:58.298 --> 00:35:02.236 align:middle line:90%,end
<c.magenta>如果想要执行URI 工作</c>
<c.magenta>分发到主队列</c>

00:35:03.604 --> 00:35:05.138 align:middle line:90%,end
<c.magenta>现在我把讲台交回给文森</c>

00:35:05.205 --> 00:35:07.841 align:middle line:90%,end
<c.magenta>为大家展示</c>
<c.magenta>实际运用范例</c>

00:35:13.947 --> 00:35:15.682 align:middle line:90%,end
<c.magenta>谢谢 汤姆</c>

00:35:15.883 --> 00:35:19.152 align:middle line:90%,end
<c.magenta>现在我想介绍第二部分演示</c>

00:35:19.419 --> 00:35:23.423 align:middle line:90%,end
<c.magenta>这是第二个演示应用</c>
<c.magenta>名称为Drop Destination</c>

00:35:23.490 --> 00:35:24.858 align:middle line:90%,end
<c.magenta>在这里 我们要做的是</c>

00:35:24.925 --> 00:35:27.561 align:middle line:90%,end
<c.magenta>创建一个类似于Photos的</c>
<c.magenta>照片展示程序</c>

00:35:27.628 --> 00:35:31.965 align:middle line:90%,end
<c.magenta>放入照片将会在</c>
<c.magenta>这个区域增加更多图像视图</c>

00:35:32.065 --> 00:35:34.735 align:middle line:90%,end
<c.magenta>这个流程应该正常工作</c>

00:35:34.801 --> 00:35:36.203 align:middle line:90%,end
<c.magenta>我应该能在这里放入</c>

00:35:36.270 --> 00:35:38.739 align:middle line:90%,end
<c.magenta>应该看到更多图像视图</c>

00:35:38.805 --> 00:35:40.174 align:middle line:90%,end
<c.magenta>但是事与愿违</c>

00:35:40.240 --> 00:35:43.343 align:middle line:90%,end
<c.magenta>让我们进入代码</c>
<c.magenta>弄清楚为什么会这样</c>

00:35:43.911 --> 00:35:45.946 align:middle line:90%,end
<c.magenta>这是我们的逻辑执行代码</c>

00:35:46.013 --> 00:35:47.848 align:middle line:90%,end
<c.magenta>Droppable Image Preview Controller</c>

00:35:47.915 --> 00:35:51.451 align:middle line:90%,end
<c.magenta>这里可以看到</c>
<c.magenta>我们只实现sessionDidUpdate</c>

00:35:51.652 --> 00:35:53.387 align:middle line:90%,end
<c.magenta>因此无法进行放入</c>

00:35:53.453 --> 00:35:56.423 align:middle line:90%,end
<c.magenta>因为我们还没有实现</c>
<c.magenta>任何放入处理功能</c>

00:35:56.590 --> 00:35:58.659 align:middle line:90%,end
<c.magenta>在这里 我要实现</c>
<c.magenta>performDrop</c>

00:35:58.725 --> 00:36:00.561 align:middle line:90%,end
<c.magenta>在这个方法中</c>

00:35:58.725 --> 00:36:00.561 align:middle line:90%,end
<c.magenta>在这个方法中</c>

00:36:00.627 --> 00:36:03.864 align:middle line:90%,end
<c.magenta>将会迭代会话中的所有项目</c>

00:36:03.931 --> 00:36:06.733 align:middle line:90%,end
<c.magenta>对于每个项目</c>
<c.magenta>如果能够加载一个UI图像</c>

00:36:06.800 --> 00:36:10.237 align:middle line:90%,end
<c.magenta>将会插入一个</c>
<c.magenta>新图像视图到层次结构中</c>

00:36:10.304 --> 00:36:12.806 align:middle line:90%,end
<c.magenta>然后通过itemProvider进行加载</c>

00:36:12.940 --> 00:36:14.441 align:middle line:90%,end
<c.magenta>当itemProvider完成加载时</c>

00:36:14.508 --> 00:36:16.143 align:middle line:90%,end
<c.magenta>将会回调主队列</c>

00:36:16.210 --> 00:36:19.079 align:middle line:90%,end
<c.magenta>将刚才插入的</c>
<c.magenta>图像视图的图像</c>

00:36:19.146 --> 00:36:21.949 align:middle line:90%,end
<c.magenta>设置为ItemProvider返回的</c>
<c.magenta>这个新图像</c>

00:36:22.850 --> 00:36:23.851 align:middle line:90%,end
<c.magenta>在进行这些修改之后</c>

00:36:23.917 --> 00:36:27.154 align:middle line:90%,end
<c.magenta>我们应该能够</c>
<c.magenta>让这个基本流程顺利工作</c>

00:36:30.224 --> 00:36:31.625 align:middle line:90%,end
<c.magenta>让我们来看将会发生什么</c>

00:36:32.759 --> 00:36:35.495 align:middle line:90%,end
<c.magenta>现在 你注意到的第一件事是</c>
<c.magenta>这里有一个绿色的+3图标</c>

00:36:35.562 --> 00:36:38.732 align:middle line:90%,end
<c.magenta>这表示有一个操作即将执行</c>

00:36:38.799 --> 00:36:43.370 align:middle line:90%,end
<c.magenta>显然 这个操作是插入新图像</c>

00:36:43.437 --> 00:36:44.671 align:middle line:90%,end
<c.magenta>这很简单</c>

00:36:45.472 --> 00:36:48.208 align:middle line:90%,end
<c.magenta>让我们来看另外一个特性</c>

00:36:48.375 --> 00:36:50.878 align:middle line:90%,end
<c.magenta>你可能注意到 底部这个区域显示</c>

00:36:50.944 --> 00:36:53.013 align:middle line:90%,end
<c.magenta>放入这里以删除照片</c>

00:36:53.280 --> 00:36:54.381 align:middle line:90%,end
<c.magenta>的确是这样的</c>

00:36:55.015 --> 00:36:57.484 align:middle line:90%,end
<c.magenta>当我把照片放入这里</c>
<c.magenta>上面的照片就被删除了</c>

00:36:57.551 --> 00:36:58.652 align:middle line:90%,end
<c.magenta>看上去还不错</c>

00:36:58.719 --> 00:37:02.122 align:middle line:90%,end
<c.magenta>但问题是 我们并没有对</c>
<c.magenta>放入预览进行任何自定义</c>

00:36:58.719 --> 00:37:02.122 align:middle line:90%,end
<c.magenta>但问题是 我们并没有对</c>
<c.magenta>放入预览进行任何自定义</c>

00:37:02.189 --> 00:37:03.090 align:middle line:90%,end
<c.magenta>默认情况下</c>

00:37:03.156 --> 00:37:06.226 align:middle line:90%,end
<c.magenta>照片移动到中间 然后淡出</c>

00:37:06.493 --> 00:37:10.464 align:middle line:90%,end
<c.magenta>现在请汤姆上来</c>
<c.magenta>为我们进行优化</c>

00:37:16.003 --> 00:37:19.439 align:middle line:90%,end
<c.magenta>我们发现 并不需要</c>
<c.magenta>许多代码来执行放入</c>

00:37:19.940 --> 00:37:22.876 align:middle line:90%,end
<c.magenta>让我们来讨论放入预览</c>
<c.magenta>和它们的动画效果</c>

00:37:23.911 --> 00:37:25.379 align:middle line:90%,end
<c.magenta>让我们调出这个图表</c>

00:37:25.445 --> 00:37:29.516 align:middle line:90%,end
<c.magenta>它看上去比较简单</c>

00:37:29.583 --> 00:37:33.487 align:middle line:90%,end
<c.magenta>让我们把这个concludeDrop放到一边</c>

00:37:33.554 --> 00:37:36.156 align:middle line:90%,end
<c.magenta>看看这个中间过程会发生什么</c>

00:37:36.790 --> 00:37:38.325 align:middle line:10%
<c.magenta>开始加载我们的数据</c>

00:37:38.659 --> 00:37:41.028 align:middle line:10%
<c.magenta>在执行Complete代码后</c>

00:37:41.094 --> 00:37:43.864 align:middle line:10%
<c.magenta>请求预览项目放入</c>

00:37:43.931 --> 00:37:46.533 align:middle line:10%
<c.magenta>使用defaultPreview</c>
<c.magenta>调用previewForDropping</c>

00:37:46.600 --> 00:37:48.235 align:middle line:10%
<c.magenta>提供一个默认预览</c>

00:37:48.302 --> 00:37:52.639 align:middle line:10%
<c.magenta>这里可以返回一个新预览</c>
<c.magenta>或返回默认预览或nil</c>

00:37:52.706 --> 00:37:53.774 align:middle line:10%
<c.magenta>这取决于你的需要</c>

00:37:53.841 --> 00:37:55.275 align:middle line:10%
<c.magenta>后面会详细解释</c>

00:37:56.643 --> 00:37:57.978 align:middle line:10%
<c.magenta>我们获得的预览</c>

00:37:58.045 --> 00:37:59.646 align:middle line:10%
<c.magenta>或默认预览</c>

00:37:59.913 --> 00:38:03.016 align:middle line:10%
<c.magenta>我们将会使用它们</c>
<c.magenta>在视图中使用动画效果显示它们</c>

00:37:59.913 --> 00:38:03.016 align:middle line:10%
<c.magenta>我们将会使用它们</c>
<c.magenta>在视图中使用动画效果显示它们</c>

00:38:03.283 --> 00:38:05.419 align:middle line:10%
<c.magenta>这样用户就能够</c>
<c.magenta>看到有内容放入</c>

00:38:06.086 --> 00:38:09.623 align:middle line:10%
<c.magenta>在此过程中</c>
<c.magenta>将执行willDropWith动画器</c>

00:38:09.690 --> 00:38:11.758 align:middle line:10%
<c.magenta>显示伴随动画效果</c>

00:38:12.359 --> 00:38:14.294 align:middle line:10%
<c.magenta>前面罗布说过</c>

00:38:14.661 --> 00:38:17.831 align:middle line:10%
<c.magenta>与提升操作一样</c>
<c.magenta>放下操作也是实时的</c>

00:38:17.898 --> 00:38:20.200 align:middle line:90%,end
<c.magenta>当你拖动时</c>
<c.magenta>会有动画效果</c>

00:38:20.267 --> 00:38:23.370 align:middle line:90%,end
<c.magenta>当你放下</c>
<c.magenta>取消或提升时 视图也实时更新</c>

00:38:23.437 --> 00:38:26.240 align:middle line:90%,end
<c.magenta>因此 可以更新视图</c>

00:38:26.540 --> 00:38:29.343 align:middle line:10%
<c.magenta>或者与其它UI一起</c>
<c.magenta>进行动画显示</c>

00:38:31.979 --> 00:38:33.547 align:middle line:10%
<c.magenta>这些动画结束时</c>

00:38:33.680 --> 00:38:37.484 align:middle line:10%
<c.magenta>将调用concludeDrop</c>
<c.magenta>指示放入已经结束</c>

00:38:37.551 --> 00:38:41.388 align:middle line:10%
<c.magenta>然后用户可以继续他们的操作</c>

00:38:41.955 --> 00:38:43.123 align:middle line:10%
<c.magenta>现在</c>

00:38:44.658 --> 00:38:48.462 align:middle line:90%,end
<c.magenta>同样地 这也不意味着</c>
<c.magenta>数据已经到达</c>

00:38:48.795 --> 00:38:51.064 align:middle line:90%,end
<c.magenta>这里有两个例子</c>

00:38:51.131 --> 00:38:55.335 align:middle line:90%,end
<c.magenta>有一个很长的加载对象调用</c>
<c.magenta>在concludeDrop之后继续运行</c>

00:38:55.402 --> 00:38:59.706 align:middle line:90%,end
<c.magenta>另外一个例子在willAnimate</c>
<c.magenta>与previewForDropping之间结束</c>

00:38:59.773 --> 00:39:03.177 align:middle line:90%,end
<c.magenta>预览的动画持续时间</c>
<c.magenta>也可能不相同</c>

00:38:59.773 --> 00:39:03.177 align:middle line:90%,end
<c.magenta>预览的动画持续时间</c>
<c.magenta>也可能不相同</c>

00:39:03.243 --> 00:39:05.946 align:middle line:90%,end
<c.magenta>这是因为</c>
<c.magenta>根据你所提供的目标位置</c>

00:39:06.013 --> 00:39:08.382 align:middle line:90%,end
<c.magenta>它们可能需要移动更远的距离</c>

00:39:08.782 --> 00:39:10.450 align:middle line:90%,end
<c.magenta>距离手指更远的项目</c>

00:39:10.517 --> 00:39:13.921 align:middle line:90%,end
<c.magenta>所花的时间长于</c>
<c.magenta>距离手指近的项目</c>

00:39:14.121 --> 00:39:15.189 align:middle line:90%,end
<c.magenta>因此请注意</c>

00:39:15.255 --> 00:39:19.026 align:middle line:90%,end
<c.magenta>各动画的时间并不相同</c>
<c.magenta>可能略有区别</c>

00:39:22.462 --> 00:39:23.630 align:middle line:90%,end
<c.magenta>这样我们获得放入预览</c>

00:39:23.697 --> 00:39:26.834 align:middle line:90%,end
<c.magenta>文森已经演示</c>
<c.magenta>我们也获得取消预览</c>

00:39:26.900 --> 00:39:30.737 align:middle line:90%,end
<c.magenta>它们看起来很相似</c>
<c.magenta>原理与提升预览相同</c>

00:39:30.804 --> 00:39:33.674 align:middle line:90%,end
<c.magenta>它们的方法相同</c>
<c.magenta>但是位置不同</c>

00:39:34.641 --> 00:39:36.043 align:middle line:90%,end
<c.magenta>文森的预览演示表明</c>

00:39:36.109 --> 00:39:39.746 align:middle line:90%,end
<c.magenta>实现previewForCanceling</c>
<c.magenta>item效果更好</c>

00:39:39.813 --> 00:39:41.715 align:middle line:90%,end
<c.magenta>因为它提供更好的用户体验</c>

00:39:41.782 --> 00:39:43.383 align:middle line:90%,end
<c.magenta>项目可以返回初始位置</c>

00:39:43.817 --> 00:39:47.054 align:middle line:90%,end
<c.magenta>更新UI时</c>
<c.magenta>用户可以导航</c>

00:39:47.120 --> 00:39:51.758 align:middle line:90%,end
<c.magenta>因此UI可能发生很大的变化</c>

00:39:51.825 --> 00:39:53.427 align:middle line:90%,end
<c.magenta>请记住这一点</c>

00:39:56.363 --> 00:39:58.198 align:middle line:10%
<c.magenta>另外willAnimateDropWith动画器</c>

00:39:58.265 --> 00:40:01.101 align:middle line:10%
<c.magenta>非常类似于</c>
<c.magenta>willAnimateCancelWith动画器</c>

00:39:58.265 --> 00:40:01.101 align:middle line:10%
<c.magenta>非常类似于</c>
<c.magenta>willAnimateCancelWith动画器</c>

00:40:01.168 --> 00:40:05.305 align:middle line:10%
<c.magenta>虽然情况不同</c>
<c.magenta>但是原理相同</c>

00:40:05.472 --> 00:40:10.444 align:middle line:10%
<c.magenta>UIDragAnimating规则</c>
<c.magenta>与UIViewPropertyAnimator十分相似</c>

00:40:10.511 --> 00:40:12.880 align:middle line:10%
<c.magenta>因此你应该感到很适应</c>

00:40:13.981 --> 00:40:15.949 align:middle line:90%,end
<c.magenta>让我们来看</c>
<c.magenta>这个默认预览</c>

00:40:16.016 --> 00:40:17.851 align:middle line:90%,end
<c.magenta>我们为什么要把它提供给你？</c>

00:40:17.918 --> 00:40:19.319 align:middle line:90%,end
<c.magenta>你可以返回它</c>

00:40:20.787 --> 00:40:21.955 align:middle line:90%,end
<c.magenta>也可以获取它</c>

00:40:22.022 --> 00:40:26.260 align:middle line:90%,end
<c.magenta>这都没有问题</c>
<c.magenta>但是这不是我们把它提供给你的原因</c>

00:40:26.326 --> 00:40:30.130 align:middle line:90%,end
<c.magenta>如果你想要默认预览</c>
<c.magenta>如果想要默认动画</c>

00:40:30.197 --> 00:40:31.465 align:middle line:90%,end
<c.magenta>只需返回nil即可</c>

00:40:31.532 --> 00:40:34.668 align:middle line:90%,end
<c.magenta>它告诉系统</c>
<c.magenta>你接受默认行为</c>

00:40:34.735 --> 00:40:38.305 align:middle line:90%,end
<c.magenta>系统可以使用任何动画效果</c>

00:40:38.372 --> 00:40:39.673 align:middle line:90%,end
<c.magenta>和表示方式</c>

00:40:40.240 --> 00:40:42.009 align:middle line:90%,end
<c.magenta>那么 我们为什么</c>
<c.magenta>提供默认预览呢？</c>

00:40:42.976 --> 00:40:44.411 align:middle line:90%,end
<c.magenta>你可以重新设置目标位置</c>

00:40:44.478 --> 00:40:46.813 align:middle line:90%,end
<c.magenta>我们希望你这样做</c>

00:40:46.880 --> 00:40:49.850 align:middle line:90%,end
<c.magenta>如果重新设置目标位置</c>
<c.magenta>你就知道默认预览在视图中的位置</c>

00:40:49.917 --> 00:40:52.819 align:middle line:90%,end
<c.magenta>我们将会使用动画效果</c>
<c.magenta>移动到你指定的目标位置</c>

00:40:52.886 --> 00:40:55.022 align:middle line:90%,end
<c.magenta>这会改善使用体验</c>

00:40:55.556 --> 00:40:58.292 align:middle line:90%,end
<c.magenta>当然 你需要知道目标位置</c>

00:40:58.358 --> 00:41:00.961 align:middle line:90%,end
<c.magenta>如果不知道位置</c>
<c.magenta>就不能重新设置</c>

00:40:58.358 --> 00:41:00.961 align:middle line:90%,end
<c.magenta>如果不知道位置</c>
<c.magenta>就不能重新设置</c>

00:41:02.329 --> 00:41:03.330 align:middle line:90%,end
<c.magenta>最后</c>

00:41:03.664 --> 00:41:07.367 align:middle line:90%,end
<c.magenta>你可以创建自定义预览</c>
<c.magenta>设置自己的UI</c>

00:41:07.434 --> 00:41:09.002 align:middle line:90%,end
<c.magenta>可以自己决定</c>

00:41:09.503 --> 00:41:13.473 align:middle line:90%,end
<c.magenta>你创建的预览</c>
<c.magenta>将会动画移动到你指定的位置</c>

00:41:14.608 --> 00:41:17.444 align:middle line:90%,end
<c.magenta>这里有几个限制</c>
<c.magenta>如果组合中的项目较少</c>

00:41:17.511 --> 00:41:20.280 align:middle line:90%,end
<c.magenta>我们将要求你预览每个项目</c>

00:41:20.347 --> 00:41:23.116 align:middle line:90%,end
<c.magenta>并且为每个项目提供伴随动画</c>

00:41:23.183 --> 00:41:27.688 align:middle line:90%,end
<c.magenta>根据项目数量</c>
<c.magenta>你可以使用这些功能</c>

00:41:27.754 --> 00:41:31.425 align:middle line:90%,end
<c.magenta>如果组合或会话中有很多项目</c>

00:41:32.492 --> 00:41:36.163 align:middle line:90%,end
<c.magenta>我们将默认预览用于所有项目</c>

00:41:36.230 --> 00:41:38.699 align:middle line:90%,end
<c.magenta>因此不会要求你创建预览</c>

00:41:39.032 --> 00:41:41.368 align:middle line:90%,end
<c.magenta>我们提供伴随动画</c>

00:41:41.435 --> 00:41:44.738 align:middle line:90%,end
<c.magenta>以伴随所有项目的动画效果</c>

00:41:46.073 --> 00:41:47.007 align:middle line:90%,end
<c.magenta>请不要信以为真</c>

00:41:47.074 --> 00:41:49.877 align:middle line:90%,end
<c.magenta>文森将展示应该怎么做</c>

00:41:54.715 --> 00:41:55.849 align:middle line:90%,end
<c.magenta>谢谢 汤姆</c>

00:41:56.283 --> 00:41:57.818 align:middle line:90%,end
<c.magenta>回顾一下</c>

00:41:57.885 --> 00:42:00.654 align:middle line:90%,end
<c.magenta>前面我们讲了如何</c>
<c.magenta>修饰这个放入动画</c>

00:41:57.885 --> 00:42:00.654 align:middle line:90%,end
<c.magenta>前面我们讲了如何</c>
<c.magenta>修饰这个放入动画</c>

00:42:01.421 --> 00:42:02.689 align:middle line:90%,end
<c.magenta>让我们来看应该怎么做</c>

00:42:03.557 --> 00:42:05.792 align:middle line:90%,end
<c.magenta>这是Droppable Delete View</c>

00:42:06.026 --> 00:42:07.861 align:middle line:90%,end
<c.magenta>在这里</c>
<c.magenta>我们首先要做的是</c>

00:42:08.195 --> 00:42:10.063 align:middle line:90%,end
<c.magenta>实现previewForDropping</c>

00:42:11.064 --> 00:42:11.965 align:middle line:90%,end
<c.magenta>然后 对于项目</c>

00:42:12.032 --> 00:42:14.201 align:middle line:90%,end
<c.magenta>我们将创建这个拖动预览目标</c>

00:42:14.868 --> 00:42:17.638 align:middle line:90%,end
<c.magenta>看上去与我们前面做的事情很相似</c>

00:42:17.704 --> 00:42:20.407 align:middle line:90%,end
<c.magenta>只是这一次</c>
<c.magenta>我们显式设置transform</c>

00:42:20.474 --> 00:42:24.811 align:middle line:90%,end
<c.magenta>它所做的事情是</c>
<c.magenta>动画显示默认预览</c>

00:42:24.878 --> 00:42:27.314 align:middle line:90%,end
<c.magenta>其宽度和长度将变化</c>
<c.magenta>为原始值的十分之一</c>

00:42:27.581 --> 00:42:29.049 align:middle line:90%,end
<c.magenta>因此 你指定一个变换效果</c>

00:42:29.116 --> 00:42:31.752 align:middle line:90%,end
<c.magenta>我们把中心设置为</c>
<c.magenta>iconView中心</c>

00:42:31.818 --> 00:42:34.721 align:middle line:90%,end
<c.magenta>如果返回应用</c>

00:42:34.788 --> 00:42:37.191 align:middle line:90%,end
<c.magenta>这个小垃圾桶位于左下角</c>

00:42:38.625 --> 00:42:40.527 align:middle line:90%,end
<c.magenta>因此我们通过动画显示到那里</c>

00:42:40.594 --> 00:42:42.696 align:middle line:90%,end
<c.magenta>我们将会使用这个target</c>

00:42:42.763 --> 00:42:44.831 align:middle line:90%,end
<c.magenta>重新定位默认预览到这个位置</c>

00:42:45.365 --> 00:42:46.600 align:middle line:90%,end
<c.magenta>但是 还不止于此</c>

00:42:47.100 --> 00:42:50.370 align:middle line:90%,end
<c.magenta>我们还可以进行更多修饰</c>

00:42:50.637 --> 00:42:53.207 align:middle line:90%,end
<c.magenta>让我们为放入添加一个伴随动画</c>

00:42:53.273 --> 00:42:57.411 align:middle line:90%,end
<c.magenta>我们为iconView添加一个变换</c>

00:42:57.477 --> 00:42:58.979 align:middle line:90%,end
<c.magenta>当放入时 变为垃圾桶</c>

00:42:59.046 --> 00:43:01.915 align:middle line:90%,end
<c.magenta>因此 将变换到1.25倍比例</c>

00:42:59.046 --> 00:43:01.915 align:middle line:90%,end
<c.magenta>因此 将变换到1.25倍比例</c>

00:43:01.982 --> 00:43:05.052 align:middle line:90%,end
<c.magenta>显示将会变大25%</c>

00:43:05.719 --> 00:43:09.523 align:middle line:90%,end
<c.magenta>并不需要始终保持125%比例</c>

00:43:09.590 --> 00:43:11.959 align:middle line:90%,end
<c.magenta>当放入完成之后</c>

00:43:12.025 --> 00:43:13.360 align:middle line:90%,end
<c.magenta>应该变换回原来的大小</c>

00:43:14.895 --> 00:43:16.230 align:middle line:90%,end
<c.magenta>利用这些修饰</c>

00:43:17.297 --> 00:43:20.334 align:middle line:90%,end
<c.magenta>效果应该更加美观</c>

00:43:20.834 --> 00:43:24.004 align:middle line:90%,end
<c.magenta>我返回应用</c>
<c.magenta>在这里拖动一些照片</c>

00:43:24.071 --> 00:43:27.474 align:middle line:90%,end
<c.magenta>请注意 当我放下时</c>
<c.magenta>将会发生什么</c>

00:43:27.875 --> 00:43:31.111 align:middle line:90%,end
<c.magenta>可以看到 照片进入</c>
<c.magenta>垃圾桶 然后消失了</c>

00:43:31.178 --> 00:43:32.813 align:middle line:90%,end
<c.magenta>说到垃圾桶</c>

00:43:32.913 --> 00:43:34.781 align:middle line:90%,end
<c.magenta>也会看到 它会变大</c>

00:43:34.848 --> 00:43:37.718 align:middle line:90%,end
<c.magenta>放入结束后会缩小</c>

00:43:38.418 --> 00:43:40.420 align:middle line:90%,end
<c.magenta>看上去比以前好多了</c>

00:43:44.691 --> 00:43:47.661 align:middle line:90%,end
<c.magenta>现在来看一些不太好的地方</c>

00:43:48.362 --> 00:43:52.366 align:middle line:90%,end
<c.magenta>在本例中</c>
<c.magenta>这是Drag Source最后一个面板</c>

00:43:52.432 --> 00:43:53.867 align:middle line:90%,end
<c.magenta>有一个Slow Draggable Image View</c>

00:43:53.934 --> 00:43:56.904 align:middle line:90%,end
<c.magenta>它们被称为slow 是因为</c>
<c.magenta>它们是来自于远程服务器的</c>

00:43:56.970 --> 00:43:59.406 align:middle line:90%,end
<c.magenta>模拟项目</c>

00:44:00.174 --> 00:44:02.543 align:middle line:90%,end
<c.magenta>如果我把这四张照片放到这里</c>

00:44:02.843 --> 00:44:05.045 align:middle line:90%,end
<c.magenta>将需要很长时间进行加载</c>

00:44:05.112 --> 00:44:06.280 align:middle line:90%,end
<c.magenta>事实上 由于时间太长</c>

00:44:06.680 --> 00:44:09.249 align:middle line:90%,end
<c.magenta>将开始显示这个应用对话框</c>

00:44:09.316 --> 00:44:11.251 align:middle line:90%,end
<c.magenta>让用户能够取消</c>

00:44:12.152 --> 00:44:14.621 align:middle line:90%,end
<c.magenta>但是 从本演示的目的出发</c>

00:44:14.688 --> 00:44:16.690 align:middle line:90%,end
<c.magenta>我们也希望对它进行自定义</c>

00:44:16.757 --> 00:44:19.793 align:middle line:90%,end
<c.magenta>让我交回给汤姆</c>
<c.magenta>让他告诉我们应该怎么做</c>

00:44:25.065 --> 00:44:28.468 align:middle line:90%,end
<c.magenta>那么我们如何处理</c>
<c.magenta>缓慢的数据交付呢？</c>

00:44:29.803 --> 00:44:33.574 align:middle line:90%,end
<c.magenta>前面我说过</c>
<c.magenta>数据加载始终是异步 的</c>

00:44:33.841 --> 00:44:35.909 align:middle line:90%,end
<c.magenta>这里有两个</c>
<c.magenta>非连续的时间线</c>

00:44:35.976 --> 00:44:37.778 align:middle line:90%,end
<c.magenta>一个是数据加载</c>

00:44:37.845 --> 00:44:41.415 align:middle line:90%,end
<c.magenta>另一个是放入预览动画显示</c>
<c.magenta>它们并不同步</c>

00:44:42.015 --> 00:44:42.883 align:middle line:90%,end
<c.magenta>我们回到这张图中</c>

00:44:42.950 --> 00:44:48.121 align:middle line:90%,end
<c.magenta>可以清晰地看到</c>
<c.magenta>这里的线条并不是一样长</c>

00:44:48.488 --> 00:44:50.524 align:middle line:90%,end
<c.magenta>loadObject调用占用不同的时间</c>

00:44:50.591 --> 00:44:52.860 align:middle line:90%,end
<c.magenta>预览动画占用不同的时间</c>

00:44:53.126 --> 00:44:57.231 align:middle line:90%,end
<c.magenta>可以看到</c>
<c.magenta>现在我们还没有获得</c>

00:44:57.297 --> 00:44:58.966 align:middle line:90%,end
<c.magenta>想要预览的数据</c>

00:45:01.134 --> 00:45:04.071 align:middle line:90%,end
<c.magenta>可能会遇到的一个用例是</c>

00:45:04.137 --> 00:45:07.074 align:middle line:90%,end
<c.magenta>从Photos拖动</c>
<c.magenta>照片到电子邮件</c>

00:45:07.241 --> 00:45:09.243 align:middle line:90%,end
<c.magenta>但是这些照片可能</c>
<c.magenta>存储在iCloud上</c>

00:45:09.309 --> 00:45:11.578 align:middle line:90%,end
<c.magenta>因为我们想要节省设备空间</c>

00:45:12.112 --> 00:45:15.949 align:middle line:90%,end
<c.magenta>进行拖动时</c>
<c.magenta>将会显示这个应用模态界面</c>

00:45:16.517 --> 00:45:20.354 align:middle line:90%,end
<c.magenta>向用户显示进度</c>
<c.magenta>并且让用户能够取消</c>

00:45:21.788 --> 00:45:23.657 align:middle line:90%,end
<c.magenta>这是一个贴合实际的用例</c>

00:45:24.791 --> 00:45:26.727 align:middle line:90%,end
<c.magenta>这里有一个“取消”按钮</c>

00:45:26.793 --> 00:45:29.696 align:middle line:90%,end
<c.magenta>因为我们不想要用户永远等待</c>

00:45:29.763 --> 00:45:33.133 align:middle line:90%,end
<c.magenta>我们不知道数据何时才会到达</c>

00:45:33.233 --> 00:45:35.002 align:middle line:90%,end
<c.magenta>也许两秒 也许两分钟</c>

00:45:35.068 --> 00:45:37.371 align:middle line:90%,end
<c.magenta>因此 我们为用户提供取消选项</c>

00:45:37.437 --> 00:45:38.472 align:middle line:90%,end
<c.magenta>如果用户取消</c>

00:45:38.539 --> 00:45:40.841 align:middle line:90%,end
<c.magenta>我们将使用nil数据调用</c>
<c.magenta>Completion代码块</c>

00:45:40.908 --> 00:45:43.076 align:middle line:90%,end
<c.magenta>将会设置一个错误</c>
<c.magenta>让你能够发现错误</c>

00:45:43.944 --> 00:45:45.012 align:middle line:90%,end
<c.magenta>此外</c>

00:45:45.245 --> 00:45:48.248 align:middle line:90%,end
<c.magenta>会话和Item Providers</c>
<c.magenta>都提供ProgressReporting</c>

00:45:48.315 --> 00:45:51.685 align:middle line:90%,end
<c.magenta>会话是ProgressReporting</c>
<c.magenta>因此可以观察其进度</c>

00:45:52.319 --> 00:45:54.221 align:middle line:90%,end
<c.magenta>ItemProvider load方法</c>

00:45:54.288 --> 00:45:57.357 align:middle line:90%,end
<c.magenta>返回一个进度对象</c>
<c.magenta>你可以使用这个对象</c>

00:45:59.826 --> 00:46:01.161 align:middle line:10%
<c.magenta>进度具有取消处理程序</c>

00:45:59.826 --> 00:46:01.161 align:middle line:10%
<c.magenta>进度具有取消处理程序</c>

00:46:01.228 --> 00:46:04.131 align:middle line:10%
<c.magenta>用于处理取消操作</c>

00:46:04.498 --> 00:46:07.334 align:middle line:10%
<c.magenta>在那里添加代码</c>
<c.magenta>以处理进入的任何项目</c>

00:46:07.501 --> 00:46:12.005 align:middle line:10%
<c.magenta>和未进入的项目</c>
<c.magenta>你可以从模态界面中删除它们</c>

00:46:13.440 --> 00:46:17.744 align:middle line:90%,end
<c.magenta>因此 我们可以自定义进度</c>
<c.magenta>正如文森前面所说的那样</c>

00:46:18.579 --> 00:46:20.314 align:middle line:90%,end
<c.magenta>如果你不需要这种应用模态UI</c>

00:46:20.380 --> 00:46:23.183 align:middle line:10%
<c.magenta>可以将session</c>
<c.magenta>progressIndicatorStyle</c>

00:46:23.250 --> 00:46:26.553 align:middle line:10%
<c.magenta>设置为无 关闭它</c>
<c.magenta>就不会显示这样的UI</c>

00:46:26.820 --> 00:46:31.225 align:middle line:10%
<c.magenta>这意味着 你需要自己</c>
<c.magenta>为用户进行这些处理</c>

00:46:31.291 --> 00:46:33.393 align:middle line:10%
<c.magenta>为此 你可以观察进度</c>

00:46:33.460 --> 00:46:34.828 align:middle line:10%
<c.magenta>会话有一个进度</c>

00:46:34.895 --> 00:46:37.764 align:middle line:10%
<c.magenta>另外ItemProvider</c>
<c.magenta>返回每个项目的进度</c>

00:46:38.465 --> 00:46:43.604 align:middle line:90%,end
<c.magenta>如果这样做 可以使用此进度信息</c>
<c.magenta>显示一些UI向用户告知进度情况</c>

00:46:43.670 --> 00:46:46.874 align:middle line:90%,end
<c.magenta>可以看到</c>
<c.magenta>每个项目</c>

00:46:46.940 --> 00:46:48.542 align:middle line:90%,end
<c.magenta>是否在加载数据</c>

00:46:48.609 --> 00:46:51.144 align:middle line:90%,end
<c.magenta>但是应该允许用户</c>
<c.magenta>取消或导航到其它位置</c>

00:46:51.211 --> 00:46:53.680 align:middle line:90%,end
<c.magenta>以避免用户</c>
<c.magenta>始终停留在你的视图上</c>

00:46:56.283 --> 00:46:57.417 align:middle line:90%,end
<c.magenta>但是仍然存在一个大问题</c>

00:46:57.484 --> 00:47:00.187 align:middle line:90%,end
<c.magenta>如果没有任何数据</c>
<c.magenta>如何生成预览呢？</c>

00:46:57.484 --> 00:47:00.187 align:middle line:90%,end
<c.magenta>如果没有任何数据</c>
<c.magenta>如何生成预览呢？</c>

00:47:00.254 --> 00:47:02.656 align:middle line:90%,end
<c.magenta>我想创建这个自定义预览</c>
<c.magenta>但是它并不起作用</c>

00:47:02.723 --> 00:47:04.424 align:middle line:90%,end
<c.magenta>你们也不会成功</c>

00:47:04.491 --> 00:47:08.195 align:middle line:90%,end
<c.magenta>如果没有数据</c>
<c.magenta>就不能创建新视图</c>

00:47:08.695 --> 00:47:10.063 align:middle line:90%,end
<c.magenta>可以使用默认预览</c>

00:47:10.130 --> 00:47:13.834 align:middle line:90%,end
<c.magenta>它准确地表示</c>
<c.magenta>项目中的实际内容</c>

00:47:14.334 --> 00:47:15.969 align:middle line:90%,end
<c.magenta>是在拖动侧设置的</c>

00:47:16.036 --> 00:47:18.872 align:middle line:90%,end
<c.magenta>因此可以用它来显示动画效果</c>

00:47:19.039 --> 00:47:23.343 align:middle line:90%,end
<c.magenta>我们设置目标位置 添加变换效果</c>
<c.magenta>可以根据需要进行更改</c>

00:47:25.812 --> 00:47:29.082 align:middle line:90%,end
<c.magenta>也可以设置一个占位符进度视图</c>

00:47:29.183 --> 00:47:33.086 align:middle line:90%,end
<c.magenta>如果你想要显示某个内容</c>
<c.magenta>比如显示旋转图标</c>

00:47:33.153 --> 00:47:37.324 align:middle line:90%,end
<c.magenta>只要适合你的UI</c>
<c.magenta>就是不错的主意</c>

00:47:37.591 --> 00:47:39.226 align:middle line:90%,end
<c.magenta>一个好处是</c>

00:47:39.293 --> 00:47:42.396 align:middle line:90%,end
<c.magenta>集合视图和表格视图</c>
<c.magenta>支持此特性</c>

00:47:42.462 --> 00:47:44.231 align:middle line:90%,end
<c.magenta>因此你不必担心</c>

00:47:44.531 --> 00:47:46.233 align:middle line:90%,end
<c.magenta>这很容易启用</c>

00:47:46.600 --> 00:47:49.603 align:middle line:90%,end
<c.magenta>我知道明天早上9点</c>

00:47:50.304 --> 00:47:53.106 align:middle line:90%,end
<c.magenta>WWDC第四天</c>
<c.magenta>有个演讲会讨论这些视图 请大家参加</c>

00:47:53.173 --> 00:47:54.575 align:middle line:90%,end
<c.magenta>值得你们去听讲</c>

00:47:56.276 --> 00:47:58.679 align:middle line:90%,end
<c.magenta>因此 不要推测数据将会到达</c>

00:47:59.012 --> 00:48:01.048 align:middle line:90%,end
<c.magenta>这是我给你们的建议</c>

00:47:59.012 --> 00:48:01.048 align:middle line:90%,end
<c.magenta>这是我给你们的建议</c>

00:48:01.682 --> 00:48:03.250 align:middle line:90%,end
<c.magenta>即使你在进行测试…</c>

00:48:04.351 --> 00:48:07.354 align:middle line:90%,end
<c.magenta>在本地测试时</c>
<c.magenta>数据可能会立即到达</c>

00:48:07.421 --> 00:48:09.323 align:middle line:90%,end
<c.magenta>但是对于用户来说可能并非如此</c>

00:48:09.389 --> 00:48:11.992 align:middle line:90%,end
<c.magenta>你不知道数据</c>
<c.magenta>何时会到达</c>

00:48:12.793 --> 00:48:15.095 align:middle line:90%,end
<c.magenta>请始终考虑到最坏的情况</c>

00:48:15.162 --> 00:48:18.232 align:middle line:90%,end
<c.magenta>这是最好的做法</c>
<c.magenta>如果数据很快到达 当然好了</c>

00:48:18.298 --> 00:48:20.534 align:middle line:90%,end
<c.magenta>但是也应该想到</c>
<c.magenta>可能会花费一定时间</c>

00:48:21.835 --> 00:48:24.905 align:middle line:90%,end
<c.magenta>如果正确地进行实现</c>
<c.magenta>结果可能是这样的</c>

00:48:34.047 --> 00:48:38.519 align:middle line:90%,end
<c.magenta>你可以看到</c>
<c.magenta>自定义进度条没有被阻止</c>

00:48:40.220 --> 00:48:43.524 align:middle line:90%,end
<c.magenta>最后 让我们来讨论</c>
<c.magenta>如何通过添加拖拉</c>

00:48:43.590 --> 00:48:45.292 align:middle line:90%,end
<c.magenta>来改善应用使用体验</c>

00:48:45.359 --> 00:48:48.962 align:middle line:90%,end
<c.magenta>你可以在应用之间</c>
<c.magenta>进行拖放</c>

00:48:49.029 --> 00:48:51.932 align:middle line:90%,end
<c.magenta>也可以利用拖放操作</c>
<c.magenta>改善你的应用</c>

00:48:52.232 --> 00:48:55.802 align:middle line:90%,end
<c.magenta>在此方面</c>
<c.magenta>我们提供一些有用的API</c>

00:48:55.869 --> 00:48:58.839 align:middle line:90%,end
<c.magenta>第一个是localDragSession:</c>
<c.magenta>UIDropSession</c>

00:48:59.106 --> 00:49:02.242 align:middle line:90%,end
<c.magenta>这让你能够访问拖动会话</c>
<c.magenta>正如我前面实现的那样</c>

00:48:59.106 --> 00:49:02.242 align:middle line:90%,end
<c.magenta>这让你能够访问拖动会话</c>
<c.magenta>正如我前面实现的那样</c>

00:49:02.876 --> 00:49:05.512 align:middle line:90%,end
<c.magenta>可以访问拖动会话中的</c>
<c.magenta>任何类型的数据</c>

00:49:05.579 --> 00:49:09.383 align:middle line:90%,end
<c.magenta>你在任何阶段设置的项目</c>
<c.magenta>都是可用的</c>

00:49:09.750 --> 00:49:11.852 align:middle line:90%,end
<c.magenta>这仅适用于应用内拖动</c>

00:49:11.919 --> 00:49:13.287 align:middle line:90%,end
<c.magenta>如果拖动到应用之外</c>

00:49:13.353 --> 00:49:16.757 align:middle line:90%,end
<c.magenta>拖动会话将不会有</c>
<c.magenta>相应的本地拖动会话</c>

00:49:18.559 --> 00:49:22.563 align:middle line:10%
<c.magenta>另外 罗布前面演示过</c>
<c.magenta>有一个localObject on UIDragItem</c>

00:49:23.330 --> 00:49:26.700 align:middle line:10%
<c.magenta>这是一个很好的本地数据容器</c>

00:49:26.767 --> 00:49:32.139 align:middle line:10%
<c.magenta>可以使用它设置</c>
<c.magenta>itemsForBeginning会话中的状态</c>

00:49:32.206 --> 00:49:35.676 align:middle line:10%
<c.magenta>并将这个状态</c>
<c.magenta>用于提升预览</c>

00:49:35.742 --> 00:49:39.713 align:middle line:10%
<c.magenta>也可以使用它将数据</c>
<c.magenta>从拖动位置传输到放入位置</c>

00:49:39.780 --> 00:49:45.018 align:middle line:10%
<c.magenta>相比之下 构建 itemProvider</c>
<c.magenta>在应用之外传输数据更复杂一些</c>

00:49:45.219 --> 00:49:47.120 align:middle line:10%
<c.magenta>如果允许拖动到应用之外</c>

00:49:47.187 --> 00:49:49.122 align:middle line:10%
<c.magenta>也应该这样做</c>

00:49:50.591 --> 00:49:54.628 align:middle line:90%,end
<c.magenta>最后还有 localContext</c>
<c.magenta>for UIDragSession允许你</c>

00:49:54.695 --> 00:50:00.000 align:middle line:90%,end
<c.magenta>在本地保留拖动会话</c>
<c.magenta>和放入会话的状态</c>

00:50:00.067 --> 00:50:02.903 align:middle line:90%,end
<c.magenta>而不必访问应用全局状态</c>

00:50:03.470 --> 00:50:05.839 align:middle line:90%,end
<c.magenta>这可以简化工作</c>

00:50:08.809 --> 00:50:10.944 align:middle line:90%,end
<c.magenta>如何将拖动保持在应用之内？</c>

00:50:11.011 --> 00:50:13.447 align:middle line:90%,end
<c.magenta>这需要</c>
<c.magenta>在dragInteraction delegate</c>

00:50:13.514 --> 00:50:17.684 align:middle line:90%,end
<c.magenta>sessionIsRestrictedTo</c>
<c.magenta>DraggingApplication上实现一个方法</c>

00:50:17.751 --> 00:50:19.152 align:middle line:90%,end
<c.magenta>在这里 如果返回真</c>

00:50:19.219 --> 00:50:21.622 align:middle line:90%,end
<c.magenta>就只能在应用内拖动</c>

00:50:21.688 --> 00:50:25.259 align:middle line:90%,end
<c.magenta>当然 用户也可以拖动到</c>
<c.magenta>你的应用之外</c>

00:50:25.325 --> 00:50:30.230 align:middle line:90%,end
<c.magenta>但是应用之外的任何放入会话</c>
<c.magenta>将会无视这个拖动</c>

00:50:30.297 --> 00:50:34.568 align:middle line:90%,end
<c.magenta>外观上并没有什么不同</c>
<c.magenta>但是不会接受任何放入</c>

00:50:34.635 --> 00:50:36.036 align:middle line:90%,end
<c.magenta>除非在应用之内</c>

00:50:36.603 --> 00:50:40.107 align:middle line:90%,end
<c.magenta>你可以在拖动和放入会话中</c>
<c.magenta>检查这个属性</c>

00:50:43.010 --> 00:50:46.380 align:middle line:90%,end
<c.magenta>最后一件事情</c>
<c.magenta>iPhone的本地拖放</c>

00:50:46.446 --> 00:50:48.415 align:middle line:90%,end
<c.magenta>默认情况下是禁止的</c>

00:50:48.482 --> 00:50:51.151 align:middle line:90%,end
<c.magenta>在iPad上 默认是启用的</c>

00:50:51.218 --> 00:50:56.256 align:middle line:90%,end
<c.magenta>因为你希望你的应用</c>
<c.magenta>根据大小类别进行运作</c>

00:50:56.323 --> 00:50:58.692 align:middle line:90%,end
<c.magenta>如果有一个边栏应用</c>
<c.magenta>将不会有问题</c>

00:50:58.759 --> 00:51:01.728 align:middle line:90%,end
<c.magenta>在iPad上</c>
<c.magenta>你可以拖入到其它应用</c>

00:50:58.759 --> 00:51:01.728 align:middle line:90%,end
<c.magenta>在iPad上</c>
<c.magenta>你可以拖入到其它应用</c>

00:51:01.795 --> 00:51:05.332 align:middle line:90%,end
<c.magenta>但是同样大小的应用</c>
<c.magenta>在iPhone就行不通</c>

00:51:05.399 --> 00:51:07.267 align:middle line:90%,end
<c.magenta>如果你想要</c>
<c.magenta>支持应用内的拖动与放入</c>

00:51:07.334 --> 00:51:09.169 align:middle line:90%,end
<c.magenta>而且也在iPhone上支持此功能</c>

00:51:09.236 --> 00:51:14.308 align:middle line:90%,end
<c.magenta>必须将拖动交互的</c>
<c.magenta>isEnabled属性设置为真</c>

00:51:14.374 --> 00:51:18.045 align:middle line:90%,end
<c.magenta>从而支持iPhone上的交互</c>

00:51:20.414 --> 00:51:23.083 align:middle line:90%,end
<c.magenta>接下来</c>
<c.magenta>文森将进行最后的演示</c>

00:51:28.622 --> 00:51:29.723 align:middle line:90%,end
<c.magenta>再次感谢汤姆</c>

00:51:29.790 --> 00:51:32.526 align:middle line:90%,end
<c.magenta>现在 我们利用学过的所有知识</c>

00:51:32.593 --> 00:51:35.662 align:middle line:90%,end
<c.magenta>来实现一个自定义进度UI</c>

00:51:35.729 --> 00:51:37.197 align:middle line:90%,end
<c.magenta>让我们来看代码</c>

00:51:37.264 --> 00:51:38.398 align:middle line:90%,end
<c.magenta>我们回过头来</c>

00:51:38.465 --> 00:51:41.101 align:middle line:90%,end
<c.magenta>重新访问 Droppable Image</c>
<c.magenta>Grid View Controller</c>

00:51:41.268 --> 00:51:44.605 align:middle line:90%,end
<c.magenta>这里有一个</c>
<c.magenta>我们前面实现的函数 用于执行放入</c>

00:51:44.671 --> 00:51:47.574 align:middle line:90%,end
<c.magenta>我们在这里添加几行代码</c>

00:51:48.275 --> 00:51:50.077 align:middle line:90%,end
<c.magenta>看上去是这样的</c>

00:51:53.714 --> 00:51:57.684 align:middle line:90%,end
<c.magenta>首先 我们将</c>
<c.magenta>progressIndicatorStyle设置为无</c>

00:51:57.751 --> 00:52:01.421 align:middle line:90%,end
<c.magenta>这命令UIKit</c>
<c.magenta>不显示模态对话框</c>

00:51:57.751 --> 00:52:01.421 align:middle line:90%,end
<c.magenta>这命令UIKit</c>
<c.magenta>不显示模态对话框</c>

00:52:02.656 --> 00:52:04.491 align:middle line:90%,end
<c.magenta>然后 我们要记住</c>
<c.magenta>拖动项目的状态是</c>

00:52:04.558 --> 00:52:06.960 align:middle line:90%,end
<c.magenta>将要放入</c>

00:52:07.661 --> 00:52:09.596 align:middle line:90%,end
<c.magenta>接下来的重要一点是</c>
<c.magenta>我们要记住</c>

00:52:09.663 --> 00:52:13.166 align:middle line:90%,end
<c.magenta>我们插入网格的视图层次结构中的视图</c>

00:52:13.300 --> 00:52:17.471 align:middle line:90%,end
<c.magenta>以及当我们在ItemProvider上</c>
<c.magenta>加载对象时返回的进度</c>

00:52:18.172 --> 00:52:21.408 align:middle line:90%,end
<c.magenta>实现previewForDropping后</c>
<c.magenta>就很简单了</c>

00:52:23.277 --> 00:52:24.645 align:middle line:90%,end
<c.magenta>在这里 我们首先要做的是</c>

00:52:24.711 --> 00:52:28.515 align:middle line:90%,end
<c.magenta>从项目状态字典中读取一个状态</c>

00:52:28.582 --> 00:52:32.986 align:middle line:90%,end
<c.magenta>这个状态描述</c>
<c.magenta>被放入的项目的相关信息</c>

00:52:33.053 --> 00:52:36.223 align:middle line:90%,end
<c.magenta>它允许我们创建</c>
<c.magenta>一个新的进度旋转图标视图</c>

00:52:36.323 --> 00:52:40.194 align:middle line:90%,end
<c.magenta>这是一个自定义视图</c>
<c.magenta>用于显示旋转图标</c>

00:52:40.694 --> 00:52:42.729 align:middle line:90%,end
<c.magenta>以表示加载进度</c>

00:52:43.530 --> 00:52:45.165 align:middle line:90%,end
<c.magenta>在这里 我们创建了</c>
<c.magenta>这个自定义视图</c>

00:52:45.232 --> 00:52:47.901 align:middle line:90%,end
<c.magenta>其余部分与前面的内容相似</c>
<c.magenta>我们创建一个目标位置</c>

00:52:47.968 --> 00:52:51.772 align:middle line:90%,end
<c.magenta>并使用这个目标位置和参数</c>
<c.magenta>创建拖动预览</c>

00:52:52.739 --> 00:52:54.074 align:middle line:90%,end
<c.magenta>请思考这个问题</c>

00:52:54.341 --> 00:52:57.544 align:middle line:90%,end
<c.magenta>如果图像加载非常快</c>
<c.magenta>将会发生什么？</c>

00:52:58.111 --> 00:53:00.981 align:middle line:90%,end
<c.magenta>你会看到</c>
<c.magenta>当拖动动画还在显示时</c>

00:52:58.111 --> 00:53:00.981 align:middle line:90%,end
<c.magenta>你会看到</c>
<c.magenta>当拖动动画还在显示时</c>

00:53:01.081 --> 00:53:04.418 align:middle line:90%,end
<c.magenta>目标位置已经有内容出现</c>
<c.magenta>我们看到这个拖动预览</c>

00:53:04.484 --> 00:53:06.854 align:middle line:90%,end
<c.magenta>飞到已经有内容的目标位置</c>

00:53:06.920 --> 00:53:09.790 align:middle line:90%,end
<c.magenta>而且放入预览会显示旋转加载图标</c>

00:53:09.857 --> 00:53:11.191 align:middle line:90%,end
<c.magenta>这看上去很奇怪</c>

00:53:11.425 --> 00:53:14.261 align:middle line:90%,end
<c.magenta>这将会处理边界情况</c>

00:53:14.328 --> 00:53:17.364 align:middle line:90%,end
<c.magenta>我们要做的是</c>
<c.magenta>将目的地视图的alpha参数设置为0</c>

00:53:17.431 --> 00:53:19.933 align:middle line:90%,end
<c.magenta>因此 在进行放入时</c>
<c.magenta>我们将隐藏</c>

00:53:20.000 --> 00:53:22.035 align:middle line:90%,end
<c.magenta>在目的地显示的任何内容</c>

00:53:22.302 --> 00:53:25.038 align:middle line:90%,end
<c.magenta>当放入结束时</c>
<c.magenta>将alpha参数设置回1</c>

00:53:25.105 --> 00:53:27.941 align:middle line:90%,end
<c.magenta>然后 目的地的放入预览</c>

00:53:28.008 --> 00:53:33.013 align:middle line:90%,end
<c.magenta>将会淡出 显示下方的实际目的地视图</c>

00:53:33.080 --> 00:53:35.482 align:middle line:90%,end
<c.magenta>这次我们将alpha设置为1</c>

00:53:35.782 --> 00:53:37.150 align:middle line:90%,end
<c.magenta>因此这将会满足我们的要求</c>

00:53:37.317 --> 00:53:39.620 align:middle line:90%,end
<c.magenta>还有最后一件事情</c>

00:53:40.320 --> 00:53:41.755 align:middle line:90%,end
<c.magenta>也就是实现concludeDrop</c>

00:53:41.822 --> 00:53:42.956 align:middle line:90%,end
<c.magenta>当放入完成时</c>

00:53:43.023 --> 00:53:45.058 align:middle line:90%,end
<c.magenta>我们需要进行良好的收尾工作</c>

00:53:45.125 --> 00:53:48.829 align:middle line:90%,end
<c.magenta>移除项目状态字典中</c>

00:53:48.896 --> 00:53:50.731 align:middle line:90%,end
<c.magenta>所有不再需要的项目</c>

00:53:51.532 --> 00:53:53.834 align:middle line:90%,end
<c.magenta>修改的地方很多</c>

00:53:54.768 --> 00:53:55.969 align:middle line:90%,end
<c.magenta>让我们来看执行效果</c>

00:54:00.908 --> 00:54:04.411 align:middle line:90%,end
<c.magenta>我要使用 Slow Draggable Image View</c>
<c.magenta>重复同样的方案</c>

00:54:04.478 --> 00:54:05.646 align:middle line:90%,end
<c.magenta>请看会发生什么</c>

00:54:06.380 --> 00:54:10.517 align:middle line:90%,end
<c.magenta>现在 每次进行放入时</c>
<c.magenta>每个被放入的项目</c>

00:54:10.584 --> 00:54:12.052 align:middle line:90%,end
<c.magenta>都有一个不同的进度UI</c>

00:54:12.686 --> 00:54:16.990 align:middle line:90%,end
<c.magenta>这很不错 因为这让我们</c>
<c.magenta>能够进行这样的操作</c>

00:54:17.457 --> 00:54:19.760 align:middle line:90%,end
<c.magenta>如果我重复相同的程序</c>

00:54:19.826 --> 00:54:22.496 align:middle line:90%,end
<c.magenta>可以看到 我可以</c>
<c.magenta>这样做 比如滚动图像视图</c>

00:54:22.563 --> 00:54:23.463 align:middle line:90%,end
<c.magenta>对不起 是网格视图</c>

00:54:23.530 --> 00:54:27.868 align:middle line:90%,end
<c.magenta>而且在进入加载时</c>
<c.magenta>与多个不同的项目进行交互</c>

00:54:32.706 --> 00:54:34.208 align:middle line:90%,end
<c.magenta>这是很不错的功能</c>

00:54:34.274 --> 00:54:36.210 align:middle line:90%,end
<c.magenta>今天的演讲讨论了很多内容</c>

00:54:36.443 --> 00:54:39.379 align:middle line:90%,end
<c.magenta>现在我想让汤姆</c>
<c.magenta>为我们进行简要回顾</c>

00:54:39.880 --> 00:54:40.714 align:middle line:90%,end
<c.magenta>实验室再见</c>

00:54:47.221 --> 00:54:49.556 align:middle line:90%,end
<c.magenta>看上去真不错</c>

00:54:50.490 --> 00:54:51.325 align:middle line:90%,end
<c.magenta>让我们进行回顾</c>

00:54:52.025 --> 00:54:53.927 align:middle line:90%,end
<c.magenta>我们讨论了</c>
<c.magenta>拖动和放入操作如何成为</c>

00:54:53.994 --> 00:54:57.798 align:middle line:90%,end
<c.magenta>应用中非常有用、</c>
<c.magenta>用户主导的输入输出机制</c>

00:54:58.932 --> 00:55:01.568 align:middle line:90%,end
<c.magenta>你可以创建自定义</c>
<c.magenta>和精彩美观的视觉效果</c>

00:54:58.932 --> 00:55:01.568 align:middle line:90%,end
<c.magenta>你可以创建自定义</c>
<c.magenta>和精彩美观的视觉效果</c>

00:55:01.635 --> 00:55:04.972 align:middle line:90%,end
<c.magenta>在右侧 在放入侧</c>
<c.magenta>以及当你取消时</c>

00:55:05.706 --> 00:55:07.040 align:middle line:90%,end
<c.magenta>可以呈现许多动画效果</c>

00:55:07.574 --> 00:55:11.778 align:middle line:90%,end
<c.magenta>我们讨论了如何处理</c>
<c.magenta>异步数据和慢速加载数据</c>

00:55:12.246 --> 00:55:15.616 align:middle line:90%,end
<c.magenta>最后 我们讲述</c>
<c.magenta>如何在应用内使用拖动和放入</c>

00:55:15.682 --> 00:55:17.351 align:middle line:90%,end
<c.magenta>来提升使用体验</c>

00:55:19.586 --> 00:55:22.256 align:middle line:90%,end
<c.magenta>这里有一些参考演讲</c>
<c.magenta>你们可以重新观看视频</c>

00:55:22.322 --> 00:55:27.261 align:middle line:90%,end
<c.magenta>希望你们没有错过这些演讲</c>

00:55:27.928 --> 00:55:31.632 align:middle line:90%,end
<c.magenta>还有一些相关的演讲</c>
<c.magenta>包括昨天的“拖动与放入简介”</c>

00:55:32.199 --> 00:55:35.469 align:middle line:90%,end
<c.magenta>请观看此视频</c>
<c.magenta>里面的内容很丰富</c>

00:55:35.802 --> 00:55:40.174 align:middle line:90%,end
<c.magenta>另外 明天还有两个演讲</c>
<c.magenta>“集合视图与表格视图”</c>

00:55:40.240 --> 00:55:43.577 align:middle line:90%,end
<c.magenta>和“数据交付”</c>
<c.magenta>在2号厅依次进行</c>

00:55:43.944 --> 00:55:46.747 align:middle line:90%,end
<c.magenta>感谢参加本演讲</c>
<c.magenta>请关注WWDC的其余部分</c>

00:55:46.813 --> 00:55:47.714 align:middle line:90%,end
<c.magenta>再见</c>

WEBVTT

00:00:21.421 --> 00:00:23.957 align:middle
无缝连接APP

00:00:34.401 --> 00:00:36.603 align:middle
大家好
我是康拉德·舒尔兹

00:00:36.670 --> 00:00:39.106 align:middle
是Safari和WebKit
团队的工程师

00:00:39.306 --> 00:00:43.177 align:middle
这是第509号讲座
《无缝连接APP》

00:00:44.745 --> 00:00:48.382 align:middle
如果参加WWDC
你几乎肯定会app

00:00:48.982 --> 00:00:51.785 align:middle
甚至会有
app的网站

00:00:52.119 --> 00:00:55.055 align:middle
大家举手示意一下
在座的有哪些

00:00:55.122 --> 00:00:58.859 align:middle
有网站 可供用户
访问与app中相同的

00:00:58.926 --> 00:01:00.994 align:middle
部分内容或功能

00:00:58.926 --> 00:01:00.994 align:middle
部分内容或功能

00:01:02.062 --> 00:01:04.197 align:middle
非常棒 这次讲座是为你准备的

00:01:06.767 --> 00:01:11.972 align:middle
我们要谈谈
怎样让app和

00:01:12.372 --> 00:01:14.341 align:middle
网站之间的壁垒
不复存在

00:01:14.675 --> 00:01:17.344 align:middle
并在二者之间
建立紧密的联系性

00:01:18.011 --> 00:01:20.414 align:middle
关于我们想谈的内容
举例而言

00:01:20.848 --> 00:01:23.851 align:middle
我希望开始
先演示一个app

00:01:23.917 --> 00:01:27.054 align:middle
你可能已经在iPhone
或iPad上安装了它

00:01:28.488 --> 00:01:29.489 align:middle
这就是WWDC app

00:01:33.060 --> 00:01:36.129 align:middle
我收到同事乔纳森
发来的一条消息

00:01:36.597 --> 00:01:38.465 align:middle
让我查看
主题

00:01:39.066 --> 00:01:40.400 align:middle
听上去
这是个不错的想法

00:01:41.201 --> 00:01:44.872 align:middle
我把WWDC app
安装在这个iPad上

00:01:45.506 --> 00:01:47.674 align:middle
看到是个网页链接

00:01:47.741 --> 00:01:50.010 align:middle
那么可能还是在
Safari打开

00:01:50.077 --> 00:01:51.411 align:middle
我们继续 轻点一下

00:01:52.346 --> 00:01:56.817 align:middle
哦 相当酷
直接进入WWDC app

00:01:57.451 --> 00:01:58.852 align:middle
也许你错过了
我们再来一遍

00:01:58.919 --> 00:02:01.421 align:middle
我来继续 轻点回
左上方的信息

00:01:58.919 --> 00:02:01.421 align:middle
我来继续 轻点回
左上方的信息

00:02:02.489 --> 00:02:06.493 align:middle
看到就是普通的
HTTPS链接 前往

00:02:06.560 --> 00:02:08.461 align:middle
Developer.
Apple.com

00:02:09.162 --> 00:02:11.198 align:middle
轻点 一下就好！

00:02:11.431 --> 00:02:14.168 align:middle
直接到了app
直接就是主题

00:02:14.401 --> 00:02:16.036 align:middle
不要再通过Safari来一遭

00:02:16.537 --> 00:02:17.471 align:middle
非常棒！

00:02:25.445 --> 00:02:28.315 align:middle
我们要谈谈
三种很酷的技术

00:02:28.549 --> 00:02:30.217 align:middle
可以帮助
消除app和

00:02:30.284 --> 00:02:31.785 align:middle
网站之间的
壁垒

00:02:33.020 --> 00:02:36.089 align:middle
首先 刚才大家看到
演示当中的神奇表现

00:02:36.356 --> 00:02:39.193 align:middle
轻击普通链接时
WWDC app在

00:02:39.359 --> 00:02:43.597 align:middle
正确的地点打开

00:02:43.964 --> 00:02:47.935 align:middle
接下来 我们来谈谈
Smart App Banner

00:02:48.202 --> 00:02:50.537 align:middle
它可以帮助
用户在访问

00:02:50.671 --> 00:02:51.805 align:middle
网站时 发现app

00:02:53.607 --> 00:02:57.311 align:middle
最后 分享网络凭证
允许app访问

00:02:57.477 --> 00:03:01.315 align:middle
Safari保存的密码
因此使得

00:02:57.477 --> 00:03:01.315 align:middle
Safari保存的密码
因此使得

00:03:01.381 --> 00:03:03.650 align:middle
用户登录app
非常快捷

00:03:04.318 --> 00:03:06.220 align:middle
首先 我想有请
我的同事乔纳森

00:03:06.286 --> 00:03:09.690 align:middle
上台来和大家聊聊
怎样连接app

00:03:17.264 --> 00:03:18.165 align:middle
<br/>
谢谢 康拉德

00:03:18.732 --> 00:03:20.701 align:middle
大家好 我是
乔纳森·格林斯潘

00:03:20.767 --> 00:03:23.637 align:middle
是Apple的核心
服务软件工程师

00:03:24.371 --> 00:03:26.974 align:middle
我希望先和大家
聊聊app

00:03:27.040 --> 00:03:29.009 align:middle
在宇宙中的
位置

00:03:29.543 --> 00:03:36.250 align:middle
刚才康拉德问 有多少人
既有app也有网站时

00:03:36.316 --> 00:03:38.352 align:middle
我看到很多人
都举起了手

00:03:38.652 --> 00:03:39.820 align:middle
这并不奇怪

00:03:40.354 --> 00:03:45.192 align:middle
许多现代的app不仅是
让用户下载

00:03:45.993 --> 00:03:51.431 align:middle
它们还有着
强大的网站呈现

00:03:51.532 --> 00:03:55.135 align:middle
网站内容常常
可以反映出app内容

00:03:55.202 --> 00:03:57.871 align:middle
在座的很多都有
强大功能的出色网站

00:03:57.938 --> 00:04:01.642 align:middle
我们希望用户可以
使用到这些功能

00:03:57.938 --> 00:04:01.642 align:middle
我们希望用户可以
使用到这些功能

00:04:01.708 --> 00:04:03.410 align:middle
甚至都无需
安装app

00:04:04.444 --> 00:04:06.313 align:middle
我们也希望各种app
都可以彼此配合

00:04:06.980 --> 00:04:11.051 align:middle
app仿佛是
生态系统的组成部分

00:04:11.752 --> 00:04:14.922 align:middle
在app或网站中
需要访问其他app

00:04:14.988 --> 00:04:16.255 align:middle
或网站所提供的内容

00:04:16.523 --> 00:04:18.192 align:middle
需要某种程度的
交流互通

00:04:19.026 --> 00:04:22.829 align:middle
例如 如果有美食家app
你可能想把它连到

00:04:22.896 --> 00:04:24.731 align:middle
菜谱搜索网站Yumly
这里app

00:04:24.798 --> 00:04:28.969 align:middle
或服务中

00:04:29.636 --> 00:04:33.140 align:middle
怎样让app连接到
Yumly 怎样快速

00:04:33.207 --> 00:04:36.743 align:middle
准确地提供Yumly的
内容呢？

00:04:37.411 --> 00:04:42.850 align:middle
在iOS上 我们通常
用URL在app之间发送

00:04:42.916 --> 00:04:43.817 align:middle
数据信息

00:04:44.818 --> 00:04:49.790 align:middle
我们先来看
今天我们会怎么做

00:04:49.990 --> 00:04:53.360 align:middle
许多 iOS app执行所谓
自定义URL方案

00:04:54.294 --> 00:04:56.063 align:middle
这些是非常有效的工具

00:04:56.129 --> 00:04:58.131 align:middle
因为它们可以让
app彼此交流

00:04:58.298 --> 00:05:00.501 align:middle
但其中也有陷阱

00:04:58.298 --> 00:05:00.501 align:middle
但其中也有陷阱

00:05:01.401 --> 00:05:04.104 align:middle
首先 它们不会
总能映射到正确的app

00:05:05.105 --> 00:05:06.974 align:middle
因为没有哪个app
真正拥有它们

00:05:08.308 --> 00:05:10.277 align:middle
两个app可能会
请求同一个URL方案

00:05:10.811 --> 00:05:12.379 align:middle
用户并没有
真正的好方法

00:05:12.446 --> 00:05:14.615 align:middle
表示他们指的是哪个app

00:05:16.183 --> 00:05:19.586 align:middle
第二 如果app
没有安装 则会回退

00:05:20.220 --> 00:05:24.558 align:middle
URL无法打开
app需要自定义代码

00:05:24.625 --> 00:05:26.326 align:middle
才能处理这种
相当常见的情形

00:05:27.060 --> 00:05:30.297 align:middle
最后 它们会使得
保护用户隐私

00:05:30.364 --> 00:05:31.331 align:middle
很是困难

00:05:31.999 --> 00:05:34.968 align:middle
App需要查明
app是否在设备上安装

00:05:35.035 --> 00:05:37.504 align:middle
才能使用
自定义URL方案

00:05:37.804 --> 00:05:41.074 align:middle
这意味着 它们可以
探嗅出用户是否

00:05:41.141 --> 00:05:44.444 align:middle
安装了约会app或银行app
或者是政治相关的app

00:05:44.811 --> 00:05:46.480 align:middle
这属于个人信息

00:05:46.547 --> 00:05:48.282 align:middle
用户不愿意
对外分享

00:05:48.815 --> 00:05:51.685 align:middle
应该有更好的办法
但是这所谓更好的办法

00:05:51.752 --> 00:05:52.920 align:middle
应该是什么样子呢？

00:05:53.921 --> 00:05:57.558 align:middle
显然 它应该和
使用URL方案

00:05:57.624 --> 00:05:59.893 align:middle
一样简单
我们现在还会

00:05:59.960 --> 00:06:01.695 align:middle
介绍一种URL

00:05:59.960 --> 00:06:01.695 align:middle
介绍一种URL

00:06:02.396 --> 00:06:04.965 align:middle
它必须具有
可证实的所有权

00:06:05.399 --> 00:06:07.367 align:middle
URL应该在
正确的app中打开

00:06:08.502 --> 00:06:11.004 align:middle
在app和URL之间
应该存在强大的

00:06:11.071 --> 00:06:13.140 align:middle
双向联系

00:06:13.707 --> 00:06:17.845 align:middle
如果app并未安装
它必须有能力

00:06:17.911 --> 00:06:19.379 align:middle
优雅地回退

00:06:19.780 --> 00:06:22.616 align:middle
当用户轻点URL时
它还应该可以工作

00:06:22.683 --> 00:06:25.886 align:middle
Safari和网页浏览器
一般而言是显示

00:06:25.953 --> 00:06:28.388 align:middle
富内容的不错方法
而且在各种平台上

00:06:28.455 --> 00:06:30.891 align:middle
都有显示
因此我们将确保

00:06:30.958 --> 00:06:33.227 align:middle
这些链接可以
在网页浏览器中打开

00:06:37.297 --> 00:06:41.101 align:middle
它绝对必须保护
用户的隐私

00:06:42.002 --> 00:06:45.038 align:middle
当我在自己的设备上
运行app时 它无权

00:06:45.105 --> 00:06:47.074 align:middle
知道 我已经
安装了你的app

00:06:47.674 --> 00:06:49.843 align:middle
当然 链接...
不好意思 当然

00:06:49.910 --> 00:06:52.813 align:middle
你轻击的链接
是在你和

00:06:52.880 --> 00:06:54.348 align:middle
设备之间的事情

00:06:54.414 --> 00:06:56.884 align:middle
没有必要牵扯
第三方进来

00:06:57.651 --> 00:07:01.221 align:middle
正如康拉德给大家看的
网页URL可以满足

00:06:57.651 --> 00:07:01.221 align:middle
正如康拉德给大家看的
网页URL可以满足

00:07:01.388 --> 00:07:02.990 align:middle
上述所有标准 是理想的解决方案

00:07:03.724 --> 00:07:05.893 align:middle
你知道
它们何时打开

00:07:05.959 --> 00:07:09.129 align:middle
它们在哪里几乎都可行
当轻击它时 没有第三方

00:07:09.196 --> 00:07:10.564 align:middle
会牵扯其中

00:07:11.265 --> 00:07:15.869 align:middle
现在我们确定
将网页URL作为

00:07:16.136 --> 00:07:17.938 align:middle
我们的解决方案
我们再把它细分

00:07:18.372 --> 00:07:21.074 align:middle
我知道大家都见过
URL 但是如果来看

00:07:21.141 --> 00:07:23.777 align:middle
URL的组件
我们会对这些

00:07:23.944 --> 00:07:25.579 align:middle
链接怎样发挥作用
有更好的理解

00:07:25.913 --> 00:07:29.883 align:middle
这里是个非常
正常的网页URL

00:07:30.250 --> 00:07:31.518 align:middle
如果你感到好奇

00:07:31.585 --> 00:07:34.021 align:middle
这是去年的WWDC
主题演讲视频的链接

00:07:34.855 --> 00:07:37.658 align:middle
这并非是我们
为此目的或

00:07:37.724 --> 00:07:39.259 align:middle
仅为此app
而新生成的URL

00:07:39.593 --> 00:07:41.595 align:middle
它是现成的
今天就可以在

00:07:41.662 --> 00:07:45.599 align:middle
Apple开发人员连接
网站上看到

00:07:45.866 --> 00:07:49.536 align:middle
如果在Safari打开
我希望看到的是

00:07:49.603 --> 00:07:53.540 align:middle
你所希望的内容
视频和相关信息

00:07:53.607 --> 00:07:57.244 align:middle
如果... 我也希望
如果是在Mac或其他

00:07:57.311 --> 00:08:00.347 align:middle
平台 我也看到的是
完全一样的内容 是通用的

00:07:57.311 --> 00:08:00.347 align:middle
平台 我也看到的是
完全一样的内容 是通用的

00:08:01.081 --> 00:08:04.418 align:middle
多亏这个通用链接
这个链接将在

00:08:04.484 --> 00:08:07.788 align:middle
WWDC app中打开
无需牵扯到网页浏览器

00:08:07.855 --> 00:08:09.756 align:middle
为了这可以发挥作用

00:08:09.823 --> 00:08:11.592 align:middle
iOS需要找到
几项内容

00:08:12.759 --> 00:08:14.494 align:middle
首先 我们要看
这个方案

00:08:14.828 --> 00:08:18.432 align:middle
我们支持HTTPS
和HTTP URL

00:08:18.866 --> 00:08:21.835 align:middle
接下来是域名
或主机名

00:08:22.469 --> 00:08:25.072 align:middle
通过使用SSL证书
签署存储在安全

00:08:25.572 --> 00:08:28.976 align:middle
网络服务器的文件
域名与app

00:08:29.042 --> 00:08:30.177 align:middle
安全关联

00:08:30.244 --> 00:08:34.615 align:middle
稍后 这方面
还有更多详情

00:08:34.681 --> 00:08:37.183 align:middle
我们分析过
方案和域名后

00:08:37.251 --> 00:08:38.251 align:middle
我们再来看路径

00:08:39.419 --> 00:08:41.455 align:middle
路径可以是
完全匹配

00:08:41.755 --> 00:08:43.423 align:middle
或者是和前缀匹配

00:08:43.924 --> 00:08:47.895 align:middle
在两种情况下
都要规定匹配 不好意思

00:08:47.961 --> 00:08:51.131 align:middle
你需要规定匹配
而且要控制情形

00:08:51.765 --> 00:08:56.637 align:middle
如果你网站的内容
无法在app上

00:08:56.703 --> 00:08:58.505 align:middle
显示时 这会
非常有用

00:09:01.808 --> 00:09:04.611 align:middle
如果URL并不匹配
可以在Safari打开

00:09:04.678 --> 00:09:06.079 align:middle
和其他任何链接一样

00:09:08.282 --> 00:09:12.319 align:middle
如果我们匹配URL 则需要
不好意思 如果匹配URL

00:09:12.386 --> 00:09:15.088 align:middle
并发送给你
你可以使用NS URL组件

00:09:15.155 --> 00:09:17.024 align:middle
来做细分
并获得URL上的

00:09:17.090 --> 00:09:18.592 align:middle
有用信息

00:09:19.359 --> 00:09:22.062 align:middle
我特别喜欢使用NS URL
Query Item

00:09:22.329 --> 00:09:25.365 align:middle
因为这可以让
访问查询组件

00:09:25.432 --> 00:09:26.834 align:middle
变得非常简单

00:09:29.503 --> 00:09:33.674 align:middle
通用链接是指
让app而不是Safari

00:09:33.740 --> 00:09:37.911 align:middle
来处理网站上的链接
目的是为了打开app

00:09:38.078 --> 00:09:41.315 align:middle
当用户轻点网站链接时
iOS需要了解

00:09:41.481 --> 00:09:43.016 align:middle
app应该
打开该链接

00:09:43.984 --> 00:09:46.887 align:middle
app必须请求
它可以从网站处理链接

00:09:47.354 --> 00:09:50.557 align:middle
iOS随后可以联系
网站 证实网站

00:09:50.624 --> 00:09:53.193 align:middle
了解app
愿意被它

00:09:53.260 --> 00:09:54.628 align:middle
来代表

00:09:56.396 --> 00:09:57.531 align:middle
我们将服务器准备好

00:09:58.131 --> 00:09:59.633 align:middle
全程包括
四个步骤

00:10:01.502 --> 00:10:04.071 align:middle
第一步是
生成特殊文件

00:10:04.137 --> 00:10:06.240 align:middle
Apple-app-site-
association文件

00:10:06.306 --> 00:10:08.375 align:middle
iOS可以从网站
服务器下载

00:10:08.942 --> 00:10:11.879 align:middle
文件包括特殊
结构的JSON数据

00:10:14.314 --> 00:10:16.183 align:middle
如果去年你从Web
用过Handoff

00:10:16.250 --> 00:10:19.052 align:middle
或Shared Web
Credentials这会非常相似

00:10:20.087 --> 00:10:22.422 align:middle
顶层密钥是
applinks 这是网站

00:10:22.489 --> 00:10:25.993 align:middle
证书的兄弟类
或活动延续

00:10:26.059 --> 00:10:28.896 align:middle
若你有
二者之一的话

00:10:28.962 --> 00:10:31.565 align:middle
app秘钥非常重要
应该和作为值的

00:10:31.632 --> 00:10:33.567 align:middle
空数组
一同显示

00:10:35.736 --> 00:10:37.871 align:middle
在新的详细秘钥下
你会看到字典

00:10:38.572 --> 00:10:41.475 align:middle
字典秘钥是
应用的识别符

00:10:41.742 --> 00:10:43.877 align:middle
其中包括
团队ID 这可以从

00:10:43.944 --> 00:10:46.246 align:middle
开发人员门户网站获得
后面跟着句号

00:10:46.580 --> 00:10:48.282 align:middle
后面还有
束识别符

00:10:48.849 --> 00:10:51.451 align:middle
如果有不止一个
app 可以用不同的

00:10:51.518 --> 00:10:52.686 align:middle
秘钥 规定每个app

00:10:55.322 --> 00:10:56.990 align:middle
路径数组告知
我们 网站的哪部分

00:10:57.057 --> 00:10:59.193 align:middle
可以通过
app支持

00:10:59.893 --> 00:11:02.396 align:middle
如果app中可以支持
整个网站

00:10:59.893 --> 00:11:02.396 align:middle
如果app中可以支持
整个网站

00:11:02.663 --> 00:11:04.831 align:middle
你只需要
包括一个星号

00:11:04.898 --> 00:11:06.033 align:middle
就像这里这样

00:11:06.099 --> 00:11:08.669 align:middle
但是在第一天

00:11:08.735 --> 00:11:11.672 align:middle
很可能app
不会支持网站的任何一个网页

00:11:12.406 --> 00:11:14.508 align:middle
我们已经让你
有能力规定

00:11:14.575 --> 00:11:16.043 align:middle
它可以处理哪些网页

00:11:17.110 --> 00:11:19.813 align:middle
如你所见 我已经
为数组增加了两个路径

00:11:20.180 --> 00:11:21.515 align:middle
第一个是完全匹配

00:11:21.982 --> 00:11:24.451 align:middle
如果用户轻点连接
可以直接前往路径

00:11:24.651 --> 00:11:26.053 align:middle
会在app中打开

00:11:27.354 --> 00:11:29.790 align:middle
如果网站的全部内容
都得到app的支持

00:11:29.857 --> 00:11:34.194 align:middle
可以使用路径前缀
例如本数组的第二输入

00:11:34.261 --> 00:11:36.263 align:middle
来规定

00:11:36.330 --> 00:11:37.931 align:middle
该部分将在
app打开

00:11:38.332 --> 00:11:40.534 align:middle
注意结尾的星号
它告知我们

00:11:40.601 --> 00:11:41.869 align:middle
这是路径前缀

00:11:42.736 --> 00:11:45.272 align:middle
需要注意
这些路径要分大小写

00:11:45.572 --> 00:11:47.975 align:middle
其他URL组件
如查询或

00:11:48.041 --> 00:11:51.044 align:middle
片段
则不支持

00:11:53.247 --> 00:11:55.849 align:middle
第二步是
从认可的证书签发机构

00:11:55.949 --> 00:11:57.751 align:middle
那里获得
SSL证书

00:11:58.318 --> 00:12:01.021 align:middle
这不是为了App Store
签署app所用的

00:11:58.318 --> 00:12:01.021 align:middle
这不是为了App Store
签署app所用的

00:12:01.188 --> 00:12:05.058 align:middle
那个证书
不是Apple生成的

00:12:05.292 --> 00:12:07.828 align:middle
我们建议你使用
HTTPS服务器上用的

00:12:07.895 --> 00:12:10.631 align:middle
相同证书
但不做要求

00:12:11.331 --> 00:12:13.600 align:middle
如果有不止一个域名
需要在app体现

00:12:13.667 --> 00:12:16.036 align:middle
我们建议
考虑获得

00:12:16.103 --> 00:12:17.171 align:middle
通配符证书

00:12:17.804 --> 00:12:19.907 align:middle
若要了解证书生成的
更多详情

00:12:20.107 --> 00:12:21.975 align:middle
请联系
证书签发机构

00:12:24.511 --> 00:12:28.182 align:middle
第三步是签署JSON文件
这是你刚通过SSL证书

00:12:28.248 --> 00:12:29.216 align:middle
而生成的

00:12:31.251 --> 00:12:32.419 align:middle
为此
你需要在

00:12:32.486 --> 00:12:36.223 align:middle
开发Mac的终端
使用openssl smime

00:12:36.290 --> 00:12:38.058 align:middle
命令

00:12:38.692 --> 00:12:40.127 align:middle
这两个文件名
都很重要

00:12:40.561 --> 00:12:43.096 align:middle
第一个是你刚生成的
文件名称

00:12:43.530 --> 00:12:46.366 align:middle
是在开发Mac上
未签署的JSON文件

00:12:46.700 --> 00:12:49.369 align:middle
第二个必须和你在这里
所见到的完全匹配

00:12:49.670 --> 00:12:52.940 align:middle
apple-app-
site-association

00:12:55.175 --> 00:12:56.310 align:middle
这些是你的私人秘钥

00:12:56.777 --> 00:12:58.946 align:middle
是在证书生成期间
生成的

00:12:59.680 --> 00:13:02.916 align:middle
以及证书签发机构
所提供的证书

00:12:59.680 --> 00:13:02.916 align:middle
以及证书签发机构
所提供的证书

00:13:03.083 --> 00:13:05.786 align:middle
同样 这不是
Apple提供的证书

00:13:05.953 --> 00:13:07.621 align:middle
也不是App Store的
证书

00:13:07.688 --> 00:13:09.223 align:middle
也不是开发人员
ID证书

00:13:10.190 --> 00:13:11.758 align:middle
这是需要注意的
最后一点

00:13:11.825 --> 00:13:13.994 align:middle
如果你有证书
签发机构提供的

00:13:14.061 --> 00:13:16.597 align:middle
中间证书
在签署期间

00:13:16.663 --> 00:13:18.065 align:middle
也需要包括在内

00:13:20.367 --> 00:13:21.735 align:middle
第四步也就是最后一步

00:13:22.236 --> 00:13:23.670 align:middle
你现在有了
签署的JSON文件

00:13:23.770 --> 00:13:25.272 align:middle
需要上传至
网站服务器

00:13:25.772 --> 00:13:27.307 align:middle
这会到达
服务器的根目录

00:13:27.374 --> 00:13:28.208 align:middle
例如

00:13:28.876 --> 00:13:30.777 align:middle
www.example.com

00:13:30.844 --> 00:13:33.580 align:middle
/ apple-app
-site-association

00:13:34.681 --> 00:13:36.216 align:middle
需要注意
域名支持的每个app

00:13:36.283 --> 00:13:39.553 align:middle
也许需要不同的
JSON文件

00:13:39.620 --> 00:13:41.355 align:middle
这是为域名妥善
签署过的

00:13:41.989 --> 00:13:43.824 align:middle
例如example.com

00:13:43.891 --> 00:13:45.626 align:middle
和<u>www.example.com</u>

00:13:45.692 --> 00:13:47.160 align:middle
<u>&lt;http://www.</u>
<u>example.com&gt;</u>是不同的

00:13:48.662 --> 00:13:51.231 align:middle
我们在iOS 8中
引入了这个功能性

00:13:51.465 --> 00:13:53.867 align:middle
支持两个功能：Handoff
from the Web

00:13:54.234 --> 00:13:55.536 align:middle
和Shared Web
Credentials

00:13:56.436 --> 00:13:59.439 align:middle
在iOS 9中 我们
添加了通用链接的支持

00:13:59.706 --> 00:14:01.975 align:middle
我们需要让它
变得尽量简单

00:13:59.706 --> 00:14:01.975 align:middle
我们需要让它
变得尽量简单

00:14:02.042 --> 00:14:05.479 align:middle
便于尽快在app中
采用通用链接

00:14:06.246 --> 00:14:10.918 align:middle
不好意思 是从
iOS 9种子2开始

00:14:11.652 --> 00:14:13.554 align:middle
我们不再要求
大家签署

00:14:13.620 --> 00:14:16.056 align:middle
Apple-app-sit
e-association文件

00:14:16.123 --> 00:14:18.425 align:middle
只要上传未签署的
JSON 谢谢

00:14:22.329 --> 00:14:23.197 align:middle
谢谢

00:14:23.263 --> 00:14:26.700 align:middle
只要上传未签署的JSON文件
加上相同的文件名

00:14:26.767 --> 00:14:29.369 align:middle
apple-app
-site-association

00:14:29.436 --> 00:14:31.805 align:middle
到HTTPS服务器

00:14:32.172 --> 00:14:33.941 align:middle
iOS就会处理
其余工作

00:14:34.675 --> 00:14:37.010 align:middle
如果需要支持iOS 8的
向后兼容

00:14:37.077 --> 00:14:39.813 align:middle
注意签名要求
还依然有效

00:14:40.147 --> 00:14:41.515 align:middle
如果是从 iOS 9开始

00:14:41.782 --> 00:14:43.150 align:middle
则无需
填写文件

00:14:43.217 --> 00:14:48.388 align:middle
我们来谈谈
应用的运用

00:14:48.889 --> 00:14:50.824 align:middle
需要调整
应用委托

00:14:50.891 --> 00:14:52.759 align:middle
需要用到
授权

00:14:52.826 --> 00:14:56.396 align:middle
我给大家看看怎么做

00:14:56.563 --> 00:14:58.532 align:middle
首先是
应用委托

00:14:59.132 --> 00:15:01.635 align:middle
如果去年用过Handoff
这会非常相似

00:14:59.132 --> 00:15:01.635 align:middle
如果去年用过Handoff
这会非常相似

00:15:03.170 --> 00:15:05.239 align:middle
当用户活动
应用委托

00:15:05.572 --> 00:15:08.242 align:middle
这个方法会发送到
应用委托

00:15:10.410 --> 00:15:12.446 align:middle
用户活动对象
不好意思

00:15:12.513 --> 00:15:15.249 align:middle
用户活动对象
有着页面URL属性

00:15:15.716 --> 00:15:17.518 align:middle
在这一功能的情况下

00:15:17.584 --> 00:15:20.821 align:middle
会一直是HTTPS
或HTTPURL

00:15:21.255 --> 00:15:23.390 align:middle
这一功能永远都不会为零值

00:15:25.325 --> 00:15:28.262 align:middle
在通用链接的情况下
活动类型

00:15:28.328 --> 00:15:29.630 align:middle
一直都是

00:15:29.696 --> 00:15:32.099 align:middle
NS User Activity
Type Browsing Web

00:15:33.166 --> 00:15:36.270 align:middle
一旦确认了
活动类型符合你的预期

00:15:37.504 --> 00:15:39.540 align:middle
就可以
通过NSURLComponent类

00:15:39.606 --> 00:15:43.177 align:middle
从网页URL
细分URL

00:15:44.311 --> 00:15:46.713 align:middle
与自定义URL方案相似
URL可能会

00:15:46.780 --> 00:15:49.550 align:middle
不代表app中的
任何内容

00:15:49.616 --> 00:15:53.187 align:middle
或代表过时
或变形的内容

00:15:53.787 --> 00:15:56.957 align:middle
如果出现这样的情况
你应该查明并优雅地失败

00:15:57.057 --> 00:15:59.893 align:middle
现在 在这里优雅
根据各app的情况

00:16:00.327 --> 00:16:02.996 align:middle
也许需要
向相关使用显示提醒

00:16:03.363 --> 00:16:06.333 align:middle
解释出了什么差错
或者在Safari

00:16:06.500 --> 00:16:09.770 align:middle
打开链接效果会更好
这可以从app来实现

00:16:09.837 --> 00:16:12.406 align:middle
调用UI Application
Open URL即可

00:16:12.940 --> 00:16:14.775 align:middle
从中拿走的
最重要的是

00:16:14.975 --> 00:16:16.810 align:middle
不会让用户
盯着空白的

00:16:16.877 --> 00:16:18.278 align:middle
View Controller

00:16:20.848 --> 00:16:24.084 align:middle
一旦应用委托
得到升级

00:16:24.151 --> 00:16:25.519 align:middle
你需要更新
app的授权

00:16:26.153 --> 00:16:27.554 align:middle
使用XCode会很容易

00:16:28.088 --> 00:16:30.090 align:middle
导航至
项目设置

00:16:30.190 --> 00:16:31.625 align:middle
再到配置
不好意思

00:16:31.692 --> 00:16:35.662 align:middle
功能选项卡
并选择相关域名

00:16:37.097 --> 00:16:39.199 align:middle
你需要添加
app支持的

00:16:39.266 --> 00:16:42.402 align:middle
每个域名的输入
app链接 后面加上冒号

00:16:42.736 --> 00:16:43.871 align:middle
再加域名名称

00:16:44.238 --> 00:16:45.806 align:middle
同样 app支持的

00:16:45.873 --> 00:16:48.775 align:middle
每个域名在这里需要单独的输入
这些都很清楚

00:16:49.209 --> 00:16:52.045 align:middle
Example.com和
www.example.com

00:16:52.112 --> 00:16:54.114 align:middle
需要不同的输入
正如大家所见

00:16:56.583 --> 00:16:57.751 align:middle
我给大家看看
这些怎样

00:16:57.818 --> 00:16:58.852 align:middle
才能很快都实现

00:16:59.152 --> 00:17:01.755 align:middle
但是 首先我想
回顾两个最佳实践

00:16:59.152 --> 00:17:01.755 align:middle
但是 首先我想
回顾两个最佳实践

00:17:03.223 --> 00:17:05.492 align:middle
因为所有内容是
来自app以外

00:17:05.893 --> 00:17:08.529 align:middle
数据可能会变形
你可能会需要验证

00:17:09.963 --> 00:17:12.199 align:middle
如果是这样 这并非是说
你犯了错

00:17:12.598 --> 00:17:14.167 align:middle
而是说
这种情况发生时

00:17:14.233 --> 00:17:16.136 align:middle
你需要优雅地
失败

00:17:17.971 --> 00:17:20.840 align:middle
一旦在处理URL
你需要牢记

00:17:20.907 --> 00:17:23.911 align:middle
HTTP在iOS 9上做出警告

00:17:24.344 --> 00:17:25.913 align:middle
这是为了用户安全

00:17:26.079 --> 00:17:27.214 align:middle
和隐私的考虑

00:17:27.281 --> 00:17:29.483 align:middle
例如 你传递了使用数据

00:17:29.550 --> 00:17:30.884 align:middle
NSURLSession

00:17:30.951 --> 00:17:34.021 align:middle
就应该一直使用HTTPS

00:17:35.122 --> 00:17:37.824 align:middle
如果需要在app使用
未加密的HTTP

00:17:38.525 --> 00:17:40.494 align:middle
则要回顾第711号讲座

00:17:40.994 --> 00:17:42.930 align:middle
《网络互联
NSURLSession》

00:17:43.030 --> 00:17:45.432 align:middle
其中涉及重要的
网络互联新技术

00:17:45.666 --> 00:17:47.701 align:middle
App Transport
Security

00:17:49.736 --> 00:17:52.372 align:middle
我们来看
这些怎样在XCode中使用

00:17:52.940 --> 00:17:53.874 align:middle
我会为大家展示

00:17:53.941 --> 00:17:55.309 align:middle
来自WWDC app的代码

00:17:55.375 --> 00:17:57.244 align:middle
这在App Store中可以获得

00:18:01.415 --> 00:18:03.050 align:middle
这里是

00:18:03.116 --> 00:18:04.952 align:middle
WWDC项目

00:18:05.018 --> 00:18:07.054 align:middle
我创建一个新的
扩展 其中会有

00:18:07.120 --> 00:18:08.956 align:middle
我们今天看到的
代码

00:18:09.323 --> 00:18:11.425 align:middle
这个扩展是在
应用委托类

00:18:11.491 --> 00:18:12.392 align:middle
我首先要做的是

00:18:12.459 --> 00:18:15.796 align:middle
添加我们探讨过的应用
委托方法

00:18:16.496 --> 00:18:17.331 align:middle
同样

00:18:17.531 --> 00:18:20.167 align:middle
如果去年用过
Handoff 这里是

00:18:20.234 --> 00:18:21.268 align:middle
同样的委托方法

00:18:21.768 --> 00:18:24.471 align:middle
你需要加以扩展
来支持这个新功能

00:18:25.372 --> 00:18:27.741 align:middle
我们感兴趣的
参数是

00:18:27.808 --> 00:18:31.011 align:middle
用户活动参数
其中包括用户

00:18:31.078 --> 00:18:32.346 align:middle
所作所为的信息

00:18:32.412 --> 00:18:35.215 align:middle
在本例中
是从网站导航

00:18:37.718 --> 00:18:38.852 align:middle
我们还感兴趣

00:18:38.919 --> 00:18:41.421 align:middle
活动类型
和网页URL

00:18:42.322 --> 00:18:45.425 align:middle
出于我们的目的
活动类型一直是NSUser

00:18:45.492 --> 00:18:46.760 align:middle
活动类型BrowsingWeb

00:18:46.994 --> 00:18:49.730 align:middle
但是 如果app支持
来自其他来源的

00:18:49.796 --> 00:18:52.999 align:middle
用户活动 例如
Handoff 那么你就要

00:18:53.066 --> 00:18:54.968 align:middle
检查我所做的
活动类型

00:18:56.203 --> 00:18:58.906 align:middle
因为它是NSUser
活动类型BrowsingWeb

00:18:58.972 --> 00:19:00.707 align:middle
我知道会有网页URL
而且不是零值

00:18:58.972 --> 00:19:00.707 align:middle
我知道会有网页URL
而且不是零值

00:19:00.974 --> 00:19:03.944 align:middle
因此我使用
网页零值

00:19:04.111 --> 00:19:07.814 align:middle
属性的显性打开
来从中获取URL

00:19:07.881 --> 00:19:10.684 align:middle
我会把它发送给函数
显示URL

00:19:11.018 --> 00:19:13.620 align:middle
它负责细分
URL 并把它

00:19:14.087 --> 00:19:16.757 align:middle
交付给
用户界面

00:19:16.823 --> 00:19:17.958 align:middle
这样用户就可以看到

00:19:20.194 --> 00:19:22.129 align:middle
这个函数的签名
相当简单

00:19:22.196 --> 00:19:25.132 align:middle
它将单一的URL
作为输入 并返回Boolean

00:19:25.199 --> 00:19:27.935 align:middle
表示我们是否
可以处理URL

00:19:28.535 --> 00:19:30.838 align:middle
现在方法的主体
有些更为复杂

00:19:30.904 --> 00:19:32.639 align:middle
但是我会带大家
逐行来看

00:19:33.540 --> 00:19:36.944 align:middle
首先我们要做的是创建NSURL
Components实例

00:19:37.578 --> 00:19:40.881 align:middle
我说过 这个类
会细分URL

00:19:41.014 --> 00:19:43.984 align:middle
并允许你访问
其中的各部分

00:19:44.384 --> 00:19:46.486 align:middle
而无需你搭建
自己的解析器

00:19:47.955 --> 00:19:51.024 align:middle
一旦有了这个对象
我们会从中

00:19:51.091 --> 00:19:52.192 align:middle
提取感兴趣的部分组件

00:19:52.960 --> 00:19:55.963 align:middle
对于WWDC app
我们感兴趣的是

00:19:56.330 --> 00:19:57.431 align:middle
主机和路径组件

00:19:58.465 --> 00:20:00.601 align:middle
现在WWDC app

00:19:58.465 --> 00:20:00.601 align:middle
现在WWDC app

00:20:00.667 --> 00:20:02.135 align:middle
可以
处理URL来自

00:20:02.202 --> 00:20:03.370 align:middle
不止一个域名的情况

00:20:03.437 --> 00:20:05.038 align:middle
所以我要检查域名

00:20:05.105 --> 00:20:06.473 align:middle
确保它是我所预期的

00:20:07.107 --> 00:20:08.542 align:middle
在这里 我有个
开关语句

00:20:09.142 --> 00:20:11.678 align:middle
是在developer.apple
.com介绍的

00:20:11.745 --> 00:20:14.114 align:middle
康拉德之前给大家
看过这个URL 不好意思

00:20:14.181 --> 00:20:15.282 align:middle
URL的主机名称

00:20:16.617 --> 00:20:18.819 align:middle
一旦进行了匹配
我希望匹配路径

00:20:19.953 --> 00:20:22.623 align:middle
我会用开关语句
这在Swift中非常强大

00:20:22.956 --> 00:20:25.192 align:middle
立刻搜集所有的组件
并在一个代码行中

00:20:25.259 --> 00:20:29.229 align:middle
进行比较
s/videos/WWDC

00:20:29.463 --> 00:20:30.998 align:middle
有些可以是
也可以不是一年

00:20:32.432 --> 00:20:34.368 align:middle
我希望来
看看值

00:20:34.434 --> 00:20:36.470 align:middle
现在是个字符串
并把它改为Int

00:20:36.537 --> 00:20:42.075 align:middle
我把它转换为Int
初始程序 不好意思

00:20:42.943 --> 00:20:44.545 align:middle
我还会搜集
讲座序号

00:20:44.611 --> 00:20:46.613 align:middle
在本例中
是第509号讲座

00:20:46.680 --> 00:20:48.448 align:middle
在康拉德给大家
展示的例子中

00:20:48.515 --> 00:20:50.951 align:middle
是第101号讲座

00:20:51.018 --> 00:20:53.253 align:middle
我马上给大家看
Find Session方法

00:20:54.688 --> 00:20:56.089 align:middle
如果组件
可以匹配

00:20:56.356 --> 00:20:58.025 align:middle
我就会将它
呈现给用户

00:20:58.091 --> 00:21:01.628 align:middle
但是我希望
先确认输入

00:20:58.091 --> 00:21:01.628 align:middle
但是我希望
先确认输入

00:21:02.963 --> 00:21:03.997 align:middle
因为可能会是

00:21:04.698 --> 00:21:07.234 align:middle
它不在任何合理范围

00:21:07.301 --> 00:21:09.536 align:middle
例如 年份是在
Apple成立之前

00:21:09.603 --> 00:21:11.071 align:middle
或讲座序列号
是数百万

00:21:12.206 --> 00:21:13.540 align:middle
我用讲座的年份

00:21:13.740 --> 00:21:15.375 align:middle
在两个范围中
进行比较

00:21:15.442 --> 00:21:17.845 align:middle
2011到2015
是年份

00:21:18.412 --> 00:21:20.714 align:middle
100到10000
是讲座序号

00:21:20.781 --> 00:21:22.482 align:middle
如果是在这两个范围内
则看似有效

00:21:22.549 --> 00:21:24.918 align:middle
可以向用户
进行呈现

00:21:25.352 --> 00:21:27.020 align:middle
我们继续来呈现

00:21:29.289 --> 00:21:32.492 align:middle
我提到这个Find
Session方法 马上就给大家看

00:21:33.393 --> 00:21:34.228 align:middle
在这里

00:21:34.661 --> 00:21:37.030 align:middle
这是专为app准备的

00:21:37.097 --> 00:21:39.166 align:middle
大家不大可能
拿到完全相同的代码

00:21:39.233 --> 00:21:41.034 align:middle
我也不会
讲太多细节

00:21:41.335 --> 00:21:44.371 align:middle
但是思路是
提供的数据可能是

00:21:44.438 --> 00:21:47.407 align:middle
来自不止一种来源
我们希望检查所有这些内容

00:21:47.608 --> 00:21:50.043 align:middle
首先我们要看
这个片段 是2014年

00:21:50.110 --> 00:21:53.580 align:middle
和之前的URL的情况
包括讲座ID

00:21:54.181 --> 00:21:57.851 align:middle
如果不包含
讲座ID 我们就看看

00:21:58.385 --> 00:21:59.253 align:middle
查询

00:21:59.620 --> 00:22:02.389 align:middle
从NSURL查询项
分离出的查询

00:21:59.620 --> 00:22:02.389 align:middle
从NSURL查询项
分离出的查询

00:22:02.789 --> 00:22:06.260 align:middle
在本例中 查询项的属性
已经为我们填好了

00:22:07.394 --> 00:22:08.996 align:middle
我们再重复一遍
可以发现

00:22:09.062 --> 00:22:10.931 align:middle
匹配的ID
或实例

00:22:10.998 --> 00:22:13.600 align:middle
任何一种都会
包括讲座序号

00:22:16.336 --> 00:22:17.871 align:middle
现在 代码基本
已经就绪

00:22:17.971 --> 00:22:19.072 align:middle
不过 有些内容缺失了

00:22:19.673 --> 00:22:21.108 align:middle
这里有很多
返回错误

00:22:21.175 --> 00:22:24.311 align:middle
还有很多
无法处理URL的情况

00:22:25.245 --> 00:22:28.215 align:middle
同样 这样是可以的
因为我们会时常

00:22:28.282 --> 00:22:29.349 align:middle
收到无效输入

00:22:29.416 --> 00:22:31.919 align:middle
但是在应用委托中

00:22:32.152 --> 00:22:33.887 align:middle
我不会对返回值
做任何处理

00:22:34.321 --> 00:22:36.690 align:middle
如果获得明显
无效的URL

00:22:37.090 --> 00:22:38.525 align:middle
用户则什么
都看不见

00:22:38.892 --> 00:22:41.628 align:middle
打开WWDC Apple
会出现空白的

00:22:41.695 --> 00:22:43.197 align:middle
View Controller

00:22:43.263 --> 00:22:45.232 align:middle
这是我希望
完全避免的情况

00:22:45.766 --> 00:22:47.334 align:middle
我们需要
优雅地失败

00:22:47.401 --> 00:22:49.136 align:middle
这可以非常
非常简单地实现

00:22:49.837 --> 00:22:52.573 align:middle
在本例中 如果出现
URL返回错误

00:22:52.840 --> 00:22:54.975 align:middle
我会了解 我并未
给用户呈现任何内容

00:22:55.309 --> 00:22:57.544 align:middle
并通过UI
ApplicationpenURL

00:22:57.611 --> 00:22:59.580 align:middle
将URL传递
给Safari

00:23:00.848 --> 00:23:02.983 align:middle
所有这些代码改变
你都需要采用

00:23:03.217 --> 00:23:05.853 align:middle
如果你已经获得
自定义URL方案的代码

00:23:05.986 --> 00:23:07.754 align:middle
很可能它会与
我们这里的情况

00:23:07.821 --> 00:23:08.655 align:middle
非常相似

00:23:09.723 --> 00:23:13.293 align:middle
现在我就将向大家
展示添加代码前后

00:23:13.460 --> 00:23:15.796 align:middle
app会是什么样子
但是在此之前

00:23:16.129 --> 00:23:17.264 align:middle
我需要加上授权

00:23:17.898 --> 00:23:20.067 align:middle
因此我进入Project
Setting

00:23:20.133 --> 00:23:21.835 align:middle
选择Capabilities选项卡

00:23:22.302 --> 00:23:24.238 align:middle
并选择Associated
Domain

00:23:25.806 --> 00:23:27.407 align:middle
我还会在这里加上
一个输入

00:23:27.541 --> 00:23:29.643 align:middle
因为我们并非是
只用到一个域名

00:23:30.010 --> 00:23:33.447 align:middle
不过同样 如果不只是
一个域名 example.com

00:23:33.514 --> 00:23:36.850 align:middle
www.example.com
它们需要在这个

00:23:36.917 --> 00:23:37.784 align:middle
授权中 分别输入

00:23:38.352 --> 00:23:40.320 align:middle
在本例中 我需要
applinks:

00:23:40.554 --> 00:23:43.423 align:middle
developer.
apple.com

00:23:44.458 --> 00:23:45.292 align:middle
就是这样

00:23:45.626 --> 00:23:46.994 align:middle
我准备在
客户端继续

00:23:47.060 --> 00:23:48.996 align:middle
那么我会让大家
看看在加上这个之前

00:23:49.062 --> 00:23:50.297 align:middle
app是什么样子

00:23:51.164 --> 00:23:53.500 align:middle
这里是我的iPad
这是我们加上之前

00:23:53.567 --> 00:23:57.371 align:middle
安装的WWDC app
拷贝 不好意思

00:23:57.437 --> 00:24:00.274 align:middle
是在我们加上
通用链接之前

00:23:57.437 --> 00:24:00.274 align:middle
是在我们加上
通用链接之前

00:24:01.308 --> 00:24:03.110 align:middle
我将前往
同样的文本信息 不好意思

00:24:03.177 --> 00:24:05.279 align:middle
是我之前发给
康拉德的同样的iMessage

00:24:06.747 --> 00:24:08.982 align:middle
信息内容完全相同
可是当我点击它的时候

00:24:09.583 --> 00:24:11.451 align:middle
因为我没有使用
通用链接

00:24:12.219 --> 00:24:13.587 align:middle
它只在Safari中打开

00:24:14.521 --> 00:24:18.058 align:middle
Safari是个不错的app
可以显示很棒的内容

00:24:18.125 --> 00:24:20.861 align:middle
特别是 它并未
提供可以从app

00:24:20.928 --> 00:24:21.862 align:middle
获得的所有选项

00:24:22.296 --> 00:24:25.465 align:middle
我可以在app和Safari上
观看视频

00:24:25.532 --> 00:24:28.869 align:middle
我还可以从app
提供反馈 使之成为

00:24:28.936 --> 00:24:31.438 align:middle
以后可作为收藏以后观看
我甚至可以下载后 脱机观看

00:24:31.839 --> 00:24:35.075 align:middle
正如我会给大家展示的那样
在app中 现在有了这个

00:24:35.175 --> 00:24:37.244 align:middle
在app中 现在大家
手中有了这个

00:24:37.778 --> 00:24:39.813 align:middle
看上去有点
像是这个样子

00:24:40.514 --> 00:24:43.584 align:middle
这还是我之前给
康拉德发的URL

00:24:43.650 --> 00:24:47.387 align:middle
和之前一样 我轻点一下
打开主题

00:24:47.788 --> 00:24:49.022 align:middle
并可以把它
加入收藏

00:24:49.356 --> 00:24:51.558 align:middle
我可以观看视频
下载 等等

00:24:52.359 --> 00:24:54.761 align:middle
基本上 我们要做的
所有内容就是这些

00:24:58.365 --> 00:24:59.199 align:middle
谢谢

00:25:04.071 --> 00:25:06.773 align:middle
我把遥控交给
康拉德之前

00:25:06.974 --> 00:25:09.710 align:middle
要非常感谢大家能来
而且我非常希望

00:25:09.776 --> 00:25:11.345 align:middle
看到大家能用
iOS 9中的

00:25:11.411 --> 00:25:13.714 align:middle
通用链接
能有所创造

00:25:13.914 --> 00:25:14.781 align:middle
谢谢

00:25:20.320 --> 00:25:21.188 align:middle
非常棒

00:25:22.022 --> 00:25:22.956 align:middle
谢谢 乔纳森

00:25:24.558 --> 00:25:27.794 align:middle
通过通用链接

00:25:28.328 --> 00:25:29.263 align:middle
你可以为所有

00:25:29.329 --> 00:25:32.766 align:middle
用户提供可能实现的
最佳用户体验

00:25:33.934 --> 00:25:37.437 align:middle
用户如果在你的iPhone
或iPad上安装了你的app

00:25:38.272 --> 00:25:39.606 align:middle
连在你网站上的链接

00:25:39.673 --> 00:25:42.109 align:middle
就会在app立刻打开

00:25:42.376 --> 00:25:45.712 align:middle
而不需要通过
Safari中间过渡

00:25:47.881 --> 00:25:51.051 align:middle
你不再需要在自己的网站上
编写JavaScript

00:25:51.451 --> 00:25:53.453 align:middle
来检查是否安装了
你的app

00:25:53.520 --> 00:25:56.323 align:middle
或是试图去检查
是否安装

00:25:56.390 --> 00:25:58.292 align:middle
再代替用户安装app

00:26:00.727 --> 00:26:03.030 align:middle
如果用户并未安装
你的app

00:26:03.197 --> 00:26:05.399 align:middle
你的链接也仍可以
在Safari无缝打开

00:26:07.634 --> 00:26:09.002 align:middle
出于同样原因

00:26:09.236 --> 00:26:13.006 align:middle
你的链接在Mac

00:26:13.073 --> 00:26:14.575 align:middle
甚至其他平台上
也会依然有效

00:26:16.310 --> 00:26:19.813 align:middle
因为这些都是在
用户设备上本地操作

00:26:20.080 --> 00:26:22.249 align:middle
就不会浪费时间
前往用户

00:26:22.316 --> 00:26:23.550 align:middle
网络服务器

00:26:24.418 --> 00:26:25.853 align:middle
或是你的网络服务器

00:26:26.920 --> 00:26:31.291 align:middle
当然 这也意味着
Apple或其他

00:26:31.358 --> 00:26:34.094 align:middle
第三方都无法跟踪
用户在做什么

00:26:37.431 --> 00:26:41.435 align:middle
我们今天
讲了一些

00:26:41.502 --> 00:26:45.272 align:middle
谈到如果没有
安装你的app

00:26:45.539 --> 00:26:47.107 align:middle
这些链接怎样将用户
带到你的网站

00:26:47.908 --> 00:26:50.077 align:middle
如果是这样 许多人
可能会希望

00:26:50.143 --> 00:26:53.313 align:middle
帮助用户发现
并安装你的app

00:26:53.680 --> 00:26:56.517 align:middle
ILS有一项技术
可以帮上忙

00:26:57.317 --> 00:26:59.286 align:middle
这就是
Smart App Banner

00:27:00.354 --> 00:27:02.256 align:middle
我们用几分钟时间
来谈谈

00:27:02.322 --> 00:27:05.692 align:middle
Smart App Banner
这是关于使用它们

00:27:05.759 --> 00:27:06.793 align:middle
将花费多长时间

00:27:08.362 --> 00:27:09.997 align:middle
那么Smart App
Banner是什么？

00:27:10.297 --> 00:27:12.366 align:middle
这是无侵入的UI元素

00:27:12.799 --> 00:27:14.568 align:middle
可以帮助将用户
带到app

00:27:15.035 --> 00:27:16.870 align:middle
可以在iOS上
通过Safari

00:27:16.937 --> 00:27:18.338 align:middle
自动呈现

00:27:20.507 --> 00:27:22.643 align:middle
如果用户并未安装
你的app

00:27:23.010 --> 00:27:24.311 align:middle
广告条则会

00:27:24.378 --> 00:27:27.214 align:middle
启动App Store
以便用户下载

00:27:27.981 --> 00:27:30.584 align:middle
如果用户已经安装了你的app

00:27:30.651 --> 00:27:31.952 align:middle
你的app 广告条则会

00:27:32.019 --> 00:27:33.487 align:middle
用户启动app

00:27:35.055 --> 00:27:38.292 align:middle
Smart App Banner
的添加对你的网站而言微不足道

00:27:39.927 --> 00:27:43.697 align:middle
iOS 9 app搜索功能
有项新内容

00:27:44.131 --> 00:27:46.166 align:middle
Apple将
Smart App Banner

00:27:46.233 --> 00:27:49.036 align:middle
用于帮助索引你的app
及其内容

00:27:49.102 --> 00:27:50.671 align:middle
这可以
提高用户发现

00:27:50.938 --> 00:27:53.440 align:middle
并安装你的
app的可能性

00:27:55.309 --> 00:27:58.512 align:middle
现在 有些人也许会用
自定义URL方案

00:27:58.812 --> 00:28:03.817 align:middle
让用户从网站
进入app

00:27:58.812 --> 00:28:03.817 align:middle
让用户从网站
进入app

00:28:04.885 --> 00:28:06.753 align:middle
这样也可以

00:28:06.820 --> 00:28:07.921 align:middle
但并不推荐这么做

00:28:08.722 --> 00:28:11.558 align:middle
这样并不会确保
自定义URL方案的

00:28:11.625 --> 00:28:14.361 align:middle
用户体验在未来
会保持一致

00:28:15.329 --> 00:28:18.165 align:middle
Smart App Banner
可提供更好的用户体验

00:28:20.300 --> 00:28:22.469 align:middle
为使用Smart App
Banner 你只需要

00:28:22.536 --> 00:28:24.671 align:middle
在网站的标头部分

00:28:24.738 --> 00:28:26.940 align:middle
添加一行HTML

00:28:28.509 --> 00:28:30.677 align:middle
apple-itunes-app
元标签

00:28:30.744 --> 00:28:32.412 align:middle
会告知Safari

00:28:32.479 --> 00:28:35.115 align:middle
你想要安装或显示
Smart App Banner

00:28:37.251 --> 00:28:38.919 align:middle
内容属性必须

00:28:38.986 --> 00:28:40.687 align:middle
包括你的app ID

00:28:41.221 --> 00:28:43.790 align:middle
这是用于将用户
指向正确的app

00:28:44.525 --> 00:28:47.628 align:middle
可以通过便捷的iTunes
link maker链接生成工具

00:28:47.694 --> 00:28:48.896 align:middle
来获取你的app ID

00:28:50.597 --> 00:28:51.965 align:middle
app参数应该包括

00:28:52.032 --> 00:28:56.570 align:middle
当前显示页面
的URL

00:28:57.371 --> 00:28:58.505 align:middle
这其中有两个原因

00:28:59.106 --> 00:28:59.940 align:middle
首先

00:29:00.407 --> 00:29:02.676 align:middle
这可以实现
自定义为用户

00:29:02.743 --> 00:29:04.244 align:middle
显示的视图

00:29:06.046 --> 00:29:09.249 align:middle
它会被传递到
应用开放URL源

00:29:09.316 --> 00:29:10.884 align:middle
应用注解方法

00:29:12.119 --> 00:29:13.320 align:middle
其二

00:29:13.387 --> 00:29:14.788 align:middle
它可以帮助
确保app搜索可以

00:29:14.855 --> 00:29:17.524 align:middle
识别出你的站点
不仅仅是

00:29:17.591 --> 00:29:18.792 align:middle
着陆页

00:29:19.026 --> 00:29:20.627 align:middle
若要了解这方面的
更多详情

00:29:21.028 --> 00:29:24.398 align:middle
我推荐大家听听《介绍搜索API》
那场讲座

00:29:24.765 --> 00:29:26.733 align:middle
可以找到相关视频

00:29:26.800 --> 00:29:27.701 align:middle
这是昨天的讲座

00:29:29.703 --> 00:29:32.306 align:middle
最后 要注意Smart
App Banner不会出现在

00:29:32.372 --> 00:29:34.074 align:middle
iOS模拟器中 所以一定

00:29:34.141 --> 00:29:35.509 align:middle
要在实体设备上
进行测试

00:29:36.977 --> 00:29:39.413 align:middle
一旦你使用了
Smart App Banner

00:29:40.080 --> 00:29:43.150 align:middle
一旦你的app可以
将链接带入你的网站

00:29:43.617 --> 00:29:46.253 align:middle
你就会有非常棒的
机会来简化

00:29:46.553 --> 00:29:48.322 align:middle
你的网站

00:29:49.289 --> 00:29:52.793 align:middle
它不再需要
成为你的app的

00:29:53.093 --> 00:29:53.927 align:middle
推广工具

00:29:54.928 --> 00:29:58.131 align:middle
这样可以专注于
以最好的方式

00:29:58.532 --> 00:30:00.167 align:middle
呈现你的内容

00:29:58.532 --> 00:30:00.167 align:middle
呈现你的内容

00:30:01.168 --> 00:30:03.637 align:middle
你不再需要参与

00:30:03.704 --> 00:30:06.106 align:middle
显示广告条

00:30:06.273 --> 00:30:07.808 align:middle
或开场屏

00:30:07.875 --> 00:30:08.976 align:middle
或编写代码

00:30:09.042 --> 00:30:10.711 align:middle
来处理自定义URL方案

00:30:11.545 --> 00:30:16.416 align:middle
网站现在使用起来更简单
编写也更容易

00:30:19.052 --> 00:30:20.053 align:middle
好的

00:30:20.120 --> 00:30:21.889 align:middle
我们已经介绍了
如何让用户

00:30:21.955 --> 00:30:24.091 align:middle
进入你的app

00:30:25.058 --> 00:30:25.893 align:middle
一旦如此

00:30:27.227 --> 00:30:29.129 align:middle
许多人
就会登录

00:30:29.196 --> 00:30:31.131 align:middle
你的服务
因为这样会有帮助

00:30:31.732 --> 00:30:34.101 align:middle
如果是这样
他们也许会看到

00:30:34.334 --> 00:30:35.169 align:middle
类似这样的屏幕

00:30:35.903 --> 00:30:36.737 align:middle
登录表

00:30:37.871 --> 00:30:40.507 align:middle
这对用户而言
会很是沮丧

00:30:41.341 --> 00:30:43.343 align:middle
也许他们不记得
凭证

00:30:43.810 --> 00:30:46.046 align:middle
即使已经在Safari多次登录过

00:30:46.113 --> 00:30:47.781 align:middle
你的站点也无济于事

00:30:48.682 --> 00:30:51.818 align:middle
他们不想或者不知道
怎么去查找密码

00:30:52.553 --> 00:30:54.121 align:middle
这时候 用户可能

00:30:54.488 --> 00:30:56.190 align:middle
就会选择
放弃 离开

00:30:56.924 --> 00:30:59.026 align:middle
你的app 也许
甚至会删掉它

00:31:00.561 --> 00:31:02.196 align:middle
但是如果你可以

00:31:02.563 --> 00:31:04.998 align:middle
罗列出一系列凭证

00:31:05.232 --> 00:31:06.266 align:middle
让用户选择会怎样呢？

00:31:07.134 --> 00:31:08.302 align:middle
可能会变成这个样子

00:31:09.336 --> 00:31:10.170 align:middle
和这个样子

00:31:11.238 --> 00:31:13.807 align:middle
用户可以轻松一点
他们之前

00:31:13.874 --> 00:31:16.777 align:middle
保存在Safari中的
密码

00:31:17.678 --> 00:31:20.914 align:middle
具体实现的技术
在iOS 8中有过介绍

00:31:21.315 --> 00:31:23.684 align:middle
叫做Shared
Web Credential

00:31:25.953 --> 00:31:28.555 align:middle
Shared Web
Credential允许你的app

00:31:28.622 --> 00:31:30.924 align:middle
访问Safari
保存的密码

00:31:31.391 --> 00:31:34.528 align:middle
因此可以
让用户后顾无忧

00:31:34.595 --> 00:31:36.430 align:middle
不必在不同的
设备的不同

00:31:36.897 --> 00:31:38.966 align:middle
上下文中
记住自己的密码

00:31:40.701 --> 00:31:41.768 align:middle
怎么做到的呢？

00:31:42.703 --> 00:31:46.473 align:middle
当Safari在iOS
或OS X上

00:31:46.907 --> 00:31:48.742 align:middle
看到有用户登录

00:31:48.809 --> 00:31:50.611 align:middle
或填写账户
创建表单

00:31:50.878 --> 00:31:52.813 align:middle
它可以通过不同
方式帮助用户

00:31:53.180 --> 00:31:56.750 align:middle
具体而言 Safari
可以在钥匙串上

00:31:56.817 --> 00:31:58.385 align:middle
代替用户
保存密码

00:31:59.553 --> 00:32:01.655 align:middle
它可以通过
iCloud Keychain

00:31:59.553 --> 00:32:01.655 align:middle
它可以通过
iCloud Keychain

00:32:01.722 --> 00:32:04.191 align:middle
在用户的所有设备中
同步这些密码

00:32:04.258 --> 00:32:05.626 align:middle
那么 它们可以在用户的

00:32:05.726 --> 00:32:07.961 align:middle
iPhone iPad和Mac上
可供使用

00:32:09.196 --> 00:32:12.933 align:middle
它会建议用户使用
保密性高的密码

00:32:14.368 --> 00:32:15.235 align:middle
当然 在用户

00:32:15.502 --> 00:32:18.539 align:middle
登录的时候
也可以代替用户

00:32:18.839 --> 00:32:20.908 align:middle
自动填写密码

00:32:21.842 --> 00:32:24.411 align:middle
有了Shared Web
Credential API

00:32:24.611 --> 00:32:27.714 align:middle
它可以防止用户
在登录时

00:32:27.781 --> 00:32:28.749 align:middle
卡在app上

00:32:30.884 --> 00:32:32.653 align:middle
使用Shared
Web Credential

00:32:32.719 --> 00:32:33.787 align:middle
分为两步骤

00:32:34.788 --> 00:32:35.622 align:middle
首先

00:32:35.956 --> 00:32:38.492 align:middle
你需要
在app和我们谈及

00:32:38.559 --> 00:32:40.694 align:middle
通用链接的
网站之间

00:32:41.061 --> 00:32:44.031 align:middle
建立密切联系

00:32:44.831 --> 00:32:45.933 align:middle
其次

00:32:45.999 --> 00:32:48.035 align:middle
你需要
在你的app中使用

00:32:48.101 --> 00:32:49.903 align:middle
一个小API 来访问
凭证本身

00:32:51.939 --> 00:32:55.976 align:middle
因为分享网页
认证证书允许

00:32:56.043 --> 00:32:58.512 align:middle
用户分享密码
我们需要确定

00:32:58.579 --> 00:33:01.715 align:middle
你可控制自己的
app和网站

00:32:58.579 --> 00:33:01.715 align:middle
你可控制自己的
app和网站

00:33:03.150 --> 00:33:05.052 align:middle
正如我们允许
允许你的app

00:33:05.252 --> 00:33:07.054 align:middle
可以从网站处理链接一样

00:33:08.522 --> 00:33:10.691 align:middle
你的服务器告知我们

00:33:10.757 --> 00:33:11.792 align:middle
可以信赖你的app

00:33:12.593 --> 00:33:13.861 align:middle
只需要简单添加

00:33:13.927 --> 00:33:16.029 align:middle
Apple-app-site
-association文件

00:33:16.096 --> 00:33:17.331 align:middle
即可 这点乔纳森提到过

00:33:17.898 --> 00:33:18.966 align:middle
具体而言

00:33:19.032 --> 00:33:23.670 align:middle
你只需要通过
你的网站所信赖的服务器

00:33:25.072 --> 00:33:26.306 align:middle
app秘钥

00:33:28.075 --> 00:33:29.810 align:middle
app ID数组
分享凭证

00:33:29.877 --> 00:33:32.346 align:middle
在网络凭证秘钥下

00:33:32.412 --> 00:33:34.615 align:middle
添加顶层字典即可

00:33:37.117 --> 00:33:39.553 align:middle
你的app还要告知我们
要信赖你的网站

00:33:40.153 --> 00:33:41.788 align:middle
这可以通过添加
一个或多个

00:33:42.322 --> 00:33:44.191 align:middle
网络凭证输入
到相关

00:33:44.491 --> 00:33:46.627 align:middle
域名授权
这个我们

00:33:47.160 --> 00:33:48.262 align:middle
刚才谈到过

00:33:48.862 --> 00:33:52.466 align:middle
还可以使用
XCode的项目检测器来实现

00:33:52.666 --> 00:33:54.168 align:middle
就像乔纳森演示的那样

00:33:56.703 --> 00:33:57.538 align:middle
好的

00:33:57.871 --> 00:34:00.674 align:middle
现在 我们来谈谈
在你的app中使用API

00:33:57.871 --> 00:34:00.674 align:middle
现在 我们来谈谈
在你的app中使用API

00:34:02.209 --> 00:34:05.312 align:middle
在你的app中
典型的流程是这个样子

00:34:05.746 --> 00:34:06.580 align:middle
首先

00:34:06.647 --> 00:34:09.583 align:middle
你的app要
检查是否在钥匙串

00:34:09.650 --> 00:34:12.186 align:middle
保存了凭证
如果保存了 则用它来登录

00:34:13.687 --> 00:34:14.855 align:middle
如果没有

00:34:14.922 --> 00:34:17.925 align:middle
它会要求
用Safari保存的

00:34:17.991 --> 00:34:20.694 align:middle
任何密码来进入

00:34:21.428 --> 00:34:23.063 align:middle
如果可用
它就会使用这些

00:34:23.130 --> 00:34:24.931 align:middle
还将在本地保存
然后登录

00:34:25.966 --> 00:34:27.201 align:middle
如果不可用

00:34:27.266 --> 00:34:29.136 align:middle
它会显示内置的登录UI

00:34:29.369 --> 00:34:32.371 align:middle
请求凭证
再按照通常方式来继续

00:34:34.541 --> 00:34:35.943 align:middle
请求Safari的密码的

00:34:36.210 --> 00:34:39.746 align:middle
基本执行
大概是这个样子

00:34:40.480 --> 00:34:42.149 align:middle
主要函数是

00:34:42.216 --> 00:34:44.284 align:middle
SecRequestShared
WebCredential

00:34:45.118 --> 00:34:46.719 align:middle
它会用到
完成处理器

00:34:48.822 --> 00:34:51.658 align:middle
也可以使用域名
和用户名参数

00:34:53.627 --> 00:34:54.761 align:middle
在完成处理器中

00:34:54.962 --> 00:34:56.830 align:middle
我们会检查是否
取回了凭证

00:34:57.698 --> 00:35:00.000 align:middle
如果取回 则用它来登录

00:35:00.834 --> 00:35:01.768 align:middle
否则

00:35:01.835 --> 00:35:03.203 align:middle
我们将
显示登录UI

00:35:04.838 --> 00:35:07.140 align:middle
注意在两种情况下
我们都会分派到主队列

00:35:07.207 --> 00:35:08.709 align:middle
因为这样并不会确保

00:35:09.009 --> 00:35:11.879 align:middle
完成处理器
会在主队列调用

00:35:14.047 --> 00:35:17.417 align:middle
如果你的app允许用户
创建账户

00:35:17.751 --> 00:35:19.152 align:middle
或改变密码

00:35:19.386 --> 00:35:21.955 align:middle
你则的确应该
升级Safari的钥匙串

00:35:22.155 --> 00:35:23.991 align:middle
这样 下次用户
登录你的网站时

00:35:24.057 --> 00:35:26.426 align:middle
比如 是通过
Mac来登录

00:35:26.727 --> 00:35:29.062 align:middle
则会自动填入
正确的密码

00:35:29.363 --> 00:35:30.764 align:middle
可以使用这里显示的

00:35:30.831 --> 00:35:33.834 align:middle
SecAddSharedWeb
Credential函数来实现

00:35:36.937 --> 00:35:38.739 align:middle
Shared Web
Credentials API

00:35:38.805 --> 00:35:40.374 align:middle
也会让你生成安全的密码

00:35:40.440 --> 00:35:43.310 align:middle
所用的算法和Safari
完全一样

00:35:43.944 --> 00:35:45.946 align:middle
通过Sec Create
Shared Web

00:35:46.013 --> 00:35:48.515 align:middle
Credential
Password函数 如这里所示

00:35:49.550 --> 00:35:51.952 align:middle
还有一些额外的
高级API功能

00:35:52.019 --> 00:35:54.254 align:middle
如果大家感兴趣
我建议大家

00:35:54.321 --> 00:35:57.291 align:middle
可以看看去年的讲座《你的App
你的网站和Safari》

00:36:02.329 --> 00:36:04.698 align:middle
我们已经介绍了
一些不错的工具

00:36:05.132 --> 00:36:08.402 align:middle
可以为用户
在你的app和

00:36:08.468 --> 00:36:10.504 align:middle
网站上提供
最佳体验

00:36:11.605 --> 00:36:12.639 align:middle
首先

00:36:12.706 --> 00:36:16.276 align:middle
在iOS 9上
只需你做一点工作

00:36:16.944 --> 00:36:19.179 align:middle
你的网站的普通链接

00:36:19.246 --> 00:36:21.215 align:middle
就会变成通用链接

00:36:22.349 --> 00:36:25.819 align:middle
可以像打开你的网站
一样 轻松打开

00:36:25.886 --> 00:36:26.854 align:middle
你的app

00:36:27.921 --> 00:36:31.425 align:middle
iOS还可以确保
用户可以获得

00:36:31.491 --> 00:36:34.161 align:middle
你的app或网站
可实现的

00:36:34.528 --> 00:36:35.863 align:middle
最佳体验

00:36:36.897 --> 00:36:40.868 align:middle
使用自定义
URL带用户进入

00:36:40.934 --> 00:36:42.870 align:middle
你的app的时代已经过去了

00:36:45.305 --> 00:36:46.139 align:middle
接下来

00:36:46.874 --> 00:36:49.009 align:middle
你可以使用
Smart App Banner

00:36:49.409 --> 00:36:52.279 align:middle
可以让用户首次
来到你的网站时

00:36:52.513 --> 00:36:53.847 align:middle
帮他们找到
你的app

00:36:54.648 --> 00:36:55.782 align:middle
在时候的访问中

00:36:56.116 --> 00:36:58.919 align:middle
它们会重新引导
用户进入你的app

00:36:59.319 --> 00:37:02.089 align:middle
它们始终会
帮助App Search

00:36:59.319 --> 00:37:02.089 align:middle
它们始终会
帮助App Search

00:37:02.489 --> 00:37:04.691 align:middle
索引你的app和内容

00:37:04.758 --> 00:37:06.660 align:middle
这样在用户的Safari和

00:37:06.727 --> 00:37:08.328 align:middle
Spotlight中就都可以使用

00:37:09.997 --> 00:37:10.831 align:middle
最后

00:37:10.898 --> 00:37:12.733 align:middle
通过使用
共享网络凭证

00:37:13.233 --> 00:37:16.870 align:middle
你可以让app访问
Safari保存的密码

00:37:17.171 --> 00:37:20.174 align:middle
帮助用户轻松
登录你的app

00:37:22.509 --> 00:37:24.278 align:middle
若要了解我们今天
介绍的更多详情

00:37:24.444 --> 00:37:25.946 align:middle
可以去看看
我们的文档资料

00:37:26.713 --> 00:37:28.549 align:middle
大家还可以在
开发人员论坛中提问

00:37:28.815 --> 00:37:30.751 align:middle
当然也可以去DTS看看

00:37:32.319 --> 00:37:35.756 align:middle
还可以联系约翰·戴维斯
我们的网络技术开发顾问

00:37:35.956 --> 00:37:38.492 align:middle
或者杰克·伯伦斯
App框架开发顾问

00:37:38.892 --> 00:37:40.961 align:middle
去年和今年 还有
若干相关讲座

00:37:41.028 --> 00:37:43.363 align:middle
其中会深入
介绍我们

00:37:43.430 --> 00:37:44.698 align:middle
所讲的内容

00:37:46.033 --> 00:37:47.734 align:middle
感谢大家 希望大家
喜欢大会的其余部分

WEBVTT

00:00:19.319 --> 00:00:23.790
<c.magenta>通过主动建议增加应用使用</c>

00:00:28.462 --> 00:00:29.563
<c.magenta>大家好</c>

00:00:29.997 --> 00:00:33.901
<c.magenta>感谢大家到场</c>
<c.magenta>与我们共度周五的下午</c>

00:00:34.268 --> 00:00:38.372
<c.magenta>希望你在WWDC度过精彩的一周</c>

00:00:39.406 --> 00:00:42.242
<c.magenta>我现在对这次演讲</c>
<c.magenta>感到十分兴奋</c>

00:00:42.309 --> 00:00:47.247
<c.magenta>因为我们将讨论的东西</c>
<c.magenta>我认为是大家都想要的</c>

00:00:48.248 --> 00:00:50.517
<c.magenta>从根本讲</c>
<c.magenta>大家都在这里</c>

00:00:50.584 --> 00:00:54.221
<c.magenta>是因为你们喜欢</c>
<c.magenta>打造优质的应用</c>

00:00:54.288 --> 00:00:58.492
<c.magenta>而且你可能想有更多的用户</c>
<c.magenta>使用那些优质的应用</c>

00:00:59.126 --> 00:01:04.498
<c.magenta>好消息是</c>
<c.magenta>我们想研究出机会</c>

00:00:59.126 --> 00:01:04.498
<c.magenta>好消息是</c>
<c.magenta>我们想研究出机会</c>

00:01:04.565 --> 00:01:07.835
<c.magenta>让你的应用在恰当的时候</c>
<c.magenta>提供给我们的客户</c>

00:01:07.901 --> 00:01:10.270
<c.magenta>这样你会得到更多的参与</c>

00:01:11.171 --> 00:01:14.875
<c.magenta>我们将在这整场的演讲中讨论</c>

00:01:14.942 --> 00:01:17.978
<c.magenta>你可以那么做的不同方法</c>

00:01:19.279 --> 00:01:23.817
<c.magenta>现今我们在整个操作系统上</c>
<c.magenta>以各种形式推荐应用</c>

00:01:23.884 --> 00:01:25.586
<c.magenta>在许多不同地方</c>

00:01:26.386 --> 00:01:29.623
<c.magenta>我们的客户可以使用</c>
<c.magenta>Siri应用建议</c>

00:01:29.690 --> 00:01:33.727
<c.magenta>当他们从主屏幕向左滑动</c>
<c.magenta>以及调用搜索的时候</c>

00:01:35.128 --> 00:01:36.897
<c.magenta>甚至在输入查询之后</c>

00:01:37.064 --> 00:01:41.401
<c.magenta>你可以在其他</c>
<c.magenta>第三方应用内部得到结果</c>

00:01:43.670 --> 00:01:48.942
<c.magenta>Handoff是我们宣传第三方</c>
<c.magenta>应用和你的应用的另一种方式</c>

00:01:49.009 --> 00:01:53.247
<c.magenta>随着你从一个设备上开始活动</c>
<c.magenta>然后转移到下一个</c>

00:01:53.313 --> 00:01:56.216
<c.magenta>我们试着预测</c>
<c.magenta>你将要做的事情</c>

00:01:56.283 --> 00:01:59.953
<c.magenta>然后在屏幕的左下角</c>
<c.magenta>提供那个应用的图标</c>

00:02:01.822 --> 00:02:05.125
<c.magenta>在某些情况下</c>
<c.magenta>当我们认为你非常想做的</c>

00:02:05.192 --> 00:02:06.894
<c.magenta>是播放一种媒体</c>

00:02:06.960 --> 00:02:10.964
<c.magenta>我们会将你的应用内容</c>
<c.magenta>推荐到设备的锁屏上</c>

00:02:11.198 --> 00:02:15.836
<c.magenta>比如在你插入耳机</c>
<c.magenta>或者Bluetooth配对</c>

00:02:15.903 --> 00:02:18.472
<c.magenta>到你的车或者音响之后</c>

00:02:18.539 --> 00:02:21.875
<c.magenta>如果有一款应用是你</c>
<c.magenta>在那种情况下经常使用的</c>

00:02:21.942 --> 00:02:23.377
<c.magenta>系统会得知</c>

00:02:23.443 --> 00:02:26.413
<c.magenta>而且不仅提供那款应用</c>
<c.magenta>还有应用的内容</c>

00:02:26.480 --> 00:02:30.017
<c.magenta>我们今天将谈谈</c>
<c.magenta>如何能够构建精彩的体验</c>

00:02:30.083 --> 00:02:31.218
<c.magenta>为那种环境</c>

00:02:33.353 --> 00:02:37.391
<c.magenta>在你使用操作系统时</c>
<c.magenta>例如阅读新闻文章</c>

00:02:37.558 --> 00:02:39.326
<c.magenta>你可以创建提醒</c>

00:02:39.426 --> 00:02:42.462
<c.magenta>与你所看的内容</c>
<c.magenta>有前后关联</c>

00:02:42.896 --> 00:02:45.065
<c.magenta>例如 如果你在读一篇文章</c>

00:02:45.132 --> 00:02:49.269
<c.magenta>然后你想再看一眼</c>
<c.magenta>或回家再读</c>

00:02:49.336 --> 00:02:52.906
<c.magenta>因为你正在观看WWDC展示</c>

00:02:53.373 --> 00:02:54.575
<c.magenta>你可以调出Siri</c>

00:02:55.075 --> 00:03:00.914
<c.magenta>当你说“提醒我这件事”时</c>
<c.magenta>Siri会理解你的意思</c>

00:02:55.075 --> 00:03:00.914
<c.magenta>当你说“提醒我这件事”时</c>
<c.magenta>Siri会理解你的意思</c>

00:03:00.981 --> 00:03:04.952
<c.magenta>它会有当前</c>
<c.magenta>在屏幕显示的前后关联</c>

00:03:05.619 --> 00:03:08.655
<c.magenta>这会在任何应用上奏效</c>
<c.magenta>只要采用一些API</c>

00:03:08.755 --> 00:03:10.824
<c.magenta>今天晚些时候我们会讨论</c>

00:03:10.924 --> 00:03:14.061
<c.magenta>大家会对此感到尤为兴奋</c>
<c.magenta>因为这意味着</c>

00:03:14.127 --> 00:03:17.331
<c.magenta>当客户打开</c>
<c.magenta>Reminders应用时</c>

00:03:17.431 --> 00:03:21.235
<c.magenta>他们可以瞬间</c>
<c.magenta>回到你的内容上</c>

00:03:22.769 --> 00:03:27.908
<c.magenta>iOS 10上新出现的是</c>
<c.magenta>整个系统上的地点推荐</c>

00:03:27.975 --> 00:03:30.978
<c.magenta>当我们认为客户有某种意图</c>

00:03:31.411 --> 00:03:34.181
<c.magenta>想去某个地方</c>
<c.magenta>或者使用一个地点时</c>

00:03:34.248 --> 00:03:36.083
<c.magenta>是他们最近看过的</c>

00:03:36.149 --> 00:03:40.988
<c.magenta>我们过会将谈谈</c>
<c.magenta>如何让你应用的数据</c>

00:03:41.154 --> 00:03:42.523
<c.magenta>在整个系统中流动</c>

00:03:44.958 --> 00:03:47.794
<c.magenta>Multitasking</c>
<c.magenta>也是另一种界面</c>

00:03:47.961 --> 00:03:52.399
<c.magenta>我们会将我们认为客户会</c>
<c.magenta>感兴趣的地点推荐给他们</c>

00:03:52.766 --> 00:03:56.803
<c.magenta>你可以将你的应用</c>
<c.magenta>图标推荐在上面</c>

00:03:56.870 --> 00:04:00.474
<c.magenta>在多任务UI</c>
<c.magenta>的醒目位置上</c>

00:03:56.870 --> 00:04:00.474
<c.magenta>在多任务UI</c>
<c.magenta>的醒目位置上</c>

00:04:02.276 --> 00:04:06.046
<c.magenta>同样是iOS 10中的新功能</c>
<c.magenta>就是我们将</c>

00:04:06.146 --> 00:04:13.020
<c.magenta>你应用的联系方式推荐到</c>
<c.magenta>原生联系人应用的内部</c>

00:04:14.621 --> 00:04:19.660
<c.magenta>这里你会注意到在</c>
<c.magenta>WhatsApp中发现了一个句柄</c>

00:04:20.093 --> 00:04:23.697
<c.magenta>我们过会将谈谈</c>
<c.magenta>如果能够让你的应用内容</c>

00:04:23.764 --> 00:04:25.098
<c.magenta>进入那个界面</c>

00:04:27.501 --> 00:04:28.335
<c.magenta>所以...</c>

00:04:29.002 --> 00:04:34.741
<c.magenta>要得知何时推荐</c>
<c.magenta>操作系统需要学习</c>

00:04:34.808 --> 00:04:36.977
<c.magenta>你的数据和应用</c>

00:04:37.711 --> 00:04:43.183
<c.magenta>好消息是</c>
<c.magenta>几个简单的API就会将</c>

00:04:43.250 --> 00:04:46.119
<c.magenta>更大价值提供给你</c>
<c.magenta>比我之前说的要更多</c>

00:04:47.054 --> 00:04:50.224
<c.magenta>除了将你的应用在各种时刻推荐</c>

00:04:50.290 --> 00:04:53.961
<c.magenta>你还会得到更深的Siri整合</c>
<c.magenta>就像我说的</c>

00:04:54.361 --> 00:04:56.597
<c.magenta>前后关联提醒那样</c>

00:04:57.865 --> 00:05:01.368
<c.magenta>所以今天我们要做的是</c>
<c.magenta>谈谈这些API</c>

00:04:57.865 --> 00:05:01.368
<c.magenta>所以今天我们要做的是</c>
<c.magenta>谈谈这些API</c>

00:05:01.602 --> 00:05:05.272
<c.magenta>并且我们会讲解</c>
<c.magenta>如何恰当采用它们</c>

00:05:05.506 --> 00:05:10.143
<c.magenta>这样你们都会得到</c>
<c.magenta>用户更多的参与</c>

00:05:10.544 --> 00:05:12.646
<c.magenta>借助在整个OS上的推荐</c>

00:05:12.946 --> 00:05:17.184
<c.magenta>首先我们将谈谈</c>
<c.magenta>NSUserActivity和schema.org</c>

00:05:17.484 --> 00:05:22.289
<c.magenta>NSUserActivity</c>
<c.magenta>这种API相当于操作系统的眼睛</c>

00:05:22.356 --> 00:05:27.928
<c.magenta>它帮助我们了解客户当前</c>
<c.magenta>在屏幕上所看的内容</c>

00:05:27.995 --> 00:05:31.999
<c.magenta>而schema.org在</c>
<c.magenta>网页上有相同的作用</c>

00:05:33.467 --> 00:05:35.969
<c.magenta>接下来 我们将谈谈</c>
<c.magenta>一些新的改进</c>

00:05:36.036 --> 00:05:39.606
<c.magenta>和新的API</c>
<c.magenta>围绕那些处理地点的应用</c>

00:05:39.773 --> 00:05:42.876
<c.magenta>如果你的应用像Yelp</c>
<c.magenta>那是一个目录</c>

00:05:43.043 --> 00:05:46.747
<c.magenta>提供很多不同地点</c>
<c.magenta>或者相反 如果你的应用像Uber</c>

00:05:46.813 --> 00:05:50.083
<c.magenta>要接收地点</c>
<c.magenta>那这就与你非常相关了</c>

00:05:51.285 --> 00:05:53.720
<c.magenta>之后我们会谈谈</c>
<c.magenta>构建精彩的体验</c>

00:05:53.787 --> 00:05:55.856
<c.magenta>围绕媒体应用建议</c>

00:05:55.923 --> 00:06:00.093
<c.magenta>我之前展示了一个例子</c>
<c.magenta>是一类内容推荐</c>

00:05:55.923 --> 00:06:00.093
<c.magenta>我之前展示了一个例子</c>
<c.magenta>是一类内容推荐</c>

00:06:00.160 --> 00:06:03.697
<c.magenta>在客户插入耳机之后就会发生</c>

00:06:03.797 --> 00:06:06.099
<c.magenta>我们会谈谈如何让你的内容</c>

00:06:06.166 --> 00:06:08.068
<c.magenta>在界面最突出位置显示</c>

00:06:08.602 --> 00:06:12.372
<c.magenta>之后我们会概述</c>
<c.magenta>今天会学到的所有内容</c>

00:06:14.241 --> 00:06:17.778
<c.magenta>先从NSUserActivity</c>
<c.magenta>和schema.org开始</c>

00:06:17.845 --> 00:06:21.014
<c.magenta>我想邀请Sofiane上台</c>
<c.magenta>Sofiane？</c>

00:06:27.120 --> 00:06:29.756
<c.magenta>谢了 Daniel</c>
<c.magenta>大家下午好</c>

00:06:29.923 --> 00:06:33.227
<c.magenta>我叫Sofiane 今天我非常</c>
<c.magenta>激动地在这里跟大家谈谈</c>

00:06:33.293 --> 00:06:35.963
<c.magenta>我们最近在研究的一些功能</c>

00:06:36.964 --> 00:06:39.933
<c.magenta>我们刚听过Daniel说过的</c>
<c.magenta>在整个系统中</c>

00:06:40.000 --> 00:06:42.669
<c.magenta>推荐应用内容的</c>
<c.magenta>好方法</c>

00:06:43.103 --> 00:06:47.374
<c.magenta>现在我们来谈谈一些API</c>
<c.magenta>你能采用它们来实现这一目的</c>

00:06:47.975 --> 00:06:50.244
<c.magenta>在整个展示中</c>
<c.magenta>我们会谈谈功能</c>

00:06:50.644 --> 00:06:53.247
<c.magenta>一些你可能已经熟悉了</c>
<c.magenta>像是Handoff</c>

00:06:53.313 --> 00:06:57.384
<c.magenta>或者Spotlight搜索还有</c>
<c.magenta>一些在iOS 10中推出的新功能</c>

00:06:57.518 --> 00:06:59.520
<c.magenta>例如 地点建议</c>

00:07:00.187 --> 00:07:02.322
<c.magenta>你在这里看到的所有功能</c>

00:07:02.389 --> 00:07:03.524
<c.magenta>都有共同点</c>

00:07:03.957 --> 00:07:07.027
<c.magenta>那就是单个API</c>
<c.magenta>叫做NSUserActivity</c>

00:07:07.995 --> 00:07:08.996
<c.magenta>首先 一些背景知识</c>

00:07:09.897 --> 00:07:13.534
<c.magenta>NSUserActivity是iOS 8中推出的</c>
<c.magenta>支持Handoff</c>

00:07:13.934 --> 00:07:16.470
<c.magenta>这是非常神奇的功能</c>
<c.magenta>允许你在一个设备上</c>

00:07:16.570 --> 00:07:20.107
<c.magenta>开始一项活动 然后转到</c>
<c.magenta>另一个设备上继续你之前的活动</c>

00:07:21.375 --> 00:07:26.380
<c.magenta>去年在iOS 9中 我们支持</c>
<c.magenta>将内容直接从</c>

00:07:26.446 --> 00:07:29.650
<c.magenta>NSUserActivity推荐到</c>
<c.magenta>Spotlight搜索结果里</c>

00:07:30.784 --> 00:07:34.588
<c.magenta>在iOS 10中我们进一步增强了</c>
<c.magenta>NSUserActivities</c>

00:07:34.655 --> 00:07:38.125
<c.magenta>它可以捕捉在你应用</c>
<c.magenta>内部查看过的地点</c>

00:07:38.192 --> 00:07:40.827
<c.magenta>并在整个系统中的</c>
<c.magenta>多个位置推荐它们</c>

00:07:40.928 --> 00:07:42.429
<c.magenta>甚至在其他应用中</c>

00:07:43.764 --> 00:07:46.934
<c.magenta>现在NSUserActivity</c>
<c.magenta>还将前后关联信息提供给Siri</c>

00:07:47.034 --> 00:07:50.604
<c.magenta>这样Siri能帮助你获取方向</c>
<c.magenta>或者呼叫</c>

00:07:50.671 --> 00:07:52.606
<c.magenta>你在应用中查看的地点</c>

00:07:53.774 --> 00:07:54.942
<c.magenta>同样新出现于iOS 10</c>

00:07:55.542 --> 00:07:58.579
<c.magenta>NSUserActivity</c>
<c.magenta>允许你的通信应用</c>

00:07:58.645 --> 00:08:00.948
<c.magenta>直接从联系人卡片中推荐</c>

00:07:58.645 --> 00:08:00.948
<c.magenta>直接从联系人卡片中推荐</c>

00:08:01.048 --> 00:08:02.850
<c.magenta>作为替代通信方式</c>

00:08:04.117 --> 00:08:07.654
<c.magenta>我知道大家在想什么</c>
<c.magenta>“这太酷了” 但愿吧</c>

00:08:08.455 --> 00:08:10.390
<c.magenta>“但工作原理是什么？”</c>

00:08:10.824 --> 00:08:12.793
<c.magenta>我来告诉大家</c>
<c.magenta>这是非常简单明了的</c>

00:08:12.860 --> 00:08:16.263
<c.magenta>我们有很多精彩内容要说</c>
<c.magenta>所以直入主题吧</c>

00:08:17.197 --> 00:08:20.300
<c.magenta>我们将谈谈</c>
<c.magenta>NSUserActivity和schema.org</c>

00:08:20.701 --> 00:08:24.571
<c.magenta>这些API允许你</c>
<c.magenta>无缝地与系统整合</c>

00:08:24.738 --> 00:08:28.642
<c.magenta>NSUserActivity用于原生应用</c>
<c.magenta>而schema.org是用于网页的</c>

00:08:29.243 --> 00:08:30.777
<c.magenta>我们首先专注于</c>
<c.magenta>NSUserActivity</c>

00:08:32.111 --> 00:08:36.750
<c.magenta>NSUserActivity是</c>
<c.magenta>轻量级界面 能捕获应用程序的状态</c>

00:08:36.850 --> 00:08:41.288
<c.magenta>在用户浏览你应用的过程中</c>
<c.magenta>这还可以在之后还原</c>

00:08:41.755 --> 00:08:43.924
<c.magenta>所以例如 这里</c>
<c.magenta>我们有Yelp应用</c>

00:08:44.358 --> 00:08:47.995
<c.magenta>这是一款本地搜索应用</c>
<c.magenta>随着用户浏览应用</c>

00:08:48.262 --> 00:08:51.532
<c.magenta>创建NSUserActivity</c>
<c.magenta>捕获我们需要的信息</c>

00:08:51.598 --> 00:08:53.333
<c.magenta>之后重现这个状态</c>

00:08:54.001 --> 00:08:56.703
<c.magenta>例如 当我触发餐厅搜索时</c>

00:08:56.770 --> 00:08:59.406
<c.magenta>我们遵循创建活动的相同模式</c>

00:08:59.740 --> 00:09:03.477
<c.magenta>当我从那个列表中查看结果时</c>

00:08:59.740 --> 00:09:03.477
<c.magenta>当我从那个列表中查看结果时</c>

00:09:04.144 --> 00:09:07.447
<c.magenta>在这个特定案例中</c>
<c.magenta>我们在查看一个地点</c>

00:09:08.048 --> 00:09:11.385
<c.magenta>在iOS 10中</c>
<c.magenta>NSUserActivity现在</c>

00:09:11.451 --> 00:09:16.023
<c.magenta>更加了解特定概念 例如</c>
<c.magenta>地点或者通信互动</c>

00:09:16.490 --> 00:09:18.692
<c.magenta>我们很快就会讲的</c>
<c.magenta>不过之前我想</c>

00:09:18.759 --> 00:09:20.460
<c.magenta>仔细看看这个屏幕</c>

00:09:21.695 --> 00:09:24.798
<c.magenta>这里我们创建了活动</c>
<c.magenta>并用信息来描述它</c>

00:09:24.865 --> 00:09:28.068
<c.magenta>来之后重现这个状态</c>
<c.magenta>以及已提交的数据</c>

00:09:28.402 --> 00:09:31.138
<c.magenta>例如 地点名称或者地址</c>

00:09:31.572 --> 00:09:34.007
<c.magenta>之后我们通知系统</c>
<c.magenta>这代表了</c>

00:09:34.074 --> 00:09:38.946
<c.magenta>当前用户状态 我们决定</c>
<c.magenta>它是否会宣传用于Handoff</c>

00:09:39.813 --> 00:09:43.350
<c.magenta>在整个系统中</c>
<c.magenta>临时可用于地点建议</c>

00:09:43.851 --> 00:09:45.953
<c.magenta>或添加到设备索引...</c>

00:09:46.486 --> 00:09:50.357
<c.magenta>或添加到设备索引上的Spotlight</c>
<c.magenta>这样它会出现在</c>

00:09:50.424 --> 00:09:51.658
<c.magenta>Spotlight搜索结果中</c>

00:09:52.860 --> 00:09:54.962
<c.magenta>这里有一些相关会议</c>
<c.magenta>关于这个话题的</c>

00:09:55.062 --> 00:09:57.764
<c.magenta>尤其是采用</c>
<c.magenta>NSUserActivities</c>

00:09:57.831 --> 00:09:59.166
<c.magenta>用于Handoff和应用搜索</c>

00:09:59.633 --> 00:10:02.669
<c.magenta>我推荐大家去看一下</c>
<c.magenta>那里的内容十分精彩</c>

00:09:59.633 --> 00:10:02.669
<c.magenta>我推荐大家去看一下</c>
<c.magenta>那里的内容十分精彩</c>

00:10:04.104 --> 00:10:05.939
<c.magenta>现在我们深入到代码 好吧？</c>

00:10:06.473 --> 00:10:09.142
<c.magenta>我将给你展示如何</c>
<c.magenta>创建这些活动</c>

00:10:09.743 --> 00:10:12.513
<c.magenta>我们在此简化</c>
<c.magenta>NSUserActivity的实例</c>

00:10:12.846 --> 00:10:14.548
<c.magenta>并提供一个活动类型</c>

00:10:14.748 --> 00:10:16.583
<c.magenta>那是你提供的字符串</c>

00:10:16.650 --> 00:10:19.786
<c.magenta>这和你在info.plist中</c>
<c.magenta>指定的字符串相同</c>

00:10:20.687 --> 00:10:23.357
<c.magenta>我们推荐使用</c>
<c.magenta>反向DNS样式符号</c>

00:10:23.423 --> 00:10:24.825
<c.magenta>保持字符串的特殊性</c>

00:10:26.059 --> 00:10:28.962
<c.magenta>接下来 我们的活动需要标题</c>
<c.magenta>而且我们使用的标题</c>

00:10:29.029 --> 00:10:31.932
<c.magenta>会描述我们在这里看的内容</c>

00:10:32.032 --> 00:10:33.567
<c.magenta>这里我们看到了餐厅</c>

00:10:33.634 --> 00:10:35.402
<c.magenta>要记住的事情是</c>

00:10:35.536 --> 00:10:37.938
<c.magenta>这是你的用户活动的公众形象</c>

00:10:38.005 --> 00:10:39.106
<c.magenta>例如 这就是</c>

00:10:39.173 --> 00:10:41.441
<c.magenta>其在Spotlight搜索</c>
<c.magenta>结果中的样子</c>

00:10:41.542 --> 00:10:45.045
<c.magenta>你要确保你使用的标题</c>
<c.magenta>有说明性并且有含义</c>

00:10:46.046 --> 00:10:49.383
<c.magenta>下面 我们启用Handoff</c>
<c.magenta>应用搜索以及公共索引</c>

00:10:49.650 --> 00:10:51.685
<c.magenta>因为我们查看的内容是公开的</c>

00:10:52.719 --> 00:10:56.790
<c.magenta>之后我们在userInfo</c>
<c.magenta>属性上设置一个字典</c>

00:10:56.857 --> 00:10:59.826
<c.magenta>捕获我们需要</c>
<c.magenta>用来重现状态的信息</c>

00:11:00.027 --> 00:11:01.528
<c.magenta>当活动还原时</c>

00:11:01.862 --> 00:11:05.999
<c.magenta>那种情况下 我们使用</c>
<c.magenta>刚才所查看的地点的唯一ID</c>

00:11:06.400 --> 00:11:09.002
<c.magenta>通常</c>
<c.magenta>当活动被还原时</c>

00:11:09.069 --> 00:11:11.505
<c.magenta>例如 当传递给了另一个设备</c>

00:11:11.672 --> 00:11:16.109
<c.magenta>你可以从服务器取回那个ID</c>
<c.magenta>然后还原那个地点</c>

00:11:16.243 --> 00:11:17.411
<c.magenta>如用户期待那样</c>

00:11:19.179 --> 00:11:22.683
<c.magenta>为了全面地描述你的活动</c>
<c.magenta>并得出更丰富的搜索结果</c>

00:11:22.850 --> 00:11:24.051
<c.magenta>你可以使用这个类</c>

00:11:24.117 --> 00:11:27.754
<c.magenta>我们在iOS 9中推出</c>
<c.magenta>叫做CSSearchableItemAttributeSet</c>

00:11:28.989 --> 00:11:33.093
<c.magenta>它在你的应用和系统之间</c>
<c.magenta>提供了共同语言</c>

00:11:33.160 --> 00:11:34.761
<c.magenta>来更好地描述你的内容</c>

00:11:36.029 --> 00:11:39.166
<c.magenta>如果你的网站映射的内容</c>

00:11:39.333 --> 00:11:41.301
<c.magenta>是你在应用内查看的</c>

00:11:41.401 --> 00:11:45.873
<c.magenta>可以提供网页URL</c>
<c.magenta>这样当你的活动</c>

00:11:45.939 --> 00:11:49.376
<c.magenta>例如被传递给一个</c>
<c.magenta>未安装有你应用的设备上</c>

00:11:49.576 --> 00:11:53.947
<c.magenta>这会顺着那个链接</c>
<c.magenta>在Safari中恰当启动</c>

00:11:54.748 --> 00:11:57.851
<c.magenta>最后我们在活动上</c>
<c.magenta>调用becomeCurrent</c>

00:11:58.018 --> 00:11:59.019
<c.magenta>告诉系统</c>

00:11:59.086 --> 00:12:01.221
<c.magenta>这代表了当前用户状态</c>

00:11:59.086 --> 00:12:01.221
<c.magenta>这代表了当前用户状态</c>

00:12:01.321 --> 00:12:03.590
<c.magenta>这是用户在屏幕上看到的东西</c>

00:12:04.892 --> 00:12:07.361
<c.magenta>当你的应用</c>
<c.magenta>启动后会发生什么？</c>

00:12:07.427 --> 00:12:09.696
<c.magenta>例如 当你的活动被还原了</c>

00:12:09.796 --> 00:12:12.266
<c.magenta>或者传递给另一个设备</c>

00:12:13.433 --> 00:12:15.836
<c.magenta>你的应用程序启动了</c>
<c.magenta>这很好</c>

00:12:16.203 --> 00:12:18.739
<c.magenta>然后调用</c>
<c.magenta>UIApplication委托方法</c>

00:12:18.939 --> 00:12:21.708
<c.magenta>叫做continueUserActivity</c>
<c.magenta>restorationHandler</c>

00:12:22.576 --> 00:12:25.078
<c.magenta>我们首先要做的是</c>
<c.magenta>检查活动类型</c>

00:12:25.279 --> 00:12:27.681
<c.magenta>然后确保它匹配</c>
<c.magenta>我们所预料的那个</c>

00:12:27.881 --> 00:12:30.751
<c.magenta>那个案例与我们</c>
<c.magenta>之前使用的那个匹配</c>

00:12:31.051 --> 00:12:32.653
<c.magenta>之后我们可以使用</c>
<c.magenta>用户输入字典</c>

00:12:32.719 --> 00:12:34.188
<c.magenta>来开始还原状态</c>

00:12:34.454 --> 00:12:38.125
<c.magenta>之前 我们放入了</c>
<c.magenta>那个地点的唯一ID</c>

00:12:38.258 --> 00:12:41.562
<c.magenta>通常在这里我们</c>
<c.magenta>能将其从服务器取回来</c>

00:12:41.662 --> 00:12:44.464
<c.magenta>然后还原它</c>
<c.magenta>并显示正确的控制器</c>

00:12:44.531 --> 00:12:45.933
<c.magenta>如用户所期待那样</c>

00:12:47.167 --> 00:12:48.769
<c.magenta>所以使用最少的代码</c>

00:12:49.002 --> 00:12:51.205
<c.magenta>我们能够从三大功能中获益</c>

00:12:51.271 --> 00:12:54.541
<c.magenta>Handoff Spotlight</c>
<c.magenta>搜索及前后关联Siri提醒</c>

00:12:55.943 --> 00:12:58.378
<c.magenta>现在我们谈谈下面</c>
<c.magenta>列出的其他功能</c>

00:12:59.112 --> 00:13:00.514
<c.magenta>不过我先问大家一下</c>

00:12:59.112 --> 00:13:00.514
<c.magenta>不过我先问大家一下</c>

00:13:00.881 --> 00:13:03.450
<c.magenta>你是否遇到这样情况</c>
<c.magenta>你肚子饿了</c>

00:13:03.517 --> 00:13:05.986
<c.magenta>想找到好的餐厅就餐？</c>

00:13:06.386 --> 00:13:08.956
<c.magenta>所以你从Yelp开始</c>
<c.magenta>然后找到完美的地点</c>

00:13:09.489 --> 00:13:11.825
<c.magenta>之后你要跟朋友发消息</c>
<c.magenta>让他们在那里见你</c>

00:13:12.059 --> 00:13:15.796
<c.magenta>所以你切换到消息 开始输入</c>
<c.magenta>“伙计们 我找到地儿了”</c>

00:13:15.863 --> 00:13:18.398
<c.magenta>不过你发现</c>
<c.magenta>你没有那个地方的地址</c>

00:13:18.465 --> 00:13:19.867
<c.magenta>所以你切换到Yelp</c>

00:13:20.100 --> 00:13:22.569
<c.magenta>你复制地址</c>
<c.magenta>之后切换回消息</c>

00:13:22.636 --> 00:13:25.472
<c.magenta>粘贴进入</c>
<c.magenta>之后你终于完成了</c>

00:13:26.139 --> 00:13:29.376
<c.magenta>然而并不是 因为你还</c>
<c.magenta>需要在某个时刻到达那里</c>

00:13:29.443 --> 00:13:31.078
<c.magenta>你切换出地图</c>

00:13:31.345 --> 00:13:33.213
<c.magenta>这可能来来回回很多次</c>

00:13:33.280 --> 00:13:35.716
<c.magenta>你懂我的意思</c>
<c.magenta>非常不好的体验</c>

00:13:38.886 --> 00:13:42.289
<c.magenta>所以在iOS 10 我们尝试</c>
<c.magenta>将这个体验变得更加容易</c>

00:13:43.223 --> 00:13:44.658
<c.magenta>你的起点还是一样</c>

00:13:44.725 --> 00:13:47.895
<c.magenta>你在应用中查看一个地点</c>
<c.magenta>比如说一家餐厅</c>

00:13:48.395 --> 00:13:50.430
<c.magenta>通过采用</c>
<c.magenta>NSUserActivity</c>

00:13:50.764 --> 00:13:52.999
<c.magenta>你的应用可以将那个相同地点</c>

00:13:53.066 --> 00:13:55.469
<c.magenta>推荐到整个系统上的</c>
<c.magenta>许多不同位置</c>

00:13:56.003 --> 00:14:00.507
<c.magenta>当你从应用中切换走</c>
<c.magenta>多任务UI会使其非常简单</c>

00:13:56.003 --> 00:14:00.507
<c.magenta>当你从应用中切换走</c>
<c.magenta>多任务UI会使其非常简单</c>

00:14:00.574 --> 00:14:03.510
<c.magenta>并在底部提供</c>
<c.magenta>这个精致的主动建议</c>

00:14:03.777 --> 00:14:06.947
<c.magenta>使用你最喜爱的</c>
<c.magenta>路径规划应用来提供方向</c>

00:14:07.214 --> 00:14:08.982
<c.magenta>到你刚才查看的地点</c>

00:14:09.683 --> 00:14:11.952
<c.magenta>如果你进入Messages</c>
<c.magenta>不需要来回操作</c>

00:14:12.252 --> 00:14:15.055
<c.magenta>你可以开始写</c>
<c.magenta>像是“见面地点是...”</c>

00:14:15.322 --> 00:14:18.792
<c.magenta>然后QuickType UI</c>
<c.magenta>会自动将那个位置</c>

00:14:18.859 --> 00:14:22.095
<c.magenta>直接推荐到QuickType</c>
<c.magenta>来自你刚才提供的内容</c>

00:14:23.297 --> 00:14:24.364
<c.magenta>在Maps上亦然</c>

00:14:24.464 --> 00:14:27.901
<c.magenta>Maps在Maps应用中</c>
<c.magenta>直接推荐这些地点</c>

00:14:28.101 --> 00:14:29.069
<c.magenta>不仅是在Maps应用中</c>

00:14:29.136 --> 00:14:31.505
<c.magenta>还在新的Today View</c>
<c.magenta>地图小部件中</c>

00:14:31.672 --> 00:14:34.508
<c.magenta>以及CarPlay中</c>
<c.magenta>这是我最喜欢的功能</c>

00:14:34.575 --> 00:14:35.409
<c.magenta>想象一下</c>

00:14:35.475 --> 00:14:38.312
<c.magenta>查看应用 进入车中</c>
<c.magenta>点击屏幕</c>

00:14:38.512 --> 00:14:40.581
<c.magenta>就好了 完成了</c>
<c.magenta>你可以出发了</c>

00:14:42.449 --> 00:14:45.252
<c.magenta>这些地点甚至可以</c>
<c.magenta>推荐到其他应用中</c>

00:14:45.319 --> 00:14:49.790
<c.magenta>所以我们在这里看的是</c>
<c.magenta>由Yelp提供的一个地点</c>

00:14:49.857 --> 00:14:53.126
<c.magenta>通过NSUserActivity</c>
<c.magenta>显示在Uber应用内部</c>

00:14:53.360 --> 00:14:56.196
<c.magenta>随着用户点入目的地文本域</c>

00:14:58.432 --> 00:15:02.536
<c.magenta>这还给Siri提供前后关联</c>
<c.magenta>所以你可以查看你的应用</c>

00:14:58.432 --> 00:15:02.536
<c.magenta>这还给Siri提供前后关联</c>
<c.magenta>所以你可以查看你的应用</c>

00:15:02.603 --> 00:15:05.672
<c.magenta>然后询问Siri来获取方向</c>
<c.magenta>或者给</c>

00:15:05.739 --> 00:15:07.307
<c.magenta>你查看的地点打电话</c>

00:15:08.141 --> 00:15:12.713
<c.magenta>采用NSUserActivity</c>
<c.magenta>会得到所有这些功能</c>

00:15:13.680 --> 00:15:16.183
<c.magenta>而且所有这些功能都有共同点</c>

00:15:16.950 --> 00:15:18.218
<c.magenta>就是它们都表示</c>

00:15:18.352 --> 00:15:21.121
<c.magenta>建议最初是源自哪里</c>

00:15:21.421 --> 00:15:22.623
<c.magenta>这个案例中是Yelp</c>

00:15:23.590 --> 00:15:26.627
<c.magenta>想象一下如果这是你的应用</c>
<c.magenta>那不就太好了吗？</c>

00:15:27.528 --> 00:15:28.896
<c.magenta>现在这是可能的</c>

00:15:29.329 --> 00:15:33.600
<c.magenta>NSUserActivity允许你</c>
<c.magenta>这样做 通过捕获在你的</c>

00:15:33.667 --> 00:15:35.335
<c.magenta>应用中查看过的地点</c>

00:15:35.569 --> 00:15:37.838
<c.magenta>我们推出新的简单API</c>

00:15:38.539 --> 00:15:41.208
<c.magenta>在MapKit和CoreSpotlight上</c>
<c.magenta>允许你那样做</c>

00:15:41.441 --> 00:15:44.311
<c.magenta>并整合到我刚谈过的所有位置</c>

00:15:45.112 --> 00:15:48.348
<c.magenta>在代码方面 我们将创建</c>
<c.magenta>一个NSUserActivity</c>

00:15:48.415 --> 00:15:50.350
<c.magenta>并且重新使用相同的</c>

00:15:50.417 --> 00:15:53.120
<c.magenta>我们之前定义的活动</c>
<c.magenta>直接添加在上面</c>

00:15:53.187 --> 00:15:55.355
<c.magenta>我们不需要创建</c>
<c.magenta>单独活动</c>

00:15:55.856 --> 00:15:58.825
<c.magenta>对于使用MapKit的应用</c>
<c.magenta>其简单程度</c>

00:15:58.892 --> 00:16:02.829
<c.magenta>相当于将MKMapItem设置到</c>
<c.magenta>这个新的MapItem属性</c>

00:15:58.892 --> 00:16:02.829
<c.magenta>相当于将MKMapItem设置到</c>
<c.magenta>这个新的MapItem属性</c>

00:16:02.896 --> 00:16:04.264
<c.magenta>定义为NSUserActivity</c>

00:16:05.199 --> 00:16:06.400
<c.magenta>这基本上就行了</c>

00:16:08.268 --> 00:16:11.071
<c.magenta>这还有很好的附加作用</c>

00:16:11.171 --> 00:16:16.243
<c.magenta>自动填充内容属性集</c>
<c.magenta>所以你不用...</c>

00:16:16.310 --> 00:16:18.779
<c.magenta>所以如果你想采用应用搜索</c>

00:16:18.979 --> 00:16:22.182
<c.magenta>你要做的就是指定</c>
<c.magenta>你想选择性加入应用搜索</c>

00:16:22.249 --> 00:16:24.284
<c.magenta>然后这些网站也会编入索引</c>

00:16:25.485 --> 00:16:28.789
<c.magenta>这里还有另一种方式</c>
<c.magenta>那就是通过采用应用搜索</c>

00:16:29.189 --> 00:16:31.391
<c.magenta>对于那些已经熟悉它的人</c>

00:16:31.458 --> 00:16:35.362
<c.magenta>你能使用CSSearchableItemAttributeSet</c>
<c.magenta>并描述地点</c>

00:16:35.929 --> 00:16:37.631
<c.magenta>我们将它分解一下</c>

00:16:37.798 --> 00:16:40.467
<c.magenta>我们首先做的是</c>
<c.magenta>设置地点的名称</c>

00:16:40.734 --> 00:16:42.536
<c.magenta>这与我们查看的相匹配</c>

00:16:42.769 --> 00:16:45.739
<c.magenta>这是我们之前讲的</c>
<c.magenta>全部UI所需要的</c>

00:16:46.840 --> 00:16:49.710
<c.magenta>接下来 我们指定</c>
<c.magenta>地址的文本表示</c>

00:16:49.843 --> 00:16:52.145
<c.magenta>这是全部基于文本UI所需要的</c>

00:16:52.212 --> 00:16:53.881
<c.magenta>例如像是键盘</c>

00:16:55.382 --> 00:16:57.651
<c.magenta>接下来 我们指定</c>
<c.magenta>维度和经度</c>

00:16:57.751 --> 00:17:02.155
<c.magenta>这是可选的 但这会保证</c>
<c.magenta>将你的用户精确地指引到</c>

00:16:57.751 --> 00:17:02.155
<c.magenta>这是可选的 但这会保证</c>
<c.magenta>将你的用户精确地指引到</c>

00:17:02.322 --> 00:17:04.391
<c.magenta>你想将他们指引到的位置</c>

00:17:04.525 --> 00:17:06.627
<c.magenta>经度和纬度</c>
<c.magenta>是最精确的表示</c>

00:17:06.693 --> 00:17:08.962
<c.magenta>供你使用</c>
<c.magenta>如果你有这个信息的话</c>

00:17:10.230 --> 00:17:14.334
<c.magenta>接下来 我们设置电话号码</c>
<c.magenta>这允许我们访问Siri</c>

00:17:14.501 --> 00:17:16.936
<c.magenta>这样我们可以说</c>
<c.magenta>比如“呼叫这个地方”</c>

00:17:17.671 --> 00:17:19.473
<c.magenta>最后 我们表明</c>

00:17:19.540 --> 00:17:22.809
<c.magenta>这个内容支持</c>
<c.magenta>导航和电话呼叫</c>

00:17:23.109 --> 00:17:26.480
<c.magenta>这样结果将会</c>
<c.magenta>呈现在Spotlight UI中</c>

00:17:27.013 --> 00:17:29.416
<c.magenta>在Spotlight搜索结果UI中</c>

00:17:29.550 --> 00:17:33.120
<c.magenta>有一个快速行动图标</c>
<c.magenta>进行电话呼叫</c>

00:17:33.187 --> 00:17:35.088
<c.magenta>或者例如获取方向</c>

00:17:35.956 --> 00:17:38.458
<c.magenta>这就是如何得到地点建议的</c>
<c.magenta>就是这么简单</c>

00:17:38.525 --> 00:17:42.029
<c.magenta>你的应用将会推荐到</c>
<c.magenta>所有这些不同地方</c>

00:17:42.596 --> 00:17:46.066
<c.magenta>我们认为这会提供</c>
<c.magenta>更加饱满的体验</c>

00:17:46.133 --> 00:17:48.435
<c.magenta>在你应用的内外都是如此</c>

00:17:49.136 --> 00:17:52.372
<c.magenta>你的品牌可以进一步</c>
<c.magenta>在整个系统中推荐</c>

00:17:52.539 --> 00:17:54.741
<c.magenta>不仅限于你的应用之内</c>

00:17:56.343 --> 00:17:58.178
<c.magenta>我们来谈谈联系人交互</c>

00:17:59.613 --> 00:18:03.684
<c.magenta>IOS 10 DP</c>
<c.magenta>从联系人卡片</c>

00:17:59.613 --> 00:18:03.684
<c.magenta>IOS 10 DP</c>
<c.magenta>从联系人卡片</c>

00:18:03.750 --> 00:18:04.718
<c.magenta>直接整合通信应用</c>

00:18:05.219 --> 00:18:07.788
<c.magenta>你在这里看到的是</c>
<c.magenta>一个联系人卡片</c>

00:18:07.855 --> 00:18:10.657
<c.magenta>这里获知了WhatsApp</c>
<c.magenta>的句柄并显示出来</c>

00:18:10.891 --> 00:18:14.428
<c.magenta>当我去点击顶部的</c>
<c.magenta>快速行动按钮</c>

00:18:14.528 --> 00:18:18.498
<c.magenta>来发送消息 我要选择</c>
<c.magenta>我想使用的联系方式</c>

00:18:19.199 --> 00:18:23.537
<c.magenta>如果我这么做了 这个选择</c>
<c.magenta>会被记住并持久保留</c>

00:18:23.637 --> 00:18:25.405
<c.magenta>为默认的通信方式</c>

00:18:25.772 --> 00:18:29.610
<c.magenta>这样你的应用会在推荐到那里</c>
<c.magenta>作为默认的通道</c>

00:18:29.710 --> 00:18:31.712
<c.magenta>给那特定的联系人发消息</c>

00:18:33.013 --> 00:18:37.117
<c.magenta>这也由NSUserActivity</c>
<c.magenta>所支持 还有新的密集框架</c>

00:18:37.284 --> 00:18:40.654
<c.magenta>这与为得到深层Siri整合</c>
<c.magenta>所使用的框架相同</c>

00:18:41.288 --> 00:18:43.790
<c.magenta>本周前几天有两场</c>
<c.magenta>关于这个话题的精彩演讲</c>

00:18:43.924 --> 00:18:45.859
<c.magenta>我非常推荐大家去看看</c>

00:18:47.761 --> 00:18:50.030
<c.magenta>这里显示的是</c>
<c.magenta>WhatsApp应用</c>

00:18:50.197 --> 00:18:53.534
<c.magenta>在发送文本消息</c>
<c.magenta>我们将探讨它的工作原理</c>

00:18:54.401 --> 00:18:56.970
<c.magenta>首先我们创建</c>
<c.magenta>INInteraction对象</c>

00:18:57.037 --> 00:19:00.440
<c.magenta>这是我们在密集API中</c>
<c.magenta>定义的新对象</c>

00:18:57.037 --> 00:19:00.440
<c.magenta>这是我们在密集API中</c>
<c.magenta>定义的新对象</c>

00:19:01.909 --> 00:19:04.077
<c.magenta>这包含了关于意图的信息</c>

00:19:04.545 --> 00:19:08.315
<c.magenta>例如 这代表用户行动</c>

00:19:08.382 --> 00:19:11.451
<c.magenta>比如发送文本消息</c>
<c.magenta>或者进行视频通话</c>

00:19:12.286 --> 00:19:15.355
<c.magenta>以及其他一些关于</c>
<c.magenta>接收方和发送方的信息</c>

00:19:15.422 --> 00:19:17.324
<c.magenta>还有创建内容的元数据</c>

00:19:17.391 --> 00:19:20.160
<c.magenta>例如像是通信是否成功</c>

00:19:21.061 --> 00:19:24.898
<c.magenta>接下来 你在交互上</c>
<c.magenta>调用Donate Method</c>

00:19:25.132 --> 00:19:27.501
<c.magenta>这样系统会得知这次交互</c>

00:19:27.568 --> 00:19:30.804
<c.magenta>并将你的应用直接</c>
<c.magenta>在联系人卡片内部推荐</c>

00:19:31.939 --> 00:19:36.176
<c.magenta>当用户通过联系人卡片</c>
<c.magenta>与你的应用进行交互</c>

00:19:36.343 --> 00:19:37.477
<c.magenta>我们也遵循相同的模式</c>

00:19:37.544 --> 00:19:40.848
<c.magenta>创建INInteraction</c>
<c.magenta>表示用户尝试做的事情</c>

00:19:41.081 --> 00:19:45.385
<c.magenta>包在NSUserActivity内</c>
<c.magenta>之后你的应用会用它来启动</c>

00:19:46.253 --> 00:19:48.322
<c.magenta>我们看看这是如何</c>
<c.magenta>转换到代码中的</c>

00:19:48.889 --> 00:19:51.992
<c.magenta>首先在这里</c>
<c.magenta>我们创建发送方和接收方</c>

00:19:52.226 --> 00:19:54.828
<c.magenta>要注意的是</c>
<c.magenta>如果你的应用可以访问</c>

00:19:54.895 --> 00:19:56.530
<c.magenta>用户的通讯簿</c>

00:19:56.964 --> 00:20:01.869
<c.magenta>你可以指定你在这里</c>
<c.magenta>使用的联系人标识符</c>

00:19:56.964 --> 00:20:01.869
<c.magenta>你可以指定你在这里</c>
<c.magenta>使用的联系人标识符</c>

00:20:02.102 --> 00:20:04.972
<c.magenta>这样系统能够更好地找出</c>

00:20:05.172 --> 00:20:06.874
<c.magenta>需要扩增的正确联系人</c>

00:20:08.542 --> 00:20:09.743
<c.magenta>接下来 我们创建意图</c>

00:20:10.143 --> 00:20:11.879
<c.magenta>这里我们使用</c>
<c.magenta>INSendMessageIntent</c>

00:20:11.945 --> 00:20:13.380
<c.magenta>因为我们发送文本消息</c>

00:20:14.281 --> 00:20:16.817
<c.magenta>这里你可以使用三种通信意图</c>

00:20:16.884 --> 00:20:19.987
<c.magenta>用于发送文本消息</c>
<c.magenta>进行音频和视频通话</c>

00:20:21.121 --> 00:20:24.925
<c.magenta>要重点注意的是</c>
<c.magenta>你还要保证你指定出</c>

00:20:24.992 --> 00:20:27.861
<c.magenta>你的应用在info.plist中</c>
<c.magenta>能够处理的意图</c>

00:20:28.161 --> 00:20:31.098
<c.magenta>这与活动类型相比几乎一样</c>

00:20:31.164 --> 00:20:32.432
<c.magenta>我们之前谈过了</c>

00:20:34.134 --> 00:20:35.769
<c.magenta>接着提供我们所使用的服务名称</c>

00:20:35.836 --> 00:20:37.037
<c.magenta>这里我们在使用WhatsApp</c>

00:20:37.104 --> 00:20:41.074
<c.magenta>如果你的应用处理多个协议</c>
<c.magenta>那这会特别有用</c>

00:20:41.208 --> 00:20:44.912
<c.magenta>例如</c>
<c.magenta>如果你有多客户端聊天应用</c>

00:20:46.079 --> 00:20:48.782
<c.magenta>比如说与Jabber</c>
<c.magenta>和ICQ有关</c>

00:20:49.116 --> 00:20:51.418
<c.magenta>你要确保你使用</c>
<c.magenta>正确的服务名称</c>

00:20:53.554 --> 00:20:55.255
<c.magenta>接下来 我们创建</c>
<c.magenta>INInteraction对象</c>

00:20:55.389 --> 00:20:58.559
<c.magenta>这会捕获我们之前</c>
<c.magenta>创建的所有信息</c>

00:20:58.959 --> 00:21:02.796
<c.magenta>以及一些元数据</c>
<c.magenta>包括通信的方向性等等</c>

00:20:58.959 --> 00:21:02.796
<c.magenta>以及一些元数据</c>
<c.magenta>包括通信的方向性等等</c>

00:21:03.397 --> 00:21:05.232
<c.magenta>因为我们在这里</c>
<c.magenta>发送文本消息</c>

00:21:05.299 --> 00:21:06.967
<c.magenta>我们使用外送方向</c>

00:21:07.734 --> 00:21:11.338
<c.magenta>这是唯一支持的</c>
<c.magenta>交互捐送方向</c>

00:21:12.306 --> 00:21:14.942
<c.magenta>最后 我们将</c>
<c.magenta>这个交互捐送给系统</c>

00:21:15.475 --> 00:21:18.779
<c.magenta>这样它会...</c>
<c.magenta>系统能够</c>

00:21:18.846 --> 00:21:23.250
<c.magenta>增强与你通信的联系人</c>

00:21:24.818 --> 00:21:28.355
<c.magenta>我说过了</c>
<c.magenta>当用户从联系人卡片</c>

00:21:28.422 --> 00:21:30.824
<c.magenta>与你的应用交互</c>
<c.magenta>我们遵循相同的模式</c>

00:21:31.124 --> 00:21:34.661
<c.magenta>并使用相同的UI应用程序</c>
<c.magenta>委托方法来启动你的应用</c>

00:21:35.262 --> 00:21:37.331
<c.magenta>我们首先在这里做的是</c>
<c.magenta>从NSUserActivity</c>

00:21:37.397 --> 00:21:40.968
<c.magenta>检查意图和交互</c>

00:21:41.468 --> 00:21:44.438
<c.magenta>之后我们可以开始与</c>
<c.magenta>预期接收方进行通信</c>

00:21:46.306 --> 00:21:47.975
<c.magenta>这就是如何得到</c>
<c.magenta>联系人交互</c>

00:21:48.375 --> 00:21:51.144
<c.magenta>你的应用可以在</c>
<c.magenta>联系人卡片上直接推荐</c>

00:21:51.512 --> 00:21:53.380
<c.magenta>这是最自然的通信方式</c>

00:21:54.515 --> 00:21:56.383
<c.magenta>成功了</c>
<c.magenta>我们讲完了列表中的一切</c>

00:21:56.850 --> 00:21:59.219
<c.magenta>但还没完</c>
<c.magenta>我们还要讲点别的</c>

00:21:59.686 --> 00:22:02.422
<c.magenta>我们来谈谈一些最佳实践</c>
<c.magenta>你要牢记在心</c>

00:21:59.686 --> 00:22:02.422
<c.magenta>我们来谈谈一些最佳实践</c>
<c.magenta>你要牢记在心</c>

00:22:02.489 --> 00:22:04.157
<c.magenta>使用NSUserActivity时</c>

00:22:05.025 --> 00:22:08.295
<c.magenta>首先就是要懒</c>
<c.magenta>对 这才是重点</c>

00:22:09.096 --> 00:22:11.598
<c.magenta>假设你在研发</c>
<c.magenta>一款邮件客户端</c>

00:22:11.665 --> 00:22:15.369
<c.magenta>你想采用Handoff</c>
<c.magenta>这样你的用户能够</c>

00:22:15.435 --> 00:22:19.173
<c.magenta>先在Mac上面开始写邮件</c>
<c.magenta>然后在手机上</c>

00:22:19.239 --> 00:22:22.543
<c.magenta>外出时 接着在iPhone上</c>
<c.magenta>之前的地方继续写下去</c>

00:22:23.277 --> 00:22:25.179
<c.magenta>这里我们做的是</c>
<c.magenta>我们有一个方法</c>

00:22:25.412 --> 00:22:28.982
<c.magenta>在每次按下键盘上的按键时</c>
<c.magenta>就调用这个方法</c>

00:22:29.550 --> 00:22:33.320
<c.magenta>而且每次我们都计算</c>
<c.magenta>并更新userInfo字典</c>

00:22:34.354 --> 00:22:36.290
<c.magenta>这会消耗巨大</c>
<c.magenta>并且效率低下</c>

00:22:36.757 --> 00:22:40.060
<c.magenta>相反你应该做的是</c>
<c.magenta>使用needsSave属性</c>

00:22:40.327 --> 00:22:43.397
<c.magenta>告诉系统这个活动是脏的</c>

00:22:43.630 --> 00:22:47.067
<c.magenta>这样系统能够在适合时间</c>

00:22:47.134 --> 00:22:50.070
<c.magenta>呼叫你来更新你的</c>
<c.magenta>userInfo目录</c>

00:22:51.071 --> 00:22:55.008
<c.magenta>例如将活动传递到</c>
<c.magenta>另一个设备之前</c>

00:22:56.009 --> 00:22:58.879
<c.magenta>这里我们是这样做的</c>
<c.magenta>我们在实施</c>

00:22:59.046 --> 00:23:01.882
<c.magenta>updateUserActivityState</c>
<c.magenta>委托方法</c>

00:22:59.046 --> 00:23:01.882
<c.magenta>updateUserActivityState</c>
<c.magenta>委托方法</c>

00:23:02.049 --> 00:23:05.085
<c.magenta>这是我们更新</c>
<c.magenta>userInfo字典的机会</c>

00:23:05.719 --> 00:23:09.456
<c.magenta>这样我们可以只做一次</c>
<c.magenta>而且效率更加的高</c>

00:23:10.891 --> 00:23:13.861
<c.magenta>接下来 确定你保留</c>
<c.magenta>当前活动的强引用</c>

00:23:14.595 --> 00:23:17.731
<c.magenta>我们在这里做的是</c>
<c.magenta>减轻NSUserActivity</c>

00:23:18.065 --> 00:23:21.568
<c.magenta>在上面做一些东西</c>
<c.magenta>调用becomeCurrent</c>

00:23:21.668 --> 00:23:23.403
<c.magenta>这很好 不过之后</c>

00:23:23.470 --> 00:23:26.006
<c.magenta>我们没有保留强引用</c>
<c.magenta>并推出了函数</c>

00:23:26.306 --> 00:23:29.042
<c.magenta>因此 活动被释放了</c>
<c.magenta>因为走出范围了</c>

00:23:30.611 --> 00:23:32.946
<c.magenta>活动释放不会是当前的</c>
<c.magenta>因为它不存在</c>

00:23:33.514 --> 00:23:36.216
<c.magenta>相反 你应该做的是</c>
<c.magenta>保留当前</c>

00:23:36.316 --> 00:23:37.584
<c.magenta>活动的强引用</c>

00:23:38.352 --> 00:23:39.887
<c.magenta>若这涉及到</c>
<c.magenta>UIViewControllers</c>

00:23:39.953 --> 00:23:42.823
<c.magenta>或者任何符合</c>
<c.magenta>UI响应器的东西</c>

00:23:43.123 --> 00:23:45.492
<c.magenta>还可以使用</c>
<c.magenta>用户活动定义...</c>

00:23:45.559 --> 00:23:48.395
<c.magenta>用户活动属性</c>
<c.magenta>定义在UI响应器上</c>

00:23:48.729 --> 00:23:50.230
<c.magenta>这有极佳的效果</c>

00:23:50.330 --> 00:23:53.800
<c.magenta>让UIKit为你管理</c>
<c.magenta>活动的当前性</c>

00:23:54.001 --> 00:23:56.770
<c.magenta>你不必调用</c>
<c.magenta>becomeCurrent或使其无效</c>

00:23:57.538 --> 00:23:59.506
<c.magenta>UIKit会为你做到</c>
<c.magenta>当视图控制器</c>

00:23:59.573 --> 00:24:02.142
<c.magenta>比如说链接到了视图层级</c>

00:23:59.573 --> 00:24:02.142
<c.magenta>比如说链接到了视图层级</c>

00:24:03.343 --> 00:24:05.112
<c.magenta>接下来</c>
<c.magenta>传送少量有效负载</c>

00:24:05.179 --> 00:24:08.649
<c.magenta>确保你只保留足够的信息</c>

00:24:08.749 --> 00:24:12.286
<c.magenta>在userInfo字典中</c>
<c.magenta>来重现状态 仅这些而已</c>

00:24:12.619 --> 00:24:17.891
<c.magenta>记住这些用户信息</c>
<c.magenta>和活动是通过</c>

00:24:17.991 --> 00:24:21.328
<c.magenta>Bluetooth发送的 这就是</c>
<c.magenta>为什么要尽可能保持轻量级</c>

00:24:22.696 --> 00:24:26.633
<c.magenta>例如 假设你研发的应用</c>
<c.magenta>要处理大型照片</c>

00:24:26.867 --> 00:24:28.168
<c.magenta>从网络上下载的</c>

00:24:28.635 --> 00:24:31.572
<c.magenta>所以我们在这里做的是</c>
<c.magenta>下载这些照片</c>

00:24:31.672 --> 00:24:34.708
<c.magenta>将其序列化为数据 然后</c>
<c.magenta>将它们放入userInfo字典</c>

00:24:35.042 --> 00:24:38.445
<c.magenta>这很容易就会达到几MB</c>
<c.magenta>效率低下</c>

00:24:39.246 --> 00:24:43.784
<c.magenta>相反 你可以做的是</c>
<c.magenta>保留独特标识符</c>

00:24:43.884 --> 00:24:48.255
<c.magenta>指向你所从事的内容</c>
<c.magenta>例如 网页URL</c>

00:24:48.488 --> 00:24:50.757
<c.magenta>这样当你还原活动时</c>

00:24:50.824 --> 00:24:54.528
<c.magenta>你可以将其从服务器取回</c>
<c.magenta>或者通过其他方法获取</c>

00:24:55.629 --> 00:24:57.331
<c.magenta>如果你真的要</c>
<c.magenta>处理大量有效负载</c>

00:24:57.397 --> 00:24:59.299
<c.magenta>你可以使用延续流</c>

00:24:59.366 --> 00:25:01.735
<c.magenta>它们专门设计用于该目的</c>

00:24:59.366 --> 00:25:01.735
<c.magenta>它们专门设计用于该目的</c>

00:25:01.802 --> 00:25:05.138
<c.magenta>在开发者资料中</c>
<c.magenta>有大量相关的信息</c>

00:25:06.039 --> 00:25:06.907
<c.magenta>好了 还有一个</c>

00:25:08.208 --> 00:25:11.645
<c.magenta>一定要保持你的活动类型</c>
<c.magenta>唯一并且有描述性</c>

00:25:11.912 --> 00:25:13.247
<c.magenta>这是为了避免冲突</c>

00:25:13.480 --> 00:25:16.884
<c.magenta>但重要的是</c>
<c.magenta>它们还要代表当前用户活动</c>

00:25:16.950 --> 00:25:18.452
<c.magenta>或者当前用户行动</c>

00:25:19.553 --> 00:25:21.922
<c.magenta>所以这里不使用</c>
<c.magenta>单个活动类型</c>

00:25:22.022 --> 00:25:23.891
<c.magenta>是我用在应用内部各处的</c>

00:25:24.591 --> 00:25:28.462
<c.magenta>更好的是使用多个活动类型</c>
<c.magenta>来描述应用的不同部分</c>

00:25:28.529 --> 00:25:30.931
<c.magenta>例如</c>
<c.magenta>一个是当我查看地点</c>

00:25:31.231 --> 00:25:33.133
<c.magenta>一个是当我搜索地点</c>

00:25:34.067 --> 00:25:38.172
<c.magenta>你会在这里发现</c>
<c.magenta>我使用反向DNS样式符号</c>

00:25:38.539 --> 00:25:44.411
<c.magenta>这确保了不会与</c>
<c.magenta>其他活动类型相冲突</c>

00:25:44.478 --> 00:25:46.813
<c.magenta>那些类型可能是在</c>
<c.magenta>其他应用内部定义的</c>

00:25:48.048 --> 00:25:49.449
<c.magenta>好了 现在该演示了</c>

00:25:49.750 --> 00:25:52.152
<c.magenta>将使用Proactive</c>
<c.magenta>Toolbox应用</c>

00:25:52.219 --> 00:25:55.656
<c.magenta>这是我们在Developer</c>
<c.magenta>Library中供大家使用的样例</c>

00:25:55.989 --> 00:26:00.260
<c.magenta>我们看看如何采用</c>
<c.magenta>NSUserActivity推荐地点</c>

00:25:55.989 --> 00:26:00.260
<c.magenta>我们看看如何采用</c>
<c.magenta>NSUserActivity推荐地点</c>

00:26:00.861 --> 00:26:04.298
<c.magenta>我们还会简短讲讲</c>
<c.magenta>Handoff以及应用搜索</c>

00:26:05.165 --> 00:26:06.099
<c.magenta>我们开始吧</c>

00:26:15.475 --> 00:26:21.315
<c.magenta>好 我将在此启动Proactive</c>
<c.magenta>Toolbox应用</c>

00:26:22.416 --> 00:26:27.454
<c.magenta>左边是我运行iOS 10的设备</c>
<c.magenta>然后Xcode就在后面</c>

00:26:28.222 --> 00:26:30.190
<c.magenta>我先给大家快速</c>
<c.magenta>浏览一下这个应用</c>

00:26:30.257 --> 00:26:31.658
<c.magenta>让你知道它的作用</c>

00:26:32.426 --> 00:26:34.394
<c.magenta>这里我们有披萨店的列表</c>

00:26:34.862 --> 00:26:37.231
<c.magenta>这是搜索本地披萨店的应用</c>

00:26:37.698 --> 00:26:40.801
<c.magenta>然后使用Core Location</c>
<c.magenta>来获取我的当前位置</c>

00:26:40.901 --> 00:26:45.172
<c.magenta>以及用MapKit来获取</c>
<c.magenta>符合披萨条件的地点</c>

00:26:45.739 --> 00:26:47.841
<c.magenta>我来看看这第一个</c>

00:26:48.242 --> 00:26:50.744
<c.magenta>我得到更丰富的页面</c>
<c.magenta>有更多详细信息</c>

00:26:50.811 --> 00:26:55.949
<c.magenta>像是名称 电话号码 地址</c>
<c.magenta>网站 以及该地点的地图</c>

00:26:56.884 --> 00:27:01.221
<c.magenta>现在我们将研究</c>
<c.magenta>如何能实施位置推荐</c>

00:26:56.884 --> 00:27:01.221
<c.magenta>现在我们将研究</c>
<c.magenta>如何能实施位置推荐</c>

00:27:02.155 --> 00:27:05.092
<c.magenta>这样相同的位置</c>
<c.magenta>会推荐到很多不同地方</c>

00:27:05.692 --> 00:27:07.294
<c.magenta>不过之前</c>
<c.magenta>我们先这么做</c>

00:27:07.361 --> 00:27:09.096
<c.magenta>我要计时</c>
<c.magenta>怎么样？</c>

00:27:09.563 --> 00:27:10.898
<c.magenta>看看这么做要多长时间</c>

00:27:11.665 --> 00:27:13.333
<c.magenta>我启动计时器</c>
<c.magenta>这就开始</c>

00:27:15.102 --> 00:27:16.904
<c.magenta>好了 我现在进入Xcode</c>

00:27:17.104 --> 00:27:20.007
<c.magenta>这是我的地点查看控制器</c>
<c.magenta>这个控制</c>

00:27:20.073 --> 00:27:23.377
<c.magenta>是我用来显示更丰富的结果</c>

00:27:23.443 --> 00:27:25.612
<c.magenta>更丰富的披萨店结果</c>

00:27:25.946 --> 00:27:29.950
<c.magenta>每当地图项目在我的应用中</c>
<c.magenta>更新时 我就会调用这个方法</c>

00:27:30.551 --> 00:27:34.221
<c.magenta>我将这个拖放到这里</c>

00:27:34.988 --> 00:27:37.191
<c.magenta>我在此创建</c>
<c.magenta>NSUserActivity</c>

00:27:37.958 --> 00:27:41.061
<c.magenta>如你所见</c>
<c.magenta>我在创建活动 提供给它</c>

00:27:41.128 --> 00:27:45.165
<c.magenta>活动类型 代表着</c>
<c.magenta>我所做的事情的含义</c>

00:27:45.566 --> 00:27:48.302
<c.magenta>在这个案例中</c>
<c.magenta>我还使用反向DNS样式符号</c>

00:27:48.602 --> 00:27:51.004
<c.magenta>这确保我的活动类型是唯一的</c>

00:27:51.905 --> 00:27:55.042
<c.magenta>我之前已经在info.plist中</c>
<c.magenta>定义了这个活动类型</c>

00:27:56.076 --> 00:27:58.045
<c.magenta>接下来我们设置标题和关键词</c>

00:27:58.412 --> 00:28:00.247
<c.magenta>我这里还是使用有含义的标题</c>

00:27:58.412 --> 00:28:00.247
<c.magenta>我这里还是使用有含义的标题</c>

00:28:00.347 --> 00:28:03.717
<c.magenta>因为这将是</c>
<c.magenta>用户活动的公开形象</c>

00:28:04.952 --> 00:28:08.322
<c.magenta>接下来 我设置Handoff</c>
<c.magenta>应用搜索以及公共索引</c>

00:28:08.689 --> 00:28:11.325
<c.magenta>因为我们在这里</c>
<c.magenta>看的内容是公开的</c>

00:28:11.892 --> 00:28:13.760
<c.magenta>更重要的部分是这个</c>

00:28:14.127 --> 00:28:16.797
<c.magenta>我在活动内部设置mapItem</c>

00:28:17.564 --> 00:28:21.568
<c.magenta>这个是有附加作用的</c>
<c.magenta>能为我们</c>

00:28:21.635 --> 00:28:23.070
<c.magenta>填充contentAttributeSets</c>

00:28:23.337 --> 00:28:28.208
<c.magenta>我在这里就那么做的</c>
<c.magenta>我的完成方法是通过表示</c>

00:28:28.308 --> 00:28:31.812
<c.magenta>这个内容支持</c>
<c.magenta>导航和电话呼叫</c>

00:28:31.945 --> 00:28:35.649
<c.magenta>这样它会有正确的图标</c>
<c.magenta>出现在Spotlight搜索结果中</c>

00:28:36.884 --> 00:28:40.120
<c.magenta>还记得要懒吗？</c>
<c.magenta>在这里我就是这样</c>

00:28:40.454 --> 00:28:43.457
<c.magenta>设置needsSave为真</c>
<c.magenta>以及委托方法</c>

00:28:43.891 --> 00:28:48.195
<c.magenta>这样就会调用</c>
<c.magenta>userActivity委托</c>

00:28:48.962 --> 00:28:50.898
<c.magenta>当我需要更新userInfo字典时</c>

00:28:52.032 --> 00:28:56.170
<c.magenta>最后我使用</c>
<c.magenta>userActivity属性</c>

00:28:56.236 --> 00:28:58.405
<c.magenta>它是由UIViewController内的</c>
<c.magenta>UI Responder所定义</c>

00:28:58.605 --> 00:29:01.608
<c.magenta>然后设置上活动</c>
<c.magenta>这样我能保留强引用</c>

00:28:58.605 --> 00:29:01.608
<c.magenta>然后设置上活动</c>
<c.magenta>这样我能保留强引用</c>

00:29:01.708 --> 00:29:04.344
<c.magenta>而且UIKit会替我自动管理它</c>

00:29:05.445 --> 00:29:10.951
<c.magenta>接下来 我将实施这个UI...</c>
<c.magenta>这个用户活动委托方法</c>

00:29:11.251 --> 00:29:12.619
<c.magenta>updateUserActivityState</c>

00:29:13.020 --> 00:29:16.323
<c.magenta>在这里我将</c>
<c.magenta>更新我的userInfo字典</c>

00:29:16.690 --> 00:29:19.193
<c.magenta>通过我在下面</c>
<c.magenta>这个方法内定义的内容</c>

00:29:19.259 --> 00:29:22.296
<c.magenta>这会返回字典的信息</c>

00:29:22.362 --> 00:29:25.332
<c.magenta>相关的信息</c>
<c.magenta>我之后要用它们重现这个状态</c>

00:29:26.233 --> 00:29:27.935
<c.magenta>我们继续 构建并运行</c>

00:29:33.907 --> 00:29:37.578
<c.magenta>好了 这就是相同的地点</c>

00:29:37.678 --> 00:29:39.646
<c.magenta>我没有破坏什么东西</c>
<c.magenta>没有出现变化</c>

00:29:40.380 --> 00:29:42.983
<c.magenta>我将双击Home键</c>

00:29:43.483 --> 00:29:47.788
<c.magenta>现在你能看到</c>
<c.magenta>这在底部出现了</c>

00:29:47.855 --> 00:29:51.124
<c.magenta>这个横幅 来获取到</c>
<c.magenta>我刚才所看地点的方向</c>

00:29:51.191 --> 00:29:52.826
<c.magenta>非常简单 超级方便</c>

00:29:53.994 --> 00:29:56.129
<c.magenta>打开Maps也是一样</c>

00:29:57.965 --> 00:30:01.802
<c.magenta>我直接在这里看到相同位置</c>
<c.magenta>甚至显示我的应用程序图标</c>

00:29:57.965 --> 00:30:01.802
<c.magenta>我直接在这里看到相同位置</c>
<c.magenta>甚至显示我的应用程序图标</c>

00:30:04.238 --> 00:30:05.372
<c.magenta>谢谢</c>

00:30:09.176 --> 00:30:11.178
<c.magenta>好了 我们缩放回来</c>

00:30:11.778 --> 00:30:14.114
<c.magenta>当我打开Messages</c>
<c.magenta>也是一样</c>

00:30:15.382 --> 00:30:18.652
<c.magenta>比如说“见面地点是...”</c>

00:30:19.086 --> 00:30:21.588
<c.magenta>你看到这里有相同的位置</c>

00:30:21.655 --> 00:30:24.858
<c.magenta>直接推荐到</c>
<c.magenta>QuickType UI内部</c>

00:30:25.492 --> 00:30:27.494
<c.magenta>由我的应用提供</c>
<c.magenta>我可以直接点击</c>

00:30:27.661 --> 00:30:30.998
<c.magenta>地点的名称和地址</c>
<c.magenta>都插入进去了</c>

00:30:35.869 --> 00:30:37.971
<c.magenta>而且这还对收到的消息有效</c>

00:30:38.038 --> 00:30:41.441
<c.magenta>这里我得到一条文本消息</c>
<c.magenta>在问我他们的电话号码是什么</c>

00:30:41.675 --> 00:30:44.611
<c.magenta>信息从NSUserActivity</c>
<c.magenta>中直接提取了出来</c>

00:30:44.678 --> 00:30:47.281
<c.magenta>我可以点击它</c>
<c.magenta>然后再插入电话号码</c>

00:30:47.814 --> 00:30:49.216
<c.magenta>非常炫酷</c>

00:30:51.752 --> 00:30:53.453
<c.magenta>我们看看计时</c>

00:30:53.887 --> 00:30:56.123
<c.magenta>3分40秒</c>
<c.magenta>这还不错</c>

00:30:56.223 --> 00:30:58.625
<c.magenta>所有这些位置推荐功能</c>

00:30:58.825 --> 00:31:01.161
<c.magenta>通过单个API</c>
<c.magenta>由我的应用提供</c>

00:30:58.825 --> 00:31:01.161
<c.magenta>通过单个API</c>
<c.magenta>由我的应用提供</c>

00:31:01.662 --> 00:31:05.365
<c.magenta>我投机取巧了一点</c>
<c.magenta>我有一些示例代码 但你懂我意思了</c>

00:31:05.432 --> 00:31:08.168
<c.magenta>这不需要大量的投入</c>

00:31:08.669 --> 00:31:11.939
<c.magenta>所以消息 QuickType</c>
<c.magenta>Siri 地图 多任务处理</c>

00:31:12.005 --> 00:31:14.107
<c.magenta>所有这些</c>
<c.magenta>只需一个API</c>

00:31:15.142 --> 00:31:18.178
<c.magenta>好了 我们也在</c>
<c.magenta>应用搜索上做了些工作</c>

00:31:18.245 --> 00:31:19.746
<c.magenta>将该内容编入索引</c>

00:31:19.813 --> 00:31:23.550
<c.magenta>我首先回到应用</c>
<c.magenta>然后还原其初始状态</c>

00:31:23.617 --> 00:31:25.519
<c.magenta>我将搜索披萨</c>

00:31:26.019 --> 00:31:27.120
<c.magenta>披萨</c>

00:31:27.788 --> 00:31:30.791
<c.magenta>果然</c>
<c.magenta>那个位置出现了</c>

00:31:31.592 --> 00:31:35.329
<c.magenta>但当我点击它 我的应用</c>
<c.magenta>就启动了 但它做得并不正确</c>

00:31:35.395 --> 00:31:39.199
<c.magenta>它没有将内容还原成</c>
<c.magenta>用户期待的那样</c>

00:31:39.266 --> 00:31:41.568
<c.magenta>没有显示披萨店的丰富UI</c>

00:31:41.935 --> 00:31:44.104
<c.magenta>我回到我的代码这里</c>

00:31:44.304 --> 00:31:47.941
<c.magenta>这是因为我们没实施</c>
<c.magenta>UIApplicationDelegate方法</c>

00:31:48.242 --> 00:31:50.043
<c.magenta>所以进入我的应用委托</c>

00:31:50.477 --> 00:31:52.412
<c.magenta>拖放那部分</c>

00:31:53.680 --> 00:31:55.649
<c.magenta>我在这里做的是</c>

00:31:55.749 --> 00:31:59.019
<c.magenta>我在实施continue</c>
<c.magenta>userActivity restorationHandler</c>

00:31:59.086 --> 00:32:02.089
<c.magenta>UIApplicationDelegate</c>
<c.magenta>首先检查活动类型</c>

00:31:59.086 --> 00:32:02.089
<c.magenta>UIApplicationDelegate</c>
<c.magenta>首先检查活动类型</c>

00:32:02.155 --> 00:32:04.625
<c.magenta>这是我们刚才使用的那个</c>

00:32:04.858 --> 00:32:08.729
<c.magenta>之后调用我在下面定义的方法</c>
<c.magenta>这会查看userInfo</c>

00:32:08.795 --> 00:32:11.565
<c.magenta>并像用户预期那样还原状态</c>

00:32:11.999 --> 00:32:13.767
<c.magenta>我将重新构建并运行</c>

00:32:16.270 --> 00:32:18.205
<c.magenta>然后再看一遍</c>

00:32:18.338 --> 00:32:20.607
<c.magenta>我们回到Spotlight</c>

00:32:22.042 --> 00:32:23.343
<c.magenta>点击结果</c>

00:32:23.510 --> 00:32:26.046
<c.magenta>现在我们做对了</c>
<c.magenta>还原了内容</c>

00:32:26.146 --> 00:32:27.581
<c.magenta>如用户期待那样</c>

00:32:28.081 --> 00:32:32.052
<c.magenta>所以这快速浏览了采用</c>
<c.magenta>NSUserActivity的方法</c>

00:32:32.119 --> 00:32:34.788
<c.magenta>用于位置推荐</c>
<c.magenta>应用搜索和Handoff</c>

00:32:34.988 --> 00:32:36.957
<c.magenta>好了 我们切换回来</c>

00:32:42.563 --> 00:32:46.066
<c.magenta>这个样例可在Developer</c>
<c.magenta>Library中获取</c>

00:32:46.200 --> 00:32:48.569
<c.magenta>它的功能还要更多</c>

00:32:48.702 --> 00:32:52.139
<c.magenta>它帮助你测试与</c>
<c.magenta>NSUserActivity的整合</c>

00:32:52.306 --> 00:32:55.309
<c.magenta>这是在你工作时</c>
<c.magenta>放在身边使用的好工具</c>

00:32:55.375 --> 00:32:57.477
<c.magenta>用于这些位置推荐功能</c>

00:32:58.445 --> 00:33:02.916
<c.magenta>好了 我们刚才知道了采用</c>
<c.magenta>NSUserActivity很容易</c>

00:32:58.445 --> 00:33:02.916
<c.magenta>好了 我们刚才知道了采用</c>
<c.magenta>NSUserActivity很容易</c>

00:33:03.050 --> 00:33:06.520
<c.magenta>并在系统的许多不同</c>
<c.magenta>部分推荐你的内容</c>

00:33:07.287 --> 00:33:09.389
<c.magenta>我将谈谈</c>
<c.magenta>schema.org如何提供</c>

00:33:09.456 --> 00:33:12.826
<c.magenta>一些这样的好处</c>
<c.magenta>尤其是位置推荐</c>

00:33:13.927 --> 00:33:17.231
<c.magenta>当我设计这些功能</c>
<c.magenta>这些位置推荐功能</c>

00:33:17.397 --> 00:33:19.366
<c.magenta>我们希望相同的效果</c>
<c.magenta>也能再现于</c>

00:33:19.633 --> 00:33:21.768
<c.magenta>你在Safari中查看的网站上</c>

00:33:22.703 --> 00:33:23.537
<c.magenta>所以为此</c>

00:33:24.204 --> 00:33:26.740
<c.magenta>例如</c>
<c.magenta>当你查看yelp.com</c>

00:33:26.807 --> 00:33:29.810
<c.magenta>这映射了我们之前</c>
<c.magenta>看过的相同内容</c>

00:33:29.977 --> 00:33:31.178
<c.magenta>在Yelp应用中</c>

00:33:31.612 --> 00:33:33.180
<c.magenta>当你从Safari切换走</c>

00:33:33.247 --> 00:33:35.315
<c.magenta>你会得到相同的</c>
<c.magenta>精致便利的建议</c>

00:33:35.382 --> 00:33:37.351
<c.magenta>来获取这个地点的方向</c>

00:33:37.851 --> 00:33:41.922
<c.magenta>这因为yelp.com</c>
<c.magenta>采用schema.org</c>

00:33:42.022 --> 00:33:44.057
<c.magenta>这是我们为此使用的技术</c>

00:33:44.992 --> 00:33:46.293
<c.magenta>稍微讲讲背景知识</c>

00:33:46.994 --> 00:33:49.129
<c.magenta>schema.org</c>
<c.magenta>是开放网页标记标准</c>

00:33:49.196 --> 00:33:52.232
<c.magenta>允许你从语义上</c>
<c.magenta>给内容加注释</c>

00:33:52.499 --> 00:33:54.468
<c.magenta>通过丰富的结构化元数据</c>

00:33:54.968 --> 00:33:59.006
<c.magenta>这里有很多架构为</c>
<c.magenta>各种概念提供大量的表达</c>

00:33:59.072 --> 00:34:00.908
<c.magenta>而且schema.org也是旨在</c>

00:33:59.072 --> 00:34:00.908
<c.magenta>而且schema.org也是旨在</c>

00:34:01.008 --> 00:34:04.011
<c.magenta>为用户提供丰富的搜索体验</c>

00:34:04.077 --> 00:34:07.981
<c.magenta>在iOS中 以及</c>
<c.magenta>所有主要搜索引擎</c>

00:34:09.783 --> 00:34:12.886
<c.magenta>这些架构都是</c>
<c.magenta>按照树形结构排列</c>

00:34:12.985 --> 00:34:16.023
<c.magenta>例如</c>
<c.magenta>更具体的架构 像是餐厅</c>

00:34:16.089 --> 00:34:19.458
<c.magenta>是源自更一般的类型</c>
<c.magenta>例如本地商业</c>

00:34:20.260 --> 00:34:22.563
<c.magenta>我们拿餐厅作为例子</c>

00:34:22.896 --> 00:34:25.732
<c.magenta>它是源自多个架构的</c>
<c.magenta>因此</c>

00:34:25.799 --> 00:34:28.702
<c.magenta>这继承了所有</c>
<c.magenta>定义它们的属性</c>

00:34:28.835 --> 00:34:32.505
<c.magenta>例如 名称属性</c>
<c.magenta>是由事物架构定义的</c>

00:34:32.739 --> 00:34:36.543
<c.magenta>在这个案例中</c>
<c.magenta>这会捕获餐厅名称</c>

00:34:37.077 --> 00:34:41.081
<c.magenta>地址也是一回事</c>
<c.magenta>那是在本地商业架构中定义的</c>

00:34:41.215 --> 00:34:43.250
<c.magenta>其他更针对于餐厅的事物</c>

00:34:43.317 --> 00:34:45.619
<c.magenta>例如是否接受预定</c>

00:34:45.853 --> 00:34:48.589
<c.magenta>是直接在餐厅架构内部定义的</c>

00:34:49.456 --> 00:34:51.891
<c.magenta>这是schema.org</c>
<c.magenta>实际运作的例子</c>

00:34:51.958 --> 00:34:55.128
<c.magenta>在左边 我们看到</c>
<c.magenta>之前看过的网站</c>

00:34:55.262 --> 00:34:58.599
<c.magenta>在右边</c>
<c.magenta>是在语义上描述它的内容</c>

00:34:58.699 --> 00:35:01.869
<c.magenta>以Safari可以理解的方法</c>

00:34:58.699 --> 00:35:01.869
<c.magenta>以Safari可以理解的方法</c>

00:35:02.402 --> 00:35:04.037
<c.magenta>创建电话号码</c>

00:35:04.137 --> 00:35:07.007
<c.magenta>餐厅名称</c>
<c.magenta>地址 评级 网站</c>

00:35:07.341 --> 00:35:09.209
<c.magenta>等等 能做的可以更多</c>

00:35:09.610 --> 00:35:11.445
<c.magenta>我们来看看</c>
<c.magenta>一个简单的例子</c>

00:35:11.578 --> 00:35:14.281
<c.magenta>这是一个非常简单的</c>
<c.magenta>HTML文档</c>

00:35:14.348 --> 00:35:16.550
<c.magenta>描述关于餐厅的内容</c>

00:35:16.917 --> 00:35:19.286
<c.magenta>我们来看看</c>
<c.magenta>这个网页可能的样子</c>

00:35:19.419 --> 00:35:23.290
<c.magenta>当加入JSON-LD</c>
<c.magenta>schema.org标记</c>

00:35:24.858 --> 00:35:27.928
<c.magenta>如你所见 我们没有</c>
<c.magenta>改变任何实际的内容</c>

00:35:27.995 --> 00:35:32.533
<c.magenta>或者实际的文档结构</c>
<c.magenta>我们只是在旁边提供了元数据</c>

00:35:32.966 --> 00:35:36.470
<c.magenta>以一种机器能接受的</c>
<c.magenta>格式来描述内容</c>

00:35:36.837 --> 00:35:40.507
<c.magenta>包括简单的属性</c>
<c.magenta>像是电话</c>

00:35:40.841 --> 00:35:44.912
<c.magenta>不过还有更复杂的结构化属性</c>
<c.magenta>像是地址</c>

00:35:45.045 --> 00:35:48.115
<c.magenta>本身就是PostalAddress</c>
<c.magenta>类型的另一个架构</c>

00:35:48.415 --> 00:35:52.619
<c.magenta>如果你喜欢</c>
<c.magenta>你还可以给内容注释</c>

00:35:52.719 --> 00:35:54.888
<c.magenta>与微数据内联</c>

00:35:54.988 --> 00:35:56.456
<c.magenta>我们就这么做</c>

00:35:56.523 --> 00:35:59.726
<c.magenta>我们在改变</c>
<c.magenta>初始文档的实际结构</c>

00:35:59.793 --> 00:36:03.330
<c.magenta>并使用内联微数据标记</c>
<c.magenta>来增强它</c>

00:35:59.793 --> 00:36:03.330
<c.magenta>并使用内联微数据标记</c>
<c.magenta>来增强它</c>

00:36:04.398 --> 00:36:07.801
<c.magenta>在iOS 10中 Safari提取</c>
<c.magenta>这些与位置相关的架构</c>

00:36:08.001 --> 00:36:11.905
<c.magenta>在NSUserActivity中</c>
<c.magenta>像推荐原生应用那样推荐它们</c>

00:36:12.539 --> 00:36:14.575
<c.magenta>这也会给你一些好处</c>

00:36:14.641 --> 00:36:17.311
<c.magenta>关于我们之前谈过的</c>
<c.magenta>位置推荐</c>

00:36:17.811 --> 00:36:20.814
<c.magenta>这些是Safari会</c>
<c.magenta>提取的一些架构</c>

00:36:21.148 --> 00:36:25.419
<c.magenta>任何带有PostalAddress</c>
<c.magenta>GeoCoordinate或电话属性</c>

00:36:25.586 --> 00:36:29.756
<c.magenta>而我们之前用的餐厅架构</c>
<c.magenta>就是绝佳的例子</c>

00:36:29.990 --> 00:36:31.959
<c.magenta>你有所有这些属性</c>

00:36:32.025 --> 00:36:37.698
<c.magenta>你可以组合或指定</c>
<c.magenta>你当时可用的那些属性</c>

00:36:39.967 --> 00:36:43.203
<c.magenta>好了 我们谈了</c>
<c.magenta>NSUserActivity和schema.org</c>

00:36:43.704 --> 00:36:47.074
<c.magenta>使用NSUserActivity</c>
<c.magenta></c>

00:36:47.274 --> 00:36:49.176
<c.magenta>将用户在应用内查看的位置</c>

00:36:49.243 --> 00:36:52.513
<c.magenta>在整个系统的很多地方中 毫不费力地推荐给他们</c>

00:36:53.480 --> 00:36:55.048
<c.magenta>还有通信应用</c>

00:36:55.616 --> 00:36:59.820
<c.magenta>当然 还有所有</c>
<c.magenta>Handoff和应用搜索的使用案例</c>

00:37:01.288 --> 00:37:04.992
<c.magenta>在你网站上使用schema.org</c>
<c.magenta>来得到这一些好处</c>

00:37:05.192 --> 00:37:06.560
<c.magenta>用于位置建议</c>

00:37:06.660 --> 00:37:08.962
<c.magenta>与NSUserActivity</c>
<c.magenta>几乎一回事</c>

00:37:09.696 --> 00:37:13.634
<c.magenta>现在我们看看你的应用</c>
<c.magenta>如何使用这些位置建议</c>

00:37:13.800 --> 00:37:15.335
<c.magenta>像我们之前看过的</c>

00:37:15.903 --> 00:37:18.772
<c.magenta>这里我们将谈谈</c>
<c.magenta>那么做的两种方式</c>

00:37:18.839 --> 00:37:22.209
<c.magenta>一个是通过键盘</c>
<c.magenta>另一个是针对路线规划应用</c>

00:37:23.210 --> 00:37:24.811
<c.magenta>我们从第一个开始</c>

00:37:25.846 --> 00:37:29.783
<c.magenta>如果你的应用处理</c>
<c.magenta>文本格式的地址</c>

00:37:30.317 --> 00:37:35.355
<c.magenta>你可在应用内部受益于位置建议</c>
<c.magenta>通过QuickType UI</c>

00:37:36.089 --> 00:37:38.358
<c.magenta>现在我们在看Uber应用</c>

00:37:39.293 --> 00:37:42.329
<c.magenta>如果你不知道的话</c>
<c.magenta>这是一款拼车应用</c>

00:37:42.496 --> 00:37:45.032
<c.magenta>当用户进入文本域</c>

00:37:45.098 --> 00:37:47.801
<c.magenta>这被注释成位置文本域</c>

00:37:48.168 --> 00:37:52.372
<c.magenta>那个情况下 我们从Yelp中</c>
<c.magenta>直接将内容推荐到Uber内部</c>

00:37:53.140 --> 00:37:56.376
<c.magenta>这包括最近推荐的位置</c>

00:37:56.443 --> 00:38:00.147
<c.magenta>由其他应用在NSUserActivities</c>
<c.magenta>或schema.org中推荐</c>

00:37:56.443 --> 00:38:00.147
<c.magenta>由其他应用在NSUserActivities</c>
<c.magenta>或schema.org中推荐</c>

00:38:01.014 --> 00:38:03.350
<c.magenta>基于你日历上面的未来位置</c>

00:38:04.418 --> 00:38:06.987
<c.magenta>可能复制到</c>
<c.magenta>粘贴板中的位置</c>

00:38:07.054 --> 00:38:09.823
<c.magenta>例如 你收到附带</c>
<c.magenta>地址的文本消息</c>

00:38:10.424 --> 00:38:15.095
<c.magenta>甚至可能是你最近使用</c>
<c.magenta>Siri互动过的地点</c>

00:38:15.462 --> 00:38:17.164
<c.magenta>例如 如果你问...</c>

00:38:17.698 --> 00:38:20.501
<c.magenta>如果你请求Siri</c>
<c.magenta>给你指向附近的餐厅</c>

00:38:20.567 --> 00:38:22.202
<c.magenta>之后与那个结果互动</c>

00:38:22.269 --> 00:38:25.906
<c.magenta>你就会在那你看到它</c>
<c.magenta>作为位置建议的一部分</c>

00:38:27.641 --> 00:38:30.277
<c.magenta>我们在UIKit中</c>
<c.magenta>推出新的API</c>

00:38:30.344 --> 00:38:32.546
<c.magenta>所以你的应用可以告知系统</c>

00:38:32.613 --> 00:38:35.549
<c.magenta>文本域所预期的内容类型</c>

00:38:35.949 --> 00:38:39.786
<c.magenta>在这个案例中</c>
<c.magenta>我们使用的是位置</c>

00:38:40.187 --> 00:38:42.890
<c.magenta>基于这个线索</c>
<c.magenta>键盘就能够作出</c>

00:38:42.956 --> 00:38:45.425
<c.magenta>正确的主动建议</c>

00:38:45.492 --> 00:38:48.629
<c.magenta>如果此时在</c>
<c.magenta>前后关联中可用的话</c>

00:38:49.530 --> 00:38:53.500
<c.magenta>不过没有可用的主动建议</c>

00:38:53.567 --> 00:38:57.404
<c.magenta>这还会在自动校正方面</c>
<c.magenta>提供更为丰富体验</c>

00:38:57.571 --> 00:39:02.709
<c.magenta>因为自动校正现在能知道</c>
<c.magenta>应用所预期的内容</c>

00:38:57.571 --> 00:39:02.709
<c.magenta>因为自动校正现在能知道</c>
<c.magenta>应用所预期的内容</c>

00:39:04.845 --> 00:39:08.549
<c.magenta>我们在UITextInputTraits中</c>
<c.magenta>添加了新属性</c>

00:39:08.615 --> 00:39:12.052
<c.magenta>叫做textContentType</c>
<c.magenta>允许你指定这个内容</c>

00:39:12.119 --> 00:39:16.790
<c.magenta>这里 我们使用UITextField</c>
<c.magenta>这符合UITextInputTraits</c>

00:39:16.857 --> 00:39:18.625
<c.magenta>因此会得到这个属性</c>

00:39:19.059 --> 00:39:23.497
<c.magenta>我们表示这个文本域</c>
<c.magenta>预期完整的街道地址</c>

00:39:24.298 --> 00:39:27.467
<c.magenta>这里有很多的</c>
<c.magenta>文本内容类型供你使用</c>

00:39:27.734 --> 00:39:31.905
<c.magenta>范围从描述人群到位置</c>
<c.magenta>还有很多其他的</c>

00:39:32.439 --> 00:39:35.509
<c.magenta>这个完整列表可在Developer</c>
<c.magenta>Library中获取</c>

00:39:35.809 --> 00:39:38.512
<c.magenta>不过我们着重仔细看看这两个</c>

00:39:38.712 --> 00:39:43.450
<c.magenta>这两个都与位置相关</c>

00:39:43.951 --> 00:39:46.153
<c.magenta>不过它们有不同的粒度等级</c>

00:39:46.920 --> 00:39:52.192
<c.magenta>你要使用最能表现</c>
<c.magenta>你的使用案例的那个</c>

00:39:52.626 --> 00:39:54.628
<c.magenta>拥有正确的粒度等级</c>

00:39:54.962 --> 00:39:55.796
<c.magenta>例如</c>

00:39:55.863 --> 00:40:00.033
<c.magenta>一个导航应用通常会</c>
<c.magenta>预期完整的街道地址</c>

00:39:55.863 --> 00:40:00.033
<c.magenta>一个导航应用通常会</c>
<c.magenta>预期完整的街道地址</c>

00:40:00.100 --> 00:40:03.370
<c.magenta>这样能准确地将用户</c>
<c.magenta>指引到他们的目的地</c>

00:40:03.837 --> 00:40:09.076
<c.magenta>而天气应用可能通常</c>
<c.magenta>只需要在乎州和城市</c>

00:40:09.376 --> 00:40:12.546
<c.magenta>因为这对天气的</c>
<c.magenta>使用案例就足够了</c>

00:40:12.646 --> 00:40:13.780
<c.magenta>如你所见</c>

00:40:13.847 --> 00:40:16.283
<c.magenta>基于我们指定的</c>
<c.magenta>不同内容类型</c>

00:40:16.350 --> 00:40:19.553
<c.magenta>我们得到了不同的内容</c>
<c.magenta>推荐到了QuickType栏内部</c>

00:40:19.620 --> 00:40:23.624
<c.magenta>一个是完整的街道地址</c>
<c.magenta>另一个只是加州旧金山</c>

00:40:25.158 --> 00:40:28.028
<c.magenta>在键盘中得到</c>
<c.magenta>建议就是这么简单</c>

00:40:28.929 --> 00:40:31.665
<c.magenta>现在我们看看</c>
<c.magenta>路线规划应用如何得益于</c>

00:40:32.099 --> 00:40:35.302
<c.magenta>这些底部精美的方向横幅</c>

00:40:36.003 --> 00:40:38.772
<c.magenta>如Daniel之前说的</c>
<c.magenta>路线规划应用</c>

00:40:39.039 --> 00:40:41.775
<c.magenta>第三方路线规划应用</c>
<c.magenta>也可以提升到这里</c>

00:40:42.142 --> 00:40:44.978
<c.magenta>让用户直接</c>
<c.magenta>加速进入你的应用</c>

00:40:45.112 --> 00:40:48.115
<c.magenta>当我们认为用户的意图</c>
<c.magenta>是获取方向</c>

00:40:49.383 --> 00:40:52.819
<c.magenta>我们利用了现有API</c>
<c.magenta>叫做MKDirectionsRequest</c>

00:40:53.153 --> 00:40:57.324
<c.magenta>这是在iOS 6中推出的</c>
<c.magenta>这允许你注册路线规划应用</c>

00:40:57.391 --> 00:40:59.126
<c.magenta>然后处理所有的方向请求</c>

00:41:00.027 --> 00:41:02.162
<c.magenta>iOS会随着时间学习</c>

00:41:02.262 --> 00:41:06.166
<c.magenta>基于各种因素判断用户</c>
<c.magenta>最爱的路线规划应用是什么</c>

00:41:06.266 --> 00:41:08.068
<c.magenta>例如像是参与</c>

00:41:08.335 --> 00:41:11.672
<c.magenta>然后在合适的时候</c>
<c.magenta>在多任务UI中建议</c>

00:41:14.441 --> 00:41:18.512
<c.magenta>为此你要确保</c>
<c.magenta>你将应用配置成</c>

00:41:18.579 --> 00:41:19.880
<c.magenta>能接收方向请求</c>

00:41:19.947 --> 00:41:23.617
<c.magenta>这很容易就能在Xcode中</c>
<c.magenta>通过功能面板完成</c>

00:41:24.184 --> 00:41:27.588
<c.magenta>在iOS 10中 我们推出了</c>
<c.magenta>一种新的路线规划模式</c>

00:41:27.654 --> 00:41:29.656
<c.magenta>专门用于拼车应用</c>

00:41:30.591 --> 00:41:34.294
<c.magenta>接下来 你要声明与你应用</c>
<c.magenta>真正相关的地图区域</c>

00:41:34.361 --> 00:41:37.164
<c.magenta>比如说如果</c>
<c.magenta>你的应用是当地的地铁应用</c>

00:41:37.231 --> 00:41:41.201
<c.magenta>你可以指定你的应用</c>
<c.magenta>只在这个区域相关</c>

00:41:42.302 --> 00:41:43.704
<c.magenta>最后你要确保</c>

00:41:43.804 --> 00:41:46.273
<c.magenta>你会采取合适的行动</c>
<c.magenta>当你的应用启动在</c>

00:41:46.340 --> 00:41:47.774
<c.magenta>MKDirectionsRequest内部</c>

00:41:48.008 --> 00:41:50.777
<c.magenta>那就是你的应用</c>
<c.magenta>应该自动开始定向</c>

00:41:50.978 --> 00:41:53.547
<c.magenta>或者填充UI 使得用户能</c>

00:41:53.714 --> 00:41:55.849
<c.magenta>容易地获取方向</c>

00:41:56.617 --> 00:42:01.121
<c.magenta>在代码方面 这个例子示范了</c>
<c.magenta>如何采用MKDirectionsRequest</c>

00:41:56.617 --> 00:42:01.121
<c.magenta>在代码方面 这个例子示范了</c>
<c.magenta>如何采用MKDirectionsRequest</c>

00:42:02.222 --> 00:42:04.458
<c.magenta>MKDirectionsRequest</c>
<c.magenta>使用一个URL方案</c>

00:42:04.758 --> 00:42:08.161
<c.magenta>当你的应用启动后</c>
<c.magenta>会附带有一个URL</c>

00:42:08.362 --> 00:42:09.730
<c.magenta>我们首先做的是检查</c>

00:42:09.830 --> 00:42:13.300
<c.magenta>我们得到的URL实际上是</c>
<c.magenta>有效的MKDirectionsRequest</c>

00:42:13.901 --> 00:42:18.539
<c.magenta>MKDirectionsRequest为此</c>
<c.magenta>提供isDirectionsRequestURL</c>

00:42:19.573 --> 00:42:22.843
<c.magenta>接下来我们减轻</c>
<c.magenta>MKDirectionsRequest的一个实例</c>

00:42:23.043 --> 00:42:26.647
<c.magenta>来自URL的内容</c>
<c.magenta>这包含的信息是关于</c>

00:42:26.813 --> 00:42:30.551
<c.magenta>出发地和用户想到达的目的地</c>

00:42:31.618 --> 00:42:34.288
<c.magenta>在iOS 10中 接下来</c>
<c.magenta>这个功能十分重要</c>

00:42:34.354 --> 00:42:38.158
<c.magenta>尤其对于那些已经采用了</c>
<c.magenta>MKDirectionsRequest的人</c>

00:42:38.659 --> 00:42:41.028
<c.magenta>那就是现在你可以</c>
<c.magenta>使用没有地理坐标的</c>

00:42:41.094 --> 00:42:43.163
<c.magenta>地图项目进行启动</c>

00:42:43.764 --> 00:42:45.399
<c.magenta>在这个案例中</c>
<c.magenta>你要将你得到的</c>

00:42:45.465 --> 00:42:49.136
<c.magenta>地址字典进行地理编码</c>
<c.magenta>使用CLGeocoders</c>

00:42:49.436 --> 00:42:53.674
<c.magenta>geocodeAddressDictionary</c>
<c.magenta>这会返给你一个地点标记</c>

00:42:53.740 --> 00:42:57.544
<c.magenta>附带正确的纬度和经度</c>
<c.magenta>这会之后帮助你开始定向</c>

00:42:57.644 --> 00:43:00.414
<c.magenta>到预定的位置</c>
<c.magenta>这就差不多好了</c>

00:42:57.644 --> 00:43:00.414
<c.magenta>到预定的位置</c>
<c.magenta>这就差不多好了</c>

00:43:01.114 --> 00:43:03.116
<c.magenta>这就是如何推荐</c>
<c.magenta>你的路线规划应用</c>

00:43:03.383 --> 00:43:05.853
<c.magenta>在多任务UI的醒目位置上</c>

00:43:07.454 --> 00:43:09.623
<c.magenta>至此 我想交给Daniel</c>

00:43:09.723 --> 00:43:12.259
<c.magenta>来谈谈媒体应用的建议</c>
<c.magenta>谢谢大家</c>

00:43:13.493 --> 00:43:15.662
<c.magenta>这太棒了</c>
<c.magenta>好了</c>

00:43:16.830 --> 00:43:21.101
<c.magenta>现在我们谈谈</c>
<c.magenta>媒体应用建议</c>

00:43:21.635 --> 00:43:25.439
<c.magenta>如果你的应用</c>
<c.magenta>处理任何形式的媒体</c>

00:43:25.506 --> 00:43:30.611
<c.magenta>像是播客应用</c>
<c.magenta>或类似Spotify的应用</c>

00:43:30.978 --> 00:43:35.315
<c.magenta>或甚至播放视频的应用</c>
<c.magenta>那你就要认真听听了</c>

00:43:36.984 --> 00:43:41.154
<c.magenta>现今的iOS会推荐</c>
<c.magenta>我们认为你会使用的应用</c>

00:43:41.221 --> 00:43:42.890
<c.magenta>基于你的行为</c>

00:43:43.123 --> 00:43:45.659
<c.magenta>我们在大量不同的UI中</c>
<c.magenta>推荐那个应用</c>

00:43:45.726 --> 00:43:46.960
<c.magenta>我之前展示过了</c>

00:43:47.995 --> 00:43:51.732
<c.magenta>我们特别地</c>
<c.magenta>在Spotlight中提供哪些建议</c>

00:43:51.899 --> 00:43:53.634
<c.magenta>还有Today View</c>

00:43:54.902 --> 00:44:00.908
<c.magenta>如果建议的动作</c>
<c.magenta>跟随着特定的触发</c>

00:43:54.902 --> 00:44:00.908
<c.magenta>如果建议的动作</c>
<c.magenta>跟随着特定的触发</c>

00:44:00.974 --> 00:44:04.778
<c.magenta>例如 当你插入耳机</c>
<c.magenta>或者Bluetooth配对</c>

00:44:05.379 --> 00:44:10.651
<c.magenta>或甚至到达某个地方</c>
<c.magenta>而且是媒体应用</c>

00:44:10.751 --> 00:44:12.319
<c.magenta>我们可以进一步提升它</c>

00:44:13.020 --> 00:44:14.521
<c.magenta>我们看看这是什么样的</c>

00:44:14.688 --> 00:44:17.191
<c.magenta>这是Spotlight中</c>
<c.magenta>推荐的样子</c>

00:44:17.457 --> 00:44:21.428
<c.magenta>假如说我总是</c>
<c.magenta>或者经常听播客</c>

00:44:21.495 --> 00:44:22.896
<c.magenta>在插入耳机之后</c>

00:44:23.463 --> 00:44:27.134
<c.magenta>注意 在左边上部</c>
<c.magenta>有播客应用建议</c>

00:44:28.468 --> 00:44:32.005
<c.magenta>不过在某些情况下</c>
<c.magenta>那个推荐</c>

00:44:32.105 --> 00:44:34.741
<c.magenta>会提升到锁屏的上面</c>

00:44:35.008 --> 00:44:36.543
<c.magenta>所以你看到的是</c>

00:44:36.610 --> 00:44:40.013
<c.magenta>我们传统上</c>
<c.magenta>用于Handoff的UI</c>

00:44:40.180 --> 00:44:43.383
<c.magenta>现在用于推荐一款应用</c>

00:44:43.483 --> 00:44:45.752
<c.magenta>是我们认为我可能使用的</c>
<c.magenta>因为这遵循</c>

00:44:45.853 --> 00:44:47.187
<c.magenta>之前提到的那些触发</c>

00:44:47.821 --> 00:44:50.991
<c.magenta>这是非常好的体验</c>

00:44:51.592 --> 00:44:54.595
<c.magenta>但又不是那么的好</c>
<c.magenta>因为说到底</c>

00:44:55.028 --> 00:44:56.496
<c.magenta>你现在必须做的是</c>

00:44:56.563 --> 00:44:58.932
<c.magenta>你必须解锁设备</c>

00:44:59.032 --> 00:45:02.169
<c.magenta>向右滑动</c>
<c.magenta>才能获取我们</c>

00:44:59.032 --> 00:45:02.169
<c.magenta>向右滑动</c>
<c.magenta>才能获取我们</c>

00:45:02.236 --> 00:45:04.404
<c.magenta>所预测的</c>
<c.magenta>你想要消费的内容</c>

00:45:05.672 --> 00:45:07.674
<c.magenta>通过非常简单的API</c>

00:45:07.875 --> 00:45:11.712
<c.magenta>你可以为用户构建更好的体验</c>

00:45:12.913 --> 00:45:15.482
<c.magenta>这是它之前的样子</c>
<c.magenta>我刚才给你展示过了</c>

00:45:16.717 --> 00:45:18.318
<c.magenta>这是它之后的样子</c>

00:45:20.754 --> 00:45:22.923
<c.magenta>我们做到了吧？</c>
<c.magenta>这是之前的样子</c>

00:45:24.024 --> 00:45:26.994
<c.magenta>这是之后的样子</c>
<c.magenta>好太多了</c>

00:45:27.661 --> 00:45:30.831
<c.magenta>不仅用户可以</c>
<c.magenta>参与到内容中</c>

00:45:31.265 --> 00:45:33.901
<c.magenta>而且不用解锁他们的设备</c>

00:45:34.268 --> 00:45:37.838
<c.magenta>同时还可以将专辑封面</c>
<c.magenta>在突出位置展现给用户</c>

00:45:39.273 --> 00:45:41.408
<c.magenta>这在做完后</c>
<c.magenta>可能很显而易见</c>

00:45:41.475 --> 00:45:45.779
<c.magenta>不过这个特定的界面</c>
<c.magenta>还提供了更好的转化</c>

00:45:46.013 --> 00:45:48.015
<c.magenta>如果你看实际数字的话</c>

00:45:48.182 --> 00:45:49.683
<c.magenta>如果你感兴趣于</c>

00:45:49.750 --> 00:45:52.186
<c.magenta>让用户实际去播放你的内容</c>

00:45:52.252 --> 00:45:55.389
<c.magenta>你应该是感兴趣的</c>
<c.magenta>那这就是属于你的API</c>

00:45:55.489 --> 00:45:56.857
<c.magenta>我们怎么做？</c>

00:45:57.224 --> 00:45:59.826
<c.magenta>我会一步步地讲</c>
<c.magenta>非常易于采用的</c>

00:46:01.128 --> 00:46:05.966
<c.magenta>这都可以归结于一个类</c>
<c.magenta>叫做MPPlayableContentManager</c>

00:46:07.568 --> 00:46:08.936
<c.magenta>想象一下</c>
<c.magenta>你有</c>

00:46:11.071 --> 00:46:14.274
<c.magenta>一个有着不同属性的字典</c>

00:46:14.341 --> 00:46:16.643
<c.magenta>有标题 艺术家 专辑</c>

00:46:17.377 --> 00:46:20.180
<c.magenta>你想做的是将其提升到</c>

00:46:20.247 --> 00:46:23.684
<c.magenta>设备的锁屏上</c>
<c.magenta>当系统认为</c>

00:46:23.917 --> 00:46:25.919
<c.magenta>客户可能会参与其中</c>

00:46:27.054 --> 00:46:28.655
<c.magenta>你首先要做的就是</c>

00:46:28.755 --> 00:46:31.925
<c.magenta>导入Media Player</c>
<c.magenta>并声明你自己</c>

00:46:32.059 --> 00:46:36.129
<c.magenta>与那个类别中的委托一致</c>

00:46:36.330 --> 00:46:41.668
<c.magenta>然后你要实施一个方法</c>
<c.magenta>叫做playableContentManager</c>

00:46:43.270 --> 00:46:44.137
<c.magenta>这很简单</c>

00:46:44.204 --> 00:46:47.307
<c.magenta>首先 你要抓取媒体项目</c>

00:46:47.574 --> 00:46:49.910
<c.magenta>通过你有的任何手段</c>

00:46:49.977 --> 00:46:51.612
<c.magenta>很显然你要做好准备</c>

00:46:51.712 --> 00:46:53.981
<c.magenta>尤其是如果你要获取远程资源</c>

00:46:54.281 --> 00:46:56.517
<c.magenta>以防其失效</c>
<c.magenta>那种情况下 你要调用</c>

00:46:56.583 --> 00:46:58.752
<c.magenta>在下面看到的那个回调句柄</c>

00:46:59.653 --> 00:47:04.191
<c.magenta>因此系统会明白</c>
<c.magenta>不一定要给你推荐</c>

00:46:59.653 --> 00:47:04.191
<c.magenta>因此系统会明白</c>
<c.magenta>不一定要给你推荐</c>

00:47:05.325 --> 00:47:08.829
<c.magenta>下一步 你要填充</c>
<c.magenta>NowPlayingInfo</c>

00:47:09.930 --> 00:47:11.732
<c.magenta>在设备的锁屏上</c>

00:47:11.832 --> 00:47:16.036
<c.magenta>这是我实施的一个方法</c>
<c.magenta>所以给你展示其背后的内容</c>

00:47:16.904 --> 00:47:23.710
<c.magenta>首先你要做的是</c>
<c.magenta>抓取infoCenter对象</c>

00:47:23.977 --> 00:47:26.813
<c.magenta>之后如果你有确实</c>
<c.magenta>一张特定的图像</c>

00:47:26.880 --> 00:47:30.784
<c.magenta>是这个媒体项目上有的</c>
<c.magenta>你可以将它推荐到</c>

00:47:31.018 --> 00:47:32.386
<c.magenta>设备的锁屏上</c>

00:47:32.452 --> 00:47:35.022
<c.magenta>如果你使用的是默认图像</c>
<c.magenta>这就是个机会</c>

00:47:35.088 --> 00:47:37.524
<c.magenta>让你的品牌得到提升</c>

00:47:39.092 --> 00:47:41.361
<c.magenta>然后你要把你的表示转化成</c>

00:47:41.795 --> 00:47:45.465
<c.magenta>nowPlayingInfo表示</c>
<c.magenta>最重要的是</c>

00:47:45.933 --> 00:47:49.203
<c.magenta>要在infoCenter上</c>
<c.magenta>设置nowPlayingInfo</c>

00:47:50.003 --> 00:47:53.407
<c.magenta>在完成之前所展示的回调之前</c>

00:47:53.473 --> 00:47:57.945
<c.magenta>所以你要在方法结束之前完成</c>

00:47:58.478 --> 00:48:01.982
<c.magenta>如果出于某种原因你不喜欢</c>

00:47:58.478 --> 00:48:01.982
<c.magenta>如果出于某种原因你不喜欢</c>

00:48:02.049 --> 00:48:05.752
<c.magenta>或你的应用在准备</c>
<c.magenta>回放时出现错误</c>

00:48:05.819 --> 00:48:07.588
<c.magenta>如果手机处于飞行模式</c>

00:48:07.788 --> 00:48:10.490
<c.magenta>这是另一个机会</c>
<c.magenta>让你提早去除错误</c>

00:48:10.624 --> 00:48:14.494
<c.magenta>注意 实际上你不想</c>
<c.magenta>在此时开始回放</c>

00:48:14.962 --> 00:48:16.597
<c.magenta>你插入耳机 你要等待</c>

00:48:16.697 --> 00:48:19.333
<c.magenta>客户点击播放按钮</c>

00:48:19.533 --> 00:48:22.736
<c.magenta>不过你要做好准备</c>
<c.magenta>加载到流文件中等等</c>

00:48:24.271 --> 00:48:25.105
<c.magenta>就是这样</c>

00:48:26.273 --> 00:48:31.144
<c.magenta>再说一遍 现今的iOS</c>
<c.magenta>根据你的行为推荐应用</c>

00:48:31.545 --> 00:48:35.516
<c.magenta>如果遵循特定的触发</c>
<c.magenta>并且它们是媒体应用</c>

00:48:35.749 --> 00:48:37.484
<c.magenta>我们把它们提升到锁屏上</c>

00:48:38.185 --> 00:48:41.121
<c.magenta>通过我刚才展示的</c>
<c.magenta>非常简单的采用</c>

00:48:41.221 --> 00:48:44.892
<c.magenta>你可以得到更好的体验</c>
<c.magenta>并且有机会</c>

00:48:44.958 --> 00:48:46.927
<c.magenta>去推广你的品牌</c>

00:48:47.027 --> 00:48:49.196
<c.magenta>以及你有的</c>
<c.magenta>那么华丽的专辑封面</c>

00:48:51.365 --> 00:48:56.136
<c.magenta>好了 总结一下</c>
<c.magenta>我们今天所讲的内容</c>

00:48:58.105 --> 00:49:02.776
<c.magenta>我们谈了几个简单的API</c>
<c.magenta>有助于将你的应用深度整合到</c>

00:48:58.105 --> 00:49:02.776
<c.magenta>我们谈了几个简单的API</c>
<c.magenta>有助于将你的应用深度整合到</c>

00:49:02.876 --> 00:49:04.511
<c.magenta>操作系统中</c>

00:49:04.912 --> 00:49:09.449
<c.magenta>我们谈了NSUserActivity</c>
<c.magenta>这相当于操作系统的眼睛</c>

00:49:09.683 --> 00:49:15.088
<c.magenta>这帮助我们从语义上</c>
<c.magenta>了解客户当前所看的内容</c>

00:49:16.423 --> 00:49:20.327
<c.magenta>然后我们谈了schema.org</c>
<c.magenta>从很多方面讲</c>

00:49:20.394 --> 00:49:22.963
<c.magenta>对网页来说</c>
<c.magenta>类似于NSUserActivity</c>

00:49:25.699 --> 00:49:29.303
<c.magenta>我们讲了现有API中</c>
<c.magenta>新的使用案例</c>

00:49:29.369 --> 00:49:32.339
<c.magenta>以及全新的UIKit API</c>

00:49:33.106 --> 00:49:38.178
<c.magenta>来帮助我们让系统了解</c>
<c.magenta>何时提升位置</c>

00:49:40.113 --> 00:49:43.717
<c.magenta>之后说到了MPContent</c>
<c.magenta>MPPlayableContentManager</c>

00:49:44.484 --> 00:49:47.287
<c.magenta>如果你是媒体应用</c>
<c.magenta>那这就尤为相关</c>

00:49:48.655 --> 00:49:51.825
<c.magenta>希望今天大家都清楚地知道</c>

00:49:51.892 --> 00:49:55.262
<c.magenta>这些API易于采用</c>
<c.magenta>并且容易测试</c>

00:49:57.764 --> 00:50:01.001
<c.magenta>在网上可以获取更多的信息</c>

00:49:57.764 --> 00:50:01.001
<c.magenta>在网上可以获取更多的信息</c>

00:50:01.902 --> 00:50:04.538
<c.magenta>以及一些精彩的相关会议</c>

00:50:04.938 --> 00:50:07.808
<c.magenta>如果还没有看的话</c>
<c.magenta>你应该去看看</c>

00:50:08.809 --> 00:50:11.311
<c.magenta>这里有很多</c>
<c.magenta>与SiriKit相关的工作</c>

00:50:11.879 --> 00:50:15.382
<c.magenta>有很多与搜索API相关的工作</c>
<c.magenta>大家今天都看过了</c>

00:50:16.016 --> 00:50:19.586
<c.magenta>以及过去两年来的</c>
<c.magenta>一些先前的会议</c>

00:50:19.653 --> 00:50:23.624
<c.magenta>围绕Handoff和</c>
<c.magenta>上述的搜索API</c>

00:50:24.124 --> 00:50:29.229
<c.magenta>最后我在结尾说一下</c>
<c.magenta>这个领域</c>

00:50:29.296 --> 00:50:33.033
<c.magenta>我们公司会继续投入下去的</c>

00:50:34.067 --> 00:50:38.138
<c.magenta>我们需要各位开发者所做的事</c>

00:50:38.205 --> 00:50:42.209
<c.magenta>就是告知我们</c>
<c.magenta>你们应用的功能</c>

00:50:42.976 --> 00:50:45.412
<c.magenta>以尽可能最详细的方式</c>

00:50:46.413 --> 00:50:49.449
<c.magenta>因为从根本上讲</c>
<c.magenta>我们越了解你的应用</c>

00:50:49.583 --> 00:50:52.553
<c.magenta>我们就越清楚</c>
<c.magenta>何时是推荐的最佳时机</c>

00:50:53.353 --> 00:50:55.322
<c.magenta>所以今天你看到了</c>

00:50:55.389 --> 00:51:00.627
<c.magenta>很多不同的情况中</c>
<c.magenta>语义细节是不同层次的</c>

00:50:55.389 --> 00:51:00.627
<c.magenta>很多不同的情况中</c>
<c.magenta>语义细节是不同层次的</c>

00:51:00.694 --> 00:51:03.997
<c.magenta>你可以将活动或</c>
<c.magenta>文本域注释进去</c>

00:51:04.565 --> 00:51:06.567
<c.magenta>我会尽可能多地鼓励你</c>

00:51:07.267 --> 00:51:10.637
<c.magenta>当你做的时候</c>
<c.magenta>要尽可能地外显出来</c>

00:51:10.704 --> 00:51:13.540
<c.magenta>不仅支持我们今天讨论的功能</c>

00:51:13.607 --> 00:51:17.044
<c.magenta>同样让你的应用处在</c>
<c.magenta>优势位置面向未来</c>

00:51:21.615 --> 00:51:23.016
<c.magenta>感谢大家今天的到来</c>

00:51:23.083 --> 00:51:26.753
<c.magenta>祝愿大家在WWDC和周五过得愉快</c>

00:51:27.354 --> 00:51:28.188
<c.magenta>再见</c>

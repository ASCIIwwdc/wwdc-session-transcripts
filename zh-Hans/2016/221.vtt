WEBVTT

00:00:19.486 --> 00:00:24.491
<c.magenta>优化按需加载资源</c>

00:00:25.859 --> 00:00:28.228
<c.magenta>欢迎来到优化按需加载资源</c>

00:00:28.295 --> 00:00:31.064
<c.magenta>我是tvOS工程师团队</c>
<c.magenta>的Bill Bumgarner</c>

00:00:32.766 --> 00:00:37.337
<c.magenta>在这个演讲上 在去年的WWDC上</c>

00:00:37.404 --> 00:00:39.506
<c.magenta>在这一年的开发者厨房</c>

00:00:39.573 --> 00:00:42.709
<c.magenta>我们已经讲了如何使用按需加载资源</c>

00:00:43.010 --> 00:00:44.611
<c.magenta>本场演讲中 我们想要关注在</c>

00:00:44.678 --> 00:00:47.748
<c.magenta>如何优化资源的使用 特别是</c>

00:00:47.814 --> 00:00:50.417
<c.magenta>如何打磨用户体验 来真正地创造</c>

00:00:50.484 --> 00:00:52.653
<c.magenta>一个极好的用户体验</c>

00:00:53.053 --> 00:00:56.190
<c.magenta>我们来看一下这些动机的一个基本概况</c>

00:00:56.256 --> 00:00:59.593
<c.magenta>如何指定标签 API的使用</c>

00:00:59.660 --> 00:01:02.396
<c.magenta>然后讲一下如何优化首次启动</c>

00:00:59.660 --> 00:01:02.396
<c.magenta>然后讲一下如何优化首次启动</c>

00:01:02.462 --> 00:01:05.799
<c.magenta>如何优化运行中的用户体验</c>

00:01:05.866 --> 00:01:08.235
<c.magenta>同时也会讲一下优化应用更新</c>

00:01:08.302 --> 00:01:10.771
<c.magenta>和一些实现的细节</c>

00:01:13.674 --> 00:01:15.709
<c.magenta>所以为什么</c>

00:01:15.776 --> 00:01:17.878
<c.magenta>为什么要按需加载资源</c>

00:01:17.945 --> 00:01:20.914
<c.magenta>对于一个传统的应用程序</c>

00:01:20.981 --> 00:01:24.518
<c.magenta>它是由应用程序的二进制值</c>
<c.magenta>和一堆资源所构成的</c>

00:01:24.585 --> 00:01:26.720
<c.magenta>这些一起组成了应用束</c>

00:01:27.054 --> 00:01:29.423
<c.magenta>它被组合在一起 上传到商店</c>

00:01:30.123 --> 00:01:32.893
<c.magenta>你们的用户可以下载并安装它</c>

00:01:32.960 --> 00:01:36.363
<c.magenta>慢慢地 他们会下载和安装一堆的应用</c>

00:01:37.231 --> 00:01:39.867
<c.magenta>但是如果你看一下这些应用的使用模式</c>

00:01:39.933 --> 00:01:45.405
<c.magenta>我们会发现</c>
<c.magenta>只有一部分的资源被经常用到</c>

00:01:45.806 --> 00:01:47.641
<c.magenta>另外一些资源可能只被用了一次</c>

00:01:47.708 --> 00:01:49.710
<c.magenta>在程序介绍或类似的其它地方</c>

00:01:50.844 --> 00:01:53.280
<c.magenta>而这会导致占用大量的磁盘空间</c>

00:01:53.914 --> 00:01:56.250
<c.magenta>这也意味着</c>
<c.magenta>用户不得不在一定程度上思考</c>

00:01:56.316 --> 00:01:58.418
<c.magenta>关于什么是他们要保留什么的</c>
<c.magenta>什么是不要保留的</c>

00:01:58.485 --> 00:02:01.355
<c.magenta>我们不想让我们的用户变成系统管理员</c>

00:01:58.485 --> 00:02:01.355
<c.magenta>我们不想让我们的用户变成系统管理员</c>

00:02:03.056 --> 00:02:06.226
<c.magenta>所以在按需资源应用中</c>
<c.magenta>我们想要尝试优化的是</c>

00:02:06.293 --> 00:02:08.895
<c.magenta>优化资源的使用</c>

00:02:08.961 --> 00:02:11.365
<c.magenta>在它被使用的时候</c>

00:02:11.431 --> 00:02:14.768
<c.magenta>同时保证它是可得的 早于用户注意到</c>

00:02:14.835 --> 00:02:16.036
<c.magenta>它需要被下载</c>

00:02:17.104 --> 00:02:20.941
<c.magenta>所以在传统应用的基础上 我们把资源</c>

00:02:21.008 --> 00:02:24.678
<c.magenta>分成绑定的资源和按需加载资源</c>

00:02:24.745 --> 00:02:28.215
<c.magenta>它们不是真的存在于系统里</c>
<c.magenta>当应用被安装的时候</c>

00:02:29.183 --> 00:02:33.420
<c.magenta>现在 在过去的一年中</c>
<c.magenta>有一些错误的概念</c>

00:02:33.487 --> 00:02:35.889
<c.magenta>关于tvOS应用的大小</c>

00:02:36.924 --> 00:02:40.661
<c.magenta>有一种说法是</c>
<c.magenta>我们把它限制在200MB以内</c>

00:02:40.727 --> 00:02:41.929
<c.magenta>这不是真的</c>

00:02:42.496 --> 00:02:48.268
<c.magenta>tvOS上主程序集限制是200MB</c>
<c.magenta>而对于iOS</c>

00:02:48.335 --> 00:02:51.138
<c.magenta>它可以最大到4GB</c>
<c.magenta>无论如何 在这两种系统中</c>

00:02:51.205 --> 00:02:54.308
<c.magenta>它们的按需加载资源可以达到20GB</c>

00:02:56.276 --> 00:02:58.345
<c.magenta>所以按需资源</c>

00:02:58.912 --> 00:03:03.317
<c.magenta>它们提供了动态加载的内容</c>
<c.magenta>它可以按需提供</c>

00:02:58.912 --> 00:03:03.317
<c.magenta>它们提供了动态加载的内容</c>
<c.magenta>它可以按需提供</c>

00:03:03.383 --> 00:03:05.586
<c.magenta>或者可以在应用安装时被下载</c>

00:03:06.753 --> 00:03:10.691
<c.magenta>它是托管在App Store上的</c>
<c.magenta>包括托管不同版本</c>

00:03:10.757 --> 00:03:12.960
<c.magenta>所以升级不是问题</c>

00:03:13.026 --> 00:03:16.029
<c.magenta>显然若你有一个用户坚持使用旧版本</c>
<c.magenta>它还是能工作的</c>

00:03:18.065 --> 00:03:20.534
<c.magenta>它们在程序安装过程中是可以下载的</c>

00:03:20.601 --> 00:03:24.104
<c.magenta>在运行的时候 如果有请求</c>
<c.magenta>它们也是可以下载的</c>

00:03:24.605 --> 00:03:27.474
<c.magenta>而且你可以控制下载的优先级</c>

00:03:27.541 --> 00:03:29.343
<c.magenta>而且你可以调整优先级</c>

00:03:29.409 --> 00:03:31.845
<c.magenta>因为用户可能改变他们的想法</c>

00:03:31.912 --> 00:03:33.046
<c.magenta>去做他们想做的事情</c>

00:03:34.348 --> 00:03:36.917
<c.magenta>同时 所以这些和系统一起</c>

00:03:36.984 --> 00:03:40.854
<c.magenta>提供了智能的内容缓存和智能清理</c>

00:03:41.588 --> 00:03:45.092
<c.magenta>这样 我们就让用户远离了</c>
<c.magenta>系统管理的工作</c>

00:03:45.392 --> 00:03:49.596
<c.magenta>对于你的的应用来说 好处是变小了</c>

00:03:50.130 --> 00:03:52.032
<c.magenta>这意味着它更快了和加速了下载</c>

00:03:52.099 --> 00:03:55.736
<c.magenta>意味着这个时间间隔变短了</c>
<c.magenta>在用户点击购买按钮和</c>

00:03:55.802 --> 00:03:57.371
<c.magenta>用户使用你的程序之间</c>

00:03:59.072 --> 00:04:03.210
<c.magenta>而且 你有更为丰富的应用内容</c>
<c.magenta>最高可达20GB</c>

00:03:59.072 --> 00:04:03.210
<c.magenta>而且 你有更为丰富的应用内容</c>
<c.magenta>最高可达20GB</c>

00:04:03.277 --> 00:04:05.179
<c.magenta>这可是很大的空间哦</c>

00:04:07.214 --> 00:04:10.217
<c.magenta>而且 那样就可在系统中装更多的应用</c>

00:04:10.284 --> 00:04:14.521
<c.magenta>它们都是可以运行的</c>
<c.magenta>而且减少了管理存储的需求</c>

00:04:14.721 --> 00:04:16.822
<c.magenta>这也意味着用户可以拍很多的照片</c>

00:04:16.890 --> 00:04:19.091
<c.magenta>一部分按需加载资源可能被释放出来</c>

00:04:19.159 --> 00:04:20.494
<c.magenta>这都是完全自动的</c>

00:04:22.329 --> 00:04:24.998
<c.magenta>那么我们如何来实现这个呢？</c>
<c.magenta>我们如何采用这个呢</c>

00:04:25.065 --> 00:04:28.302
<c.magenta>你要做的第一件事是要指定标签</c>

00:04:28.368 --> 00:04:31.405
<c.magenta>给所有的资源 你实现这个通过寻找</c>

00:04:31.471 --> 00:04:34.074
<c.magenta>在程序中 找出所有的资源</c>

00:04:34.141 --> 00:04:37.044
<c.magenta>找出每个资源在你的应用中的角色</c>

00:04:37.477 --> 00:04:38.645
<c.magenta>和你需要它们的时间</c>

00:04:40.113 --> 00:04:42.416
<c.magenta>然后在Xcode中指定标签</c>

00:04:42.482 --> 00:04:43.784
<c.magenta>标签一点儿都不神奇</c>

00:04:43.851 --> 00:04:45.085
<c.magenta>它们只是字符串</c>

00:04:46.453 --> 00:04:50.023
<c.magenta>只是一些你想要的字符串</c>
<c.magenta>第一级 任意东西</c>

00:04:50.891 --> 00:04:52.726
<c.magenta>它们可以被应用于单独的资产</c>

00:04:52.793 --> 00:04:58.632
<c.magenta>或者一个单独的资源 一个声音文件</c>
<c.magenta>一个纹理 一张图片 无论什么东西</c>

00:04:58.699 --> 00:05:01.902
<c.magenta>纯数据</c>
<c.magenta>或者它们可以被指定给整个文件夹</c>

00:04:58.699 --> 00:05:01.902
<c.magenta>纯数据</c>
<c.magenta>或者它们可以被指定给整个文件夹</c>

00:05:02.769 --> 00:05:05.205
<c.magenta>而且 每个资源可以有多个标签</c>

00:05:05.272 --> 00:05:07.074
<c.magenta>因为它有可能有多个角色</c>

00:05:08.609 --> 00:05:10.944
<c.magenta>让我们回过头</c>
<c.magenta>看看GreatGame这个应用</c>

00:05:11.011 --> 00:05:13.547
<c.magenta>看一下那些资源</c>

00:05:13.614 --> 00:05:15.916
<c.magenta>把这些资源按照角色分类</c>

00:05:16.450 --> 00:05:19.520
<c.magenta>在这个例子中</c>
<c.magenta>这是一个非常明了的基于级别的应用</c>

00:05:21.021 --> 00:05:23.390
<c.magenta>而且它有总是需要的资源</c>

00:05:23.457 --> 00:05:25.392
<c.magenta>这些就是 比如你的启动页面</c>

00:05:25.459 --> 00:05:27.294
<c.magenta>你的启动加载页面 或者是设置页面</c>

00:05:27.361 --> 00:05:28.362
<c.magenta>这一类的东西</c>

00:05:28.428 --> 00:05:32.499
<c.magenta>它有给每一级别提供的资源</c>

00:05:32.966 --> 00:05:36.637
<c.magenta>或者购买项目或者应用内购买的东西</c>

00:05:38.138 --> 00:05:40.474
<c.magenta>对于这些标签 是非常直接明了的</c>

00:05:40.541 --> 00:05:42.609
<c.magenta>只要给他们和它们角色一样的名字就行</c>

00:05:44.912 --> 00:05:47.648
<c.magenta>所以当我们做这些 当我们看这些时</c>

00:05:47.714 --> 00:05:49.917
<c.magenta>我们给这些东西打标签的策略是什么呢</c>

00:05:49.983 --> 00:05:52.853
<c.magenta>只要给主程序集的资源</c>

00:05:52.920 --> 00:05:56.156
<c.magenta>那些程序始终确实需要的资源</c>

00:05:56.924 --> 00:05:59.459
<c.magenta>你的加载页面</c>
<c.magenta>你的程序启动页面 这类东西</c>

00:06:00.861 --> 00:06:04.631
<c.magenta>然后你给另外所有的东西打上标签</c>

00:06:05.432 --> 00:06:09.403
<c.magenta>每个标签可被应用在最多512MB的</c>

00:06:09.503 --> 00:06:11.138
<c.magenta>资产或者资源</c>

00:06:11.572 --> 00:06:15.309
<c.magenta>然而 我们强烈建议你</c>
<c.magenta>遵循64MB左右的限制</c>

00:06:15.375 --> 00:06:18.111
<c.magenta>因为那样会使下载更快</c>

00:06:18.178 --> 00:06:20.013
<c.magenta>而且让用户更加不易察觉</c>

00:06:20.881 --> 00:06:23.750
<c.magenta>每个资源可以都多个标签</c>

00:06:24.218 --> 00:06:26.887
<c.magenta>只要你用了其中的一个标签</c>

00:06:26.954 --> 00:06:29.890
<c.magenta>就会提取所有对应的资源</c>

00:06:31.391 --> 00:06:34.962
<c.magenta>所有我们已将所有东西归类并打上标签</c>

00:06:35.028 --> 00:06:36.730
<c.magenta>让我们看一下运行时的情况</c>

00:06:38.131 --> 00:06:41.568
<c.magenta>在运行时 我们尝试让API尽量简单</c>

00:06:41.869 --> 00:06:44.071
<c.magenta>实际上 这只是一个类</c>

00:06:44.638 --> 00:06:47.074
<c.magenta>有一个资源请求类</c>

00:06:47.674 --> 00:06:51.678
<c.magenta>你要创建这个类的一个实例来管理所有</c>

00:06:51.745 --> 00:06:53.413
<c.magenta>按需加载资源的读取</c>

00:06:53.914 --> 00:06:56.717
<c.magenta>它通过一个标签或者一组标签来创建</c>

00:06:56.783 --> 00:06:58.785
<c.magenta>而且它有一些其它的选项来管理它</c>

00:06:59.686 --> 00:07:03.023
<c.magenta>你可以用它来开始和结束资源的访问</c>

00:06:59.686 --> 00:07:03.023
<c.magenta>你可以用它来开始和结束资源的访问</c>

00:07:03.090 --> 00:07:06.426
<c.magenta>开始访问会触发下载 如果需要</c>

00:07:06.793 --> 00:07:09.429
<c.magenta>结束访问会告诉系统 嘿 我结束啦</c>

00:07:10.364 --> 00:07:12.799
<c.magenta>在这个对象中 你也可以设定优先级</c>

00:07:12.866 --> 00:07:16.270
<c.magenta>如果你有一个特别大的下载</c>
<c.magenta>或者一个特别慢的网络连接</c>

00:07:16.336 --> 00:07:20.174
<c.magenta>你可以追踪进度</c>
<c.magenta>而且也有可能会遇到错误</c>

00:07:20.707 --> 00:07:22.342
<c.magenta>我们马上会降到</c>

00:07:22.409 --> 00:07:23.911
<c.magenta>关于这个类有一个有趣的东西是</c>

00:07:23.977 --> 00:07:25.879
<c.magenta>每一个实例都是一次性的</c>

00:07:25.946 --> 00:07:28.215
<c.magenta>它们是非常轻量级的 非常容易被创建</c>

00:07:28.282 --> 00:07:32.252
<c.magenta>这意味着当你创建一个实例</c>
<c.magenta>开始访问它</c>

00:07:32.319 --> 00:07:35.088
<c.magenta>在你调用结束访问之后</c>
<c.magenta>这个对象就完了</c>

00:07:35.489 --> 00:07:36.323
<c.magenta>创建一个新的</c>

00:07:39.026 --> 00:07:43.096
<c.magenta>有一个非常重要需要记住的概念是</c>

00:07:43.163 --> 00:07:47.701
<c.magenta>请求和访问是不关联的</c>

00:07:48.535 --> 00:07:52.406
<c.magenta>所有当你请求</c>

00:07:52.472 --> 00:07:54.675
<c.magenta>从当你要使用这个资源时</c>
<c.magenta>我们是可以的</c>

00:07:54.741 --> 00:07:56.543
<c.magenta>我们会在预测加载讲这些</c>

00:07:56.610 --> 00:07:58.312
<c.magenta>所有我们可以预测用户将要干什么</c>

00:07:58.378 --> 00:08:00.447
<c.magenta>来保证他们永远不会看到那些加载界面</c>

00:07:58.378 --> 00:08:00.447
<c.magenta>来保证他们永远不会看到那些加载界面</c>

00:08:01.849 --> 00:08:03.617
<c.magenta>让我们来看一下真实的代码</c>

00:08:05.752 --> 00:08:08.922
<c.magenta>初始化一批资源请求是相当直接的</c>

00:08:08.989 --> 00:08:12.092
<c.magenta>只要给它一组标签</c>
<c.magenta>然后你就有你的请求了</c>

00:08:12.659 --> 00:08:15.028
<c.magenta>如果你想要开始访问那些标签</c>

00:08:15.095 --> 00:08:18.365
<c.magenta>调用开始访问 它有一个完成句柄</c>

00:08:18.432 --> 00:08:20.767
<c.magenta>那个完成句柄会被错误地调用</c>

00:08:20.834 --> 00:08:23.036
<c.magenta>如果有错误的话 或者它会被正确调用</c>

00:08:23.103 --> 00:08:24.938
<c.magenta>那么你的资源就是可利用的了</c>

00:08:25.606 --> 00:08:28.742
<c.magenta>为了得到资源 使用包API</c>

00:08:28.809 --> 00:08:31.311
<c.magenta>抓住一个NS包实例 对不起</c>

00:08:31.378 --> 00:08:34.815
<c.magenta>包实例 重命名 从请求中</c>

00:08:34.881 --> 00:08:38.085
<c.magenta>只要使用正常的资源请求方法</c>

00:08:38.150 --> 00:08:39.753
<c.magenta>于包 来控制它</c>

00:08:41.355 --> 00:08:44.358
<c.magenta>当你结束了之后</c>
<c.magenta>调用结束访问是非常重要的</c>

00:08:44.424 --> 00:08:47.060
<c.magenta>这告诉了系统你已经用完了这个资源</c>

00:08:47.127 --> 00:08:48.862
<c.magenta>需要重点指出的是 那不意味着</c>

00:08:48.929 --> 00:08:51.365
<c.magenta>系统就会真的删除资源</c>

00:08:51.431 --> 00:08:53.333
<c.magenta>系统是非常懒惰的</c>

00:08:53.400 --> 00:08:56.537
<c.magenta>它们不想做额外的工作</c>
<c.magenta>删除东西的额外工作</c>

00:08:58.038 --> 00:09:02.409
<c.magenta>所以当你加载资源的时候</c>
<c.magenta>你可以控制优先级</c>

00:08:58.038 --> 00:09:02.409
<c.magenta>所以当你加载资源的时候</c>
<c.magenta>你可以控制优先级</c>

00:09:02.476 --> 00:09:04.711
<c.magenta>比如 你要在玩一个游戏</c>

00:09:04.778 --> 00:09:06.246
<c.magenta>用户改变了他们的想法</c>

00:09:06.313 --> 00:09:07.915
<c.magenta>你就下载这个级别的资源</c>

00:09:07.981 --> 00:09:09.516
<c.magenta>现在你需要下载级别5</c>

00:09:10.217 --> 00:09:11.952
<c.magenta>你开始于开始访问</c>

00:09:12.019 --> 00:09:13.987
<c.magenta>你可以继续 你可以改变加载优先级</c>

00:09:14.054 --> 00:09:18.325
<c.magenta>来把优先级提到5级或者降到3级</c>

00:09:18.392 --> 00:09:20.561
<c.magenta>如果你觉得他们可能返回</c>
<c.magenta>或者你可以结束它</c>

00:09:21.562 --> 00:09:23.530
<c.magenta>它只是一个值 从0到1</c>

00:09:23.931 --> 00:09:26.600
<c.magenta>但是有特别紧急的优先级</c>

00:09:27.501 --> 00:09:30.771
<c.magenta>有时候 会播放器会关闭</c>

00:09:30.838 --> 00:09:33.140
<c.magenta>而你又无法预测</c>

00:09:33.407 --> 00:09:36.143
<c.magenta>你需要立即下载所有东西</c>

00:09:36.510 --> 00:09:40.747
<c.magenta>在这种情况下</c>
<c.magenta>这种特别紧急的加载优先级</c>

00:09:40.814 --> 00:09:41.882
<c.magenta>就能被用到了</c>

00:09:41.949 --> 00:09:43.817
<c.magenta>它会挂起所有其它的下载</c>

00:09:44.284 --> 00:09:46.220
<c.magenta>也会最大化吞吐量</c>

00:09:46.286 --> 00:09:47.754
<c.magenta>所有没有网络节流</c>

00:09:48.255 --> 00:09:51.692
<c.magenta>也会最大化中央处理器使用</c>
<c.magenta>专门用于下载</c>

00:09:54.995 --> 00:09:57.397
<c.magenta>最后 会有有条件请求</c>

00:09:57.631 --> 00:10:00.367
<c.magenta>有条件请求可以用来检查</c>

00:09:57.631 --> 00:10:00.367
<c.magenta>有条件请求可以用来检查</c>

00:10:00.434 --> 00:10:02.536
<c.magenta>资源是否已经被下载</c>

00:10:03.203 --> 00:10:05.973
<c.magenta>如果你还记得在我说结束访问的时候</c>

00:10:06.039 --> 00:10:08.542
<c.magenta>不一定要删除资源</c>

00:10:09.443 --> 00:10:11.178
<c.magenta>播放器已经在玩一个游戏</c>

00:10:11.245 --> 00:10:13.180
<c.magenta>他们已经玩过了1 2 3 级</c>

00:10:13.247 --> 00:10:15.549
<c.magenta>你已经结束对1 2 3级别的访问</c>

00:10:16.617 --> 00:10:18.652
<c.magenta>他们退出游戏</c>
<c.magenta>下线后再做了其它一些事情</c>

00:10:18.719 --> 00:10:20.354
<c.magenta>当他们回来 重启游戏</c>

00:10:20.854 --> 00:10:22.589
<c.magenta>他们想要重玩1级</c>

00:10:22.956 --> 00:10:24.591
<c.magenta>你可以有条件地使用</c>

00:10:24.658 --> 00:10:27.327
<c.magenta>或者说他们想要选择不同的级别</c>

00:10:27.394 --> 00:10:30.130
<c.magenta>你可以条件地使用开始访问</c>

00:10:30.531 --> 00:10:32.065
<c.magenta>来检查什么级别已经被下载了</c>

00:10:32.132 --> 00:10:34.902
<c.magenta>给它们指示什么已经可以玩了</c>

00:10:35.302 --> 00:10:37.171
<c.magenta>或者如果它们进入了一个级别</c>

00:10:37.237 --> 00:10:40.040
<c.magenta>在每个级别中</c>
<c.magenta>你已按照角色分解你的资源</c>

00:10:40.107 --> 00:10:42.176
<c.magenta>可能你优化了级别的第一部分</c>

00:10:42.242 --> 00:10:45.112
<c.magenta>只是展示数和刷子和敌人</c>

00:10:45.179 --> 00:10:47.548
<c.magenta>正好那个时候在磁盘上</c>

00:10:47.614 --> 00:10:49.850
<c.magenta>当你在后台下载余下的部分</c>

00:10:50.450 --> 00:10:52.219
<c.magenta>所以所有都是关于你可以</c>

00:10:52.286 --> 00:10:54.454
<c.magenta>避免加载页面</c>

00:10:56.490 --> 00:11:00.727
<c.magenta>如果这些项目已经被下载了</c>
<c.magenta>那就会像开始访问一样地工作</c>

00:10:56.490 --> 00:11:00.727
<c.magenta>如果这些项目已经被下载了</c>
<c.magenta>那就会像开始访问一样地工作</c>

00:11:02.095 --> 00:11:04.865
<c.magenta>同样 需要调用介绍访问</c>

00:11:04.932 --> 00:11:08.702
<c.magenta>就算你得到回调 那它也是假的</c>

00:11:08.769 --> 00:11:11.371
<c.magenta>你决定不去触发下载</c>

00:11:11.438 --> 00:11:12.840
<c.magenta>总是调用结束访问</c>

00:11:14.942 --> 00:11:18.078
<c.magenta>现在你有了一个可以工作的程序</c>

00:11:22.749 --> 00:11:24.384
<c.magenta>但是让我们看一下首次启动</c>

00:11:26.787 --> 00:11:28.822
<c.magenta>特别看一下这个时间轴</c>

00:11:29.823 --> 00:11:31.491
<c.magenta>我们会沿着时间轴</c>

00:11:32.226 --> 00:11:35.729
<c.magenta>从用户在商场中</c>
<c.magenta>购买这个应用的那一刻开始</c>

00:11:35.796 --> 00:11:37.631
<c.magenta>应用被下载 被安装</c>

00:11:38.765 --> 00:11:41.468
<c.magenta>和第一次启动</c>
<c.magenta>然后我们需要做的事情</c>

00:11:41.535 --> 00:11:44.471
<c.magenta>我们要做的第一件事 开始访问1级</c>

00:11:44.771 --> 00:11:47.941
<c.magenta>这会触发一个下载</c>
<c.magenta>然后播放器开始这个游戏</c>

00:11:48.575 --> 00:11:52.079
<c.magenta>然后到达2级 我们也是开始访问</c>

00:11:52.312 --> 00:11:53.981
<c.magenta>它会下载 用户在那等待</c>

00:11:54.081 --> 00:11:56.483
<c.magenta>用户继续玩 重复这个流程</c>

00:11:56.550 --> 00:11:59.052
<c.magenta>3级 下载 等待 玩游戏</c>

00:11:59.987 --> 00:12:03.023
<c.magenta>甚至对于可购买的项目 程序内购买</c>

00:11:59.987 --> 00:12:03.023
<c.magenta>甚至对于可购买的项目 程序内购买</c>

00:12:03.423 --> 00:12:05.125
<c.magenta>下载 等待 玩游戏</c>

00:12:07.060 --> 00:12:09.630
<c.magenta>这不是一个好的用户体验</c>

00:12:10.664 --> 00:12:13.534
<c.magenta>让用户经常地看到加载页面</c>
<c.magenta>这是不行的</c>

00:12:13.600 --> 00:12:14.635
<c.magenta>我们不想这个样子</c>

00:12:14.968 --> 00:12:16.336
<c.magenta>所以我们要做的第一是</c>

00:12:16.403 --> 00:12:19.206
<c.magenta>充分利用功能和按需加载资源</c>

00:12:19.706 --> 00:12:23.510
<c.magenta>这是自带的功能 来优化首次启动</c>

00:12:23.577 --> 00:12:27.247
<c.magenta>我们要做的第一是使用初始安装标签</c>

00:12:28.282 --> 00:12:30.984
<c.magenta>接下来我们要使用的是预获取标签</c>

00:12:33.220 --> 00:12:34.755
<c.magenta>有了这些</c>

00:12:35.055 --> 00:12:38.926
<c.magenta>那么1级会在应用购买的时候</c>
<c.magenta>被下载和安装</c>

00:12:39.426 --> 00:12:42.496
<c.magenta>2级会紧跟着被下载和安装</c>

00:12:42.896 --> 00:12:45.666
<c.magenta>用户可以开始玩了</c>

00:12:47.067 --> 00:12:49.169
<c.magenta>让我们看一下预测下载</c>

00:12:49.236 --> 00:12:51.038
<c.magenta>但先看一下</c>

00:12:51.104 --> 00:12:53.040
<c.magenta>如何配置初始预提取</c>

00:12:54.274 --> 00:12:57.344
<c.magenta>所以初始安装标签</c>

00:12:57.411 --> 00:13:01.081
<c.magenta>这些在Xcode中</c>
<c.magenta>被标记的标签需要被下载</c>

00:12:57.411 --> 00:13:01.081
<c.magenta>这些在Xcode中</c>
<c.magenta>被标记的标签需要被下载</c>

00:13:01.148 --> 00:13:03.450
<c.magenta>作为出程序安装的一部分</c>

00:13:04.084 --> 00:13:07.387
<c.magenta>最多可以有多达2GB的资源</c>
<c.magenta>这是很多的</c>

00:13:08.488 --> 00:13:11.358
<c.magenta>这是在App Store上</c>
<c.magenta>显示的程序大小的一部分 实际上</c>

00:13:11.425 --> 00:13:13.994
<c.magenta>当下载进度条开始的时候</c>

00:13:14.061 --> 00:13:16.930
<c.magenta>表明初始安装标签也开始了</c>

00:13:18.098 --> 00:13:20.400
<c.magenta>预提取标签是稍有不同的</c>

00:13:20.934 --> 00:13:23.470
<c.magenta>你可以有任意多的预提取标签</c>

00:13:23.537 --> 00:13:27.307
<c.magenta>最高可达4GB减去初始安装的大小</c>

00:13:28.308 --> 00:13:30.477
<c.magenta>它会遵循Xcode中指定的一个排序</c>

00:13:30.911 --> 00:13:34.615
<c.magenta>预提取标签在初始化之后立即被下载</c>

00:13:35.249 --> 00:13:36.884
<c.magenta>它们不会阻止应用的启动</c>

00:13:37.651 --> 00:13:40.687
<c.magenta>所以用户可以进入游戏并开始玩了</c>

00:13:40.754 --> 00:13:43.257
<c.magenta>尽管预提取的东西在后台被下载下来</c>

00:13:44.291 --> 00:13:45.726
<c.magenta>在Xcode中</c>

00:13:46.894 --> 00:13:48.862
<c.magenta>用户界面是这个样子的</c>

00:13:48.929 --> 00:13:53.400
<c.magenta>这是资源标签检查器 在目标编辑器内</c>

00:13:53.467 --> 00:13:54.635
<c.magenta>对于你的应用</c>

00:13:55.002 --> 00:13:57.671
<c.magenta>它有三部分 初始 预提取</c>

00:13:57.738 --> 00:13:59.640
<c.magenta>和按需标签的下载</c>

00:14:00.207 --> 00:14:01.208
<c.magenta>你一开始移动这些东西</c>

00:14:01.275 --> 00:14:04.011
<c.magenta>这些会和你的应用一起打包</c>

00:14:04.077 --> 00:14:05.779
<c.magenta>同时被安装</c>

00:14:06.713 --> 00:14:10.317
<c.magenta>预提取</c>
<c.magenta>会按照你在屏幕上看到的顺序被下载</c>

00:14:11.051 --> 00:14:13.453
<c.magenta>最后 按需的下载</c>

00:14:13.720 --> 00:14:17.591
<c.magenta>是只有你开始访问那些标签的时候</c>
<c.magenta>才被下载</c>

00:14:19.960 --> 00:14:21.495
<c.magenta>回到我们的时间轴</c>

00:14:21.795 --> 00:14:23.664
<c.magenta>我们非常简略地讲过预测加载</c>

00:14:23.730 --> 00:14:25.165
<c.magenta>那这到底是什么意思呢？</c>

00:14:25.232 --> 00:14:27.000
<c.magenta>我们开始初始化</c>

00:14:27.301 --> 00:14:28.602
<c.magenta>得到我们的预提取</c>

00:14:28.669 --> 00:14:30.904
<c.magenta>我们仍然让我们在3级的时候在等待</c>

00:14:31.505 --> 00:14:35.676
<c.magenta>若我们开始访问3级标签对应的资源</c>

00:14:36.043 --> 00:14:37.845
<c.magenta>在1级或者2级的某些时候</c>

00:14:37.911 --> 00:14:41.949
<c.magenta>这样可能在用户到达那里的时候</c>
<c.magenta>那些资源就已被下载并能被使用了</c>

00:14:42.649 --> 00:14:44.218
<c.magenta>同样对于购买项目</c>

00:14:44.551 --> 00:14:49.022
<c.magenta>如果在你的应用 游戏 不管什么中</c>
<c.magenta>有一个特殊的时间点</c>

00:14:49.089 --> 00:14:52.125
<c.magenta>你认为有可能或者你希望玩家将要</c>

00:14:52.192 --> 00:14:55.562
<c.magenta>做一个程序内购买</c>
<c.magenta>那就在那里开始访问</c>

00:14:55.896 --> 00:14:58.298
<c.magenta>只有当你得到返回后 你才能访问它们</c>

00:14:58.365 --> 00:15:00.634
<c.magenta>但是至少它会在那里 不会有等待</c>

00:14:58.365 --> 00:15:00.634
<c.magenta>但是至少它会在那里 不会有等待</c>

00:15:00.734 --> 00:15:04.438
<c.magenta>现在我们得到一个大的绿色时间轴</c>
<c.magenta>和一个非常高兴的用户</c>

00:15:06.173 --> 00:15:09.743
<c.magenta>我们已经讨论了这个基于层级的游戏</c>

00:15:10.344 --> 00:15:12.212
<c.magenta>这是一个非常线性访问的模式</c>

00:15:12.746 --> 00:15:14.815
<c.magenta>它非常容易创建漂亮的幻灯片</c>

00:15:14.882 --> 00:15:16.016
<c.magenta>这不是真实的世界</c>

00:15:17.384 --> 00:15:21.555
<c.magenta>在一个线性访问模式中</c>
<c.magenta>大部分资产会被使用</c>

00:15:21.622 --> 00:15:23.524
<c.magenta>它们大部分会被按照顺序地使用</c>

00:15:23.924 --> 00:15:26.460
<c.magenta>你的标签大小不是那么得关键</c>

00:15:26.527 --> 00:15:30.330
<c.magenta>因为你始终可以在用户之前得到访问</c>

00:15:31.932 --> 00:15:35.035
<c.magenta>但是问题是 当然</c>

00:15:35.102 --> 00:15:36.537
<c.magenta>这里没有什么是线性的</c>

00:15:37.371 --> 00:15:38.639
<c.magenta>特别地</c>

00:15:38.705 --> 00:15:43.076
<c.magenta>很多时候 应用都是随机访问模式</c>

00:15:43.911 --> 00:15:45.712
<c.magenta>播放器可以播放任意一个地方</c>

00:15:45.779 --> 00:15:48.148
<c.magenta>或者有些东西可能被不同的级别所共享</c>

00:15:48.215 --> 00:15:50.784
<c.magenta>或者他们可能选择特定的配置</c>

00:15:50.851 --> 00:15:54.421
<c.magenta>或者他们可能购买了一些应用内购买项</c>
<c.magenta>在这种情况下</c>

00:15:54.488 --> 00:15:57.991
<c.magenta>目标是尽量多地预测</c>

00:15:58.058 --> 00:16:00.160
<c.magenta>尝试在用户需要之前把东西下载下来</c>

00:15:58.058 --> 00:16:00.160
<c.magenta>尝试在用户需要之前把东西下载下来</c>

00:16:00.227 --> 00:16:02.329
<c.magenta>但是在你需要下载的时候</c>

00:16:02.396 --> 00:16:04.164
<c.magenta>在那一刻真的需要时</c>

00:16:05.065 --> 00:16:07.100
<c.magenta>坚持小的标签组</c>

00:16:08.035 --> 00:16:10.571
<c.magenta>这样就会下载得很快</c>

00:16:11.205 --> 00:16:13.640
<c.magenta>而且你可以有前瞻性地下载标签组</c>

00:16:13.707 --> 00:16:16.710
<c.magenta>可以继续了 只是猜测什么将会被需要</c>

00:16:17.377 --> 00:16:20.047
<c.magenta>让它们就那样 下载到磁盘 因为</c>

00:16:20.113 --> 00:16:22.216
<c.magenta>当然 我们有这个智能缓存机制</c>

00:16:22.282 --> 00:16:25.752
<c.magenta>它会在后台运行 确保删除正确的东西</c>

00:16:25.819 --> 00:16:27.287
<c.magenta>如果磁盘满了的话</c>

00:16:28.488 --> 00:16:30.757
<c.magenta>再强调一遍 结束访问并不意味着删除</c>

00:16:30.824 --> 00:16:33.293
<c.magenta>如果你下线了</c>
<c.magenta>而且你提前下载了一些东西</c>

00:16:33.360 --> 00:16:34.828
<c.magenta>然后你根本不需要它 没关系</c>

00:16:34.895 --> 00:16:36.797
<c.magenta>只要结束访问 它可能还是在那里</c>

00:16:36.864 --> 00:16:39.633
<c.magenta>当你以后需要它的时候</c>

00:16:41.001 --> 00:16:43.670
<c.magenta>现在有另外一种模式</c>
<c.magenta>这是一种在两者之间的</c>

00:16:44.805 --> 00:16:46.807
<c.magenta>那是探索性访问模式</c>

00:16:47.174 --> 00:16:49.476
<c.magenta>那是...你想</c>

00:16:49.543 --> 00:16:52.012
<c.magenta>从一个村庄到另一个村庄类似的情况</c>

00:16:52.613 --> 00:16:54.848
<c.magenta>在这种情况下 存在有限的预测</c>

00:16:55.282 --> 00:16:57.317
<c.magenta>很多可能不会被使用</c>

00:16:58.585 --> 00:17:01.622
<c.magenta>但是你经常在一个分支上</c>
<c.magenta>当你在一个分支上的时候</c>

00:16:58.585 --> 00:17:01.622
<c.magenta>但是你经常在一个分支上</c>
<c.magenta>当你在一个分支上的时候</c>

00:17:01.688 --> 00:17:03.790
<c.magenta>你可以下载一个标签的子集</c>

00:17:03.857 --> 00:17:05.459
<c.magenta>用户左转 右转</c>

00:17:05.526 --> 00:17:07.560
<c.magenta>所以我要下载向左的标签和向右的标签</c>

00:17:07.627 --> 00:17:09.896
<c.magenta>当用户做出决定后</c>

00:17:10.464 --> 00:17:13.634
<c.magenta>打算向右</c>

00:17:13.700 --> 00:17:15.002
<c.magenta>让那个下载停止</c>

00:17:15.801 --> 00:17:18.571
<c.magenta>关注右边 开始预测下一步</c>

00:17:21.141 --> 00:17:23.877
<c.magenta>所以现在这个应用可以正常工作了</c>

00:17:23.944 --> 00:17:28.048
<c.magenta>我们得到了一个非常棒的用户体验</c>

00:17:29.049 --> 00:17:31.418
<c.magenta>但是让我们看一下一些实现的细节</c>

00:17:31.485 --> 00:17:33.353
<c.magenta>在页面的背后进行着的</c>

00:17:34.555 --> 00:17:37.991
<c.magenta>你可以关注一下以进一步优化用户体验</c>

00:17:41.828 --> 00:17:45.566
<c.magenta>特别地 正如我所说的 程序包</c>

00:17:45.799 --> 00:17:50.137
<c.magenta>在iOS上被限制为4GB</c>
<c.magenta>在tvOS上被限制为200MB</c>

00:17:50.204 --> 00:17:53.106
<c.magenta>但你可有多达20GB的按需加载资源</c>

00:17:53.173 --> 00:17:56.577
<c.magenta>它们中的最多2GB可以</c>
<c.magenta>和应用一起被下载和安装</c>

00:17:57.077 --> 00:18:01.882
<c.magenta>最多4GB可以被预提取</c>
<c.magenta>减去那2GB或者最多2GB的安装</c>

00:17:57.077 --> 00:18:01.882
<c.magenta>最多4GB可以被预提取</c>
<c.magenta>减去那2GB或者最多2GB的安装</c>

00:18:02.749 --> 00:18:05.018
<c.magenta>还有一些数据要记住</c>

00:18:06.353 --> 00:18:09.957
<c.magenta>同一时间最多可以有2GB的活动资源</c>

00:18:10.290 --> 00:18:13.660
<c.magenta>所以你开始访问最多2GB的标签</c>

00:18:14.228 --> 00:18:16.430
<c.magenta>那些会被下载 然后就是可用的</c>

00:18:16.496 --> 00:18:17.464
<c.magenta>这非常棒</c>

00:18:17.664 --> 00:18:20.267
<c.magenta>当你超过了2GB 会发生的是</c>

00:18:20.334 --> 00:18:25.038
<c.magenta>开始访问方法会得到一个NS错误</c>

00:18:25.105 --> 00:18:28.675
<c.magenta>这表示用完了带标签资源的空间</c>

00:18:28.909 --> 00:18:32.279
<c.magenta>你需要对一些标签集结束访问</c>

00:18:32.346 --> 00:18:35.382
<c.magenta>来释放一些空间</c>
<c.magenta>使得更多的资源能被访问</c>

00:18:35.749 --> 00:18:39.052
<c.magenta>重复这一点是</c>
<c.magenta>因为有另外一个困惑的地方</c>

00:18:39.820 --> 00:18:43.056
<c.magenta>如果你有2GB的已经下载好的标签</c>

00:18:43.490 --> 00:18:45.092
<c.magenta>而且你想要访问更多</c>

00:18:45.158 --> 00:18:48.295
<c.magenta>你访问其中的500MB</c>

00:18:48.362 --> 00:18:51.798
<c.magenta>固定另外的250MB</c>
<c.magenta>那500MB资源</c>

00:18:51.865 --> 00:18:53.800
<c.magenta>可能不会被删除</c>

00:18:53.967 --> 00:18:55.569
<c.magenta>它们还在而且是可用的</c>

00:18:55.636 --> 00:18:58.238
<c.magenta>但是这只是告诉系统</c>
<c.magenta>如果情况变得不好了</c>

00:18:58.305 --> 00:19:00.107
<c.magenta>它可以去删除它们</c>

00:18:58.305 --> 00:19:00.107
<c.magenta>它可以去删除它们</c>

00:19:01.775 --> 00:19:06.313
<c.magenta>任意一个标签 最多可以到512MB</c>
<c.magenta>尽量坚持64MB或者更小</c>

00:19:09.049 --> 00:19:12.019
<c.magenta>你已经有最多1000个资产包</c>

00:19:13.220 --> 00:19:16.890
<c.magenta>资产包是什么鬼呢 还没提过这个词</c>

00:19:17.991 --> 00:19:22.062
<c.magenta>资产包来自于Xcode编译系统</c>

00:19:22.129 --> 00:19:24.131
<c.magenta>这是你的应用生成和管理的方式</c>

00:19:24.198 --> 00:19:27.134
<c.magenta>这是按需下载资源被编译在一起的方式</c>

00:19:27.201 --> 00:19:28.969
<c.magenta>通过商店来管理</c>

00:19:30.170 --> 00:19:32.673
<c.magenta>看一下我们GreatGame</c>
<c.magenta>在这个情况中</c>

00:19:32.739 --> 00:19:34.708
<c.magenta>一个角色扮演游戏 这无所谓</c>

00:19:35.509 --> 00:19:39.112
<c.magenta>我们有标签 非常的典型</c>

00:19:39.847 --> 00:19:42.449
<c.magenta>资源会被重复使用</c>

00:19:42.516 --> 00:19:44.751
<c.magenta>东西会被使用在1级到2级</c>

00:19:44.952 --> 00:19:47.187
<c.magenta>敌人变成了朋友 诸如此类的东西</c>

00:19:47.921 --> 00:19:53.560
<c.magenta>所以我们在这里有这两个资源</c>
<c.magenta>它们在2级的时候被使用</c>

00:19:53.961 --> 00:19:57.631
<c.magenta>所以它们标记了1级和2级的标签</c>

00:20:01.368 --> 00:20:03.203
<c.magenta>所以我们的标签集看起来是这样的</c>

00:20:03.303 --> 00:20:07.674
<c.magenta>我们有四个带一个标签的资源</c>
<c.magenta>和两个带两个标签的资源</c>

00:20:08.642 --> 00:20:11.311
<c.magenta>当我们至于四个标签的时候</c>

00:20:12.246 --> 00:20:14.114
<c.magenta>最后会有六个资产包</c>

00:20:14.548 --> 00:20:18.418
<c.magenta>如果你考虑一下一个随机访问的游戏</c>

00:20:19.253 --> 00:20:20.954
<c.magenta>这就会变成一个阻碍</c>

00:20:21.455 --> 00:20:25.459
<c.magenta>若你很多资源被很多不同的角色共享</c>

00:20:25.526 --> 00:20:30.197
<c.magenta>比如很多资源有</c>
<c.magenta>5个 10个 15个标签</c>

00:20:30.497 --> 00:20:33.901
<c.magenta>那么所以这些的叉积会超过</c>

00:20:33.967 --> 00:20:36.770
<c.magenta>1000个标签</c>
<c.magenta>或者1000个资产包的限制</c>

00:20:36.837 --> 00:20:38.939
<c.magenta>这时需要注意的</c>

00:20:41.008 --> 00:20:45.612
<c.magenta>所以在游戏或者应用的生命周期内</c>

00:20:45.679 --> 00:20:48.048
<c.magenta>当然 你会有程序更新</c>

00:20:48.448 --> 00:20:51.618
<c.magenta>你想要提升用户体验 让用户回来</c>

00:20:53.453 --> 00:20:56.957
<c.magenta>按需下载资源被优化</c>

00:20:57.024 --> 00:20:58.659
<c.magenta>为了程序的更新</c>

00:20:59.693 --> 00:21:01.828
<c.magenta>可能有一点点令人惊奇</c>

00:20:59.693 --> 00:21:01.828
<c.magenta>可能有一点点令人惊奇</c>

00:21:02.763 --> 00:21:04.998
<c.magenta>但是如果你仔细想想 这是合理的</c>

00:21:05.332 --> 00:21:08.735
<c.magenta>特别的 我们以1.0版本的游戏开始</c>

00:21:09.803 --> 00:21:12.439
<c.magenta>我们在游戏中</c>
<c.magenta>有一堆的资源 一些带标签的</c>

00:21:12.506 --> 00:21:14.041
<c.magenta>和一些在主要包里的</c>

00:21:14.107 --> 00:21:16.009
<c.magenta>然后我们发布第二版</c>

00:21:16.076 --> 00:21:18.412
<c.magenta>我们在主包里面做了一些改动</c>

00:21:18.478 --> 00:21:20.814
<c.magenta>我们可能给1级增加了一下资源</c>

00:21:21.348 --> 00:21:23.217
<c.magenta>对2级更改了一些东西</c>

00:21:23.283 --> 00:21:24.785
<c.magenta>我们增加了一个全新的级别</c>

00:21:25.919 --> 00:21:27.754
<c.magenta>这些都很好</c>

00:21:27.821 --> 00:21:30.157
<c.magenta>那在升级的过程中会发生什么呢</c>

00:21:32.392 --> 00:21:36.330
<c.magenta>第一件事情是当你更新资源的时候</c>

00:21:36.396 --> 00:21:41.268
<c.magenta>更新带标签的资源</c>
<c.magenta>没有什么是被自动重新下载的</c>

00:21:41.568 --> 00:21:44.171
<c.magenta>当它第一次被访问时 它会被重新下载</c>

00:21:45.706 --> 00:21:48.342
<c.magenta>我们不想重新下载教学级别</c>

00:21:48.642 --> 00:21:50.811
<c.magenta>当用户已经远离这个了</c>

00:21:52.846 --> 00:21:55.916
<c.magenta>所有没被更改的资源会待在磁盘中</c>

00:21:56.984 --> 00:21:59.019
<c.magenta>不需要下载 它们就可以被访问</c>

00:22:00.587 --> 00:22:03.290
<c.magenta>新的资源</c>
<c.magenta>它们会在被访问的时候被下载</c>

00:22:03.624 --> 00:22:06.727
<c.magenta>所有 再说一遍</c>
<c.magenta>系统对待这个是非常懒惰的</c>

00:22:06.793 --> 00:22:10.898
<c.magenta>在这种情况下 因为我们不能预测</c>
<c.magenta>我们会对应用做什么样的改动</c>

00:22:10.964 --> 00:22:13.667
<c.magenta>会被需求各种各样的状态 或者用户</c>

00:22:13.734 --> 00:22:14.968
<c.magenta>在你的应用留下的东西</c>

00:22:15.369 --> 00:22:16.637
<c.magenta>我们将其交给你决定</c>

00:22:16.703 --> 00:22:20.841
<c.magenta>触发开始访问来触发上传</c>

00:22:20.908 --> 00:22:22.109
<c.magenta>和下载新东西</c>

00:22:22.176 --> 00:22:24.444
<c.magenta>实际上 在第一次启动时</c>
<c.magenta>你可能想要开始</c>

00:22:24.511 --> 00:22:27.247
<c.magenta>和开始访问一些你改变过的东西</c>

00:22:27.314 --> 00:22:31.018
<c.magenta>以此确保在用户主要到之前</c>
<c.magenta>就让这些资源是可用的</c>

00:22:33.053 --> 00:22:36.790
<c.magenta>所以 这个的最佳实践</c>

00:22:38.392 --> 00:22:42.262
<c.magenta>避免对带标签资源的不必要的修改</c>

00:22:43.163 --> 00:22:44.464
<c.magenta>比如</c>

00:22:44.531 --> 00:22:47.668
<c.magenta>我们有过一种情形</c>
<c.magenta>当有人做了一个拼写的改变</c>

00:22:47.734 --> 00:22:49.670
<c.magenta>令人惊奇的是所有东西都被重新下载了</c>

00:22:49.736 --> 00:22:51.171
<c.magenta>当第一次访问它的时候</c>

00:22:53.273 --> 00:22:57.477
<c.magenta>如果你改变了这个资产包里的一个资源</c>

00:22:57.845 --> 00:23:01.648
<c.magenta>这会触发下载整个资产包 这只是一个</c>

00:22:57.845 --> 00:23:01.648
<c.magenta>这会触发下载整个资产包 这只是一个</c>

00:23:01.715 --> 00:23:03.183
<c.magenta>具体的实现</c>

00:23:03.517 --> 00:23:04.518
<c.magenta>所以请牢记</c>

00:23:04.585 --> 00:23:06.954
<c.magenta>你应该做的是 比如</c>

00:23:07.020 --> 00:23:10.891
<c.magenta>在我们给1级</c>
<c.magenta>增加一些额外资源的情况下</c>

00:23:11.458 --> 00:23:14.027
<c.magenta>我们可以让1级更新一个标签</c>

00:23:14.094 --> 00:23:16.797
<c.magenta>然后开始访问它们 下载</c>

00:23:16.864 --> 00:23:19.900
<c.magenta>当它们都可以使用的时候</c>
<c.magenta>然后运行用户运行1级</c>

00:23:21.802 --> 00:23:23.303
<c.magenta>保持那些标签一致</c>

00:23:25.606 --> 00:23:28.709
<c.magenta>从一开始 你要设计好</c>

00:23:28.775 --> 00:23:32.646
<c.magenta>可更新内容和静态内容的分离</c>

00:23:35.082 --> 00:23:38.685
<c.magenta>所有这些意味着 你可能有一个标签</c>

00:23:38.752 --> 00:23:40.954
<c.magenta>对于你的程序中的单一的角色</c>

00:23:41.255 --> 00:23:44.258
<c.magenta>可能你想要把那个标签分隔成多个标签</c>

00:23:44.324 --> 00:23:47.194
<c.magenta>当它是可能永远不会改变</c>

00:23:47.261 --> 00:23:48.662
<c.magenta>和少数会被改变</c>

00:23:52.366 --> 00:23:56.503
<c.magenta>所以这些如何组成智能内容缓存的呢</c>

00:23:58.639 --> 00:24:02.709
<c.magenta>对于tvOS</c>
<c.magenta>这个操作系统的目标之一</c>

00:23:58.639 --> 00:24:02.709
<c.magenta>对于tvOS</c>
<c.magenta>这个操作系统的目标之一</c>

00:24:02.776 --> 00:24:07.214
<c.magenta>是永远不让用户注意到这个用法</c>

00:24:08.282 --> 00:24:10.017
<c.magenta>永远不需要删除东西</c>

00:24:10.851 --> 00:24:12.452
<c.magenta>永远不需要去考虑它</c>

00:24:13.854 --> 00:24:15.122
<c.magenta>作为这个的一部分</c>

00:24:15.189 --> 00:24:18.392
<c.magenta>有一个完整的</c>
<c.magenta>缓存管理系统和自动清理系统</c>

00:24:19.359 --> 00:24:22.763
<c.magenta>系统会清理到磁盘上的资源</c>

00:24:22.829 --> 00:24:24.998
<c.magenta>当磁盘空间快满了的时候</c>

00:24:25.499 --> 00:24:28.268
<c.magenta>有多个不同的级别</c>
<c.magenta>从优先级最低的开始</c>

00:24:28.335 --> 00:24:29.736
<c.magenta>会清理缓存这些</c>

00:24:29.803 --> 00:24:32.005
<c.magenta>然后一步一步地到越来越高的优先级</c>

00:24:33.307 --> 00:24:35.909
<c.magenta>所以 再强调一些这点</c>

00:24:36.844 --> 00:24:41.415
<c.magenta>当你用完了资源的时候</c>
<c.magenta>一定要结束访问</c>

00:24:41.481 --> 00:24:43.050
<c.magenta>这并不意味着资源会被删除</c>

00:24:44.384 --> 00:24:46.687
<c.magenta>智能内容缓存</c>

00:24:46.753 --> 00:24:50.123
<c.magenta>有很多变量告诉系统关于清理的顺序</c>

00:24:50.591 --> 00:24:55.329
<c.magenta>显然的 最长时间没被用的先被清理</c>

00:24:55.929 --> 00:24:58.532
<c.magenta>你也可以控制保留优先级</c>

00:25:00.367 --> 00:25:03.770
<c.magenta>保留优先级是一个信号</c>
<c.magenta>对于打包资源请求</c>

00:25:04.505 --> 00:25:08.275
<c.magenta>这是一个0到1的数值 只是用来表示</c>

00:25:08.342 --> 00:25:10.911
<c.magenta>系统以什么样的顺序删除东西</c>

00:25:11.645 --> 00:25:14.348
<c.magenta>它独立于你的应用 所以不会作弊</c>

00:25:15.182 --> 00:25:16.850
<c.magenta>它不会帮你把所有都设为1</c>

00:25:16.917 --> 00:25:20.354
<c.magenta>它只是表示当真的需要的时候</c>
<c.magenta>我们会吹走一切</c>

00:25:20.821 --> 00:25:23.357
<c.magenta>如果你的程序在运行</c>

00:25:23.924 --> 00:25:27.594
<c.magenta>它会是系统最后一个清理的资源</c>

00:25:31.398 --> 00:25:33.534
<c.magenta>这是非常重要的</c>

00:25:33.600 --> 00:25:35.736
<c.magenta>不要使用临时变量和缓存</c>

00:25:36.570 --> 00:25:41.508
<c.magenta>显然若你需要一下临时的东西或者缓存</c>
<c.magenta>你可以使用</c>

00:25:42.609 --> 00:25:44.778
<c.magenta>但是因为我们无法知道</c>

00:25:44.845 --> 00:25:47.581
<c.magenta>在临时缓存中的数据的结构</c>

00:25:48.582 --> 00:25:53.053
<c.magenta>系统会认为</c>
<c.magenta>它们是在低优先级时 就可以被清理的</c>

00:25:53.620 --> 00:25:55.756
<c.magenta>它们会被清理 而当它们被清理了</c>

00:25:55.822 --> 00:25:57.357
<c.magenta>它们是被整体地清理了</c>

00:26:00.093 --> 00:26:01.962
<c.magenta>所以 最后</c>

00:26:03.630 --> 00:26:04.665
<c.magenta>总结一下</c>

00:26:06.533 --> 00:26:08.168
<c.magenta>使用按需加载资源</c>

00:26:08.235 --> 00:26:12.573
<c.magenta>特别是对于tvOS</c>
<c.magenta>按需加载资源的使用</c>

00:26:13.307 --> 00:26:16.210
<c.magenta>真的提供了更加优化的用户体验</c>

00:26:16.677 --> 00:26:18.912
<c.magenta>它影响了网络连接</c>

00:26:19.313 --> 00:26:21.682
<c.magenta>在iOS上 事情变得更加的棘手</c>

00:26:21.748 --> 00:26:24.685
<c.magenta>但也有很多成功使用它的方式</c>

00:26:27.054 --> 00:26:28.889
<c.magenta>它会使得应用更小</c>

00:26:29.223 --> 00:26:32.893
<c.magenta>这会减少用户获取的时间</c>

00:26:33.460 --> 00:26:39.099
<c.magenta>从商店到你用户玩上你的游戏</c>
<c.magenta>使用你的程序</c>

00:26:40.200 --> 00:26:42.202
<c.magenta>用你的内容做所有的事情</c>

00:26:45.239 --> 00:26:46.840
<c.magenta>你有了更多的应用内容</c>

00:26:46.907 --> 00:26:51.879
<c.magenta>现在你有了最多到20GB的空间</c>
<c.magenta>放任意你想的东西</c>

00:26:54.581 --> 00:26:58.285
<c.magenta>而对于用户 他们不需要考虑这个</c>

00:26:58.352 --> 00:27:00.654
<c.magenta>他们可以安装任意多的应用</c>

00:26:58.352 --> 00:27:00.654
<c.magenta>他们可以安装任意多的应用</c>

00:27:00.721 --> 00:27:02.523
<c.magenta>他们没有一个障碍</c>

00:27:02.589 --> 00:27:04.558
<c.magenta>他们也不需要考虑存储</c>

00:27:05.926 --> 00:27:09.997
<c.magenta>这就是按需下载资源的优化</c>

00:27:10.864 --> 00:27:12.065
<c.magenta>更多相关的信息</c>

00:27:13.534 --> 00:27:15.602
<c.magenta>请参考我们的网页</c>

00:27:16.103 --> 00:27:19.506
<c.magenta>在本周的早些时候也有许多相关的演讲</c>

00:27:19.806 --> 00:27:21.241
<c.magenta>我建议大家回顾一下</c>

00:27:21.308 --> 00:27:22.176
<c.magenta>谢谢</c>

WEBVTT

00:00:07.516 --> 00:00:14.500 A:middle
[ Music ]

00:00:20.516 --> 00:00:26.936 A:middle
[ Applause ]

00:00:27.436 --> 00:00:28.196 A:middle
&gt;&gt; Hi, everyone.

00:00:28.196 --> 00:00:29.726 A:middle
My name is Neil Desai, and I'm a

00:00:29.726 --> 00:00:31.456 A:middle
watchOS Frameworks engineer, and

00:00:31.456 --> 00:00:33.116 A:middle
I'm really excited to be here to

00:00:33.116 --> 00:00:34.216 A:middle
talk about how to create some

00:00:34.216 --> 00:00:36.116 A:middle
great audio apps for watchOS.

00:00:36.616 --> 00:00:38.276 A:middle
And honestly, we've been waiting

00:00:38.276 --> 00:00:39.336 A:middle
a little over a year to give

00:00:39.336 --> 00:00:40.566 A:middle
this talk, so I'm really happy

00:00:40.566 --> 00:00:42.626 A:middle
to be here, so let's just jump

00:00:42.626 --> 00:00:43.616 A:middle
right in.

00:00:44.576 --> 00:00:46.596 A:middle
In watchOS 4, we unveiled a

00:00:46.596 --> 00:00:48.906 A:middle
revamped music and radio app.

00:00:48.906 --> 00:00:51.016 A:middle
And in watchOS 5, we unveiled a

00:00:51.016 --> 00:00:52.386 A:middle
brand-new podcast app.

00:00:52.486 --> 00:00:53.906 A:middle
And we're finding that users

00:00:53.986 --> 00:00:56.156 A:middle
absolutely love being able to

00:00:56.156 --> 00:00:58.366 A:middle
play audio on the go or in the

00:00:58.366 --> 00:00:59.286 A:middle
middle of a workout.

00:01:02.046 --> 00:01:02.686 A:middle
And we're also finding that

00:01:02.686 --> 00:01:04.275 A:middle
users really like to be able to

00:01:04.275 --> 00:01:05.696 A:middle
remote control some playback

00:01:05.696 --> 00:01:06.776 A:middle
that's occurring on another

00:01:06.776 --> 00:01:07.316 A:middle
device.

00:01:07.766 --> 00:01:09.326 A:middle
For example, your iPhone or

00:01:09.326 --> 00:01:09.956 A:middle
HomePod.

00:01:10.296 --> 00:01:11.486 A:middle
And I especially really like

00:01:11.486 --> 00:01:12.016 A:middle
this feature.

00:01:12.016 --> 00:01:13.636 A:middle
I love just being able to play

00:01:13.636 --> 00:01:15.916 A:middle
some music out of my iPhone and

00:01:15.916 --> 00:01:17.196 A:middle
then being able to control the

00:01:17.196 --> 00:01:18.716 A:middle
volume, for instance, directly

00:01:18.716 --> 00:01:19.456 A:middle
with my watch.

00:01:19.916 --> 00:01:20.996 A:middle
That's a great feature.

00:01:21.756 --> 00:01:23.426 A:middle
And today, with watchOS 5, we're

00:01:23.426 --> 00:01:25.086 A:middle
going to show you how to build a

00:01:25.086 --> 00:01:27.016 A:middle
great experience like you saw on

00:01:27.016 --> 00:01:28.396 A:middle
the keynote like Audible was

00:01:28.396 --> 00:01:30.466 A:middle
able to make and just like

00:01:30.536 --> 00:01:31.626 A:middle
Pandora was able to make.

00:01:32.496 --> 00:01:34.516 A:middle
And so they were able to use

00:01:34.516 --> 00:01:36.756 A:middle
some of the new tools available

00:01:36.756 --> 00:01:37.726 A:middle
in watchOS 5.

00:01:37.766 --> 00:01:39.526 A:middle
And today, we're going to talk

00:01:39.526 --> 00:01:40.836 A:middle
about how we can do the same

00:01:40.836 --> 00:01:41.436 A:middle
sort of thing.

00:01:42.216 --> 00:01:43.156 A:middle
And to do that, we're going to

00:01:43.156 --> 00:01:44.686 A:middle
talk about four major themes.

00:01:44.966 --> 00:01:46.736 A:middle
We're going to talk about our

00:01:46.736 --> 00:01:48.276 A:middle
native controls and how we can

00:01:48.276 --> 00:01:49.926 A:middle
now embed our system controls

00:01:50.266 --> 00:01:51.926 A:middle
directly within our application.

00:01:52.826 --> 00:01:53.856 A:middle
We're going to talk about, how

00:01:53.856 --> 00:01:55.296 A:middle
do we get content over to the

00:01:55.296 --> 00:01:55.846 A:middle
watch?

00:01:56.196 --> 00:01:57.496 A:middle
And then, once we have that

00:01:57.496 --> 00:01:59.186 A:middle
content, how do we actually play

00:01:59.186 --> 00:02:00.416 A:middle
something back for our user?

00:01:59.186 --> 00:02:00.416 A:middle
something back for our user?

00:02:01.716 --> 00:02:02.766 A:middle
And lastly, we're going to go

00:02:02.766 --> 00:02:04.296 A:middle
over the whole audio experience

00:02:04.296 --> 00:02:05.656 A:middle
and how to build a really rich

00:02:05.656 --> 00:02:07.296 A:middle
experience for our users that

00:02:07.296 --> 00:02:08.536 A:middle
integrates well throughout the

00:02:08.536 --> 00:02:09.356 A:middle
entire system.

00:02:11.276 --> 00:02:12.746 A:middle
So let's talk about our native

00:02:12.746 --> 00:02:13.326 A:middle
controls.

00:02:15.776 --> 00:02:17.736 A:middle
In watchOS 5, we're unveiling

00:02:17.736 --> 00:02:19.046 A:middle
two new controls that you can

00:02:19.046 --> 00:02:20.246 A:middle
embed directly within your

00:02:20.246 --> 00:02:20.936 A:middle
application.

00:02:21.926 --> 00:02:23.756 A:middle
And the first is a Now Playing

00:02:23.756 --> 00:02:25.696 A:middle
view which you can embed within

00:02:25.696 --> 00:02:26.746 A:middle
your watchOS app.

00:02:27.136 --> 00:02:29.306 A:middle
And this is really great for

00:02:29.306 --> 00:02:31.356 A:middle
content that may not be yours,

00:02:31.356 --> 00:02:31.966 A:middle
for instance.

00:02:32.456 --> 00:02:34.876 A:middle
And you can also embed a volume

00:02:34.876 --> 00:02:36.286 A:middle
control so you can build your

00:02:36.286 --> 00:02:38.166 A:middle
own custom UI to allow your user

00:02:38.166 --> 00:02:40.016 A:middle
to control the volume.

00:02:41.146 --> 00:02:42.306 A:middle
And you might be wondering for

00:02:42.306 --> 00:02:43.326 A:middle
that first view, that Now

00:02:43.326 --> 00:02:45.686 A:middle
Playing view, when exactly would

00:02:45.686 --> 00:02:47.446 A:middle
I ever want to allow my user to

00:02:47.526 --> 00:02:49.646 A:middle
control some audio, but the

00:02:49.646 --> 00:02:50.986 A:middle
content's not exactly mine?

00:02:52.086 --> 00:02:53.276 A:middle
Well, let me give you an

00:02:53.276 --> 00:02:53.676 A:middle
example.

00:02:53.676 --> 00:02:54.756 A:middle
We do this ourselves in the

00:02:54.756 --> 00:02:55.406 A:middle
workout app.

00:02:55.846 --> 00:02:56.936 A:middle
So I'm in the middle of a HIIT

00:02:56.936 --> 00:02:57.606 A:middle
workout.

00:02:57.606 --> 00:02:58.636 A:middle
I swipe to the left.

00:02:58.636 --> 00:03:00.426 A:middle
I get my power song, "Eye of the

00:02:58.636 --> 00:03:00.426 A:middle
I get my power song, "Eye of the

00:03:00.426 --> 00:03:02.096 A:middle
Tiger," and I'm a little bit of

00:03:02.096 --> 00:03:03.376 A:middle
a dork, so I actually do listen

00:03:03.376 --> 00:03:05.016 A:middle
to this song sometimes when I

00:03:05.016 --> 00:03:05.486 A:middle
work out.

00:03:05.486 --> 00:03:05.956 A:middle
I love it.

00:03:06.406 --> 00:03:07.596 A:middle
And this is a great experience.

00:03:07.596 --> 00:03:08.896 A:middle
You just swipe over, and you can

00:03:08.896 --> 00:03:11.076 A:middle
allow your user to control the

00:03:11.076 --> 00:03:11.546 A:middle
playback.

00:03:12.236 --> 00:03:13.246 A:middle
And so if you're building a

00:03:13.246 --> 00:03:15.066 A:middle
workout app, and you can do

00:03:15.066 --> 00:03:16.736 A:middle
this, build the same sort of

00:03:16.736 --> 00:03:18.006 A:middle
experience, just embedding the

00:03:18.006 --> 00:03:19.856 A:middle
Now Playing view directly within

00:03:19.856 --> 00:03:20.656 A:middle
your application.

00:03:22.036 --> 00:03:22.826 A:middle
Let's talk about the

00:03:22.826 --> 00:03:24.306 A:middle
characteristics of that Now

00:03:24.356 --> 00:03:24.846 A:middle
Playing view.

00:03:24.846 --> 00:03:26.796 A:middle
And the first thing I want to

00:03:26.796 --> 00:03:28.346 A:middle
note is that the Digital Crown

00:03:28.346 --> 00:03:29.426 A:middle
controls the volume.

00:03:30.006 --> 00:03:31.396 A:middle
And because of that, you're

00:03:31.396 --> 00:03:32.536 A:middle
going to want to place this view

00:03:32.536 --> 00:03:34.026 A:middle
in a non-scrolling controller.

00:03:34.526 --> 00:03:36.326 A:middle
So for instance, it's, in my app

00:03:36.326 --> 00:03:38.686 A:middle
here, I've actually just pushed

00:03:38.686 --> 00:03:40.126 A:middle
directly to a controller that

00:03:40.126 --> 00:03:41.886 A:middle
has the Now Playing view in it.

00:03:41.886 --> 00:03:43.746 A:middle
Or you could reload directly to

00:03:43.746 --> 00:03:45.726 A:middle
a page that has this controller

00:03:45.726 --> 00:03:47.486 A:middle
or place it in a page interface

00:03:47.806 --> 00:03:48.966 A:middle
similar to the workout app.

00:03:49.436 --> 00:03:52.366 A:middle
And this view is going to

00:03:52.366 --> 00:03:54.006 A:middle
automatically switch the sources

00:03:54.006 --> 00:03:54.646 A:middle
on behalf.

00:03:54.736 --> 00:03:56.606 A:middle
So no matter if it's the iPhone

00:03:56.606 --> 00:03:58.256 A:middle
or the watch that's providing

00:03:58.256 --> 00:03:59.766 A:middle
the source of audio playback,

00:04:00.236 --> 00:04:01.356 A:middle
this view's going to take care

00:04:01.356 --> 00:04:01.966 A:middle
of it for you.

00:04:01.966 --> 00:04:03.096 A:middle
You don't have to worry about

00:04:03.696 --> 00:04:03.846 A:middle
that.

00:04:04.916 --> 00:04:06.466 A:middle
And lastly, the Now Playing

00:04:06.466 --> 00:04:07.696 A:middle
view, it's going to grab your

00:04:07.696 --> 00:04:09.426 A:middle
application's tint color so it

00:04:09.426 --> 00:04:10.956 A:middle
fits within the look and feel of

00:04:10.956 --> 00:04:11.846 A:middle
your application.

00:04:13.076 --> 00:04:15.616 A:middle
Now, to use this, let's see how

00:04:15.616 --> 00:04:17.336 A:middle
it looks in Interface Builder.

00:04:17.726 --> 00:04:19.446 A:middle
Here we are in Xcode, and I've

00:04:19.446 --> 00:04:20.916 A:middle
selected my Object Library, and

00:04:21.016 --> 00:04:22.696 A:middle
then I can just drag and drop my

00:04:22.696 --> 00:04:24.206 A:middle
Now Playing view into a

00:04:24.206 --> 00:04:24.866 A:middle
controller.

00:04:25.176 --> 00:04:26.496 A:middle
Once my user navigates to that

00:04:26.496 --> 00:04:28.106 A:middle
view, everything will be done

00:04:28.106 --> 00:04:28.496 A:middle
for you.

00:04:28.496 --> 00:04:29.646 A:middle
The system will take care of it

00:04:29.646 --> 00:04:29.816 A:middle
all.

00:04:30.196 --> 00:04:31.726 A:middle
And it really is just that

00:04:31.726 --> 00:04:32.096 A:middle
simple.

00:04:33.536 --> 00:04:35.046 A:middle
So that's our Now Playing view.

00:04:35.746 --> 00:04:36.966 A:middle
Now, let's talk about our volume

00:04:36.966 --> 00:04:37.386 A:middle
control.

00:04:38.176 --> 00:04:39.606 A:middle
So the volume control can be set

00:04:39.606 --> 00:04:41.616 A:middle
up to either control the

00:04:41.616 --> 00:04:43.136 A:middle
iPhone's volume or the local

00:04:43.136 --> 00:04:43.936 A:middle
watch's volume.

00:04:44.616 --> 00:04:46.216 A:middle
And just like our Now Playing

00:04:46.216 --> 00:04:47.606 A:middle
view, we're going to grab your

00:04:47.606 --> 00:04:48.946 A:middle
application's tint color and

00:04:48.946 --> 00:04:51.026 A:middle
apply it appropriately to this

00:04:51.056 --> 00:04:51.896 A:middle
particular control.

00:04:54.636 --> 00:04:56.656 A:middle
And in the case of when the user

00:04:56.656 --> 00:04:58.426 A:middle
is actually scrolling with the

00:04:58.426 --> 00:05:00.126 A:middle
Digital Crown, then, in that

00:04:58.426 --> 00:05:00.126 A:middle
Digital Crown, then, in that

00:05:00.126 --> 00:05:01.646 A:middle
case, the volume control will be

00:05:01.956 --> 00:05:04.026 A:middle
tinted to the system green color

00:05:04.026 --> 00:05:05.746 A:middle
to match the rest of the system.

00:05:06.276 --> 00:05:09.796 A:middle
So for the volume control, to

00:05:09.796 --> 00:05:12.376 A:middle
actually decide when or not to

00:05:12.626 --> 00:05:14.596 A:middle
control the local or iPhone's

00:05:14.596 --> 00:05:17.036 A:middle
volume, there, in the Attributes

00:05:17.036 --> 00:05:18.506 A:middle
Inspector is a check box for

00:05:18.506 --> 00:05:19.746 A:middle
Controls Local Volume.

00:05:20.486 --> 00:05:21.696 A:middle
So if you leave it unchecked,

00:05:21.926 --> 00:05:22.866 A:middle
then the volume control will

00:05:22.866 --> 00:05:24.316 A:middle
control the iPhone's content.

00:05:25.086 --> 00:05:27.056 A:middle
And if you check it off, then

00:05:27.166 --> 00:05:28.676 A:middle
the volume control will control

00:05:28.676 --> 00:05:29.676 A:middle
the watch's content.

00:05:30.216 --> 00:05:32.656 A:middle
And so if your application might

00:05:32.656 --> 00:05:34.366 A:middle
have multiple scenarios where it

00:05:34.366 --> 00:05:35.506 A:middle
could either remote control some

00:05:35.506 --> 00:05:37.466 A:middle
content or play some content

00:05:37.466 --> 00:05:39.236 A:middle
locally, then, in that case, you

00:05:39.236 --> 00:05:40.446 A:middle
might have different controls

00:05:40.446 --> 00:05:41.616 A:middle
with different volume controls

00:05:41.616 --> 00:05:43.136 A:middle
within them, and you make those

00:05:43.136 --> 00:05:44.436 A:middle
decisions at design time.

00:05:45.516 --> 00:05:47.176 A:middle
All right, so those are really

00:05:47.176 --> 00:05:49.276 A:middle
our system controls, so now

00:05:49.276 --> 00:05:50.466 A:middle
let's talk about, how do we

00:05:50.466 --> 00:05:51.996 A:middle
actually get content over to the

00:05:51.996 --> 00:05:53.266 A:middle
device itself?

00:05:55.096 --> 00:05:57.606 A:middle
So I've been building a museum

00:05:57.606 --> 00:05:59.306 A:middle
guided tour type application.

00:05:59.466 --> 00:06:01.166 A:middle
I want to allow my user to just

00:05:59.466 --> 00:06:01.166 A:middle
I want to allow my user to just

00:06:01.456 --> 00:06:03.336 A:middle
tap in, listen to a guided tour

00:06:03.336 --> 00:06:04.836 A:middle
while they're in the museum, and

00:06:04.836 --> 00:06:06.116 A:middle
it's a great experience on the

00:06:06.116 --> 00:06:08.606 A:middle
watch because I can just put my

00:06:08.606 --> 00:06:09.496 A:middle
phone away.

00:06:09.496 --> 00:06:10.716 A:middle
I can just have the entire

00:06:10.716 --> 00:06:12.666 A:middle
experience on my wrist and enjoy

00:06:12.666 --> 00:06:14.656 A:middle
the beautiful art around me.

00:06:15.046 --> 00:06:17.936 A:middle
And let's say I had a, like a

00:06:17.936 --> 00:06:19.706 A:middle
buffer that allowed my user to

00:06:19.816 --> 00:06:21.646 A:middle
download the content on, when

00:06:21.646 --> 00:06:22.816 A:middle
they're on their way to the

00:06:22.816 --> 00:06:23.446 A:middle
museum.

00:06:24.236 --> 00:06:25.616 A:middle
In that case, I would want to

00:06:25.616 --> 00:06:27.926 A:middle
use URLSession and grab that

00:06:27.926 --> 00:06:29.726 A:middle
directly from my server, all my

00:06:29.726 --> 00:06:31.196 A:middle
content, and download it to the

00:06:31.196 --> 00:06:31.906 A:middle
watch itself.

00:06:33.326 --> 00:06:35.546 A:middle
So let's jump into some code and

00:06:35.546 --> 00:06:38.026 A:middle
see how we could do that.

00:06:38.226 --> 00:06:39.256 A:middle
So here we are.

00:06:39.256 --> 00:06:41.626 A:middle
I have an IBAction which is tied

00:06:41.626 --> 00:06:43.206 A:middle
to my WK Interface button.

00:06:43.446 --> 00:06:44.246 A:middle
And the first thing you'll

00:06:44.246 --> 00:06:46.776 A:middle
notice is I set my frontmost

00:06:46.816 --> 00:06:48.456 A:middle
timeout extended property to be

00:06:48.456 --> 00:06:48.776 A:middle
true.

00:06:50.006 --> 00:06:51.096 A:middle
And we're going to talk a little

00:06:51.096 --> 00:06:52.546 A:middle
bit more about frontmost later,

00:06:52.686 --> 00:06:53.586 A:middle
but the thing I wanted to

00:06:53.586 --> 00:06:55.416 A:middle
mention is that the user has

00:06:55.416 --> 00:06:57.526 A:middle
made a user interaction, so it's

00:06:57.616 --> 00:06:59.496 A:middle
fair to say that the user, next

00:06:59.496 --> 00:07:00.526 A:middle
time they raise their wrist,

00:06:59.496 --> 00:07:00.526 A:middle
time they raise their wrist,

00:07:00.526 --> 00:07:01.356 A:middle
would want to see our

00:07:01.356 --> 00:07:02.076 A:middle
application.

00:07:02.586 --> 00:07:04.476 A:middle
And because we're extending the

00:07:04.476 --> 00:07:05.946 A:middle
frontmost timeout, then we're

00:07:05.946 --> 00:07:07.266 A:middle
getting some additional priority

00:07:07.266 --> 00:07:08.286 A:middle
by the system for our

00:07:08.356 --> 00:07:09.256 A:middle
URLSessions.

00:07:09.636 --> 00:07:10.766 A:middle
And again, I'll talk a little

00:07:10.766 --> 00:07:11.776 A:middle
bit more about that later.

00:07:12.186 --> 00:07:15.656 A:middle
And the user can, of course, put

00:07:15.656 --> 00:07:16.926 A:middle
their wrist down at any point,

00:07:17.176 --> 00:07:18.476 A:middle
so I want to make sure to use a

00:07:18.476 --> 00:07:19.416 A:middle
backgroundSession.

00:07:19.826 --> 00:07:21.276 A:middle
So that way, when my application

00:07:21.276 --> 00:07:22.516 A:middle
goes into the background, my

00:07:22.516 --> 00:07:23.886 A:middle
download is still occurring.

00:07:24.566 --> 00:07:26.186 A:middle
And then, I can just download

00:07:26.186 --> 00:07:27.706 A:middle
that task and appropriately

00:07:27.906 --> 00:07:28.816 A:middle
resume it.

00:07:29.686 --> 00:07:30.926 A:middle
And when you're building an

00:07:30.926 --> 00:07:32.886 A:middle
experience like this, you want

00:07:32.886 --> 00:07:34.556 A:middle
to indicate download progress

00:07:34.626 --> 00:07:35.796 A:middle
and, of course, handle any

00:07:35.796 --> 00:07:36.216 A:middle
errors.

00:07:36.586 --> 00:07:40.406 A:middle
So let's look at how to do that.

00:07:40.406 --> 00:07:41.196 A:middle
So here we are.

00:07:41.196 --> 00:07:41.926 A:middle
I have my class, my

00:07:41.926 --> 00:07:43.796 A:middle
DownloadManager, which is my

00:07:44.026 --> 00:07:45.536 A:middle
SessionTaskDelegate and my

00:07:45.566 --> 00:07:47.176 A:middle
URLSessionDownload Delegate.

00:07:47.666 --> 00:07:49.886 A:middle
And in the first function, I can

00:07:49.886 --> 00:07:51.296 A:middle
actually grab the total bytes

00:07:51.296 --> 00:07:52.646 A:middle
written and divide it by the

00:07:52.646 --> 00:07:54.076 A:middle
total bytes expected to write.

00:07:54.356 --> 00:07:55.366 A:middle
So that way, I can get the

00:07:55.366 --> 00:07:56.676 A:middle
progress of my particular

00:07:56.676 --> 00:07:58.606 A:middle
download whenever URLSession

00:07:59.006 --> 00:08:00.796 A:middle
calls me and gives me that

00:07:59.006 --> 00:08:00.796 A:middle
calls me and gives me that

00:08:00.796 --> 00:08:01.436 A:middle
information.

00:08:01.926 --> 00:08:04.086 A:middle
And when I do this, I can just

00:08:04.086 --> 00:08:06.646 A:middle
update progress for my user in

00:08:06.646 --> 00:08:07.026 A:middle
my UI.

00:08:07.726 --> 00:08:10.266 A:middle
And then, when the download

00:08:10.266 --> 00:08:12.316 A:middle
completes, I can, of course,

00:08:12.316 --> 00:08:13.686 A:middle
manage the file, and I might

00:08:13.686 --> 00:08:15.426 A:middle
want to post a notification

00:08:15.426 --> 00:08:17.156 A:middle
alerting my user that there's a

00:08:17.156 --> 00:08:18.246 A:middle
playback opportunity.

00:08:18.766 --> 00:08:21.976 A:middle
And, of course, I'm also going

00:08:21.976 --> 00:08:22.936 A:middle
to be called into a

00:08:22.936 --> 00:08:24.946 A:middle
didCompleteWithError, so I just

00:08:24.946 --> 00:08:26.266 A:middle
want to clean up appropriately

00:08:26.496 --> 00:08:28.066 A:middle
and handle any errors at that

00:08:28.066 --> 00:08:28.916 A:middle
point, if there are any.

00:08:29.946 --> 00:08:31.466 A:middle
And that's wonderful,

00:08:31.466 --> 00:08:32.976 A:middle
URLSession, for when we can

00:08:32.976 --> 00:08:34.265 A:middle
download directly to the watch,

00:08:34.816 --> 00:08:36.416 A:middle
but sometimes the content might

00:08:36.416 --> 00:08:38.056 A:middle
already exist on our iPhone.

00:08:39.106 --> 00:08:40.576 A:middle
In that case, we can just use

00:08:40.576 --> 00:08:42.135 A:middle
watch connectivity and transfer

00:08:42.135 --> 00:08:43.946 A:middle
the file directly over to our

00:08:43.946 --> 00:08:44.416 A:middle
watch.

00:08:48.536 --> 00:08:50.336 A:middle
And to do so, we'll just use the

00:08:50.336 --> 00:08:51.426 A:middle
transfer file API.

00:08:51.426 --> 00:08:53.946 A:middle
And new in watchOS 5, you can

00:08:53.946 --> 00:08:55.756 A:middle
get the progress of that

00:08:55.756 --> 00:08:56.256 A:middle
transfer.

00:08:57.376 --> 00:08:58.306 A:middle
So let's take a look.

00:08:58.956 --> 00:09:00.546 A:middle
Here we are in code, and I see

00:08:58.956 --> 00:09:00.546 A:middle
Here we are in code, and I see

00:09:00.546 --> 00:09:02.236 A:middle
my WCSession FileTransfer.

00:09:02.596 --> 00:09:03.996 A:middle
And new, there's a progress

00:09:03.996 --> 00:09:05.526 A:middle
property that's available in

00:09:05.526 --> 00:09:08.166 A:middle
watchOS 5 and iOS 12.

00:09:12.996 --> 00:09:14.666 A:middle
And then, I can just get my

00:09:14.666 --> 00:09:16.186 A:middle
fileTransfer, query for the

00:09:16.186 --> 00:09:18.746 A:middle
progress, and update my view on

00:09:18.746 --> 00:09:18.966 A:middle
iOS.

00:09:20.566 --> 00:09:21.476 A:middle
And if you want to know some

00:09:21.476 --> 00:09:22.766 A:middle
more about watch connectivity.

00:09:23.156 --> 00:09:24.346 A:middle
There's some great sample code

00:09:24.346 --> 00:09:25.596 A:middle
that's available online.

00:09:25.936 --> 00:09:27.056 A:middle
Highly recommend you check it

00:09:27.056 --> 00:09:28.196 A:middle
out, the simple watch

00:09:28.196 --> 00:09:29.426 A:middle
connectivity sample code.

00:09:29.906 --> 00:09:33.196 A:middle
And you might be wondering --

00:09:33.776 --> 00:09:34.936 A:middle
there's URLSession, there's

00:09:34.936 --> 00:09:36.896 A:middle
watch connectivity -- which one

00:09:37.106 --> 00:09:38.176 A:middle
do we use, exactly?

00:09:38.176 --> 00:09:39.486 A:middle
And when does it make sense?

00:09:41.016 --> 00:09:43.126 A:middle
Well, for URLSession, we want to

00:09:43.126 --> 00:09:44.176 A:middle
use that when it's user

00:09:44.176 --> 00:09:45.866 A:middle
initiated on the watch itself.

00:09:46.646 --> 00:09:47.566 A:middle
And then, when we do that, we

00:09:47.566 --> 00:09:48.836 A:middle
want a query the waits for

00:09:48.836 --> 00:09:50.676 A:middle
connectivity property to know

00:09:50.676 --> 00:09:51.586 A:middle
that we have a network

00:09:51.586 --> 00:09:54.136 A:middle
connection at that point.

00:09:54.306 --> 00:09:55.476 A:middle
And I just wanted to mention

00:09:55.476 --> 00:09:57.006 A:middle
that if the iPhone is nearby,

00:09:57.006 --> 00:09:58.306 A:middle
then requests are proxied

00:09:58.606 --> 00:09:59.876 A:middle
through the iPhone when it's in

00:09:59.876 --> 00:10:00.336 A:middle
range.

00:09:59.876 --> 00:10:00.336 A:middle
range.

00:10:01.566 --> 00:10:02.906 A:middle
And if you want to know some of

00:10:03.176 --> 00:10:05.216 A:middle
the nuances of URLSession,

00:10:05.486 --> 00:10:06.516 A:middle
there's a great talk from last

00:10:06.516 --> 00:10:07.826 A:middle
year that's available online,

00:10:07.826 --> 00:10:09.426 A:middle
Advances in Networking, Part 2.

00:10:09.726 --> 00:10:10.996 A:middle
I definitely recommend checking

00:10:10.996 --> 00:10:11.296 A:middle
it out.

00:10:11.816 --> 00:10:14.646 A:middle
And then, on the flip side,

00:10:14.646 --> 00:10:16.706 A:middle
there's watch connectivity, and

00:10:16.706 --> 00:10:17.856 A:middle
that's really important when

00:10:17.856 --> 00:10:19.336 A:middle
your user flow might be when

00:10:19.336 --> 00:10:20.696 A:middle
it's initiated on the iPhone

00:10:20.696 --> 00:10:22.806 A:middle
itself or in the case where

00:10:22.806 --> 00:10:23.726 A:middle
you've already downloaded some

00:10:23.726 --> 00:10:25.186 A:middle
content and there's no need to

00:10:25.186 --> 00:10:26.326 A:middle
request it from your server

00:10:26.326 --> 00:10:26.596 A:middle
again.

00:10:28.716 --> 00:10:30.446 A:middle
And for both and especially for

00:10:30.446 --> 00:10:31.646 A:middle
watch connectivity, you're going

00:10:31.646 --> 00:10:33.096 A:middle
to want to set expectations for

00:10:33.096 --> 00:10:33.606 A:middle
your user.

00:10:34.116 --> 00:10:35.476 A:middle
Make sure to instruct them of

00:10:35.476 --> 00:10:36.526 A:middle
when the download, or the

00:10:36.526 --> 00:10:37.926 A:middle
transfer's most likely to

00:10:37.926 --> 00:10:38.376 A:middle
complete.

00:10:38.376 --> 00:10:40.596 A:middle
And that's going to be when the

00:10:40.596 --> 00:10:41.836 A:middle
watch is on the magnetic

00:10:41.836 --> 00:10:42.306 A:middle
charger.

00:10:42.846 --> 00:10:44.406 A:middle
And for example, we do this

00:10:44.406 --> 00:10:45.006 A:middle
ourselves.

00:10:45.336 --> 00:10:47.156 A:middle
In the Apple Watch app in the

00:10:47.156 --> 00:10:49.676 A:middle
Music pane, at the top, we

00:10:49.676 --> 00:10:51.926 A:middle
actually show our user how many

00:10:51.926 --> 00:10:53.516 A:middle
songs have actually been

00:10:53.516 --> 00:10:54.846 A:middle
transferred over to the watch

00:10:54.846 --> 00:10:56.956 A:middle
itself, and we even instruct our

00:10:56.956 --> 00:10:59.166 A:middle
user, hey, music's going to sync

00:10:59.166 --> 00:11:00.216 A:middle
when the Apple Watch is on its

00:10:59.166 --> 00:11:00.216 A:middle
when the Apple Watch is on its

00:11:00.216 --> 00:11:03.156 A:middle
charger, so keep that in mind.

00:11:03.326 --> 00:11:04.796 A:middle
All right, so we talked about

00:11:04.796 --> 00:11:07.186 A:middle
getting content, and now that we

00:11:07.186 --> 00:11:08.216 A:middle
have it, let's talk about

00:11:08.216 --> 00:11:09.466 A:middle
actually playing something back.

00:11:10.466 --> 00:11:12.326 A:middle
And on watchOS, we have a bunch

00:11:12.326 --> 00:11:13.736 A:middle
of different tools we can use.

00:11:14.186 --> 00:11:16.226 A:middle
And some of those audio tools

00:11:16.226 --> 00:11:17.546 A:middle
are in WatchKit itself.

00:11:18.036 --> 00:11:20.646 A:middle
So there's a presentMedia

00:11:20.646 --> 00:11:22.216 A:middle
PlayerController with options,

00:11:22.216 --> 00:11:23.966 A:middle
completion that you can use.

00:11:24.426 --> 00:11:26.446 A:middle
And there's also WKAudioFile

00:11:26.446 --> 00:11:27.086 A:middle
QueuePlayer.

00:11:27.306 --> 00:11:29.076 A:middle
And so you can give it a list of

00:11:29.076 --> 00:11:30.416 A:middle
items, and then the queue player

00:11:30.416 --> 00:11:31.506 A:middle
will appropriately play back

00:11:31.536 --> 00:11:32.126 A:middle
that content.

00:11:32.636 --> 00:11:35.536 A:middle
So the presentMedia

00:11:35.536 --> 00:11:37.256 A:middle
PlayerController option will

00:11:37.326 --> 00:11:38.716 A:middle
present the system UI.

00:11:38.716 --> 00:11:40.006 A:middle
So the controls are taken care

00:11:40.006 --> 00:11:40.656 A:middle
of for you.

00:11:41.056 --> 00:11:42.006 A:middle
There's not really much you have

00:11:42.006 --> 00:11:42.476 A:middle
to do.

00:11:42.826 --> 00:11:44.456 A:middle
And this is perfect for when

00:11:44.456 --> 00:11:46.306 A:middle
it's short-form content and you

00:11:46.306 --> 00:11:47.176 A:middle
don't really want to have to

00:11:47.176 --> 00:11:48.686 A:middle
think too much about it.

00:11:50.096 --> 00:11:52.536 A:middle
And WKAudioFIleQueuePlayer is

00:11:52.536 --> 00:11:53.416 A:middle
great for when you have more

00:11:53.416 --> 00:11:54.736 A:middle
long-form content that you want

00:11:54.736 --> 00:11:55.706 A:middle
to play in the background.

00:11:56.126 --> 00:11:57.346 A:middle
And this is more of a conveyer

00:11:57.346 --> 00:12:00.116 A:middle
belt type approach where you

00:11:57.346 --> 00:12:00.116 A:middle
belt type approach where you

00:12:00.116 --> 00:12:01.726 A:middle
have some items, you just want

00:12:01.726 --> 00:12:02.896 A:middle
to hand it over to the system,

00:12:02.896 --> 00:12:03.916 A:middle
and the system will play it on

00:12:03.916 --> 00:12:04.426 A:middle
your behalf.

00:12:05.006 --> 00:12:06.936 A:middle
And that's exactly what

00:12:06.936 --> 00:12:08.736 A:middle
WKAudioFileQueuePlayer is for.

00:12:09.086 --> 00:12:12.006 A:middle
And there's also AVFoundation at

00:12:12.006 --> 00:12:12.696 A:middle
our disposal.

00:12:16.386 --> 00:12:19.136 A:middle
So there's AVAudioPlayer and

00:12:19.136 --> 00:12:19.866 A:middle
AVAudioEngine.

00:12:20.396 --> 00:12:22.966 A:middle
And prior to watchOS 5, it was

00:12:22.966 --> 00:12:24.396 A:middle
tied to the workout background

00:12:24.396 --> 00:12:26.486 A:middle
mode, or when your application

00:12:26.486 --> 00:12:28.196 A:middle
was foreground and screen on.

00:12:29.406 --> 00:12:31.736 A:middle
For example, Nike Run Club app

00:12:31.796 --> 00:12:33.086 A:middle
actually did this exact thing,

00:12:33.086 --> 00:12:34.346 A:middle
where you're in the middle of a

00:12:34.346 --> 00:12:36.346 A:middle
run, you want some mindfulness,

00:12:36.686 --> 00:12:39.026 A:middle
you can play some guided

00:12:39.026 --> 00:12:40.586 A:middle
meditation with Headspace.

00:12:41.956 --> 00:12:44.546 A:middle
And prior to watchOS 5,

00:12:44.546 --> 00:12:46.406 A:middle
background playback was, with

00:12:46.406 --> 00:12:47.756 A:middle
AVFoundation, was really only

00:12:47.756 --> 00:12:48.936 A:middle
possible for these types of

00:12:48.936 --> 00:12:49.666 A:middle
workout apps.

00:12:50.166 --> 00:12:52.666 A:middle
But new in watchOS 5, there's a

00:12:52.666 --> 00:12:54.296 A:middle
brand-new audio playback

00:12:54.456 --> 00:12:55.746 A:middle
background mode, which I'm

00:12:55.746 --> 00:12:56.716 A:middle
really thrilled for.

00:12:57.846 --> 00:13:00.296 A:middle
So let's talk about what we have

00:12:57.846 --> 00:13:00.296 A:middle
So let's talk about what we have

00:13:00.296 --> 00:13:01.306 A:middle
now at our disposal.

00:13:02.096 --> 00:13:04.076 A:middle
Kind of broadened our tool kit.

00:13:07.376 --> 00:13:09.806 A:middle
And so we have AVFoundation, and

00:13:09.806 --> 00:13:11.026 A:middle
it doesn't have to be tied to

00:13:11.026 --> 00:13:12.156 A:middle
any other background mode, and

00:13:12.156 --> 00:13:13.996 A:middle
we can now use just AVFoundation

00:13:13.996 --> 00:13:15.266 A:middle
directly in the background.

00:13:16.616 --> 00:13:18.626 A:middle
We also are exposing the ability

00:13:18.626 --> 00:13:21.586 A:middle
to allow you to, allow your user

00:13:21.586 --> 00:13:22.776 A:middle
to pick a different route.

00:13:22.776 --> 00:13:24.256 A:middle
So maybe some different types of

00:13:24.256 --> 00:13:25.196 A:middle
Bluetooth headphones.

00:13:26.176 --> 00:13:28.146 A:middle
And new in watchOS 5, we're also

00:13:28.146 --> 00:13:29.376 A:middle
exposing the MediaPlayer.

00:13:29.376 --> 00:13:30.636 A:middle
framework, so you can provide

00:13:30.636 --> 00:13:32.186 A:middle
some Now Playing information and

00:13:32.186 --> 00:13:34.686 A:middle
also handle any media remote

00:13:35.736 --> 00:13:36.026 A:middle
commands.

00:13:36.026 --> 00:13:37.626 A:middle
And just like our own Music,

00:13:37.626 --> 00:13:39.366 A:middle
Podcasts, and Radio app, the

00:13:39.366 --> 00:13:41.056 A:middle
long-form content is restricted

00:13:41.406 --> 00:13:43.516 A:middle
to Bluetooth routes, which

00:13:43.816 --> 00:13:45.406 A:middle
really is just a fancy way of

00:13:45.406 --> 00:13:46.776 A:middle
saying you can't play it through

00:13:47.236 --> 00:13:49.276 A:middle
the speaker.

00:13:49.446 --> 00:13:50.906 A:middle
So let's take it step by step

00:13:51.306 --> 00:13:52.836 A:middle
and talk about how we actually

00:13:52.836 --> 00:13:54.386 A:middle
get this background long-form

00:13:54.386 --> 00:13:55.206 A:middle
content to play.

00:13:55.756 --> 00:13:58.366 A:middle
So the first thing, you add

00:13:58.366 --> 00:13:59.886 A:middle
audio to your info.plist

00:13:59.886 --> 00:14:00.726 A:middle
background modes.

00:13:59.886 --> 00:14:00.726 A:middle
background modes.

00:14:01.166 --> 00:14:04.366 A:middle
And then, you just appropriately

00:14:04.366 --> 00:14:05.656 A:middle
set up your session, and you're

00:14:05.656 --> 00:14:06.806 A:middle
going to want to tell the system

00:14:06.806 --> 00:14:07.696 A:middle
that you want to play this

00:14:07.696 --> 00:14:09.136 A:middle
long-form content in the

00:14:09.136 --> 00:14:09.646 A:middle
background.

00:14:09.956 --> 00:14:13.456 A:middle
You want to allow your user to

00:14:13.696 --> 00:14:14.736 A:middle
select a different route.

00:14:14.986 --> 00:14:16.976 A:middle
And then, you're just going to

00:14:16.976 --> 00:14:18.416 A:middle
want to call play and

00:14:18.666 --> 00:14:19.656 A:middle
appropriately handle the

00:14:19.656 --> 00:14:20.916 A:middle
playback when the user's in the

00:14:20.916 --> 00:14:23.006 A:middle
middle of that playback session.

00:14:23.866 --> 00:14:25.606 A:middle
So let's break that more, break

00:14:25.606 --> 00:14:28.266 A:middle
that down more a little bit.

00:14:29.196 --> 00:14:30.956 A:middle
And so in Xcode in the Project

00:14:30.956 --> 00:14:32.486 A:middle
Settings, in the Capabilities

00:14:32.486 --> 00:14:34.696 A:middle
tab, you just flip the switch

00:14:34.696 --> 00:14:35.876 A:middle
for Background Mode, you check

00:14:35.876 --> 00:14:37.396 A:middle
off Audio, and you're good to go

00:14:37.396 --> 00:14:38.206 A:middle
to the next step.

00:14:38.576 --> 00:14:42.056 A:middle
And so to set up your session,

00:14:42.236 --> 00:14:43.186 A:middle
you're going to want to set your

00:14:43.186 --> 00:14:45.126 A:middle
routeSharingPolicy to longform

00:14:45.346 --> 00:14:46.626 A:middle
on your AVAudioSession.

00:14:46.726 --> 00:14:49.026 A:middle
And then, you call the new

00:14:49.026 --> 00:14:50.886 A:middle
activate withOptions completion

00:14:51.646 --> 00:14:53.726 A:middle
method on AVAudioSession.

00:14:53.936 --> 00:14:55.276 A:middle
And then, once it completes,

00:14:55.276 --> 00:14:56.216 A:middle
you're going to call play.

00:14:57.276 --> 00:14:58.946 A:middle
And in between when you first

00:14:58.946 --> 00:15:01.106 A:middle
call the activate function and

00:14:58.946 --> 00:15:01.106 A:middle
call the activate function and

00:15:01.266 --> 00:15:02.926 A:middle
then when the completion comes

00:15:02.966 --> 00:15:04.676 A:middle
back, what we call the route

00:15:04.676 --> 00:15:06.176 A:middle
picker is going to get displayed

00:15:06.176 --> 00:15:06.956 A:middle
on your behalf.

00:15:07.336 --> 00:15:09.636 A:middle
And so this is what the route

00:15:09.636 --> 00:15:10.516 A:middle
picker looks like.

00:15:10.516 --> 00:15:11.396 A:middle
And so this is going to be

00:15:11.396 --> 00:15:12.616 A:middle
showing up within your

00:15:12.616 --> 00:15:14.126 A:middle
application, which is going to

00:15:14.126 --> 00:15:15.966 A:middle
allow your user to pick

00:15:15.966 --> 00:15:17.266 A:middle
whichever Bluetooth headphones

00:15:17.266 --> 00:15:18.746 A:middle
route they want to have and

00:15:18.746 --> 00:15:19.656 A:middle
control their playback.

00:15:21.376 --> 00:15:22.636 A:middle
So let's talk a little bit more

00:15:22.636 --> 00:15:23.486 A:middle
about that route picker.

00:15:23.986 --> 00:15:25.446 A:middle
Again, all it is, you just call

00:15:25.446 --> 00:15:26.796 A:middle
your asynchronous activate

00:15:27.166 --> 00:15:29.496 A:middle
function, which is going to call

00:15:29.496 --> 00:15:32.036 A:middle
and show your route picker, and

00:15:32.276 --> 00:15:33.456 A:middle
then it's going to come back

00:15:33.796 --> 00:15:34.856 A:middle
into your completion, and you

00:15:34.856 --> 00:15:36.196 A:middle
handle that, and you just call

00:15:36.196 --> 00:15:36.396 A:middle
play.

00:15:36.396 --> 00:15:38.026 A:middle
And you're going to want to do

00:15:38.026 --> 00:15:39.146 A:middle
this every time you want

00:15:39.146 --> 00:15:40.016 A:middle
playback to occur.

00:15:40.236 --> 00:15:41.566 A:middle
So that way, you can ensure that

00:15:41.566 --> 00:15:43.846 A:middle
you have appropriate route to

00:15:43.846 --> 00:15:45.046 A:middle
cause some playback to occur.

00:15:46.496 --> 00:15:47.956 A:middle
All right, so let's jump into

00:15:47.956 --> 00:15:49.246 A:middle
code and set up our session.

00:15:49.886 --> 00:15:50.836 A:middle
And so we have our

00:15:50.836 --> 00:15:52.576 A:middle
AVAudioSession, and then we're

00:15:52.576 --> 00:15:53.676 A:middle
going to set our category to

00:15:53.676 --> 00:15:54.256 A:middle
playback.

00:15:54.816 --> 00:15:55.506 A:middle
And then, we're going to set our

00:15:55.506 --> 00:15:56.606 A:middle
mode to default.

00:15:57.256 --> 00:15:58.706 A:middle
And then, most importantly,

00:15:58.706 --> 00:15:59.596 A:middle
we're going to set our route

00:15:59.596 --> 00:16:01.176 A:middle
sharing policy to longform.

00:15:59.596 --> 00:16:01.176 A:middle
sharing policy to longform.

00:16:02.076 --> 00:16:03.656 A:middle
And then, you want to activate

00:16:03.656 --> 00:16:05.406 A:middle
your session, which is going to

00:16:05.406 --> 00:16:07.316 A:middle
display the route picker, and

00:16:07.316 --> 00:16:08.346 A:middle
then you're going to call play

00:16:08.346 --> 00:16:08.946 A:middle
appropriately.

00:16:10.006 --> 00:16:11.816 A:middle
And now, for that route picker,

00:16:11.816 --> 00:16:13.666 A:middle
I wanted to call out that we

00:16:13.666 --> 00:16:15.276 A:middle
really think of routes in two

00:16:15.276 --> 00:16:15.906 A:middle
different ways.

00:16:16.766 --> 00:16:18.536 A:middle
And the first way is our Apple

00:16:18.536 --> 00:16:19.906 A:middle
wireless chip-based routes,

00:16:19.906 --> 00:16:21.106 A:middle
which are commonly referred to

00:16:21.106 --> 00:16:21.866 A:middle
as our W1 routes.

00:16:21.866 --> 00:16:24.256 A:middle
So these are our AirPods or

00:16:24.256 --> 00:16:25.506 A:middle
Beats Studio Wireless.

00:16:26.476 --> 00:16:27.386 A:middle
And then, we just have our

00:16:27.386 --> 00:16:28.526 A:middle
normal Bluetooth headphone

00:16:28.526 --> 00:16:28.946 A:middle
routes.

00:16:29.646 --> 00:16:30.986 A:middle
And it's important to make that

00:16:30.986 --> 00:16:32.836 A:middle
distinction when we talk about

00:16:33.196 --> 00:16:34.496 A:middle
the route picker itself.

00:16:37.056 --> 00:16:39.206 A:middle
And so if the user has an active

00:16:39.206 --> 00:16:40.726 A:middle
connected route, then the route

00:16:40.726 --> 00:16:41.846 A:middle
picker's going to automatically

00:16:41.846 --> 00:16:42.916 A:middle
select that route on your

00:16:42.916 --> 00:16:43.186 A:middle
behalf.

00:16:43.756 --> 00:16:44.666 A:middle
What's great is that the route

00:16:44.666 --> 00:16:46.146 A:middle
picker might not even display to

00:16:46.146 --> 00:16:46.796 A:middle
your user.

00:16:47.036 --> 00:16:47.926 A:middle
You're just going to get called

00:16:47.926 --> 00:16:49.146 A:middle
back in your completion

00:16:49.456 --> 00:16:50.066 A:middle
immediately.

00:16:50.506 --> 00:16:53.296 A:middle
And in the case where the user

00:16:53.296 --> 00:16:55.276 A:middle
has an active W1 route but it's

00:16:55.306 --> 00:16:57.416 A:middle
being used by the iPhone, then

00:16:57.416 --> 00:16:58.806 A:middle
the system's going to grab that

00:16:58.806 --> 00:17:00.346 A:middle
route from iPhone and bring it

00:16:58.806 --> 00:17:00.346 A:middle
route from iPhone and bring it

00:17:00.346 --> 00:17:01.586 A:middle
directly to your watch.

00:17:02.616 --> 00:17:03.806 A:middle
And there's some cases where

00:17:03.806 --> 00:17:04.646 A:middle
that won't happen.

00:17:04.646 --> 00:17:06.126 A:middle
It's really just when your

00:17:06.126 --> 00:17:07.435 A:middle
iPhone has more priority.

00:17:07.866 --> 00:17:09.205 A:middle
So for example, say I'm in the

00:17:09.205 --> 00:17:10.886 A:middle
middle of a phone call on my

00:17:10.886 --> 00:17:11.465 A:middle
phone.

00:17:11.685 --> 00:17:12.636 A:middle
Then, we're not going to take

00:17:12.636 --> 00:17:13.766 A:middle
that route and put it on your

00:17:13.766 --> 00:17:15.286 A:middle
watch because phone call's

00:17:15.776 --> 00:17:16.945 A:middle
probably pretty important.

00:17:17.425 --> 00:17:20.195 A:middle
And if there are no active

00:17:20.195 --> 00:17:21.356 A:middle
routes, then the route picker

00:17:21.356 --> 00:17:23.685 A:middle
will just appear on your behalf.

00:17:24.636 --> 00:17:26.425 A:middle
All right, so that's our route

00:17:26.425 --> 00:17:27.576 A:middle
picker, and now let's talk

00:17:27.576 --> 00:17:29.296 A:middle
about, how do we actually get

00:17:29.296 --> 00:17:30.316 A:middle
some playback to occur?

00:17:31.306 --> 00:17:32.686 A:middle
Well, you just use the same

00:17:32.686 --> 00:17:34.836 A:middle
AVAudioPlayer and AVAudioEngine.

00:17:34.996 --> 00:17:35.946 A:middle
And there's a variety of

00:17:35.946 --> 00:17:36.946 A:middle
different formats that are

00:17:36.946 --> 00:17:38.236 A:middle
supported on watchOS.

00:17:38.946 --> 00:17:40.116 A:middle
And what's great about this is

00:17:40.226 --> 00:17:42.586 A:middle
if you have iOS code that uses

00:17:42.586 --> 00:17:44.006 A:middle
these classes, then you could

00:17:44.006 --> 00:17:45.256 A:middle
have a shared framework between

00:17:45.256 --> 00:17:46.936 A:middle
your iOS and watchOS playback

00:17:47.246 --> 00:17:48.026 A:middle
operations.

00:17:49.096 --> 00:17:51.206 A:middle
And in the case of

00:17:51.206 --> 00:17:53.736 A:middle
AVAudioEngine, you can actually

00:17:53.736 --> 00:17:55.506 A:middle
play some DRM content in

00:17:55.506 --> 00:17:57.186 A:middle
conjunction with AVAudioPlayer

00:17:57.186 --> 00:17:57.446 A:middle
node.

00:17:57.996 --> 00:17:59.666 A:middle
And so you can now play your own

00:17:59.666 --> 00:18:01.086 A:middle
DRM content, decrypt it

00:17:59.666 --> 00:18:01.086 A:middle
DRM content, decrypt it

00:18:01.086 --> 00:18:02.926 A:middle
yourself, and play it back for

00:18:02.926 --> 00:18:03.426 A:middle
your user.

00:18:03.936 --> 00:18:06.476 A:middle
An especially important thing to

00:18:06.476 --> 00:18:09.676 A:middle
note for watchOS is the power of

00:18:09.676 --> 00:18:11.866 A:middle
the device itself, so only play

00:18:11.866 --> 00:18:14.056 A:middle
audio when absolutely necessary,

00:18:14.056 --> 00:18:15.476 A:middle
when the user actually wants the

00:18:15.476 --> 00:18:16.326 A:middle
audio to occur.

00:18:17.316 --> 00:18:19.386 A:middle
And for AVAudioEngine, the

00:18:19.386 --> 00:18:21.886 A:middle
autoShutdownEnabled property is

00:18:21.966 --> 00:18:24.096 A:middle
enabled by default, so if there

00:18:24.096 --> 00:18:25.946 A:middle
are no active nodes on your

00:18:25.946 --> 00:18:27.426 A:middle
AVAudioEngine, then we're going

00:18:27.426 --> 00:18:29.026 A:middle
to automatically power down your

00:18:29.026 --> 00:18:31.026 A:middle
AVAudioEngine when necessary.

00:18:31.516 --> 00:18:34.796 A:middle
And so that's our playback.

00:18:35.366 --> 00:18:37.366 A:middle
And then, we, let's talk about

00:18:37.366 --> 00:18:38.006 A:middle
our MediaPlayer.

00:18:38.006 --> 00:18:38.436 A:middle
framework.

00:18:38.826 --> 00:18:40.076 A:middle
So we want to, of course,

00:18:40.076 --> 00:18:41.176 A:middle
provide our Now Playing

00:18:41.176 --> 00:18:44.136 A:middle
information to the system.

00:18:44.586 --> 00:18:47.576 A:middle
And then, the Now Playing UI

00:18:47.576 --> 00:18:48.826 A:middle
will update, and that's the

00:18:48.826 --> 00:18:50.766 A:middle
system-wide notion of what's

00:18:50.796 --> 00:18:51.886 A:middle
playing, and it's going to be

00:18:51.886 --> 00:18:53.546 A:middle
updated based on the information

00:18:53.546 --> 00:18:54.136 A:middle
you provide.

00:18:54.556 --> 00:18:55.506 A:middle
So this is going to show up in

00:18:55.506 --> 00:18:57.156 A:middle
the Now Playing app, and even

00:18:57.156 --> 00:18:59.386 A:middle
inside apps such as Workout, or

00:18:59.386 --> 00:19:00.636 A:middle
in the cases of any third-party

00:18:59.386 --> 00:19:00.636 A:middle
in the cases of any third-party

00:19:00.636 --> 00:19:02.586 A:middle
apps that embed that Now Playing

00:19:02.586 --> 00:19:02.906 A:middle
view.

00:19:03.376 --> 00:19:04.796 A:middle
This will also show up there.

00:19:04.796 --> 00:19:07.366 A:middle
And then, with the MediaPlayer.

00:19:07.366 --> 00:19:08.326 A:middle
framework, we just want to

00:19:08.326 --> 00:19:10.386 A:middle
handle the events, any type of

00:19:10.386 --> 00:19:11.626 A:middle
media remote commands -- for

00:19:11.626 --> 00:19:13.396 A:middle
example, a Next Track on

00:19:13.396 --> 00:19:14.526 A:middle
AirPods, for instance.

00:19:15.576 --> 00:19:16.846 A:middle
All right, let's jump into some

00:19:16.846 --> 00:19:18.146 A:middle
code and see how we can provide

00:19:18.146 --> 00:19:19.346 A:middle
that Now Playing information.

00:19:23.216 --> 00:19:24.776 A:middle
So here we are.

00:19:24.776 --> 00:19:26.376 A:middle
We have our MPNowPlaying

00:19:26.376 --> 00:19:26.986 A:middle
InfoCenter.

00:19:26.986 --> 00:19:28.176 A:middle
We just want to grab that.

00:19:28.576 --> 00:19:29.386 A:middle
And then, we set up our

00:19:29.386 --> 00:19:30.406 A:middle
nowPlayingInfo.

00:19:30.956 --> 00:19:35.046 A:middle
And then, we have, we want to

00:19:35.046 --> 00:19:36.526 A:middle
set our artwork, our MPMedia

00:19:36.526 --> 00:19:37.566 A:middle
ItemArtwork.

00:19:37.866 --> 00:19:39.126 A:middle
And it's not currently available

00:19:39.126 --> 00:19:40.366 A:middle
in seed 1, but it's coming in

00:19:40.366 --> 00:19:40.876 A:middle
seed 2.

00:19:41.456 --> 00:19:43.526 A:middle
And in this case, the artwork

00:19:43.526 --> 00:19:45.306 A:middle
that you provide will display on

00:19:45.306 --> 00:19:46.436 A:middle
the Siri watch face.

00:19:46.956 --> 00:19:50.006 A:middle
And then, we just set up, in

00:19:50.006 --> 00:19:51.606 A:middle
this case, our title, album,

00:19:51.606 --> 00:19:53.646 A:middle
artwork, and then we set it to

00:19:53.646 --> 00:19:55.436 A:middle
our nowPlaying InfoCenter.

00:19:56.206 --> 00:19:57.726 A:middle
And then, when we do something

00:19:57.726 --> 00:20:01.206 A:middle
such as this, then our data will

00:19:57.726 --> 00:20:01.206 A:middle
such as this, then our data will

00:20:01.206 --> 00:20:02.946 A:middle
appear in the Now Playing app.

00:20:02.946 --> 00:20:04.276 A:middle
And this is the actual Now

00:20:04.276 --> 00:20:04.816 A:middle
Playing app.

00:20:05.086 --> 00:20:07.516 A:middle
And I provided some, a song that

00:20:07.516 --> 00:20:09.476 A:middle
I was currently listening to in

00:20:09.476 --> 00:20:10.296 A:middle
my application.

00:20:10.686 --> 00:20:13.866 A:middle
And when we do this, then, also,

00:20:13.866 --> 00:20:15.196 A:middle
the Now Playing complication

00:20:15.196 --> 00:20:16.306 A:middle
will also get updated.

00:20:16.576 --> 00:20:17.726 A:middle
So in this case, the bottom

00:20:17.726 --> 00:20:18.866 A:middle
shows the "Lights in the Sky"

00:20:18.866 --> 00:20:19.956 A:middle
song that I was listening to.

00:20:20.286 --> 00:20:22.786 A:middle
And then, for media remote

00:20:22.786 --> 00:20:24.246 A:middle
commands, again, just use the

00:20:24.246 --> 00:20:24.836 A:middle
MediaPlayer.

00:20:24.836 --> 00:20:25.256 A:middle
framework.

00:20:25.256 --> 00:20:27.416 A:middle
And now, in watchOS, you can

00:20:27.416 --> 00:20:28.846 A:middle
handle those commands however

00:20:28.846 --> 00:20:29.466 A:middle
you wish.

00:20:31.366 --> 00:20:32.876 A:middle
So let's look at some code.

00:20:32.876 --> 00:20:34.456 A:middle
So we just grab our

00:20:34.566 --> 00:20:35.986 A:middle
MPRemoteCommandCenter.

00:20:36.836 --> 00:20:38.266 A:middle
And then, instead of doing a

00:20:38.266 --> 00:20:40.046 A:middle
Next Track, let's talk about how

00:20:40.046 --> 00:20:42.156 A:middle
we can actually skip forward for

00:20:42.656 --> 00:20:43.546 A:middle
our user.

00:20:43.666 --> 00:20:44.846 A:middle
So I have this function.

00:20:44.966 --> 00:20:46.966 A:middle
It's a enableSkipForwardCommand

00:20:47.396 --> 00:20:48.666 A:middle
and, just by default, takes in

00:20:48.666 --> 00:20:49.866 A:middle
15 seconds.

00:20:50.816 --> 00:20:52.646 A:middle
And I set my preferred intervals

00:20:52.646 --> 00:20:53.836 A:middle
on my skip forward command.

00:20:53.946 --> 00:20:55.966 A:middle
And then, I just add a target

00:20:55.966 --> 00:20:57.836 A:middle
and selector, and then I just

00:20:57.836 --> 00:20:59.636 A:middle
enable the command within my

00:20:59.636 --> 00:21:00.596 A:middle
remote command center.

00:20:59.636 --> 00:21:00.596 A:middle
remote command center.

00:21:01.896 --> 00:21:03.406 A:middle
If you want to know more about

00:21:03.406 --> 00:21:04.616 A:middle
the media player framework and

00:21:04.616 --> 00:21:05.696 A:middle
especially these media remote

00:21:05.696 --> 00:21:07.296 A:middle
commands, I highly recommend

00:21:07.296 --> 00:21:09.236 A:middle
checking out the MP remote

00:21:09.236 --> 00:21:10.866 A:middle
command sample that's available

00:21:10.866 --> 00:21:11.376 A:middle
online.

00:21:11.946 --> 00:21:12.996 A:middle
And in this case, when I

00:21:12.996 --> 00:21:14.536 A:middle
actually set my preferred

00:21:14.536 --> 00:21:17.156 A:middle
intervals, then the system's Now

00:21:17.156 --> 00:21:18.606 A:middle
Playing app will appropriately

00:21:18.606 --> 00:21:19.226 A:middle
get adjusted.

00:21:19.226 --> 00:21:21.056 A:middle
That Now Playing UI, wherever it

00:21:21.056 --> 00:21:22.876 A:middle
is, will show the minus 15

00:21:22.876 --> 00:21:25.196 A:middle
seconds or plus 15 seconds, and

00:21:25.196 --> 00:21:29.396 A:middle
that's all done on your behalf.

00:21:29.546 --> 00:21:32.086 A:middle
All right, so that's the audio

00:21:32.086 --> 00:21:34.486 A:middle
experience on watch, or that's

00:21:34.486 --> 00:21:35.826 A:middle
our playback, so let's talk

00:21:35.826 --> 00:21:37.016 A:middle
about our audio experience.

00:21:42.216 --> 00:21:44.286 A:middle
So there's 4 major things I want

00:21:44.286 --> 00:21:45.316 A:middle
to talk about first for the

00:21:45.316 --> 00:21:46.086 A:middle
audio experience.

00:21:46.476 --> 00:21:47.506 A:middle
There's our auto-launching

00:21:47.506 --> 00:21:48.536 A:middle
feature where your app will

00:21:48.536 --> 00:21:49.686 A:middle
automatically get launched.

00:21:50.236 --> 00:21:51.696 A:middle
There's the frontmost app state

00:21:51.696 --> 00:21:52.966 A:middle
and how we can take advantage of

00:21:52.966 --> 00:21:54.366 A:middle
that in our application.

00:21:54.936 --> 00:21:56.396 A:middle
There's our new interactive

00:21:56.396 --> 00:21:57.356 A:middle
notifications.

00:21:57.716 --> 00:21:59.506 A:middle
And how to integrate with Siri

00:21:59.506 --> 00:22:00.066 A:middle
Shortcuts.

00:21:59.506 --> 00:22:00.066 A:middle
Shortcuts.

00:22:03.076 --> 00:22:05.566 A:middle
And so we've been talking a lot

00:22:05.566 --> 00:22:06.856 A:middle
about playback occurring on the

00:22:06.856 --> 00:22:09.316 A:middle
watch itself, but I want to take

00:22:09.316 --> 00:22:10.836 A:middle
a step back, and I just wanted

00:22:10.836 --> 00:22:11.986 A:middle
to talk through that remote

00:22:11.986 --> 00:22:14.946 A:middle
control case.

00:22:15.136 --> 00:22:16.886 A:middle
So let's say I was playing some

00:22:16.886 --> 00:22:19.026 A:middle
Apple Music on my iPhone, and

00:22:19.026 --> 00:22:20.426 A:middle
automatically the Now Playing

00:22:20.426 --> 00:22:22.176 A:middle
app will get displayed on my

00:22:22.176 --> 00:22:22.726 A:middle
watch.

00:22:23.016 --> 00:22:24.486 A:middle
And I love this feature.

00:22:24.486 --> 00:22:25.986 A:middle
It feels like magic when I just

00:22:25.986 --> 00:22:27.396 A:middle
look at my wrist and I can

00:22:27.396 --> 00:22:28.896 A:middle
easily control my playback.

00:22:28.896 --> 00:22:31.876 A:middle
I, it's the coolest thing.

00:22:33.306 --> 00:22:34.456 A:middle
And in the case where it's our

00:22:34.456 --> 00:22:35.626 A:middle
application that's actually

00:22:35.626 --> 00:22:37.226 A:middle
causing the playback to occur on

00:22:37.226 --> 00:22:38.626 A:middle
iPhone, then our app

00:22:38.626 --> 00:22:40.406 A:middle
automatically gets launched on

00:22:40.406 --> 00:22:40.936 A:middle
the watch.

00:22:45.356 --> 00:22:46.766 A:middle
And we call this the auto-launch

00:22:46.766 --> 00:22:47.886 A:middle
audio apps feature.

00:22:48.386 --> 00:22:49.766 A:middle
And so whenever the Now Playing

00:22:49.766 --> 00:22:51.496 A:middle
session is occurring on iPhone,

00:22:51.806 --> 00:22:53.426 A:middle
then our Apple Watch app will be

00:22:53.426 --> 00:22:55.116 A:middle
brought frontmost at that time.

00:22:56.126 --> 00:22:57.316 A:middle
And we're going to stay

00:22:57.316 --> 00:22:59.126 A:middle
frontmost for the duration of

00:22:59.126 --> 00:22:59.766 A:middle
that session.

00:23:00.056 --> 00:23:01.406 A:middle
So as long as the user is

00:23:01.406 --> 00:23:02.726 A:middle
listening to content on iPhone,

00:23:02.986 --> 00:23:04.736 A:middle
then our app will stay

00:23:04.736 --> 00:23:06.076 A:middle
frontmost, unless the user

00:23:06.076 --> 00:23:07.296 A:middle
decides to navigate away.

00:23:08.556 --> 00:23:11.196 A:middle
And new in watchOS 5 is we're

00:23:11.196 --> 00:23:12.756 A:middle
exposing a Now Playing session

00:23:12.756 --> 00:23:14.816 A:middle
API where you're going to know

00:23:14.816 --> 00:23:16.236 A:middle
when you're launched for this

00:23:16.236 --> 00:23:17.756 A:middle
Now Playing session on iPhone,

00:23:18.156 --> 00:23:19.496 A:middle
and so you can take your user

00:23:19.496 --> 00:23:21.106 A:middle
directly to the appropriate

00:23:21.106 --> 00:23:21.396 A:middle
view.

00:23:21.906 --> 00:23:24.026 A:middle
And to do this, you're going to

00:23:24.026 --> 00:23:25.486 A:middle
use the handleRemoteNow

00:23:25.486 --> 00:23:27.216 A:middle
PlayingActivity on your

00:23:27.216 --> 00:23:28.326 A:middle
WKExtension Delegate.

00:23:30.026 --> 00:23:31.636 A:middle
So let's take a look at some

00:23:31.636 --> 00:23:33.086 A:middle
code and see how we could use

00:23:35.796 --> 00:23:35.896 A:middle
this.

00:23:36.086 --> 00:23:36.976 A:middle
So here we are.

00:23:36.976 --> 00:23:38.196 A:middle
I have my extension delegate,

00:23:39.176 --> 00:23:40.406 A:middle
and then I can implement my

00:23:40.406 --> 00:23:42.316 A:middle
handleRemoteNow PlayingActivity.

00:23:43.216 --> 00:23:44.286 A:middle
And the first thing I want to

00:23:44.286 --> 00:23:46.216 A:middle
check is, where is my user at

00:23:46.216 --> 00:23:46.846 A:middle
that time?

00:23:47.476 --> 00:23:50.256 A:middle
So I can just grab the visible

00:23:50.256 --> 00:23:51.926 A:middle
interface controller, I can

00:23:51.926 --> 00:23:54.016 A:middle
check where my user is, and if

00:23:54.016 --> 00:23:55.856 A:middle
the user already is at my Now

00:23:55.856 --> 00:23:57.576 A:middle
Playing UI, that's great.

00:23:57.776 --> 00:23:58.746 A:middle
Let's leave them right there.

00:23:59.896 --> 00:24:01.116 A:middle
But in the case they're not, we

00:23:59.896 --> 00:24:01.116 A:middle
But in the case they're not, we

00:24:01.116 --> 00:24:03.916 A:middle
can just reload directly to our

00:24:03.916 --> 00:24:04.316 A:middle
view.

00:24:04.316 --> 00:24:05.836 A:middle
So that way, we have that same

00:24:05.836 --> 00:24:07.636 A:middle
magical experience where I raise

00:24:07.636 --> 00:24:09.536 A:middle
my wrists and I see the remote

00:24:09.536 --> 00:24:10.976 A:middle
controls that I want to use.

00:24:16.116 --> 00:24:18.396 A:middle
And in some cases, you might

00:24:18.396 --> 00:24:20.316 A:middle
want to opt out of this feature

00:24:20.316 --> 00:24:21.416 A:middle
if it doesn't make sense for

00:24:21.416 --> 00:24:22.056 A:middle
your user.

00:24:22.506 --> 00:24:23.896 A:middle
So just do the right thing.

00:24:23.896 --> 00:24:25.066 A:middle
Make that decision.

00:24:25.376 --> 00:24:26.556 A:middle
And let's say our app has

00:24:26.556 --> 00:24:28.616 A:middle
nothing to do with our phone

00:24:28.616 --> 00:24:29.946 A:middle
app, and that's an appropriate

00:24:29.946 --> 00:24:31.196 A:middle
use of actually opting out of

00:24:31.196 --> 00:24:32.086 A:middle
this capability.

00:24:32.836 --> 00:24:34.756 A:middle
And so to do so, use the auto,

00:24:34.946 --> 00:24:36.716 A:middle
the opt out of auto-launch

00:24:36.716 --> 00:24:40.396 A:middle
feature on your WK extension's

00:24:40.396 --> 00:24:41.306 A:middle
info.plist.

00:24:41.796 --> 00:24:44.916 A:middle
And in the case you do opt out,

00:24:44.996 --> 00:24:46.366 A:middle
then the Now Playing app will

00:24:46.366 --> 00:24:47.146 A:middle
show instead.

00:24:52.046 --> 00:24:53.716 A:middle
And now, let's talk about that

00:24:53.716 --> 00:24:55.116 A:middle
frontmost app state, and let's

00:24:55.116 --> 00:24:56.636 A:middle
give a little bit of a refresher

00:24:56.636 --> 00:24:56.906 A:middle
of that.

00:24:58.096 --> 00:25:00.196 A:middle
So here I have my app.

00:24:58.096 --> 00:25:00.196 A:middle
So here I have my app.

00:25:00.196 --> 00:25:01.276 A:middle
It's foreground running.

00:25:01.276 --> 00:25:02.196 A:middle
I'm looking at it.

00:25:02.526 --> 00:25:04.066 A:middle
The screen is on, and this app

00:25:04.066 --> 00:25:05.486 A:middle
is considered active and

00:25:05.486 --> 00:25:06.176 A:middle
frontmost.

00:25:06.826 --> 00:25:07.766 A:middle
But then, let's say I put my

00:25:07.766 --> 00:25:08.376 A:middle
wrist down.

00:25:09.546 --> 00:25:11.246 A:middle
In that case, the application is

00:25:11.246 --> 00:25:12.646 A:middle
still considered frontmost

00:25:13.106 --> 00:25:14.396 A:middle
because if I raise my wrist

00:25:14.396 --> 00:25:15.326 A:middle
again, I'll see that

00:25:15.326 --> 00:25:15.996 A:middle
application.

00:25:16.416 --> 00:25:18.356 A:middle
And in that case, the

00:25:18.356 --> 00:25:19.916 A:middle
application is just in the

00:25:19.916 --> 00:25:20.506 A:middle
background.

00:25:24.116 --> 00:25:26.066 A:middle
So with the frontmost app state,

00:25:26.266 --> 00:25:27.226 A:middle
we get some enhanced

00:25:27.226 --> 00:25:28.586 A:middle
capabilities from the system.

00:25:29.116 --> 00:25:32.286 A:middle
Our background transfers from

00:25:32.406 --> 00:25:33.856 A:middle
iPhones -- so say we were

00:25:33.856 --> 00:25:35.436 A:middle
transferring our content from

00:25:35.576 --> 00:25:36.986 A:middle
iPhone to watch itself, those

00:25:36.986 --> 00:25:39.036 A:middle
background transfers, when they

00:25:39.036 --> 00:25:40.326 A:middle
complete, the resumes will

00:25:40.476 --> 00:25:42.266 A:middle
directly just wake up our app if

00:25:42.266 --> 00:25:43.276 A:middle
we're in the frontmost app

00:25:43.276 --> 00:25:43.586 A:middle
state.

00:25:44.486 --> 00:25:45.996 A:middle
And the same thing in, with our

00:25:45.996 --> 00:25:47.286 A:middle
URL session resumes.

00:25:47.616 --> 00:25:49.886 A:middle
So if the URL session, our

00:25:49.886 --> 00:25:51.246 A:middle
background session before was

00:25:51.246 --> 00:25:53.166 A:middle
downloading and it completes,

00:25:53.166 --> 00:25:54.396 A:middle
then our app will automatically

00:25:54.396 --> 00:25:55.926 A:middle
get waked up and deliver the

00:25:55.926 --> 00:25:56.346 A:middle
payload.

00:25:56.826 --> 00:26:00.566 A:middle
And if we're frontmost, we're

00:25:56.826 --> 00:26:00.566 A:middle
And if we're frontmost, we're

00:26:00.566 --> 00:26:02.256 A:middle
going to get called into, so we

00:26:02.256 --> 00:26:03.776 A:middle
can decide whenever, if a

00:26:03.776 --> 00:26:06.036 A:middle
notification appears, how we

00:26:06.036 --> 00:26:07.206 A:middle
properly want to handle that

00:26:07.206 --> 00:26:07.916 A:middle
notification.

00:26:08.286 --> 00:26:09.686 A:middle
Maybe we want to keep our user

00:26:09.686 --> 00:26:11.166 A:middle
in the app, or maybe we want to

00:26:11.166 --> 00:26:12.366 A:middle
show the notification to our

00:26:12.366 --> 00:26:12.716 A:middle
user.

00:26:13.136 --> 00:26:14.566 A:middle
And in the frontmost app state,

00:26:14.566 --> 00:26:15.826 A:middle
we can make that decision.

00:26:16.256 --> 00:26:18.786 A:middle
And when you're in the frontmost

00:26:18.786 --> 00:26:20.086 A:middle
app state, you can play some

00:26:20.086 --> 00:26:20.626 A:middle
haptics.

00:26:21.236 --> 00:26:23.516 A:middle
And if you want to know a little

00:26:23.516 --> 00:26:24.706 A:middle
bit more about frontmost app

00:26:24.706 --> 00:26:26.646 A:middle
state, there's the talk from

00:26:26.646 --> 00:26:28.236 A:middle
last year, The Life of a watchOS

00:26:28.236 --> 00:26:28.476 A:middle
App.

00:26:28.956 --> 00:26:30.396 A:middle
It's a great talk.

00:26:30.396 --> 00:26:31.806 A:middle
You might recognize the speaker.

00:26:31.806 --> 00:26:32.666 A:middle
He's okay.

00:26:33.636 --> 00:26:35.956 A:middle
And so you're going to stay

00:26:35.956 --> 00:26:38.816 A:middle
frontmost for 2 minutes, but, if

00:26:38.816 --> 00:26:40.396 A:middle
you recall, I extended my

00:26:40.396 --> 00:26:41.336 A:middle
frontmost earlier.

00:26:41.716 --> 00:26:43.066 A:middle
And so in that case, it's just

00:26:43.066 --> 00:26:44.276 A:middle
going to be extended by default

00:26:44.566 --> 00:26:45.526 A:middle
to 8 minutes.

00:26:45.986 --> 00:26:47.636 A:middle
And so, again, this is great for

00:26:47.636 --> 00:26:48.856 A:middle
when we were downloading that

00:26:48.856 --> 00:26:50.666 A:middle
content from before, and so I

00:26:50.666 --> 00:26:52.666 A:middle
can just extend my time out.

00:27:00.236 --> 00:27:01.446 A:middle
And when we're actually playing

00:27:01.446 --> 00:27:03.996 A:middle
back some audio, our app will be

00:27:03.996 --> 00:27:06.046 A:middle
kept frontmost for the duration

00:27:06.046 --> 00:27:07.796 A:middle
of that session, just like when

00:27:07.796 --> 00:27:08.586 A:middle
we were actually remote

00:27:08.586 --> 00:27:10.006 A:middle
controlling the audio when it

00:27:10.006 --> 00:27:11.266 A:middle
was occurring on iPhone.

00:27:12.396 --> 00:27:13.566 A:middle
And again, if the user ever

00:27:13.566 --> 00:27:15.716 A:middle
navigates away, then you're no

00:27:15.716 --> 00:27:17.646 A:middle
longer frontmost, but your

00:27:17.646 --> 00:27:19.066 A:middle
background playback will still

00:27:19.066 --> 00:27:20.016 A:middle
occur appropriately.

00:27:21.166 --> 00:27:22.346 A:middle
And in that case, you can, of

00:27:22.346 --> 00:27:23.826 A:middle
course, properly handle all of

00:27:23.826 --> 00:27:26.266 A:middle
your background events.

00:27:26.266 --> 00:27:26.766 A:middle
All right.

00:27:28.656 --> 00:27:30.786 A:middle
So now, we're -- and when we are

00:27:30.786 --> 00:27:33.746 A:middle
in that frontmost state, then we

00:27:33.746 --> 00:27:35.306 A:middle
also can integrate properly with

00:27:35.306 --> 00:27:36.116 A:middle
notification.

00:27:36.116 --> 00:27:38.406 A:middle
So we could post, for example,

00:27:38.406 --> 00:27:39.586 A:middle
when the download completes, a

00:27:39.586 --> 00:27:40.806 A:middle
content available local

00:27:40.806 --> 00:27:41.546 A:middle
notification.

00:27:42.006 --> 00:27:43.466 A:middle
And we might want to have play

00:27:43.466 --> 00:27:44.826 A:middle
as our primary action.

00:27:45.596 --> 00:27:46.876 A:middle
And with our new interaction

00:27:46.876 --> 00:27:49.046 A:middle
notifications on watchOS, we can

00:27:49.046 --> 00:27:50.396 A:middle
allow our user to actually

00:27:50.396 --> 00:27:52.906 A:middle
configure some playback right

00:27:52.906 --> 00:27:54.766 A:middle
from within the notification and

00:27:54.766 --> 00:27:56.156 A:middle
then be able to call play as the

00:27:56.156 --> 00:27:57.946 A:middle
primary action, then get into

00:27:57.946 --> 00:27:59.616 A:middle
your app and immediately cause

00:27:59.616 --> 00:28:00.646 A:middle
some playback to occur.

00:27:59.616 --> 00:28:00.646 A:middle
some playback to occur.

00:28:01.576 --> 00:28:03.546 A:middle
So for example, say I had a

00:28:03.546 --> 00:28:06.146 A:middle
Salvador Dali exhibit.

00:28:06.146 --> 00:28:07.226 A:middle
It's ready to go.

00:28:07.296 --> 00:28:08.556 A:middle
I can then adjust the playback

00:28:08.556 --> 00:28:10.496 A:middle
speed, immediately call play,

00:28:10.996 --> 00:28:12.976 A:middle
that'll launch my app, and then

00:28:12.976 --> 00:28:14.556 A:middle
I can play that great content at

00:28:14.556 --> 00:28:16.006 A:middle
the appropriate rate for my

00:28:16.006 --> 00:28:16.326 A:middle
user.

00:28:16.326 --> 00:28:19.796 A:middle
If you want to know more about

00:28:19.796 --> 00:28:21.336 A:middle
some interactive notifications,

00:28:21.666 --> 00:28:22.856 A:middle
check out the What's New in

00:28:22.856 --> 00:28:24.226 A:middle
watchOS talk given earlier,

00:28:24.876 --> 00:28:26.056 A:middle
which is available online.

00:28:26.056 --> 00:28:27.676 A:middle
It was a great talk, and you'll

00:28:27.676 --> 00:28:28.756 A:middle
know a lot more about

00:28:28.756 --> 00:28:30.176 A:middle
interactive notifications after

00:28:30.176 --> 00:28:31.206 A:middle
watching it.

00:28:31.976 --> 00:28:33.526 A:middle
All right, so do you remember

00:28:33.526 --> 00:28:35.486 A:middle
this code from before where I

00:28:35.486 --> 00:28:36.456 A:middle
actually posted that

00:28:36.456 --> 00:28:39.316 A:middle
notification alerting our user

00:28:39.316 --> 00:28:40.376 A:middle
of this type of playback

00:28:40.376 --> 00:28:40.966 A:middle
opportunity?

00:28:41.396 --> 00:28:42.716 A:middle
Well, let's say our app was

00:28:42.716 --> 00:28:45.046 A:middle
frontmost at that time.

00:28:45.246 --> 00:28:46.336 A:middle
In that case, when I got

00:28:46.336 --> 00:28:48.006 A:middle
delivered the notification from

00:28:48.006 --> 00:28:50.306 A:middle
frontmost in user notification,

00:28:50.366 --> 00:28:52.126 A:middle
I'm going to get called into and

00:28:52.126 --> 00:28:53.866 A:middle
will present notification with

00:28:53.866 --> 00:28:55.276 A:middle
completion handler.

00:28:56.426 --> 00:28:57.886 A:middle
And in that case, I can actually

00:28:57.886 --> 00:28:59.406 A:middle
decide whether or not I want to

00:28:59.406 --> 00:29:00.846 A:middle
still post that notification.

00:28:59.406 --> 00:29:00.846 A:middle
still post that notification.

00:29:01.226 --> 00:29:02.436 A:middle
Or maybe because my app's

00:29:02.436 --> 00:29:04.176 A:middle
frontmost, I could just play a

00:29:04.176 --> 00:29:06.076 A:middle
haptic and let my user know

00:29:06.076 --> 00:29:07.586 A:middle
that, hey, raise your wrist, and

00:29:07.586 --> 00:29:08.516 A:middle
there's some new content.

00:29:08.516 --> 00:29:09.556 A:middle
I can update my view.

00:29:10.216 --> 00:29:11.436 A:middle
And again, if you want to know

00:29:11.436 --> 00:29:12.686 A:middle
some more about the frontmost

00:29:12.686 --> 00:29:14.396 A:middle
notifications, check out the

00:29:14.396 --> 00:29:15.636 A:middle
Life of a watchOS App.

00:29:16.516 --> 00:29:18.396 A:middle
Great, so that's how we used our

00:29:18.396 --> 00:29:19.976 A:middle
interactive notifications and

00:29:19.976 --> 00:29:22.266 A:middle
the frontmost app state, but we

00:29:22.266 --> 00:29:24.026 A:middle
also want to show up on the Siri

00:29:24.026 --> 00:29:24.756 A:middle
watch face.

00:29:25.756 --> 00:29:27.306 A:middle
And with audio apps, you can

00:29:27.306 --> 00:29:28.906 A:middle
provide suggestions of audio to

00:29:28.906 --> 00:29:30.806 A:middle
play on the Siri watch face

00:29:30.856 --> 00:29:32.336 A:middle
using relevant shortcuts.

00:29:32.976 --> 00:29:34.546 A:middle
So for example, that could be

00:29:34.646 --> 00:29:36.356 A:middle
the next episode of your user's

00:29:36.356 --> 00:29:38.506 A:middle
favorite podcast or the new

00:29:38.506 --> 00:29:39.896 A:middle
music that you just synced over

00:29:39.896 --> 00:29:40.506 A:middle
to the watch.

00:29:43.986 --> 00:29:46.116 A:middle
For example, Audible was able to

00:29:46.116 --> 00:29:47.586 A:middle
build the same experience where

00:29:47.976 --> 00:29:49.726 A:middle
they can just get their user

00:29:49.726 --> 00:29:50.616 A:middle
directly within their

00:29:50.616 --> 00:29:52.156 A:middle
application from the Siri watch

00:29:52.156 --> 00:29:54.126 A:middle
face and resume the playback of

00:29:54.126 --> 00:29:54.756 A:middle
an audiobook.

00:29:55.236 --> 00:29:59.036 A:middle
And whenever a user interaction

00:29:59.036 --> 00:30:00.866 A:middle
is occurring, just wanted to

00:29:59.036 --> 00:30:00.866 A:middle
is occurring, just wanted to

00:30:00.866 --> 00:30:02.336 A:middle
highlight, think through your

00:30:02.336 --> 00:30:03.136 A:middle
donations.

00:30:03.586 --> 00:30:05.256 A:middle
Make sure to donate your INMedia

00:30:05.256 --> 00:30:07.656 A:middle
PlaybackIntent to the system so

00:30:07.656 --> 00:30:08.836 A:middle
that way the system knows what

00:30:08.836 --> 00:30:10.356 A:middle
your user is commonly doing on

00:30:10.356 --> 00:30:10.816 A:middle
the watch.

00:30:11.286 --> 00:30:12.536 A:middle
And that way, you can become

00:30:12.536 --> 00:30:14.016 A:middle
more relevant on the Siri watch

00:30:14.016 --> 00:30:14.396 A:middle
face.

00:30:17.016 --> 00:30:19.016 A:middle
And also, just think through

00:30:19.016 --> 00:30:21.116 A:middle
your shortcut phrases like

00:30:21.456 --> 00:30:23.836 A:middle
design appropriate phrases that

00:30:23.926 --> 00:30:26.486 A:middle
your user could use within Siri

00:30:26.516 --> 00:30:28.986 A:middle
to get your user directly within

00:30:28.986 --> 00:30:30.586 A:middle
your application to allow for

00:30:30.586 --> 00:30:31.706 A:middle
some playback to occur.

00:30:32.206 --> 00:30:35.826 A:middle
And all in all, on the Siri

00:30:35.826 --> 00:30:37.556 A:middle
watch face, design a great

00:30:37.556 --> 00:30:38.296 A:middle
experience.

00:30:38.556 --> 00:30:39.736 A:middle
You might have some glanceable

00:30:39.736 --> 00:30:41.366 A:middle
information like, hey, there's

00:30:41.366 --> 00:30:42.666 A:middle
an exhibit coming soon.

00:30:43.266 --> 00:30:45.016 A:middle
Or you could have some tappable

00:30:45.016 --> 00:30:46.386 A:middle
actions like Audible was able to

00:30:46.386 --> 00:30:47.946 A:middle
make where, hey, we just want to

00:30:47.946 --> 00:30:49.646 A:middle
play that audio tour and get our

00:30:49.646 --> 00:30:53.446 A:middle
user directly in the app.

00:30:53.706 --> 00:30:56.166 A:middle
And so for shortcuts, donate

00:30:56.166 --> 00:30:57.966 A:middle
your INMediaPlaybackIntent.

00:30:58.876 --> 00:31:00.706 A:middle
Use the relevant shortcut API to

00:30:58.876 --> 00:31:00.706 A:middle
Use the relevant shortcut API to

00:31:00.706 --> 00:31:02.236 A:middle
appear on the Siri watch face.

00:31:03.436 --> 00:31:04.746 A:middle
And think through your shortcut

00:31:04.746 --> 00:31:05.256 A:middle
phrases.

00:31:06.786 --> 00:31:07.906 A:middle
And there's been some great

00:31:07.906 --> 00:31:09.706 A:middle
talks this week about shortcuts,

00:31:09.706 --> 00:31:10.986 A:middle
and I definitely wanted to

00:31:10.986 --> 00:31:12.326 A:middle
highlight the Shortcuts on the

00:31:12.326 --> 00:31:13.396 A:middle
Siri Watch Face talk.

00:31:13.706 --> 00:31:14.506 A:middle
I saw that myself.

00:31:14.506 --> 00:31:16.126 A:middle
It was a great talk, and I

00:31:16.126 --> 00:31:16.706 A:middle
learned a lot.

00:31:19.276 --> 00:31:21.556 A:middle
And so in summary, for the first

00:31:21.556 --> 00:31:23.436 A:middle
time, you can embed your native

00:31:23.436 --> 00:31:24.976 A:middle
controls directly from within

00:31:24.976 --> 00:31:25.866 A:middle
your application.

00:31:26.346 --> 00:31:27.676 A:middle
You can allow background

00:31:27.676 --> 00:31:29.226 A:middle
playback to occur however you

00:31:29.226 --> 00:31:30.986 A:middle
want and handle media remote

00:31:30.986 --> 00:31:32.176 A:middle
commands however you want.

00:31:32.636 --> 00:31:35.686 A:middle
And there are better ways that

00:31:35.686 --> 00:31:37.326 A:middle
transfer audio assets to your

00:31:37.326 --> 00:31:39.066 A:middle
watch and convey that type of

00:31:39.066 --> 00:31:40.416 A:middle
progress to your users.

00:31:41.556 --> 00:31:42.786 A:middle
So if you want some more

00:31:43.126 --> 00:31:44.836 A:middle
information, feel free to go

00:31:44.836 --> 00:31:47.006 A:middle
online or join us in the lab

00:31:47.006 --> 00:31:47.816 A:middle
this afternoon.

00:31:49.016 --> 00:31:50.676 A:middle
I'm really excited to see what

00:31:50.676 --> 00:31:52.216 A:middle
type of audio apps are built on

00:31:52.216 --> 00:31:54.816 A:middle
watchOS, and thanks, everyone.

00:31:55.166 --> 00:31:57.106 A:middle
Have a great WWDC.

00:31:57.256 --> 00:31:57.816 A:middle
Thanks.

00:31:58.516 --> 00:32:03.500 A:middle
[ Applause ]

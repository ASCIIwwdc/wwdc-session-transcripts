WEBVTT

00:00:07.516 --> 00:00:17.776 A:middle
[ Music ]

00:00:18.276 --> 00:00:19.586 A:middle
&gt;&gt; In this session we are going

00:00:19.586 --> 00:00:20.826 A:middle
to tell you all about Quick

00:00:20.826 --> 00:00:21.006 A:middle
Look.

00:00:21.646 --> 00:00:22.806 A:middle
Welcome to previews from the

00:00:22.806 --> 00:00:23.366 A:middle
ground up.

00:00:24.096 --> 00:00:26.046 A:middle
My name is Raffael and I'm going

00:00:26.046 --> 00:00:27.816 A:middle
to present together with Maxime,

00:00:28.186 --> 00:00:29.576 A:middle
both software engineers at

00:00:29.576 --> 00:00:29.946 A:middle
Apple.

00:00:30.456 --> 00:00:34.256 A:middle
We are going to start with a

00:00:34.256 --> 00:00:36.286 A:middle
brief overview of what Quick

00:00:36.286 --> 00:00:36.826 A:middle
Look is.

00:00:37.896 --> 00:00:39.326 A:middle
Then we're going to show you how

00:00:39.326 --> 00:00:41.656 A:middle
to adopt the Quick Look Preview

00:00:41.656 --> 00:00:43.366 A:middle
Controller in your application.

00:00:43.726 --> 00:00:45.816 A:middle
And then we're going to explain

00:00:45.816 --> 00:00:47.566 A:middle
how to provide custom Quick Look

00:00:47.566 --> 00:00:51.216 A:middle
previews and custom thumbnails

00:00:51.416 --> 00:00:52.976 A:middle
for your own file formats.

00:00:55.536 --> 00:00:57.376 A:middle
Let's jump right into it, what's

00:00:57.376 --> 00:00:57.866 A:middle
Quick Look?

00:01:00.156 --> 00:01:01.486 A:middle
Quick Look is all about

00:01:01.486 --> 00:01:03.786 A:middle
previewing documents, it allows

00:01:03.786 --> 00:01:05.426 A:middle
you to present documents without

00:01:05.426 --> 00:01:06.006 A:middle
the hassle.

00:01:07.026 --> 00:01:08.936 A:middle
More precisely, Quick Look is an

00:01:09.126 --> 00:01:10.726 A:middle
iOS framework that provides

00:01:10.726 --> 00:01:12.826 A:middle
multiple core features to you as

00:01:12.826 --> 00:01:13.466 A:middle
a developer.

00:01:15.036 --> 00:01:16.236 A:middle
It allows you to preview

00:01:16.236 --> 00:01:18.246 A:middle
documents of several commonly

00:01:18.246 --> 00:01:21.716 A:middle
used file formats, to provide

00:01:21.716 --> 00:01:23.926 A:middle
custom previews for files of

00:01:23.926 --> 00:01:27.596 A:middle
your very own file format, and

00:01:27.596 --> 00:01:29.236 A:middle
to provide thumbnails to the

00:01:29.236 --> 00:01:31.296 A:middle
system for files of your own

00:01:31.296 --> 00:01:32.326 A:middle
custom file format.

00:01:35.786 --> 00:01:37.146 A:middle
Quick Look is in fact already

00:01:37.146 --> 00:01:38.816 A:middle
used by many of Apple's first

00:01:38.816 --> 00:01:39.886 A:middle
party applications.

00:01:41.006 --> 00:01:43.896 A:middle
For example, in files to present

00:01:43.896 --> 00:01:45.616 A:middle
your documents that you have in

00:01:45.616 --> 00:01:45.976 A:middle
the Cloud.

00:01:51.046 --> 00:01:53.346 A:middle
Or in Mail and Notes to preview

00:01:53.346 --> 00:01:53.976 A:middle
your attachments.

00:02:01.356 --> 00:02:03.266 A:middle
And in Messages to show your

00:02:03.266 --> 00:02:04.676 A:middle
pictures and videos that you've

00:02:04.676 --> 00:02:04.976 A:middle
sent.

00:02:12.046 --> 00:02:13.286 A:middle
So who is this session for?

00:02:13.686 --> 00:02:15.546 A:middle
Well if you want to know how to

00:02:15.546 --> 00:02:17.106 A:middle
present documents in your

00:02:17.106 --> 00:02:18.836 A:middle
application without having to

00:02:18.836 --> 00:02:19.976 A:middle
implement all the common

00:02:19.976 --> 00:02:21.696 A:middle
features the users are used to

00:02:22.526 --> 00:02:23.676 A:middle
you're in the right session.

00:02:24.986 --> 00:02:26.836 A:middle
You also might own a custom file

00:02:26.836 --> 00:02:29.176 A:middle
format which iOS doesn't support

00:02:29.176 --> 00:02:30.796 A:middle
natively and you want to make

00:02:30.796 --> 00:02:32.306 A:middle
sure that your file format is

00:02:32.306 --> 00:02:34.136 A:middle
properly handled by iOS with

00:02:34.136 --> 00:02:35.776 A:middle
custom thumbnails and previews

00:02:36.046 --> 00:02:37.356 A:middle
stay here if you want to learn

00:02:37.356 --> 00:02:38.176 A:middle
more about this.

00:02:39.776 --> 00:02:40.816 A:middle
And no matter if you're a

00:02:40.816 --> 00:02:43.046 A:middle
newcomer to iOS or if you

00:02:43.046 --> 00:02:45.026 A:middle
already have an app we're going

00:02:45.026 --> 00:02:46.616 A:middle
to guide you step-by-step.

00:02:49.356 --> 00:02:50.626 A:middle
By the way, if you haven't

00:02:50.626 --> 00:02:51.906 A:middle
checked it out yet you should

00:02:51.906 --> 00:02:53.526 A:middle
definitely take a look at last

00:02:53.526 --> 00:02:55.286 A:middle
year's session, Building Great

00:02:55.336 --> 00:02:57.876 A:middle
Document-based Apps in iOS in

00:02:57.876 --> 00:02:59.586 A:middle
which we have introduced the UA

00:02:59.586 --> 00:03:01.256 A:middle
document browser view controller

00:02:59.586 --> 00:03:01.256 A:middle
document browser view controller

00:03:01.506 --> 00:03:03.286 A:middle
and also have covered the basics

00:03:03.286 --> 00:03:04.656 A:middle
of Quick Look preview and

00:03:04.656 --> 00:03:06.086 A:middle
thumbnail extensions briefly.

00:03:07.516 --> 00:03:09.046 A:middle
There's also going to be a

00:03:09.046 --> 00:03:10.426 A:middle
document browser one-on-one

00:03:10.426 --> 00:03:11.986 A:middle
session this year which we

00:03:11.986 --> 00:03:13.606 A:middle
highly encourage you to attend

00:03:14.016 --> 00:03:15.506 A:middle
if you're interested in file

00:03:15.506 --> 00:03:16.896 A:middle
handling on iOS.

00:03:21.246 --> 00:03:22.416 A:middle
Quick Look has been around for

00:03:22.416 --> 00:03:23.426 A:middle
quite a while already.

00:03:23.886 --> 00:03:25.146 A:middle
It's been introduced with the

00:03:25.146 --> 00:03:26.536 A:middle
iOS 4 SDK.

00:03:28.046 --> 00:03:29.386 A:middle
The main class you're interested

00:03:29.386 --> 00:03:30.786 A:middle
in is to [inaudible] preview

00:03:30.786 --> 00:03:32.476 A:middle
controller which is a view

00:03:32.476 --> 00:03:34.356 A:middle
controller to preview documents.

00:03:36.266 --> 00:03:38.386 A:middle
It uses the classic data source

00:03:38.386 --> 00:03:40.086 A:middle
and delegate pattern that you

00:03:40.086 --> 00:03:41.706 A:middle
already know from your UIKit and

00:03:41.706 --> 00:03:42.526 A:middle
other frameworks.

00:03:42.976 --> 00:03:46.156 A:middle
And presenting Quick Look with a

00:03:46.156 --> 00:03:47.516 A:middle
beautiful [inaudible] transition

00:03:47.516 --> 00:03:49.256 A:middle
couldn't be easier with the API

00:03:49.256 --> 00:03:49.976 A:middle
that we give you.

00:03:55.046 --> 00:03:56.076 A:middle
Why would you want to use Quick

00:03:56.236 --> 00:03:56.326 A:middle
Look?

00:03:56.606 --> 00:03:58.326 A:middle
Well if you have a similar use

00:03:58.326 --> 00:04:00.986 A:middle
case to files, mail or the other

00:03:58.326 --> 00:04:00.986 A:middle
case to files, mail or the other

00:04:00.986 --> 00:04:02.356 A:middle
apps we've shown you before

00:04:02.986 --> 00:04:04.296 A:middle
Quick Look is the perfect choice

00:04:04.296 --> 00:04:04.696 A:middle
for you.

00:04:05.886 --> 00:04:07.146 A:middle
Quick Look comes with everything

00:04:07.146 --> 00:04:08.426 A:middle
you need out of the box.

00:04:10.306 --> 00:04:11.896 A:middle
It supports the commonly used

00:04:11.896 --> 00:04:14.436 A:middle
file types and it provides that

00:04:14.436 --> 00:04:16.495 A:middle
native user experience that your

00:04:16.495 --> 00:04:18.055 A:middle
users are used to from other

00:04:18.055 --> 00:04:19.656 A:middle
first party iOS apps.

00:04:21.616 --> 00:04:22.976 A:middle
We made sure Quick Look has a

00:04:22.976 --> 00:04:24.586 A:middle
create performance on all

00:04:24.586 --> 00:04:26.056 A:middle
devices, so that all the

00:04:26.056 --> 00:04:27.736 A:middle
animations and gestures are

00:04:27.736 --> 00:04:28.166 A:middle
fluid.

00:04:30.006 --> 00:04:31.106 A:middle
And you might be dealing with

00:04:31.106 --> 00:04:32.976 A:middle
files from untrusted sources,

00:04:33.046 --> 00:04:34.556 A:middle
but don't worry we got your

00:04:34.556 --> 00:04:34.936 A:middle
back.

00:04:35.466 --> 00:04:36.396 A:middle
Quick Look comes with a

00:04:36.396 --> 00:04:38.046 A:middle
sophisticated security model

00:04:38.046 --> 00:04:39.376 A:middle
that keeps your application

00:04:39.376 --> 00:04:39.816 A:middle
safe.

00:04:44.136 --> 00:04:45.056 A:middle
Let's take a look at the

00:04:45.056 --> 00:04:46.296 A:middle
supported file types.

00:04:47.196 --> 00:04:48.966 A:middle
As you can see all the common

00:04:48.966 --> 00:04:49.986 A:middle
types are in here.

00:04:50.406 --> 00:04:52.676 A:middle
Media files such as images,

00:04:52.676 --> 00:04:54.506 A:middle
audio files and videos,

00:04:54.876 --> 00:04:56.916 A:middle
documents such as PDFs and

00:04:56.916 --> 00:04:58.926 A:middle
office files, but also zip

00:04:58.926 --> 00:04:59.526 A:middle
archives.

00:05:00.556 --> 00:05:02.786 A:middle
Previewing a zip archive lets

00:05:02.786 --> 00:05:04.586 A:middle
you look into the contents of

00:05:04.586 --> 00:05:06.346 A:middle
the archive and view the

00:05:06.346 --> 00:05:08.466 A:middle
contained files individually and

00:05:08.466 --> 00:05:09.516 A:middle
share them for example.

00:05:11.446 --> 00:05:13.176 A:middle
Now if your custom file format

00:05:13.176 --> 00:05:14.726 A:middle
is missing in this list don't

00:05:14.726 --> 00:05:15.136 A:middle
worry.

00:05:16.096 --> 00:05:17.786 A:middle
Last year we introduced a new

00:05:17.786 --> 00:05:19.456 A:middle
extension point for implementing

00:05:19.456 --> 00:05:21.046 A:middle
Quick Look preview extensions.

00:05:21.916 --> 00:05:23.726 A:middle
Preview extensions allow you as

00:05:23.726 --> 00:05:25.886 A:middle
a developer to create a preview

00:05:25.886 --> 00:05:27.746 A:middle
for files of your very own

00:05:27.746 --> 00:05:28.876 A:middle
custom file format.

00:05:28.876 --> 00:05:31.176 A:middle
We will cover this in the second

00:05:31.176 --> 00:05:31.976 A:middle
part of the session.

00:05:32.476 --> 00:05:35.776 A:middle
And this year with iOS 12 we

00:05:35.776 --> 00:05:37.376 A:middle
have also added support for the

00:05:37.376 --> 00:05:41.196 A:middle
new AR file format USDC, so with

00:05:41.196 --> 00:05:43.156 A:middle
just a few lines of code you get

00:05:43.156 --> 00:05:44.856 A:middle
a fully immersive augmented

00:05:44.856 --> 00:05:46.586 A:middle
reality experience in your

00:05:46.586 --> 00:05:47.276 A:middle
application.

00:05:48.746 --> 00:05:50.166 A:middle
Okay, now let's talk about user

00:05:50.166 --> 00:05:50.896 A:middle
experience.

00:05:51.556 --> 00:05:53.086 A:middle
For each of the file types shown

00:05:53.086 --> 00:05:55.056 A:middle
before we made sure that Quick

00:05:55.056 --> 00:05:56.606 A:middle
Look provides the best possible

00:05:56.606 --> 00:05:58.866 A:middle
preview on your mobile devices.

00:06:00.476 --> 00:06:01.936 A:middle
For example, when previewing

00:06:01.936 --> 00:06:04.266 A:middle
images you're able to zoom into

00:06:04.266 --> 00:06:05.796 A:middle
the images conveniently.

00:06:06.246 --> 00:06:08.706 A:middle
You're also able to close Quick

00:06:08.706 --> 00:06:10.466 A:middle
Look with a swipe down gesture.

00:06:11.006 --> 00:06:14.596 A:middle
In PDF documents you get a

00:06:14.596 --> 00:06:16.156 A:middle
sidebar with thumbnails for

00:06:16.156 --> 00:06:17.286 A:middle
easier navigation.

00:06:18.356 --> 00:06:20.366 A:middle
In spreadsheets you can switch

00:06:20.366 --> 00:06:22.256 A:middle
through the individual pages of

00:06:22.256 --> 00:06:22.956 A:middle
the document.

00:06:24.396 --> 00:06:26.476 A:middle
And in media files we show a

00:06:26.476 --> 00:06:28.176 A:middle
scrubber that allows you to go

00:06:28.176 --> 00:06:29.656 A:middle
back and forth and so on.

00:06:29.776 --> 00:06:30.626 A:middle
You get the idea.

00:06:32.556 --> 00:06:33.896 A:middle
So when you choose Quick Look

00:06:34.246 --> 00:06:36.046 A:middle
your users get all the gestures

00:06:36.046 --> 00:06:37.586 A:middle
they are used to from other

00:06:37.586 --> 00:06:37.976 A:middle
applications.

00:06:43.386 --> 00:06:44.516 A:middle
So what are some common use

00:06:44.516 --> 00:06:46.126 A:middle
cases for using Quick Look?

00:06:47.196 --> 00:06:49.046 A:middle
For example, you might want to

00:06:49.046 --> 00:06:51.136 A:middle
let the users zoom into photos

00:06:51.136 --> 00:06:54.386 A:middle
or you want to be able to flick

00:06:54.386 --> 00:06:55.876 A:middle
through a collection of photos

00:06:56.046 --> 00:06:56.746 A:middle
left and right.

00:06:57.826 --> 00:07:00.096 A:middle
You want to play audio or video

00:06:57.826 --> 00:07:00.096 A:middle
You want to play audio or video

00:07:00.096 --> 00:07:02.046 A:middle
files without having to deal

00:07:02.046 --> 00:07:03.546 A:middle
with lower-level frameworks.

00:07:03.546 --> 00:07:06.996 A:middle
Or you want to present for

00:07:06.996 --> 00:07:08.946 A:middle
example a scrollable and

00:07:08.946 --> 00:07:11.106 A:middle
zoomable user agreement PDF to

00:07:11.106 --> 00:07:11.646 A:middle
the user.

00:07:12.876 --> 00:07:14.026 A:middle
Use Quick Look for this.

00:07:16.686 --> 00:07:17.876 A:middle
But Quick Look shouldn't be

00:07:17.876 --> 00:07:19.956 A:middle
misused, here's when not to use

00:07:19.956 --> 00:07:20.446 A:middle
Quick Look.

00:07:21.936 --> 00:07:22.946 A:middle
Quick Look is all about

00:07:22.946 --> 00:07:24.896 A:middle
previewing but doesn't provide

00:07:24.896 --> 00:07:25.826 A:middle
editing features.

00:07:26.766 --> 00:07:27.866 A:middle
So if you need to provide

00:07:27.866 --> 00:07:29.806 A:middle
functionality such as image

00:07:29.806 --> 00:07:32.746 A:middle
editing, PDF management or movie

00:07:32.746 --> 00:07:34.376 A:middle
trimming you need to choose a

00:07:34.376 --> 00:07:34.976 A:middle
different approach.

00:07:39.046 --> 00:07:40.676 A:middle
Similarly, if you need more

00:07:40.676 --> 00:07:42.336 A:middle
advanced playback control for

00:07:42.336 --> 00:07:43.906 A:middle
your videos Quick Look is

00:07:43.906 --> 00:07:45.426 A:middle
probably not the best choice,

00:07:46.016 --> 00:07:47.896 A:middle
you can use AVPlayer instead.

00:07:49.116 --> 00:07:50.016 A:middle
Quick Look is meant to be

00:07:50.016 --> 00:07:51.346 A:middle
presented full screen.

00:07:51.716 --> 00:07:53.276 A:middle
If you simply want to present an

00:07:53.276 --> 00:07:55.456 A:middle
image, a video or a document

00:07:55.636 --> 00:07:57.356 A:middle
embedded in your layout together

00:07:57.356 --> 00:07:58.936 A:middle
with other views surrounding it

00:07:59.616 --> 00:08:00.886 A:middle
you probably want to use

00:07:59.616 --> 00:08:00.886 A:middle
you probably want to use

00:08:00.886 --> 00:08:04.506 A:middle
UAImageView, AVPlayer, WKWebView

00:08:04.576 --> 00:08:06.086 A:middle
or other kind of views instead.

00:08:08.816 --> 00:08:10.316 A:middle
Also note that it's not

00:08:10.316 --> 00:08:12.436 A:middle
supported to customize the view

00:08:12.436 --> 00:08:13.856 A:middle
hierarchy of Quick Look.

00:08:14.416 --> 00:08:16.316 A:middle
Please don't try to add views on

00:08:16.316 --> 00:08:17.696 A:middle
top of the previews the

00:08:17.696 --> 00:08:20.036 A:middle
navigational toolbar, this is

00:08:20.036 --> 00:08:20.976 A:middle
simply not supported.

00:08:26.166 --> 00:08:27.826 A:middle
So now that we've introduced

00:08:27.826 --> 00:08:29.596 A:middle
Quick Look, let's take a look at

00:08:29.596 --> 00:08:31.286 A:middle
how to actually make use of our

00:08:31.286 --> 00:08:31.976 A:middle
APIs.

00:08:37.275 --> 00:08:38.655 A:middle
If you want to present documents

00:08:38.655 --> 00:08:40.966 A:middle
to the user as a first step you

00:08:40.966 --> 00:08:42.166 A:middle
instantiate a new

00:08:42.166 --> 00:08:44.296 A:middle
QLPreviewController which is

00:08:44.296 --> 00:08:46.186 A:middle
basically a UIViewController.

00:08:48.176 --> 00:08:49.726 A:middle
Next, in order to tell the

00:08:49.726 --> 00:08:50.886 A:middle
preview controller which

00:08:50.886 --> 00:08:53.006 A:middle
documents to preview, you need

00:08:53.006 --> 00:08:54.726 A:middle
to assign a data source to it.

00:08:55.676 --> 00:08:57.156 A:middle
The data source is an object

00:08:57.156 --> 00:08:58.046 A:middle
that conforms to the

00:08:58.046 --> 00:08:59.986 A:middle
QLPreviewController data source

00:08:59.986 --> 00:09:00.426 A:middle
protocol.

00:08:59.986 --> 00:09:00.426 A:middle
protocol.

00:09:00.426 --> 00:09:02.496 A:middle
We'll take a look at this in a

00:09:02.496 --> 00:09:02.906 A:middle
second.

00:09:03.396 --> 00:09:07.116 A:middle
And as a third and last step,

00:09:07.586 --> 00:09:09.006 A:middle
all you have to do is present

00:09:09.006 --> 00:09:09.786 A:middle
the view controller.

00:09:15.046 --> 00:09:16.296 A:middle
Let's take a closer look at how

00:09:16.296 --> 00:09:17.436 A:middle
the data source works.

00:09:18.376 --> 00:09:20.236 A:middle
Your data source has to conform

00:09:20.236 --> 00:09:22.106 A:middle
to the QLPreviewController data

00:09:22.106 --> 00:09:22.956 A:middle
source protocol.

00:09:24.026 --> 00:09:25.706 A:middle
This is a protocol that requires

00:09:25.706 --> 00:09:26.426 A:middle
two methods.

00:09:26.776 --> 00:09:28.666 A:middle
First, you need to return the

00:09:28.666 --> 00:09:30.406 A:middle
number of items that your

00:09:30.406 --> 00:09:31.456 A:middle
preview controller should

00:09:31.456 --> 00:09:31.946 A:middle
preview.

00:09:32.956 --> 00:09:34.336 A:middle
It should provide more than one

00:09:34.336 --> 00:09:36.166 A:middle
item the users will be able to

00:09:36.166 --> 00:09:37.926 A:middle
swipe left and right to flick

00:09:37.926 --> 00:09:38.936 A:middle
through the documents.

00:09:41.156 --> 00:09:43.216 A:middle
Next, Quick Look then will ask

00:09:43.216 --> 00:09:44.186 A:middle
you for one or more

00:09:44.186 --> 00:09:46.446 A:middle
QLPreviewItems depending on what

00:09:46.446 --> 00:09:47.706 A:middle
number you've previously

00:09:47.706 --> 00:09:48.176 A:middle
returned.

00:09:50.516 --> 00:09:52.636 A:middle
Okay what's a QLPreviewItem?

00:09:53.456 --> 00:09:54.966 A:middle
It's a protocol that acts as an

00:09:54.966 --> 00:09:56.736 A:middle
abstraction for your documents.

00:09:57.386 --> 00:09:59.326 A:middle
For Quick Look a preview item is

00:09:59.326 --> 00:10:02.136 A:middle
basically the URL, where to find

00:09:59.326 --> 00:10:02.136 A:middle
basically the URL, where to find

00:10:02.136 --> 00:10:04.596 A:middle
the document on disk and

00:10:04.596 --> 00:10:06.936 A:middle
optionally a title that Quick

00:10:06.936 --> 00:10:08.336 A:middle
Look will show in the navigation

00:10:08.336 --> 00:10:08.566 A:middle
bar.

00:10:09.136 --> 00:10:12.216 A:middle
The class representing documents

00:10:12.216 --> 00:10:14.206 A:middle
in your app needs to conform to

00:10:14.206 --> 00:10:15.746 A:middle
the QLPreviewItem protocol.

00:10:16.586 --> 00:10:19.266 A:middle
But by the way, NSURL already

00:10:19.266 --> 00:10:21.376 A:middle
conforms to the QLPreviewItem

00:10:21.376 --> 00:10:23.396 A:middle
protocol, so if you don't need

00:10:23.396 --> 00:10:25.246 A:middle
custom titles you can simply

00:10:25.246 --> 00:10:27.896 A:middle
return NSURL instances in your

00:10:27.896 --> 00:10:29.806 A:middle
data source without implementing

00:10:29.806 --> 00:10:30.936 A:middle
the protocol yourself.

00:10:31.466 --> 00:10:34.896 A:middle
Let's take a look at an example.

00:10:36.426 --> 00:10:38.136 A:middle
In this scenario our view

00:10:38.136 --> 00:10:39.576 A:middle
controller that presents Quick

00:10:39.576 --> 00:10:41.766 A:middle
Look acts as the data source of

00:10:41.766 --> 00:10:43.166 A:middle
the QLPreviewController.

00:10:44.496 --> 00:10:46.566 A:middle
Therefore, we let it conform to

00:10:46.566 --> 00:10:48.236 A:middle
the QLPreviewController data

00:10:48.236 --> 00:10:50.346 A:middle
source in an extension and we

00:10:50.346 --> 00:10:51.586 A:middle
implement the two methods.

00:10:53.276 --> 00:10:54.986 A:middle
Here we are using an area of

00:10:54.986 --> 00:10:57.046 A:middle
file URLs that acts as the

00:10:57.046 --> 00:10:57.396 A:middle
model.

00:10:57.986 --> 00:10:59.516 A:middle
We return the number of URLs

00:10:59.516 --> 00:11:02.096 A:middle
that we have in the number of

00:10:59.516 --> 00:11:02.096 A:middle
that we have in the number of

00:11:02.096 --> 00:11:03.646 A:middle
preview items in controller

00:11:03.646 --> 00:11:04.086 A:middle
method.

00:11:04.586 --> 00:11:07.626 A:middle
And then each URL respectively

00:11:07.796 --> 00:11:10.006 A:middle
referenced by the index in the

00:11:10.006 --> 00:11:12.216 A:middle
previewController controller

00:11:12.216 --> 00:11:13.896 A:middle
previewItemAt index method.

00:11:19.046 --> 00:11:20.866 A:middle
Okay we've set up our preview

00:11:20.866 --> 00:11:22.426 A:middle
controller and it knows what

00:11:22.426 --> 00:11:24.336 A:middle
files to preview, so we are

00:11:24.336 --> 00:11:25.656 A:middle
ready to actually present the

00:11:25.656 --> 00:11:26.376 A:middle
view controller.

00:11:27.386 --> 00:11:28.616 A:middle
There are two ways for doing

00:11:28.616 --> 00:11:28.836 A:middle
that.

00:11:29.586 --> 00:11:30.766 A:middle
You can either present the

00:11:30.766 --> 00:11:32.496 A:middle
preview controller modally on

00:11:32.496 --> 00:11:34.866 A:middle
top of the current context or

00:11:34.866 --> 00:11:36.456 A:middle
you push the preview controller

00:11:36.916 --> 00:11:38.626 A:middle
into a UINavigationController.

00:11:39.726 --> 00:11:41.746 A:middle
Both ways work great and you

00:11:41.746 --> 00:11:43.646 A:middle
need to decide what fits best in

00:11:43.646 --> 00:11:44.586 A:middle
your situation.

00:11:44.586 --> 00:11:47.016 A:middle
To present it modally you do

00:11:47.016 --> 00:11:48.066 A:middle
what you do with any view

00:11:48.066 --> 00:11:49.716 A:middle
controller you call present.

00:11:51.666 --> 00:11:53.296 A:middle
Here's an example of what a

00:11:53.296 --> 00:11:54.716 A:middle
modal presentation can look

00:11:54.716 --> 00:11:54.996 A:middle
like.

00:11:57.176 --> 00:11:58.046 A:middle
If you have a

00:11:58.046 --> 00:11:59.876 A:middle
UINavigationController and

00:11:59.876 --> 00:12:01.396 A:middle
prefer to push the preview

00:11:59.876 --> 00:12:01.396 A:middle
prefer to push the preview

00:12:01.396 --> 00:12:03.386 A:middle
controller instead you use

00:12:03.386 --> 00:12:03.976 A:middle
pushViewController.

00:12:08.146 --> 00:12:08.976 A:middle
This is what it looks like.

00:12:16.046 --> 00:12:17.286 A:middle
The QLPreviewController class

00:12:17.286 --> 00:12:18.866 A:middle
provides a few more methods that

00:12:18.866 --> 00:12:19.906 A:middle
I would like to highlight.

00:12:20.956 --> 00:12:22.826 A:middle
First, if you want to know if

00:12:22.826 --> 00:12:24.296 A:middle
Quick Look is capable of

00:12:24.366 --> 00:12:25.986 A:middle
previewing a certain document

00:12:26.706 --> 00:12:28.756 A:middle
use the canPreview item class

00:12:28.756 --> 00:12:32.026 A:middle
method, this will return true if

00:12:32.026 --> 00:12:33.726 A:middle
the document matches any of the

00:12:33.726 --> 00:12:36.376 A:middle
supported default file types or

00:12:36.376 --> 00:12:37.756 A:middle
if there is a preview extension

00:12:37.756 --> 00:12:39.226 A:middle
available that can handle the

00:12:39.226 --> 00:12:39.666 A:middle
file.

00:12:41.856 --> 00:12:43.766 A:middle
The data source we've already

00:12:43.766 --> 00:12:44.216 A:middle
covered.

00:12:46.816 --> 00:12:49.216 A:middle
Reload data reloads the list of

00:12:49.216 --> 00:12:50.356 A:middle
documents your preview

00:12:50.356 --> 00:12:51.556 A:middle
controller should present.

00:12:52.236 --> 00:12:54.406 A:middle
If this list ever changes while

00:12:54.406 --> 00:12:55.486 A:middle
the preview controller is

00:12:55.486 --> 00:12:57.626 A:middle
currently presented use this

00:12:57.626 --> 00:12:59.236 A:middle
method to trigger a reload.

00:13:01.796 --> 00:13:03.446 A:middle
If you need to obtain the index

00:13:03.446 --> 00:13:05.236 A:middle
of the currently previewed item

00:13:05.236 --> 00:13:07.146 A:middle
in your list of preview items

00:13:07.956 --> 00:13:09.546 A:middle
remember the user can swipe left

00:13:09.546 --> 00:13:10.696 A:middle
and right to switch to a

00:13:10.696 --> 00:13:12.766 A:middle
different one, use the current

00:13:12.766 --> 00:13:14.436 A:middle
previewItemIndex variable.

00:13:15.646 --> 00:13:17.206 A:middle
This is both a getter and a

00:13:17.206 --> 00:13:19.486 A:middle
setter, so if you want Quick

00:13:19.486 --> 00:13:20.986 A:middle
Look to start with a particular

00:13:20.986 --> 00:13:22.746 A:middle
item when it's being presented

00:13:22.746 --> 00:13:24.836 A:middle
set the index to the right

00:13:24.836 --> 00:13:25.256 A:middle
value.

00:13:25.666 --> 00:13:29.946 A:middle
Last but not least, preview

00:13:29.946 --> 00:13:31.816 A:middle
controllers also have a

00:13:31.816 --> 00:13:32.376 A:middle
delegate.

00:13:33.066 --> 00:13:34.126 A:middle
Let's take a look at the

00:13:34.126 --> 00:13:35.536 A:middle
QLPreviewController delegate

00:13:35.536 --> 00:13:35.936 A:middle
protocol now.

00:13:41.056 --> 00:13:42.506 A:middle
If you assign a delegate to your

00:13:42.506 --> 00:13:44.366 A:middle
preview controller you get more

00:13:44.366 --> 00:13:46.046 A:middle
ways to control how Quick Look

00:13:46.046 --> 00:13:46.626 A:middle
behaves.

00:13:47.736 --> 00:13:49.226 A:middle
It also lets you react to Quick

00:13:49.226 --> 00:13:50.496 A:middle
Look presentation events.

00:13:51.316 --> 00:13:52.836 A:middle
Note that all of the methods in

00:13:52.836 --> 00:13:54.946 A:middle
the QLPreviewController delegate

00:13:54.946 --> 00:13:55.616 A:middle
are optional.

00:13:56.226 --> 00:13:57.636 A:middle
You don't have to implement them

00:13:57.726 --> 00:13:59.096 A:middle
and in fact you don't even have

00:13:59.096 --> 00:14:00.556 A:middle
to assign a delegate at all.

00:13:59.096 --> 00:14:00.556 A:middle
to assign a delegate at all.

00:14:02.376 --> 00:14:04.076 A:middle
The protocol hosts a bunch of

00:14:04.076 --> 00:14:05.506 A:middle
methods you can implement.

00:14:06.306 --> 00:14:07.986 A:middle
The first two methods lets you

00:14:07.986 --> 00:14:09.566 A:middle
react to the event that Quick

00:14:09.566 --> 00:14:11.086 A:middle
Look is about to be dismissed by

00:14:11.086 --> 00:14:13.246 A:middle
the user and also that the

00:14:13.246 --> 00:14:13.976 A:middle
dismissing is now complete.

00:14:18.046 --> 00:14:19.036 A:middle
You might want to use these

00:14:19.036 --> 00:14:20.636 A:middle
methods to update the view

00:14:20.636 --> 00:14:22.126 A:middle
controller that is presenting

00:14:22.126 --> 00:14:22.976 A:middle
Quick Look right now.

00:14:27.176 --> 00:14:29.456 A:middle
Next, the preview controller

00:14:29.456 --> 00:14:31.856 A:middle
should open URL for item method

00:14:32.386 --> 00:14:34.026 A:middle
allows you to prevent Quick Look

00:14:34.026 --> 00:14:35.966 A:middle
to follow a link contained in

00:14:35.966 --> 00:14:37.136 A:middle
previewed documents.

00:14:38.006 --> 00:14:39.846 A:middle
With this method you can for

00:14:39.846 --> 00:14:41.736 A:middle
example prevent the user from

00:14:41.736 --> 00:14:43.806 A:middle
leaving your app when tapping a

00:14:43.806 --> 00:14:45.886 A:middle
URL or a phone number contained

00:14:45.886 --> 00:14:46.206 A:middle
in a PDF.

00:14:46.206 --> 00:14:51.086 A:middle
And last but not least, as

00:14:51.086 --> 00:14:52.246 A:middle
promised before the

00:14:52.246 --> 00:14:53.936 A:middle
QLPreviewController delegate

00:14:53.936 --> 00:14:56.356 A:middle
protocol also provides API to

00:14:56.476 --> 00:14:58.896 A:middle
get a smooth zoom animation when

00:14:58.896 --> 00:15:00.106 A:middle
Quick Look is presented and

00:14:58.896 --> 00:15:00.106 A:middle
Quick Look is presented and

00:15:00.106 --> 00:15:00.636 A:middle
dismissed.

00:15:01.716 --> 00:15:03.616 A:middle
With these methods a thumbnail

00:15:03.616 --> 00:15:05.396 A:middle
that is on screen in your user

00:15:05.396 --> 00:15:07.706 A:middle
interface can transition into a

00:15:07.706 --> 00:15:09.536 A:middle
full Quick Look preview when

00:15:09.536 --> 00:15:10.086 A:middle
tapping it.

00:15:13.056 --> 00:15:15.466 A:middle
Imagine an email attachment or a

00:15:15.466 --> 00:15:17.356 A:middle
photo inside a conversation view

00:15:17.586 --> 00:15:20.526 A:middle
which you can tap to show it

00:15:20.526 --> 00:15:22.096 A:middle
full screen with Quick Look.

00:15:25.406 --> 00:15:27.356 A:middle
We made it super easy for you to

00:15:27.356 --> 00:15:28.906 A:middle
get this cross fade zoom

00:15:28.906 --> 00:15:30.756 A:middle
animation in your application.

00:15:32.276 --> 00:15:33.936 A:middle
If you implement one of the two

00:15:33.936 --> 00:15:35.496 A:middle
approaches in your delegate

00:15:35.936 --> 00:15:37.236 A:middle
Quick Look will ask for the

00:15:37.236 --> 00:15:38.986 A:middle
information that is needed for

00:15:38.986 --> 00:15:40.096 A:middle
performing the zoom.

00:15:41.026 --> 00:15:42.126 A:middle
This is basically the

00:15:42.126 --> 00:15:44.386 A:middle
rectangular area the animation

00:15:44.386 --> 00:15:45.636 A:middle
should start from when

00:15:45.636 --> 00:15:48.246 A:middle
presenting or end in when

00:15:48.246 --> 00:15:49.226 A:middle
dismissing Quick Look.

00:15:51.176 --> 00:15:54.666 A:middle
Either you provide the frame and

00:15:54.666 --> 00:15:58.586 A:middle
the image of the thumbnail or

00:15:58.686 --> 00:16:00.266 A:middle
and this is the preferred way of

00:15:58.686 --> 00:16:00.266 A:middle
and this is the preferred way of

00:16:00.266 --> 00:16:02.416 A:middle
doing it, you use our mode and

00:16:02.416 --> 00:16:04.136 A:middle
method in which you simply

00:16:04.136 --> 00:16:05.946 A:middle
return the thumbnail as a view.

00:16:06.916 --> 00:16:08.306 A:middle
With this approach you don't

00:16:08.306 --> 00:16:09.916 A:middle
have to worry about coordinates

00:16:10.436 --> 00:16:11.306 A:middle
Quick Look will do all the heavy

00:16:11.306 --> 00:16:11.976 A:middle
lifting for you.

00:16:17.126 --> 00:16:18.176 A:middle
And this is what it can look

00:16:18.176 --> 00:16:18.416 A:middle
like.

00:16:19.986 --> 00:16:21.006 A:middle
Note how the thumbnail

00:16:21.006 --> 00:16:22.916 A:middle
transitions into the full-screen

00:16:22.916 --> 00:16:23.896 A:middle
Quick Look preview.

00:16:26.126 --> 00:16:27.716 A:middle
All right now it's time for a

00:16:27.716 --> 00:16:29.206 A:middle
demo in which we would like to

00:16:29.206 --> 00:16:30.646 A:middle
show you what we've just

00:16:30.646 --> 00:16:31.016 A:middle
covered.

00:16:33.156 --> 00:16:35.666 A:middle
Okay, here's an iOS project and

00:16:35.666 --> 00:16:37.226 A:middle
instead of talking about it

00:16:37.226 --> 00:16:38.696 A:middle
let's just press the play button

00:16:38.906 --> 00:16:40.016 A:middle
to see what we've already

00:16:40.016 --> 00:16:41.546 A:middle
prepared and what we are dealing

00:16:41.546 --> 00:16:41.926 A:middle
with here.

00:16:51.046 --> 00:16:51.926 A:middle
We are calling this Wildlife

00:16:51.926 --> 00:16:53.766 A:middle
Explorer and it's a very simple

00:16:53.766 --> 00:16:53.976 A:middle
app.

00:16:54.766 --> 00:16:56.516 A:middle
It basically displays a grid of

00:16:56.516 --> 00:16:58.766 A:middle
photos and each of these photos

00:16:58.766 --> 00:17:00.516 A:middle
that we see here acts as a

00:16:58.766 --> 00:17:00.516 A:middle
that we see here acts as a

00:17:00.516 --> 00:17:02.276 A:middle
thumbnail for what's behind it

00:17:02.276 --> 00:17:03.126 A:middle
once you tap it.

00:17:03.256 --> 00:17:05.496 A:middle
For example, tapping the

00:17:05.496 --> 00:17:07.286 A:middle
elephant should show a large

00:17:07.286 --> 00:17:08.866 A:middle
photo of the elephant in full

00:17:08.866 --> 00:17:11.826 A:middle
screen and tapping the giraffe

00:17:12.066 --> 00:17:13.945 A:middle
should preview an entire PDF

00:17:13.945 --> 00:17:15.715 A:middle
about all sorts of giraffes.

00:17:17.215 --> 00:17:18.906 A:middle
Right now we can't do anything

00:17:18.906 --> 00:17:20.445 A:middle
else than just looking at it,

00:17:21.156 --> 00:17:23.126 A:middle
tapping won't do anything yet so

00:17:23.126 --> 00:17:23.806 A:middle
let's fix this.

00:17:28.306 --> 00:17:30.406 A:middle
Now this application is fairly

00:17:30.406 --> 00:17:31.376 A:middle
simply structured.

00:17:32.546 --> 00:17:33.916 A:middle
For displaying the grid of

00:17:33.916 --> 00:17:35.166 A:middle
photos we use a

00:17:35.166 --> 00:17:36.356 A:middle
CollectionViewController.

00:17:38.886 --> 00:17:41.686 A:middle
When initializing it we obtain a

00:17:41.686 --> 00:17:43.996 A:middle
list of URLs of documents that

00:17:43.996 --> 00:17:45.656 A:middle
are bundled with the application

00:17:45.656 --> 00:17:46.776 A:middle
like the elephant we've just

00:17:46.776 --> 00:17:46.946 A:middle
seen.

00:17:51.196 --> 00:17:53.276 A:middle
We use that list to initialize

00:17:53.276 --> 00:17:54.866 A:middle
what we call a document data

00:17:54.866 --> 00:17:55.396 A:middle
source.

00:17:56.666 --> 00:17:58.626 A:middle
This object serves as the model

00:17:58.626 --> 00:17:59.966 A:middle
for the collection view in the

00:17:59.966 --> 00:18:01.296 A:middle
implementation of the

00:17:59.966 --> 00:18:01.296 A:middle
implementation of the

00:18:01.296 --> 00:18:03.506 A:middle
UICollectionViewDataSource

00:18:03.506 --> 00:18:03.976 A:middle
protocol.

00:18:12.106 --> 00:18:13.896 A:middle
Here we return the number of

00:18:13.896 --> 00:18:15.696 A:middle
documents we have just gathered

00:18:16.096 --> 00:18:17.896 A:middle
and then create a cell for each

00:18:17.896 --> 00:18:19.316 A:middle
of the documents with a

00:18:19.316 --> 00:18:20.896 A:middle
thumbnail as the image of the

00:18:20.896 --> 00:18:22.076 A:middle
cell respectively.

00:18:22.526 --> 00:18:25.756 A:middle
And that's pretty much the core

00:18:25.756 --> 00:18:27.166 A:middle
of the application so far.

00:18:28.266 --> 00:18:29.736 A:middle
Now let's add what we've talked

00:18:29.736 --> 00:18:30.476 A:middle
about before.

00:18:31.216 --> 00:18:32.786 A:middle
When tapping a cell we would

00:18:32.786 --> 00:18:34.246 A:middle
like to show Quick Look with the

00:18:34.246 --> 00:18:35.146 A:middle
right document.

00:18:36.286 --> 00:18:37.886 A:middle
We've already made sure that we

00:18:37.886 --> 00:18:39.196 A:middle
have a method that is called

00:18:39.196 --> 00:18:40.856 A:middle
when the user has just tapped a

00:18:40.856 --> 00:18:40.966 A:middle
cell.

00:18:47.056 --> 00:18:48.676 A:middle
To show Quick Look we create a

00:18:48.676 --> 00:18:50.896 A:middle
new QLPreviewController in here

00:18:51.286 --> 00:18:51.976 A:middle
and configure it.

00:19:03.396 --> 00:19:05.796 A:middle
We create a new controller, we

00:19:05.796 --> 00:19:07.426 A:middle
assign the document data source

00:19:07.426 --> 00:19:09.676 A:middle
to it as the data source and

00:19:09.856 --> 00:19:11.446 A:middle
then make sure Quick Look shows

00:19:11.446 --> 00:19:12.936 A:middle
the correct preview when it's

00:19:12.936 --> 00:19:15.016 A:middle
presented by setting the right

00:19:15.116 --> 00:19:15.976 A:middle
CurrentPreviewItemIndex.

00:19:20.056 --> 00:19:22.316 A:middle
Great, now Xcode is already

00:19:22.316 --> 00:19:23.986 A:middle
complaining about our new code,

00:19:23.986 --> 00:19:25.486 A:middle
it doesn't know

00:19:25.486 --> 00:19:27.106 A:middle
QLPreviewController yet.

00:19:27.826 --> 00:19:29.106 A:middle
We need to import Quick Look

00:19:29.106 --> 00:19:31.396 A:middle
first and therefore we return to

00:19:31.396 --> 00:19:32.666 A:middle
the top of the file and import

00:19:32.716 --> 00:19:32.976 A:middle
Quick Look.

00:19:44.046 --> 00:19:46.456 A:middle
Done. The next thing Xcode

00:19:46.456 --> 00:19:47.946 A:middle
complains about is the data

00:19:47.946 --> 00:19:48.446 A:middle
source.

00:19:49.166 --> 00:19:50.766 A:middle
The document data source that we

00:19:50.766 --> 00:19:52.016 A:middle
assigned to the new preview

00:19:52.016 --> 00:19:53.556 A:middle
controller doesn't seem to

00:19:53.556 --> 00:19:54.416 A:middle
conform to the

00:19:54.416 --> 00:19:56.226 A:middle
QLPreviewController data source

00:19:56.226 --> 00:19:57.946 A:middle
protocol yet which we have

00:19:57.946 --> 00:19:58.946 A:middle
talked about earlier.

00:20:00.656 --> 00:20:02.766 A:middle
To fix this let's switch to the

00:20:02.766 --> 00:20:04.366 A:middle
implementation of the document

00:20:04.366 --> 00:20:04.976 A:middle
data source.

00:20:10.246 --> 00:20:11.606 A:middle
The document data source is a

00:20:11.606 --> 00:20:13.486 A:middle
very simple kind of object, it

00:20:13.576 --> 00:20:15.926 A:middle
simply owns an area of URLs so

00:20:15.926 --> 00:20:16.246 A:middle
far.

00:20:17.256 --> 00:20:18.286 A:middle
We need to add the

00:20:18.286 --> 00:20:20.086 A:middle
QLPreviewController data source

00:20:20.086 --> 00:20:21.646 A:middle
protocol to the list of

00:20:21.646 --> 00:20:23.206 A:middle
protocols that this class

00:20:23.206 --> 00:20:23.936 A:middle
implements.

00:20:33.246 --> 00:20:34.566 A:middle
Next, we implement the missing

00:20:34.566 --> 00:20:34.956 A:middle
methods.

00:20:45.096 --> 00:20:46.456 A:middle
As you can see the way we use

00:20:46.456 --> 00:20:48.376 A:middle
the document data source here is

00:20:48.376 --> 00:20:50.216 A:middle
very similar to the way we use

00:20:50.216 --> 00:20:51.326 A:middle
it for the collection view.

00:20:51.586 --> 00:20:54.066 A:middle
In the numberOfPreviewItems

00:20:54.066 --> 00:20:56.046 A:middle
method we return the number of

00:20:56.046 --> 00:20:57.516 A:middle
URLs that we have gathered

00:20:57.516 --> 00:20:58.986 A:middle
before from our documents

00:20:58.986 --> 00:20:59.326 A:middle
folder.

00:20:59.806 --> 00:21:03.626 A:middle
And then Quick Look asks for the

00:20:59.806 --> 00:21:03.626 A:middle
And then Quick Look asks for the

00:21:03.626 --> 00:21:06.126 A:middle
individual QLPreviewItems and we

00:21:06.126 --> 00:21:08.146 A:middle
return the right URL referenced

00:21:08.146 --> 00:21:08.896 A:middle
by the index.

00:21:13.066 --> 00:21:14.106 A:middle
Great, the data source has been

00:21:14.106 --> 00:21:15.866 A:middle
properly set up so we can go

00:21:15.866 --> 00:21:17.496 A:middle
ahead and actually present the

00:21:17.496 --> 00:21:18.416 A:middle
preview controller.

00:21:19.456 --> 00:21:20.836 A:middle
Therefore, we return to the

00:21:20.836 --> 00:21:23.036 A:middle
didTapCollectionCell method and

00:21:23.036 --> 00:21:23.976 A:middle
add the missing method call.

00:21:34.046 --> 00:21:34.886 A:middle
Let's check out how this looks

00:21:34.886 --> 00:21:34.976 A:middle
like.

00:21:46.046 --> 00:21:47.456 A:middle
All right we are back in grid

00:21:47.666 --> 00:21:49.516 A:middle
and now when tapping a cell

00:21:49.846 --> 00:21:51.766 A:middle
Quick Look appears displaying

00:21:51.766 --> 00:21:53.186 A:middle
the right document in full

00:21:53.186 --> 00:21:53.656 A:middle
screen.

00:21:55.326 --> 00:21:57.406 A:middle
Note how easy it is to present

00:21:57.406 --> 00:21:59.936 A:middle
images and even PDFs in full

00:21:59.936 --> 00:22:01.826 A:middle
screen with all of the gestures

00:21:59.936 --> 00:22:01.826 A:middle
screen with all of the gestures

00:22:01.826 --> 00:22:03.346 A:middle
that you are used to.

00:22:04.126 --> 00:22:06.256 A:middle
We can zoom into the document

00:22:06.606 --> 00:22:09.276 A:middle
with two fingers, we can select

00:22:09.276 --> 00:22:11.576 A:middle
text, and even copy it.

00:22:13.846 --> 00:22:16.356 A:middle
And once we are done we can use

00:22:16.356 --> 00:22:18.706 A:middle
a pinch gesture to dismiss Quick

00:22:18.706 --> 00:22:18.976 A:middle
Look again.

00:22:23.046 --> 00:22:24.416 A:middle
So what we are using here to

00:22:24.416 --> 00:22:25.976 A:middle
present Quick Look is a modal

00:22:25.976 --> 00:22:26.986 A:middle
presentation style.

00:22:27.946 --> 00:22:29.406 A:middle
As I've explained earlier, we

00:22:29.406 --> 00:22:31.156 A:middle
can also present Quick Look with

00:22:31.156 --> 00:22:32.136 A:middle
a push animation.

00:22:33.426 --> 00:22:35.026 A:middle
Therefore, we simply tell the

00:22:35.026 --> 00:22:36.556 A:middle
application's navigation

00:22:36.556 --> 00:22:38.206 A:middle
controller to present the

00:22:38.206 --> 00:22:40.116 A:middle
preview controller by pushing it

00:22:40.116 --> 00:22:40.976 A:middle
on top of the current one.

00:22:52.106 --> 00:22:52.786 A:middle
Let's take a look.

00:23:05.076 --> 00:23:06.336 A:middle
As you can see, this is a

00:23:06.336 --> 00:23:07.896 A:middle
different style of presenting

00:23:07.896 --> 00:23:09.506 A:middle
Quick Look and it works just as

00:23:09.506 --> 00:23:10.976 A:middle
fine as presenting it modally.

00:23:17.066 --> 00:23:19.226 A:middle
Okay Quick Look works and now

00:23:19.226 --> 00:23:20.356 A:middle
the last thing I would like to

00:23:20.356 --> 00:23:22.126 A:middle
show you is how to use the Quick

00:23:22.126 --> 00:23:23.766 A:middle
Look delegate in order to get a

00:23:23.766 --> 00:23:25.576 A:middle
beautiful zoom animation when

00:23:25.576 --> 00:23:28.616 A:middle
tapping a thumbnail in our grid.

00:23:28.706 --> 00:23:30.456 A:middle
First, we switch back to the

00:23:30.456 --> 00:23:32.286 A:middle
modal presentation style which

00:23:32.286 --> 00:23:33.276 A:middle
is needed for the zoom

00:23:33.276 --> 00:23:33.976 A:middle
transition to work.

00:23:39.046 --> 00:23:40.286 A:middle
Then we need to assign a

00:23:40.286 --> 00:23:41.496 A:middle
delegate to the preview

00:23:41.496 --> 00:23:43.706 A:middle
controller and in this case, we

00:23:43.706 --> 00:23:44.496 A:middle
assign self.

00:23:54.046 --> 00:23:55.646 A:middle
However, self doesn't conform to

00:23:55.646 --> 00:23:57.536 A:middle
the QLPreviewController delegate

00:23:57.536 --> 00:23:59.506 A:middle
yet, so let's add it to the list

00:23:59.506 --> 00:23:59.976 A:middle
of protocols.

00:24:12.236 --> 00:24:14.556 A:middle
And now as the last step we

00:24:14.556 --> 00:24:16.446 A:middle
implement the magic method which

00:24:16.446 --> 00:24:18.156 A:middle
tells Quick Look which view to

00:24:18.156 --> 00:24:20.176 A:middle
use as the source for the zoom

00:24:20.176 --> 00:24:22.156 A:middle
animation when it is about to be

00:24:22.156 --> 00:24:22.756 A:middle
presented.

00:24:34.366 --> 00:24:36.506 A:middle
As you can see, we are using the

00:24:36.506 --> 00:24:38.816 A:middle
image view of the most recently

00:24:38.816 --> 00:24:40.356 A:middle
tapped cell which we keep a

00:24:40.356 --> 00:24:42.356 A:middle
reference of and return it to

00:24:42.356 --> 00:24:42.896 A:middle
Quick Look.

00:24:44.196 --> 00:24:45.646 A:middle
That's literally all we have to

00:24:45.646 --> 00:24:47.316 A:middle
do to make the zoom animation

00:24:47.316 --> 00:24:47.666 A:middle
work.

00:24:48.066 --> 00:24:49.836 A:middle
Quick Look will call this method

00:24:49.836 --> 00:24:51.626 A:middle
when it's presented and when

00:24:51.626 --> 00:24:52.416 A:middle
it's dismissed.

00:24:52.996 --> 00:24:53.916 A:middle
Let's try it out.

00:25:03.046 --> 00:25:04.506 A:middle
Now when we tap a thumbnail

00:25:05.116 --> 00:25:06.576 A:middle
notice how the thumbnail is

00:25:06.576 --> 00:25:07.976 A:middle
animating to the full-screen

00:25:07.976 --> 00:25:08.446 A:middle
preview.

00:25:09.756 --> 00:25:11.646 A:middle
Also observe no matter how we

00:25:11.646 --> 00:25:13.726 A:middle
dismiss the preview it

00:25:13.766 --> 00:25:15.406 A:middle
beautifully transitions back to

00:25:15.406 --> 00:25:15.946 A:middle
the right origin.

00:25:22.306 --> 00:25:24.586 A:middle
Great, that's it for the demo,

00:25:25.206 --> 00:25:26.106 A:middle
back to the slides.

00:25:26.616 --> 00:25:28.116 A:middle
And now I would like to hand it

00:25:28.116 --> 00:25:30.036 A:middle
over to Maxime who is going to

00:25:30.036 --> 00:25:31.996 A:middle
tell you all about previews and

00:25:31.996 --> 00:25:33.076 A:middle
thumbnail extensions.

00:25:34.336 --> 00:25:35.506 A:middle
&gt;&gt; Thank you Raffael.

00:25:36.186 --> 00:25:37.916 A:middle
So as you have seen, Quick Look

00:25:37.996 --> 00:25:39.486 A:middle
makes it super easy to add a

00:25:39.486 --> 00:25:41.036 A:middle
powerful previewing feature to

00:25:41.036 --> 00:25:41.506 A:middle
your app.

00:25:42.196 --> 00:25:43.756 A:middle
But there is more to talk about.

00:25:44.486 --> 00:25:45.556 A:middle
The first thing I want to show

00:25:45.556 --> 00:25:47.326 A:middle
you is how to extend Quick

00:25:47.326 --> 00:25:48.826 A:middle
Look's previewing capabilities

00:25:48.896 --> 00:25:50.766 A:middle
by providing a preview for your

00:25:50.766 --> 00:25:51.676 A:middle
own file format.

00:25:54.006 --> 00:25:55.476 A:middle
We have listed the file types

00:25:55.476 --> 00:25:56.636 A:middle
that Quick Look supports

00:25:56.636 --> 00:25:57.536 A:middle
natively before.

00:25:59.216 --> 00:26:02.936 A:middle
However, since iOS 11 this list

00:25:59.216 --> 00:26:02.936 A:middle
However, since iOS 11 this list

00:26:03.046 --> 00:26:04.836 A:middle
can be extended by bundling a

00:26:04.836 --> 00:26:06.646 A:middle
preview extension with your iOS

00:26:06.646 --> 00:26:08.886 A:middle
app which allows you as a

00:26:08.886 --> 00:26:10.876 A:middle
developer to provide previews

00:26:10.876 --> 00:26:12.326 A:middle
for your custom file formats.

00:26:12.636 --> 00:26:15.666 A:middle
You should provide a preview if

00:26:15.666 --> 00:26:16.886 A:middle
you're in a custom fil format

00:26:17.166 --> 00:26:18.536 A:middle
and you'd like this one to be

00:26:18.536 --> 00:26:20.436 A:middle
previewed by Quick Look just

00:26:20.436 --> 00:26:22.466 A:middle
like any other native type.

00:26:23.656 --> 00:26:25.146 A:middle
File types that are meant to be

00:26:25.146 --> 00:26:27.126 A:middle
shared are usually good types to

00:26:27.126 --> 00:26:28.656 A:middle
create an extension for,

00:26:29.576 --> 00:26:31.046 A:middle
especially if you want your

00:26:31.046 --> 00:26:32.886 A:middle
users to preview the content

00:26:32.936 --> 00:26:35.106 A:middle
easily after receiving a file in

00:26:35.106 --> 00:26:37.516 A:middle
an app like Mail, Messages or in

00:26:37.516 --> 00:26:38.256 A:middle
a Note for instance.

00:26:38.766 --> 00:26:40.536 A:middle
And then everything works

00:26:40.536 --> 00:26:43.176 A:middle
together and your application

00:26:43.176 --> 00:26:44.096 A:middle
that is using a

00:26:44.096 --> 00:26:45.896 A:middle
QLPreviewController with a file

00:26:46.196 --> 00:26:48.026 A:middle
that is not natively supported

00:26:48.476 --> 00:26:49.806 A:middle
will benefit from your preview

00:26:49.806 --> 00:26:50.326 A:middle
extension.

00:26:52.606 --> 00:26:54.796 A:middle
Here is an example of what you

00:26:54.796 --> 00:26:56.456 A:middle
can achieve thanks to a preview

00:26:56.456 --> 00:26:56.916 A:middle
extension.

00:26:57.346 --> 00:26:59.876 A:middle
We have built a sample app that

00:26:59.876 --> 00:27:01.386 A:middle
can be downloaded from Apple's

00:26:59.876 --> 00:27:01.386 A:middle
can be downloaded from Apple's

00:27:01.386 --> 00:27:02.956 A:middle
website that allows one to

00:27:02.956 --> 00:27:05.316 A:middle
create customized and interact

00:27:05.316 --> 00:27:05.936 A:middle
with Particles.

00:27:07.086 --> 00:27:08.406 A:middle
Since we wanted to share our

00:27:08.406 --> 00:27:11.286 A:middle
cool Particles to other users we

00:27:11.286 --> 00:27:13.956 A:middle
created a new file format, the

00:27:13.956 --> 00:27:16.636 A:middle
particles file format.

00:27:16.636 --> 00:27:18.076 A:middle
Each file represents a particle

00:27:18.076 --> 00:27:20.316 A:middle
system and you can configure all

00:27:20.316 --> 00:27:22.856 A:middle
sorts of [inaudible] systems.

00:27:24.466 --> 00:27:26.956 A:middle
Now let's say you share a

00:27:27.296 --> 00:27:28.706 A:middle
particles file with your

00:27:28.706 --> 00:27:29.146 A:middle
friends.

00:27:30.026 --> 00:27:31.656 A:middle
When previewing them in messages

00:27:31.786 --> 00:27:33.106 A:middle
or as an email attachment for

00:27:33.106 --> 00:27:34.906 A:middle
instance [inaudible] get to see

00:27:35.206 --> 00:27:36.996 A:middle
is a blank screen, that is

00:27:36.996 --> 00:27:40.256 A:middle
certainly not what we want.

00:27:40.416 --> 00:27:42.176 A:middle
But by implementing your preview

00:27:42.176 --> 00:27:43.696 A:middle
extension for our particles file

00:27:43.696 --> 00:27:45.196 A:middle
format it will replace that

00:27:45.196 --> 00:27:46.476 A:middle
blank screen with a beautifully

00:27:46.476 --> 00:27:47.926 A:middle
rendered three-dimensional

00:27:48.236 --> 00:27:49.586 A:middle
interactive particle system.

00:27:49.586 --> 00:27:49.976 A:middle
How good is that?

00:27:54.046 --> 00:27:55.136 A:middle
I am sure you now want to learn

00:27:55.346 --> 00:27:56.546 A:middle
how you can make your own

00:27:56.546 --> 00:27:58.016 A:middle
preview extension for your file

00:27:58.016 --> 00:27:58.586 A:middle
formats.

00:28:00.276 --> 00:28:02.666 A:middle
First, you will need to add a

00:28:02.666 --> 00:28:04.556 A:middle
new target in your existing

00:28:04.556 --> 00:28:05.696 A:middle
application project.

00:28:06.786 --> 00:28:08.736 A:middle
To do so you will have to select

00:28:08.736 --> 00:28:10.116 A:middle
the Quick Look Preview Extension

00:28:10.156 --> 00:28:13.986 A:middle
template in Xcode.

00:28:13.986 --> 00:28:16.486 A:middle
After that several files will be

00:28:16.486 --> 00:28:17.956 A:middle
generated for you by Xcode.

00:28:19.226 --> 00:28:20.936 A:middle
The PreviewViewController class

00:28:20.936 --> 00:28:22.426 A:middle
with a basic implementation.

00:28:23.296 --> 00:28:25.186 A:middle
This is where you will have to

00:28:25.186 --> 00:28:26.476 A:middle
add code for your preview.

00:28:27.066 --> 00:28:29.816 A:middle
The storyboard that has the

00:28:29.816 --> 00:28:31.646 A:middle
PreviewViewController as its

00:28:31.646 --> 00:28:32.216 A:middle
entry point.

00:28:32.686 --> 00:28:35.696 A:middle
And an Info.plist that's the

00:28:35.696 --> 00:28:36.966 A:middle
first thing you will want to

00:28:37.436 --> 00:28:37.626 A:middle
edit.

00:28:37.626 --> 00:28:42.586 A:middle
Let's take a closer look at it.

00:28:42.796 --> 00:28:45.066 A:middle
To get started the attribute we

00:28:45.066 --> 00:28:46.776 A:middle
are the most interested in is

00:28:46.776 --> 00:28:48.836 A:middle
named QLSupportedContentTypes.

00:28:49.706 --> 00:28:50.786 A:middle
This is the one that is

00:28:50.816 --> 00:28:52.256 A:middle
highlighted on the screen shot.

00:28:53.706 --> 00:28:55.066 A:middle
This is an array in which you

00:28:55.066 --> 00:28:56.346 A:middle
list all the file types for

00:28:56.346 --> 00:28:57.756 A:middle
which your extension can provide

00:28:57.756 --> 00:28:58.136 A:middle
previews.

00:28:59.366 --> 00:29:00.946 A:middle
Please note that you can only

00:28:59.366 --> 00:29:00.946 A:middle
Please note that you can only

00:29:00.946 --> 00:29:02.716 A:middle
provide previews for UTIs you

00:29:02.756 --> 00:29:03.996 A:middle
own and export.

00:29:05.356 --> 00:29:07.146 A:middle
When Quick Look can't natively

00:29:07.146 --> 00:29:09.246 A:middle
preview a file type it will make

00:29:09.246 --> 00:29:10.826 A:middle
use of the content types added

00:29:10.826 --> 00:29:13.986 A:middle
to this array and select an

00:29:13.986 --> 00:29:15.306 A:middle
extension that can handle

00:29:15.506 --> 00:29:16.106 A:middle
previewing it.

00:29:16.906 --> 00:29:18.246 A:middle
So make sure to list all file

00:29:18.246 --> 00:29:19.426 A:middle
types [inaudible] extension

00:29:19.426 --> 00:29:19.946 A:middle
support.

00:29:21.056 --> 00:29:22.526 A:middle
Let's see how we achieve this

00:29:22.746 --> 00:29:24.176 A:middle
with our Particles app.

00:29:24.426 --> 00:29:29.576 A:middle
As you can see Particles

00:29:29.576 --> 00:29:30.896 A:middle
declares and exports a new

00:29:31.276 --> 00:29:32.176 A:middle
particles file type.

00:29:32.326 --> 00:29:34.806 A:middle
Its identifier is [inaudible]

00:29:35.486 --> 00:29:37.986 A:middle
example.applesample

00:29:37.986 --> 00:29:39.996 A:middle
code.particles.particles.

00:29:41.296 --> 00:29:43.006 A:middle
Since we wanted our extension to

00:29:43.006 --> 00:29:45.196 A:middle
support particles previews we

00:29:45.196 --> 00:29:47.016 A:middle
added this identifier to the

00:29:47.016 --> 00:29:48.836 A:middle
QLSupportedContentTypes of its

00:29:48.836 --> 00:29:49.566 A:middle
Info.plist.

00:29:50.256 --> 00:29:52.196 A:middle
By the way, if you're interested

00:29:52.196 --> 00:29:54.756 A:middle
in UTIs you should check out the

00:29:54.756 --> 00:29:56.646 A:middle
Documents Manager session of

00:29:56.646 --> 00:29:56.956 A:middle
this year.

00:30:00.376 --> 00:30:01.696 A:middle
When a new preview has to be

00:30:01.696 --> 00:30:03.066 A:middle
generated for a file type

00:30:03.066 --> 00:30:04.096 A:middle
[inaudible] Quick Look will

00:30:04.776 --> 00:30:06.156 A:middle
create a new

00:30:06.156 --> 00:30:07.986 A:middle
PreviewViewController instance

00:30:08.456 --> 00:30:09.026 A:middle
and calls it

00:30:09.086 --> 00:30:10.636 A:middle
preparePreviewOfFile at URL

00:30:10.636 --> 00:30:12.056 A:middle
completionHandler method.

00:30:14.976 --> 00:30:16.716 A:middle
This method is part of the

00:30:16.716 --> 00:30:18.876 A:middle
QLPreviewingController protocol

00:30:19.216 --> 00:30:20.826 A:middle
and is mandatory to provide

00:30:20.826 --> 00:30:22.296 A:middle
previews for a file.

00:30:23.156 --> 00:30:25.296 A:middle
Quick Look will display

00:30:25.336 --> 00:30:26.116 A:middle
[inaudible] while waiting for

00:30:26.116 --> 00:30:27.486 A:middle
your extension to be ready to

00:30:27.486 --> 00:30:28.266 A:middle
display the preview.

00:30:28.756 --> 00:30:31.026 A:middle
All you have to take care of is

00:30:31.026 --> 00:30:32.116 A:middle
loading the contents of your

00:30:32.116 --> 00:30:34.276 A:middle
preview and calling the

00:30:34.276 --> 00:30:36.196 A:middle
completion handler as soon as

00:30:36.196 --> 00:30:38.886 A:middle
your extension is ready.

00:30:39.026 --> 00:30:40.216 A:middle
All right that's it for the

00:30:40.216 --> 00:30:42.676 A:middle
preview extensions, let's go one

00:30:42.676 --> 00:30:43.216 A:middle
step further.

00:30:44.016 --> 00:30:46.046 A:middle
Similarly to previews you can

00:30:46.046 --> 00:30:47.266 A:middle
also provide thumbnails for

00:30:47.266 --> 00:30:48.926 A:middle
files of your own file format.

00:30:49.316 --> 00:30:51.506 A:middle
Let's talk about Quick Look

00:30:51.506 --> 00:30:52.356 A:middle
thumbnail extensions.

00:30:52.916 --> 00:30:56.776 A:middle
A thumbnail is an image of a

00:30:56.776 --> 00:30:58.806 A:middle
limited size that represents the

00:30:58.806 --> 00:31:00.806 A:middle
contents of a file.

00:30:58.806 --> 00:31:00.806 A:middle
contents of a file.

00:31:01.116 --> 00:31:03.206 A:middle
There is throughout iOS and

00:31:03.206 --> 00:31:05.856 A:middle
macOS to allow users to identify

00:31:05.856 --> 00:31:08.216 A:middle
files officially without having

00:31:08.216 --> 00:31:09.316 A:middle
to open them to the file

00:31:09.316 --> 00:31:09.876 A:middle
contents.

00:31:11.366 --> 00:31:12.796 A:middle
For instance you can see on the

00:31:12.796 --> 00:31:15.016 A:middle
screenshot how iOS makes uses of

00:31:15.016 --> 00:31:17.706 A:middle
them in the file tap.

00:31:17.706 --> 00:31:19.326 A:middle
iOS can generate thumbnails for

00:31:19.326 --> 00:31:21.356 A:middle
different file types, images,

00:31:21.356 --> 00:31:24.426 A:middle
videos, PDFs, text files, and

00:31:24.426 --> 00:31:25.266 A:middle
USDZ files.

00:31:26.126 --> 00:31:28.276 A:middle
Now you may have noticed the

00:31:28.276 --> 00:31:29.966 A:middle
blank icons on the left.

00:31:31.186 --> 00:31:32.816 A:middle
This is because these are

00:31:32.956 --> 00:31:35.726 A:middle
particles files and iOS doesn't

00:31:35.726 --> 00:31:37.346 A:middle
know how to generate thumbnails

00:31:37.346 --> 00:31:38.466 A:middle
for this file natively.

00:31:38.796 --> 00:31:41.786 A:middle
But don't worry we are going to

00:31:41.786 --> 00:31:43.756 A:middle
show you how to create a

00:31:43.756 --> 00:31:45.376 A:middle
thumbnail extension that you can

00:31:45.376 --> 00:31:46.746 A:middle
use to improve this situation

00:31:46.746 --> 00:31:47.986 A:middle
for your custom file types

00:31:47.986 --> 00:31:48.296 A:middle
easily.

00:31:49.296 --> 00:31:50.996 A:middle
Look at how great these

00:31:50.996 --> 00:31:52.516 A:middle
thumbnails look for particles

00:31:52.516 --> 00:31:54.346 A:middle
files thanks to the thumbnail

00:31:54.346 --> 00:31:55.876 A:middle
extension we have added to our

00:31:55.876 --> 00:31:55.976 A:middle
app.

00:32:01.166 --> 00:32:02.426 A:middle
Thumbnails provided by this

00:32:02.426 --> 00:32:04.906 A:middle
extension appear in the Files

00:32:04.906 --> 00:32:06.416 A:middle
app, as well as in any

00:32:06.416 --> 00:32:07.616 A:middle
UIDocumentBrowswer

00:32:07.616 --> 00:32:09.526 A:middle
ViewController-based app.

00:32:10.576 --> 00:32:12.256 A:middle
They also appear in the Quick

00:32:12.256 --> 00:32:14.076 A:middle
Look list, that you can see when

00:32:14.076 --> 00:32:15.746 A:middle
tapping the list button when

00:32:15.746 --> 00:32:17.106 A:middle
previewing multiple files in

00:32:17.106 --> 00:32:17.546 A:middle
Quick Look.

00:32:17.546 --> 00:32:20.166 A:middle
If you have custom file types

00:32:20.166 --> 00:32:22.136 A:middle
that the user can share and

00:32:22.136 --> 00:32:24.276 A:middle
interact with you will likely

00:32:24.276 --> 00:32:25.396 A:middle
want to provide a certain

00:32:25.396 --> 00:32:26.416 A:middle
extension with your app.

00:32:27.166 --> 00:32:28.786 A:middle
Let's now see how you can do so.

00:32:31.796 --> 00:32:33.436 A:middle
Creating a thumbnail extension

00:32:33.466 --> 00:32:34.996 A:middle
is as just creating a preview

00:32:34.996 --> 00:32:35.466 A:middle
extension.

00:32:36.856 --> 00:32:39.626 A:middle
To do so add a new target in

00:32:39.626 --> 00:32:40.936 A:middle
your existing application

00:32:40.936 --> 00:32:42.536 A:middle
project and select the Thumbnail

00:32:42.536 --> 00:32:43.986 A:middle
Extension template.

00:32:46.326 --> 00:32:48.226 A:middle
Xcode will generate for you two

00:32:48.226 --> 00:32:50.126 A:middle
files, the ThumbnailProvider

00:32:50.126 --> 00:32:51.316 A:middle
class with a basic

00:32:51.316 --> 00:32:52.046 A:middle
implementation.

00:32:53.326 --> 00:32:54.716 A:middle
This is where you will have to

00:32:54.716 --> 00:32:56.296 A:middle
add the code that takes care of

00:32:56.296 --> 00:32:57.456 A:middle
generating thumbnails.

00:32:58.476 --> 00:33:00.596 A:middle
And an Info.plist this is just

00:32:58.476 --> 00:33:00.596 A:middle
And an Info.plist this is just

00:33:00.596 --> 00:33:01.806 A:middle
like for the preview extension,

00:33:02.356 --> 00:33:03.856 A:middle
the first thing you will have to

00:33:03.856 --> 00:33:05.266 A:middle
edit after creating your

00:33:05.266 --> 00:33:05.796 A:middle
extension.

00:33:10.046 --> 00:33:11.296 A:middle
As in the Info.plist of the

00:33:11.296 --> 00:33:12.926 A:middle
preview extensions the

00:33:12.926 --> 00:33:14.096 A:middle
Info.plist of the thumbnail

00:33:14.096 --> 00:33:15.406 A:middle
extensions have a

00:33:15.406 --> 00:33:17.326 A:middle
QLSupportedContentTypes array

00:33:17.936 --> 00:33:19.336 A:middle
that needs to be filled with the

00:33:19.336 --> 00:33:20.766 A:middle
content types that your

00:33:20.856 --> 00:33:23.096 A:middle
extension supports.

00:33:24.096 --> 00:33:26.866 A:middle
So make sure to include in

00:33:26.866 --> 00:33:29.086 A:middle
QLSupportedContentTypes all the

00:33:29.086 --> 00:33:30.756 A:middle
content types for which your

00:33:30.756 --> 00:33:32.076 A:middle
extension can generate

00:33:32.076 --> 00:33:32.626 A:middle
thumbnails.

00:33:33.766 --> 00:33:35.646 A:middle
After setting up your extension

00:33:35.836 --> 00:33:37.466 A:middle
you will be able to start

00:33:37.466 --> 00:33:38.336 A:middle
implementing your

00:33:38.476 --> 00:33:40.206 A:middle
QLThumbnailProvider subclass.

00:33:40.596 --> 00:33:42.506 A:middle
You have two ways to provide a

00:33:42.506 --> 00:33:44.976 A:middle
thumbnail for a file.

00:33:45.116 --> 00:33:46.396 A:middle
You can [inaudible] use it

00:33:46.936 --> 00:33:49.336 A:middle
CoreGraphics or UIKit

00:33:49.336 --> 00:33:52.266 A:middle
[inaudible] techniques or you

00:33:52.266 --> 00:33:54.286 A:middle
can return an image file URL.

00:33:55.536 --> 00:33:59.296 A:middle
You will have to override the

00:33:59.296 --> 00:34:00.866 A:middle
provideThumbnail for request

00:33:59.296 --> 00:34:00.866 A:middle
provideThumbnail for request

00:34:00.866 --> 00:34:02.316 A:middle
handler method in your

00:34:02.536 --> 00:34:04.326 A:middle
QLThumbnailProvider subclass.

00:34:05.546 --> 00:34:07.816 A:middle
We extensively covered this part

00:34:07.816 --> 00:34:09.795 A:middle
of the Quick Look API in your

00:34:09.826 --> 00:34:14.376 A:middle
session for WWDC 2017, Building

00:34:14.376 --> 00:34:16.106 A:middle
Great Document-Based Apps in iOS

00:34:16.106 --> 00:34:16.556 A:middle
11.

00:34:17.076 --> 00:34:18.166 A:middle
So if you'd like to provide

00:34:18.166 --> 00:34:19.485 A:middle
thumbnails for your custom file

00:34:19.485 --> 00:34:21.966 A:middle
types I highly encourage you to

00:34:21.966 --> 00:34:23.666 A:middle
check it out.

00:34:23.936 --> 00:34:25.485 A:middle
In a nutshell, you will need to

00:34:25.485 --> 00:34:26.936 A:middle
make use of the parameters

00:34:26.936 --> 00:34:28.166 A:middle
contained in the

00:34:28.275 --> 00:34:29.866 A:middle
QLFileThumbnailRequest of the

00:34:29.866 --> 00:34:30.286 A:middle
method.

00:34:31.856 --> 00:34:34.126 A:middle
The URL of the file, the maximum

00:34:34.126 --> 00:34:35.176 A:middle
and minimum sizes of the

00:34:35.176 --> 00:34:37.295 A:middle
thumbnail, and its scale.

00:34:39.596 --> 00:34:41.565 A:middle
For each thumbnail request the

00:34:41.565 --> 00:34:43.646 A:middle
API expects you to create a

00:34:43.646 --> 00:34:45.315 A:middle
QLThumbnailReply object.

00:34:45.916 --> 00:34:48.025 A:middle
This object will have to take

00:34:48.025 --> 00:34:49.335 A:middle
care of generating the

00:34:49.335 --> 00:34:49.886 A:middle
thumbnail.

00:34:50.826 --> 00:34:51.886 A:middle
You will have to provide it to

00:34:51.886 --> 00:34:53.116 A:middle
Quick Look through the

00:34:53.116 --> 00:34:55.286 A:middle
completion handler of the

00:34:57.456 --> 00:34:57.636 A:middle
method.

00:34:57.766 --> 00:34:59.166 A:middle
All right let's see all of this

00:34:59.166 --> 00:35:00.306 A:middle
in action it's demo time.

00:34:59.166 --> 00:35:00.306 A:middle
in action it's demo time.

00:35:00.806 --> 00:35:03.956 A:middle
Let's start by taking a look at

00:35:04.096 --> 00:35:05.556 A:middle
how things look like after

00:35:05.556 --> 00:35:06.866 A:middle
installing the Particles app

00:35:06.866 --> 00:35:07.986 A:middle
without any Quick Look

00:35:07.986 --> 00:35:08.566 A:middle
extension.

00:35:09.556 --> 00:35:11.466 A:middle
All right we don't have any file

00:35:11.466 --> 00:35:13.686 A:middle
yet, let's create a new one by

00:35:13.686 --> 00:35:15.056 A:middle
pressing the + button.

00:35:17.116 --> 00:35:18.686 A:middle
What you can see here is the

00:35:18.686 --> 00:35:19.686 A:middle
particle editor.

00:35:20.126 --> 00:35:21.786 A:middle
Let's create a file particle

00:35:21.786 --> 00:35:23.946 A:middle
system, we change the color a

00:35:23.946 --> 00:35:25.426 A:middle
bit, and save the document.

00:35:27.096 --> 00:35:30.336 A:middle
Well as you can see we don't get

00:35:30.336 --> 00:35:31.716 A:middle
to see the beautiful particle

00:35:31.716 --> 00:35:33.046 A:middle
system we just designed.

00:35:33.406 --> 00:35:35.716 A:middle
[Inaudible] of that by adding a

00:35:35.716 --> 00:35:37.126 A:middle
thumbnail extension to our

00:35:37.126 --> 00:35:37.716 A:middle
application.

00:35:38.476 --> 00:35:40.586 A:middle
Now let's save the file to a

00:35:41.076 --> 00:35:41.966 A:middle
[inaudible] and see how the

00:35:41.966 --> 00:35:44.046 A:middle
preview looks like in Quick

00:35:46.816 --> 00:35:46.916 A:middle
Look.

00:35:47.076 --> 00:35:49.436 A:middle
All right let's open the file

00:35:49.436 --> 00:35:50.056 A:middle
format.

00:35:52.316 --> 00:35:54.746 A:middle
All we see is a blank screen, we

00:35:54.746 --> 00:35:56.246 A:middle
can do better, let's improve

00:35:56.246 --> 00:35:56.626 A:middle
this too.

00:35:57.556 --> 00:35:59.066 A:middle
Let's switch to Xcode and

00:35:59.066 --> 00:36:00.706 A:middle
implement a preview and a

00:35:59.066 --> 00:36:00.706 A:middle
implement a preview and a

00:36:00.706 --> 00:36:01.606 A:middle
thumbnail extension.

00:36:02.826 --> 00:36:04.526 A:middle
We already have an existing

00:36:04.526 --> 00:36:06.546 A:middle
project containing the extension

00:36:06.546 --> 00:36:06.926 A:middle
setup.

00:36:07.956 --> 00:36:09.516 A:middle
We are going to use these as a

00:36:09.516 --> 00:36:11.036 A:middle
starting point and add the two

00:36:11.036 --> 00:36:11.736 A:middle
extensions.

00:36:12.556 --> 00:36:14.266 A:middle
As mentioned previously we need

00:36:14.266 --> 00:36:16.326 A:middle
the Info.plist of our extensions

00:36:16.326 --> 00:36:17.936 A:middle
to be configured so that the

00:36:17.936 --> 00:36:19.436 A:middle
system knows we are able to

00:36:19.436 --> 00:36:21.196 A:middle
provide previews and thumbnails

00:36:21.196 --> 00:36:22.316 A:middle
for particles files.

00:36:23.476 --> 00:36:25.786 A:middle
So Particles app defines its own

00:36:25.786 --> 00:36:28.236 A:middle
file format in the exported UTIs

00:36:28.236 --> 00:36:29.576 A:middle
section of the application

00:36:29.576 --> 00:36:30.076 A:middle
target.

00:36:30.936 --> 00:36:32.246 A:middle
We need to configure the

00:36:32.246 --> 00:36:34.256 A:middle
extensions to use that UTI in

00:36:34.256 --> 00:36:35.156 A:middle
the Info.plist.

00:36:35.336 --> 00:36:38.676 A:middle
As you can see the

00:36:38.676 --> 00:36:40.186 A:middle
QLSupportedContentTypes of the

00:36:40.186 --> 00:36:41.376 A:middle
Info.plist of the preview

00:36:41.376 --> 00:36:43.346 A:middle
extension does contain the

00:36:43.346 --> 00:36:44.756 A:middle
identifier of the UTI of the

00:36:44.756 --> 00:36:45.746 A:middle
particles file format.

00:36:46.226 --> 00:36:49.606 A:middle
And this is also the case of the

00:36:49.606 --> 00:36:50.886 A:middle
Info.plist of the thumbnail

00:36:50.886 --> 00:36:51.446 A:middle
extension.

00:36:51.966 --> 00:36:54.256 A:middle
So the only thing left to do is

00:36:54.526 --> 00:36:55.586 A:middle
to actually implement these

00:36:55.586 --> 00:36:56.226 A:middle
extensions.

00:36:56.766 --> 00:36:57.716 A:middle
Let's start with the preview

00:36:57.716 --> 00:36:58.226 A:middle
extension.

00:36:59.276 --> 00:37:02.296 A:middle
As mentioned in the presentation

00:36:59.276 --> 00:37:02.296 A:middle
As mentioned in the presentation

00:37:02.626 --> 00:37:03.796 A:middle
we need to implement this

00:37:03.796 --> 00:37:05.976 A:middle
method, preparePreviewOfFile at

00:37:05.976 --> 00:37:07.166 A:middle
URL completionHandler.

00:37:07.536 --> 00:37:10.506 A:middle
Our main app Particles already

00:37:10.506 --> 00:37:12.316 A:middle
has a view controller class

00:37:12.626 --> 00:37:13.686 A:middle
which [inaudible] the particle

00:37:13.686 --> 00:37:14.526 A:middle
system on screen.

00:37:15.546 --> 00:37:16.866 A:middle
We are going to reduce

00:37:16.866 --> 00:37:17.766 A:middle
[inaudible] controller in our

00:37:17.766 --> 00:37:18.346 A:middle
extension.

00:37:19.406 --> 00:37:21.126 A:middle
We are going to create a helper

00:37:21.126 --> 00:37:22.716 A:middle
method that will take care of

00:37:22.716 --> 00:37:24.176 A:middle
loading such a view controller

00:37:24.366 --> 00:37:25.826 A:middle
and adding it to the view

00:37:25.826 --> 00:37:26.316 A:middle
hierarchy.

00:37:28.046 --> 00:37:30.726 A:middle
As you can see present

00:37:30.726 --> 00:37:32.156 A:middle
particleViewController for a

00:37:32.156 --> 00:37:33.656 A:middle
document simply creates a

00:37:33.656 --> 00:37:35.526 A:middle
particleViewController and

00:37:35.526 --> 00:37:37.146 A:middle
passes it to the document it

00:37:37.146 --> 00:37:38.426 A:middle
received so that the

00:37:38.426 --> 00:37:39.806 A:middle
particleViewController can

00:37:39.806 --> 00:37:41.566 A:middle
render the particles that the

00:37:41.566 --> 00:37:42.586 A:middle
document represents.

00:37:44.126 --> 00:37:45.426 A:middle
We still need to call this

00:37:45.426 --> 00:37:46.896 A:middle
method from preparePreviewOfFile

00:37:46.896 --> 00:37:50.286 A:middle
at URL, so let's do it.

00:37:51.336 --> 00:37:54.136 A:middle
We first create a document that

00:37:54.136 --> 00:37:55.146 A:middle
is a subclass of [inaudible]

00:37:55.226 --> 00:37:56.096 A:middle
document.

00:37:57.136 --> 00:37:59.876 A:middle
We open it and once it is open

00:37:59.876 --> 00:38:01.846 A:middle
and usable we call our helper

00:37:59.876 --> 00:38:01.846 A:middle
and usable we call our helper

00:38:01.846 --> 00:38:03.496 A:middle
method that will displace a

00:38:03.496 --> 00:38:04.566 A:middle
particleViewController.

00:38:05.696 --> 00:38:08.206 A:middle
Finally, we may not forget to

00:38:08.206 --> 00:38:09.606 A:middle
close the completion handler to

00:38:09.606 --> 00:38:11.796 A:middle
notify Quick Look that our view

00:38:11.796 --> 00:38:13.186 A:middle
controller is loaded and ready

00:38:13.186 --> 00:38:13.976 A:middle
to appear on screen.

00:38:15.306 --> 00:38:17.226 A:middle
Our preview extension is now

00:38:17.226 --> 00:38:17.606 A:middle
ready.

00:38:18.376 --> 00:38:19.446 A:middle
Let's implement the thumbnail

00:38:19.446 --> 00:38:19.986 A:middle
extension.

00:38:21.586 --> 00:38:24.466 A:middle
All we have to do here is to

00:38:24.466 --> 00:38:26.086 A:middle
implement the provideThumbnail

00:38:26.086 --> 00:38:27.456 A:middle
for request handler method.

00:38:28.776 --> 00:38:30.546 A:middle
So request provides several

00:38:30.546 --> 00:38:32.016 A:middle
properties that you need to

00:38:32.016 --> 00:38:33.256 A:middle
consider when rendering a

00:38:33.256 --> 00:38:33.686 A:middle
thumbnail.

00:38:35.886 --> 00:38:37.696 A:middle
In this example we will make use

00:38:37.696 --> 00:38:39.886 A:middle
of the file URL as the maximum

00:38:39.886 --> 00:38:40.726 A:middle
size of the thumbnail.

00:38:41.966 --> 00:38:43.926 A:middle
Note that there are also a scale

00:38:43.926 --> 00:38:45.826 A:middle
and minimum size properties, but

00:38:45.926 --> 00:38:47.056 A:middle
in the case of our particle

00:38:47.056 --> 00:38:48.316 A:middle
system we don't use them.

00:38:49.716 --> 00:38:51.496 A:middle
We then create a drawing block

00:38:51.826 --> 00:38:52.896 A:middle
that we are going to provide

00:38:52.896 --> 00:38:54.386 A:middle
later [inaudible] completion

00:38:54.386 --> 00:38:54.676 A:middle
block.

00:38:56.596 --> 00:38:58.836 A:middle
In this case, we call the helper

00:38:58.836 --> 00:39:00.476 A:middle
method that will take care of

00:38:58.836 --> 00:39:00.476 A:middle
method that will take care of

00:39:00.476 --> 00:39:01.246 A:middle
drawing the thumbnail,

00:39:02.056 --> 00:39:03.606 A:middle
drawThumbnail for fileURL,

00:39:04.126 --> 00:39:04.866 A:middle
contextSize.

00:39:05.336 --> 00:39:06.676 A:middle
We are going to implement this

00:39:06.676 --> 00:39:08.136 A:middle
helper method in a second.

00:39:08.706 --> 00:39:10.296 A:middle
You may have noticed that our

00:39:10.296 --> 00:39:11.716 A:middle
drawing block returns a Boolean,

00:39:12.576 --> 00:39:13.926 A:middle
this flag indicates if the

00:39:13.926 --> 00:39:15.196 A:middle
thumbnail was successfully drawn

00:39:15.196 --> 00:39:17.266 A:middle
or not once this block will be

00:39:17.266 --> 00:39:18.376 A:middle
used to generate the thumbnail.

00:39:19.396 --> 00:39:21.376 A:middle
Let's now see how we draw our

00:39:21.376 --> 00:39:22.236 A:middle
particle thumbnails.

00:39:24.316 --> 00:39:26.746 A:middle
To draw the thumbnails we make

00:39:26.746 --> 00:39:29.316 A:middle
use of the URL of the file and

00:39:29.316 --> 00:39:30.736 A:middle
of the size of the context we

00:39:30.736 --> 00:39:31.276 A:middle
will draw into.

00:39:32.196 --> 00:39:33.856 A:middle
In this case, we all know the

00:39:33.856 --> 00:39:35.256 A:middle
maximum size of the thumbnail

00:39:35.256 --> 00:39:37.116 A:middle
request since we can generate

00:39:37.116 --> 00:39:38.526 A:middle
particle thumbnails of any size.

00:39:39.376 --> 00:39:41.756 A:middle
Our method first creates a

00:39:41.756 --> 00:39:43.426 A:middle
document that represents the

00:39:43.426 --> 00:39:45.776 A:middle
file and attempts to open it.

00:39:46.226 --> 00:39:48.296 A:middle
If this fails it returns false

00:39:48.336 --> 00:39:49.506 A:middle
to indicate that it could not

00:39:49.506 --> 00:39:50.276 A:middle
generate a thumbnail.

00:39:50.906 --> 00:39:54.066 A:middle
After opening the file it then

00:39:54.186 --> 00:39:56.036 A:middle
creates a particleViewController

00:39:56.626 --> 00:39:57.576 A:middle
that will be used to render the

00:39:57.576 --> 00:39:57.966 A:middle
particles file.

00:39:59.506 --> 00:40:01.136 A:middle
Then it takes a snapshot of the

00:39:59.506 --> 00:40:01.136 A:middle
Then it takes a snapshot of the

00:40:01.136 --> 00:40:02.666 A:middle
particleViewController and uses

00:40:02.666 --> 00:40:05.466 A:middle
it to draw the thumbnail.

00:40:05.506 --> 00:40:06.766 A:middle
We close the document before

00:40:06.766 --> 00:40:08.196 A:middle
returning true to indicate that

00:40:08.196 --> 00:40:09.516 A:middle
we successfully have generated a

00:40:09.516 --> 00:40:09.886 A:middle
thumbnail.

00:40:11.766 --> 00:40:13.116 A:middle
Now that we have [inaudible] to

00:40:13.116 --> 00:40:15.736 A:middle
generate thumbnails we need to

00:40:15.736 --> 00:40:16.736 A:middle
create our [inaudible] reply.

00:40:17.296 --> 00:40:20.476 A:middle
We created out of the context

00:40:20.476 --> 00:40:23.076 A:middle
size, which in this case is the

00:40:23.076 --> 00:40:25.076 A:middle
maximum size and the drawing

00:40:25.076 --> 00:40:25.486 A:middle
block.

00:40:27.516 --> 00:40:29.886 A:middle
Also we have our reply object we

00:40:29.886 --> 00:40:32.346 A:middle
provided through the completion

00:40:32.346 --> 00:40:33.356 A:middle
handler [inaudible] parameter,

00:40:33.936 --> 00:40:35.806 A:middle
which in this case is new since

00:40:35.806 --> 00:40:36.946 A:middle
we always add them to draw

00:40:36.946 --> 00:40:38.566 A:middle
thumbnails for particles

00:40:39.676 --> 00:40:40.956 A:middle
documents.

00:40:40.956 --> 00:40:41.926 A:middle
If [inaudible] while drawing it

00:40:42.386 --> 00:40:43.486 A:middle
the thumbnail block success

00:40:43.486 --> 00:40:45.486 A:middle
value will indicate it, so the

00:40:45.486 --> 00:40:46.866 A:middle
thumbnail can be discounted

00:40:47.596 --> 00:40:47.736 A:middle
later.

00:40:48.266 --> 00:40:49.796 A:middle
We are finally all set, let's

00:40:49.796 --> 00:40:50.916 A:middle
run this code and see how this

00:40:50.916 --> 00:40:51.326 A:middle
looks like.

00:40:52.406 --> 00:40:54.726 A:middle
Wow. We now see a beautiful

00:40:54.726 --> 00:40:56.616 A:middle
thumbnail for our fire particles

00:40:56.616 --> 00:40:56.926 A:middle
file.

00:40:57.446 --> 00:40:59.026 A:middle
This looks so much better than

00:40:59.026 --> 00:40:59.386 A:middle
before.

00:41:00.426 --> 00:41:02.676 A:middle
Now let's check our preview

00:41:02.676 --> 00:41:03.296 A:middle
extension.

00:41:04.966 --> 00:41:05.376 A:middle
Okay.

00:41:05.376 --> 00:41:07.076 A:middle
So we are in Note and Quick Look

00:41:07.076 --> 00:41:08.126 A:middle
is still showing the blank

00:41:08.126 --> 00:41:09.726 A:middle
screen from the previous time we

00:41:09.726 --> 00:41:11.006 A:middle
tried to previewing your file.

00:41:11.676 --> 00:41:13.016 A:middle
Let's dismiss Quick Look and

00:41:13.016 --> 00:41:13.706 A:middle
present it again.

00:41:16.186 --> 00:41:18.556 A:middle
We now see our great particles

00:41:18.556 --> 00:41:20.796 A:middle
preview, note how easy it was to

00:41:20.796 --> 00:41:23.526 A:middle
make our custom file format

00:41:24.816 --> 00:41:25.186 A:middle
[inaudible] in iOS.

00:41:25.186 --> 00:41:26.556 A:middle
And that's it for the demo.

00:41:27.086 --> 00:41:29.116 A:middle
So what have we learned today?

00:41:29.806 --> 00:41:32.176 A:middle
First, we have shown you how

00:41:32.326 --> 00:41:33.956 A:middle
easy it is to add powerful

00:41:33.956 --> 00:41:35.696 A:middle
previewing capabilities to your

00:41:35.696 --> 00:41:37.306 A:middle
application by using the

00:41:37.306 --> 00:41:38.956 A:middle
QLPreviewController of Quick

00:41:38.956 --> 00:41:39.276 A:middle
Look.

00:41:40.276 --> 00:41:42.926 A:middle
Then we have taken a look at

00:41:42.926 --> 00:41:44.316 A:middle
Quick Look's extension points.

00:41:45.196 --> 00:41:47.236 A:middle
Preview extension allows you to

00:41:47.236 --> 00:41:48.876 A:middle
have your custom files preview

00:41:48.876 --> 00:41:50.306 A:middle
by Quick Look just like any

00:41:50.306 --> 00:41:51.386 A:middle
native file type.

00:41:52.396 --> 00:41:54.326 A:middle
While the thumbnail extension is

00:41:54.326 --> 00:41:56.136 A:middle
used to provide thumbnails of

00:41:56.176 --> 00:41:57.976 A:middle
your own file types to iOS when

00:41:57.976 --> 00:41:58.276 A:middle
needed.

00:41:59.086 --> 00:42:01.526 A:middle
Together these extensions make

00:41:59.086 --> 00:42:01.526 A:middle
Together these extensions make

00:42:01.526 --> 00:42:02.826 A:middle
your file formats first-class

00:42:02.826 --> 00:42:06.216 A:middle
citizens in iOS.

00:42:06.356 --> 00:42:08.036 A:middle
And that's it for this Quick

00:42:08.036 --> 00:42:08.576 A:middle
Look session.

00:42:09.186 --> 00:42:10.286 A:middle
If you would like to have more

00:42:10.286 --> 00:42:12.346 A:middle
information you can check out

00:42:12.346 --> 00:42:13.246 A:middle
Apple's website.

00:42:13.646 --> 00:42:14.976 A:middle
Thank you for your attention.

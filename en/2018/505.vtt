WEBVTT

00:00:07.516 --> 00:00:15.500 A:middle
[ Music ]

00:00:20.516 --> 00:00:22.616 A:middle
[ Applause ]

00:00:23.116 --> 00:00:23.466 A:middle
&gt;&gt; Morning.

00:00:25.466 --> 00:00:25.906 A:middle
Good morning.

00:00:26.696 --> 00:00:27.786 A:middle
My name's Eric Hanson.

00:00:27.836 --> 00:00:29.476 A:middle
I'm the Technology Evangelist

00:00:29.476 --> 00:00:30.736 A:middle
for the Photos platform.

00:00:31.026 --> 00:00:32.415 A:middle
And, I'm joined by three of my

00:00:32.415 --> 00:00:33.626 A:middle
colleagues from the Photos

00:00:33.626 --> 00:00:35.476 A:middle
engineering team today to talk

00:00:35.476 --> 00:00:37.506 A:middle
to you about integrating your

00:00:37.506 --> 00:00:38.806 A:middle
application with Photos on

00:00:38.806 --> 00:00:39.566 A:middle
macOS.

00:00:42.176 --> 00:00:43.586 A:middle
We have two key things that

00:00:43.586 --> 00:00:44.486 A:middle
we're going to talk about.

00:00:46.196 --> 00:00:48.146 A:middle
The first is a full update on

00:00:48.146 --> 00:00:49.736 A:middle
the Photos Project Extension API

00:00:49.736 --> 00:00:51.366 A:middle
that we introduced last year in

00:00:51.366 --> 00:00:52.606 A:middle
macOS High Sierra.

00:00:53.126 --> 00:00:54.906 A:middle
And then, we're going to get

00:00:54.906 --> 00:00:57.636 A:middle
into interacting with your

00:00:57.636 --> 00:01:00.166 A:middle
application via drag and drop.

00:00:57.636 --> 00:01:00.166 A:middle
application via drag and drop.

00:01:01.066 --> 00:01:02.556 A:middle
But first, let's talk about

00:01:02.556 --> 00:01:03.816 A:middle
Photo Project Extensions.

00:01:07.686 --> 00:01:09.946 A:middle
When iPhoto was first launched

00:01:09.946 --> 00:01:14.036 A:middle
in 2002, Apple became one of the

00:01:14.166 --> 00:01:16.406 A:middle
first companies to allow people

00:01:16.406 --> 00:01:20.516 A:middle
to create beautiful books, and

00:01:20.516 --> 00:01:22.106 A:middle
later cards and calendars.

00:01:24.476 --> 00:01:28.776 A:middle
To date over 70 million photo

00:01:28.776 --> 00:01:30.316 A:middle
books, cards, and calendars have

00:01:30.316 --> 00:01:32.716 A:middle
been created using iPhoto and

00:01:32.716 --> 00:01:33.196 A:middle
Photos.

00:01:37.116 --> 00:01:38.476 A:middle
But, in that same amount of

00:01:38.476 --> 00:01:41.146 A:middle
time, 16 years, we've seen this

00:01:41.146 --> 00:01:43.266 A:middle
blossoming market.

00:01:44.056 --> 00:01:45.906 A:middle
There is a tremendous breadth

00:01:45.906 --> 00:01:48.596 A:middle
now of choice for users to

00:01:48.596 --> 00:01:50.186 A:middle
create all sorts of things with

00:01:50.186 --> 00:01:52.036 A:middle
their photos, both physical and

00:01:52.036 --> 00:01:52.466 A:middle
digital.

00:01:53.006 --> 00:01:56.076 A:middle
And, it's the observance of this

00:01:56.456 --> 00:01:59.506 A:middle
amazing ecosystem that led us to

00:01:59.506 --> 00:02:00.866 A:middle
the introduction of the Photo

00:01:59.506 --> 00:02:00.866 A:middle
the introduction of the Photo

00:02:00.866 --> 00:02:03.006 A:middle
Project Extension API last year,

00:02:03.806 --> 00:02:05.536 A:middle
to build on that ecosystem.

00:02:06.046 --> 00:02:09.606 A:middle
We've seen some great extensions

00:02:09.606 --> 00:02:10.056 A:middle
already.

00:02:11.166 --> 00:02:13.686 A:middle
For example, Mimeo Photos.

00:02:14.316 --> 00:02:15.886 A:middle
It lets you create these books,

00:02:15.886 --> 00:02:17.386 A:middle
and cards, and calendars of

00:02:17.386 --> 00:02:18.796 A:middle
exceptional quality.

00:02:20.396 --> 00:02:22.036 A:middle
There's Whitewall, that lets you

00:02:22.036 --> 00:02:23.886 A:middle
create gallery-quality framed

00:02:23.886 --> 00:02:25.246 A:middle
prints from your photos.

00:02:25.756 --> 00:02:28.096 A:middle
And, we have digital services

00:02:28.096 --> 00:02:30.466 A:middle
like Wix.com, that make it very

00:02:30.466 --> 00:02:32.216 A:middle
easy for you to create web photo

00:02:32.216 --> 00:02:33.266 A:middle
albums to share with your

00:02:33.266 --> 00:02:34.236 A:middle
friends and family.

00:02:34.776 --> 00:02:37.696 A:middle
And, we're now seeing some new

00:02:37.696 --> 00:02:39.046 A:middle
extensions on the horizon.

00:02:39.886 --> 00:02:42.066 A:middle
Like this one, called Motif.

00:02:42.236 --> 00:02:44.886 A:middle
It is a brand-new fully native

00:02:45.516 --> 00:02:47.246 A:middle
experience, integrated directly

00:02:47.246 --> 00:02:49.606 A:middle
into Photos, coming to you this

00:02:49.606 --> 00:02:49.926 A:middle
summer.

00:02:54.076 --> 00:02:56.386 A:middle
All of this choice, this whole

00:02:56.386 --> 00:02:58.866 A:middle
ecosystem is a tremendous

00:02:58.866 --> 00:03:00.716 A:middle
opportunity to you, as a

00:02:58.866 --> 00:03:00.716 A:middle
opportunity to you, as a

00:03:00.716 --> 00:03:01.376 A:middle
developer.

00:03:02.786 --> 00:03:04.476 A:middle
You can take the very rich

00:03:04.476 --> 00:03:06.846 A:middle
metadata and the context and the

00:03:06.846 --> 00:03:08.526 A:middle
image curation that we pass to

00:03:08.526 --> 00:03:10.586 A:middle
your extension, and you can

00:03:10.586 --> 00:03:12.316 A:middle
build on that, using the full

00:03:12.316 --> 00:03:14.106 A:middle
stack of native frameworks on

00:03:14.106 --> 00:03:16.316 A:middle
macOS, to create something

00:03:16.316 --> 00:03:18.626 A:middle
really extraordinary, and new,

00:03:19.136 --> 00:03:20.796 A:middle
that delights users around the

00:03:20.796 --> 00:03:20.976 A:middle
world.

00:03:25.046 --> 00:03:26.806 A:middle
And, it's for this reason that

00:03:27.576 --> 00:03:30.026 A:middle
Apple is announcing we will be

00:03:30.026 --> 00:03:31.716 A:middle
transitioning our entire print

00:03:31.716 --> 00:03:32.976 A:middle
product business to this

00:03:32.976 --> 00:03:35.626 A:middle
ecosystem in macOS Mojave.

00:03:37.356 --> 00:03:39.586 A:middle
Project Extensions will be the

00:03:39.586 --> 00:03:41.696 A:middle
way users will create books,

00:03:41.696 --> 00:03:43.686 A:middle
cards, calendars, all sorts of

00:03:43.686 --> 00:03:44.246 A:middle
things.

00:03:44.736 --> 00:03:46.406 A:middle
Whatever you surprise us with

00:03:46.466 --> 00:03:47.686 A:middle
with your extensions.

00:03:48.196 --> 00:03:51.666 A:middle
And, by doing this, we're

00:03:51.666 --> 00:03:53.306 A:middle
building a better Photos

00:03:53.306 --> 00:03:54.616 A:middle
experience for everyone.

00:03:55.936 --> 00:03:57.686 A:middle
So, let's talk about what's new

00:03:57.686 --> 00:03:59.646 A:middle
in the Extensions API.

00:04:00.726 --> 00:04:03.566 A:middle
First, with the UI.

00:04:03.566 --> 00:04:06.736 A:middle
We now take the UI of your

00:04:06.736 --> 00:04:08.116 A:middle
extension, and integrate it

00:04:08.116 --> 00:04:09.856 A:middle
directly into the Photos app.

00:04:11.126 --> 00:04:12.706 A:middle
So, the sidebar that you're

00:04:12.706 --> 00:04:14.056 A:middle
familiar with is always

00:04:14.056 --> 00:04:14.676 A:middle
available.

00:04:15.726 --> 00:04:17.116 A:middle
Right? A user can be creating a

00:04:17.116 --> 00:04:18.206 A:middle
project in one of your

00:04:18.206 --> 00:04:20.666 A:middle
extensions, and can grab content

00:04:20.666 --> 00:04:22.055 A:middle
from the sidebar, and just drag

00:04:22.055 --> 00:04:23.066 A:middle
and drop it right onto your

00:04:23.066 --> 00:04:23.626 A:middle
project.

00:04:24.056 --> 00:04:26.256 A:middle
Or, they could pop up to the

00:04:26.256 --> 00:04:29.136 A:middle
photo search, search for a photo

00:04:29.136 --> 00:04:31.726 A:middle
they want to use, copy it, and

00:04:31.726 --> 00:04:32.926 A:middle
paste it into the project that

00:04:32.926 --> 00:04:34.196 A:middle
they're working on.

00:04:35.736 --> 00:04:38.026 A:middle
We're also allowing you to

00:04:38.026 --> 00:04:39.406 A:middle
integrate directly with the

00:04:39.456 --> 00:04:41.696 A:middle
powerful editing tools of

00:04:41.696 --> 00:04:42.326 A:middle
Photos.

00:04:44.376 --> 00:04:46.646 A:middle
For example, you may want to

00:04:46.646 --> 00:04:49.026 A:middle
allow a user to simply

00:04:49.026 --> 00:04:51.916 A:middle
double-click on a photo to edit

00:04:51.916 --> 00:04:52.086 A:middle
it.

00:04:52.516 --> 00:04:53.926 A:middle
And, you can do that now, with a

00:04:53.926 --> 00:04:55.776 A:middle
single line of API.

00:04:55.976 --> 00:04:58.266 A:middle
You can invoke the actual full

00:04:58.266 --> 00:04:59.426 A:middle
editor of Photos.

00:04:59.716 --> 00:05:01.076 A:middle
We pushed the edit session to

00:04:59.716 --> 00:05:01.076 A:middle
We pushed the edit session to

00:05:01.076 --> 00:05:02.996 A:middle
the top of the view stack, with

00:05:03.046 --> 00:05:04.056 A:middle
that photo loaded.

00:05:04.506 --> 00:05:05.436 A:middle
Let the user make any

00:05:05.436 --> 00:05:06.726 A:middle
adjustments they want to make.

00:05:07.506 --> 00:05:08.876 A:middle
And, we also give them access to

00:05:08.876 --> 00:05:10.456 A:middle
all of the other assets that are

00:05:10.456 --> 00:05:11.616 A:middle
used in that project.

00:05:12.636 --> 00:05:13.476 A:middle
When they're done with their

00:05:13.476 --> 00:05:15.246 A:middle
editing session, they simply hit

00:05:15.246 --> 00:05:17.116 A:middle
the Done button, and they're

00:05:17.116 --> 00:05:18.876 A:middle
returned to the project that

00:05:18.876 --> 00:05:19.526 A:middle
they're working on.

00:05:20.386 --> 00:05:22.906 A:middle
You get a notification that the

00:05:22.906 --> 00:05:23.856 A:middle
library changed.

00:05:23.856 --> 00:05:25.126 A:middle
You can respond to that, and

00:05:25.126 --> 00:05:26.506 A:middle
update your UI accordingly.

00:05:29.256 --> 00:05:30.726 A:middle
But, none of this would matter

00:05:32.136 --> 00:05:34.196 A:middle
if it was hard to find the apps

00:05:34.196 --> 00:05:35.136 A:middle
and the extensions that you

00:05:35.136 --> 00:05:35.626 A:middle
create.

00:05:36.396 --> 00:05:37.596 A:middle
And so, we're stepping up the

00:05:37.596 --> 00:05:40.036 A:middle
game in the discoverability of

00:05:40.036 --> 00:05:41.206 A:middle
your applications.

00:05:42.296 --> 00:05:44.056 A:middle
The Photos app links to the Mac

00:05:44.056 --> 00:05:45.596 A:middle
App Store in the Create menu.

00:05:46.856 --> 00:05:48.836 A:middle
And now, with the brand-new Mac

00:05:48.836 --> 00:05:51.546 A:middle
App Store, on macOS Mojave, we

00:05:51.546 --> 00:05:53.726 A:middle
actually can link directly to a

00:05:53.726 --> 00:05:56.066 A:middle
fully curated story that's

00:05:56.066 --> 00:05:57.876 A:middle
targeted specifically at the

00:05:57.876 --> 00:05:59.306 A:middle
extension experience.

00:06:00.136 --> 00:06:01.556 A:middle
And, this is an evergreen story

00:06:01.556 --> 00:06:02.366 A:middle
that will live on.

00:06:02.366 --> 00:06:03.296 A:middle
It's something that we can

00:06:03.296 --> 00:06:05.716 A:middle
update, and feature new

00:06:05.716 --> 00:06:07.396 A:middle
experiences, and educate users

00:06:07.396 --> 00:06:08.826 A:middle
on new ways to do things with

00:06:08.886 --> 00:06:09.556 A:middle
their photos.

00:06:10.066 --> 00:06:12.766 A:middle
And, when a user downloads an

00:06:13.506 --> 00:06:16.936 A:middle
app from this story, they're

00:06:16.936 --> 00:06:18.386 A:middle
downloading an app that contains

00:06:18.386 --> 00:06:19.116 A:middle
an extension.

00:06:20.176 --> 00:06:22.086 A:middle
And, historically, that may have

00:06:22.086 --> 00:06:24.696 A:middle
led you, as a developer, to put

00:06:24.696 --> 00:06:25.766 A:middle
some time into, kind of,

00:06:25.766 --> 00:06:27.096 A:middle
educating users in your

00:06:27.096 --> 00:06:28.606 A:middle
standalone app on how to use the

00:06:28.606 --> 00:06:29.776 A:middle
extension in Photos.

00:06:30.156 --> 00:06:30.996 A:middle
But, we think we can do

00:06:30.996 --> 00:06:31.766 A:middle
something better.

00:06:32.366 --> 00:06:34.106 A:middle
Wouldn't it be great if the user

00:06:34.106 --> 00:06:35.256 A:middle
could download an app and

00:06:35.256 --> 00:06:36.466 A:middle
immediately launch into the

00:06:36.466 --> 00:06:37.766 A:middle
project creation experience in

00:06:37.766 --> 00:06:38.306 A:middle
Photos?

00:06:39.336 --> 00:06:40.546 A:middle
We're making that possible.

00:06:41.926 --> 00:06:43.696 A:middle
We've added a custom URL scheme

00:06:43.696 --> 00:06:45.866 A:middle
to Photos, where you can simply

00:06:46.296 --> 00:06:47.596 A:middle
pass in your extension

00:06:47.596 --> 00:06:49.926 A:middle
identifier, and optionally pass

00:06:49.926 --> 00:06:51.456 A:middle
in a category.

00:06:52.566 --> 00:06:53.986 A:middle
And, Photos will be brought to

00:06:53.986 --> 00:06:55.556 A:middle
the back-- brought to the

00:06:55.556 --> 00:06:58.956 A:middle
foreground, with the options of

00:06:58.956 --> 00:07:00.336 A:middle
your extension displayed for the

00:06:58.956 --> 00:07:00.336 A:middle
your extension displayed for the

00:07:00.336 --> 00:07:00.726 A:middle
user.

00:07:02.026 --> 00:07:03.576 A:middle
So, they're immediately taken

00:07:03.576 --> 00:07:05.376 A:middle
into the creation experience as

00:07:05.376 --> 00:07:06.646 A:middle
a first-launch experience.

00:07:06.646 --> 00:07:07.716 A:middle
And, we think this is great.

00:07:11.526 --> 00:07:13.516 A:middle
And, finally, when they create a

00:07:13.516 --> 00:07:16.216 A:middle
project, we want those projects

00:07:16.216 --> 00:07:19.126 A:middle
to live where they belong, right

00:07:19.126 --> 00:07:20.846 A:middle
inside the user's Photo library.

00:07:22.136 --> 00:07:23.426 A:middle
And so, that's exactly what we

00:07:23.426 --> 00:07:23.676 A:middle
do.

00:07:23.676 --> 00:07:25.296 A:middle
We have this Project Gallery in

00:07:25.296 --> 00:07:27.406 A:middle
Photos that lets a user see all

00:07:27.406 --> 00:07:28.606 A:middle
the things that they've created.

00:07:28.696 --> 00:07:30.676 A:middle
And we now let the extension

00:07:30.956 --> 00:07:32.876 A:middle
create a custom preview for each

00:07:32.876 --> 00:07:33.496 A:middle
project.

00:07:34.086 --> 00:07:35.636 A:middle
So, that preview can represent

00:07:35.636 --> 00:07:37.436 A:middle
what the project really is.

00:07:37.876 --> 00:07:39.716 A:middle
Take this photo mug for example.

00:07:40.246 --> 00:07:43.586 A:middle
Not only can a user double-click

00:07:43.586 --> 00:07:44.866 A:middle
on one of those projects to get

00:07:44.866 --> 00:07:46.136 A:middle
back into your extension, to

00:07:46.136 --> 00:07:48.206 A:middle
continue to work on it, they can

00:07:48.206 --> 00:07:49.466 A:middle
create projects from other

00:07:49.466 --> 00:07:50.206 A:middle
projects.

00:07:50.706 --> 00:07:51.976 A:middle
They can simply select a

00:07:51.976 --> 00:07:53.546 A:middle
project, go to the Create menu,

00:07:53.636 --> 00:07:54.896 A:middle
create something new from it.

00:07:55.336 --> 00:07:56.756 A:middle
And, we pass over everything we

00:07:56.756 --> 00:08:00.216 A:middle
can to help your extension, kind

00:07:56.756 --> 00:08:00.216 A:middle
can to help your extension, kind

00:08:00.216 --> 00:08:01.416 A:middle
of, start with some great

00:08:01.416 --> 00:08:02.166 A:middle
context.

00:08:03.046 --> 00:08:04.256 A:middle
But, in the case of the Apple

00:08:04.256 --> 00:08:06.316 A:middle
projects, we can do a lot more.

00:08:06.466 --> 00:08:07.336 A:middle
And so, we do.

00:08:08.596 --> 00:08:11.226 A:middle
We send you photo-by-photo,

00:08:11.306 --> 00:08:13.726 A:middle
page-by-page exactly how that

00:08:13.726 --> 00:08:14.526 A:middle
was laid out.

00:08:15.016 --> 00:08:16.526 A:middle
So that your extension can

00:08:16.526 --> 00:08:18.236 A:middle
create a complete conversion

00:08:18.236 --> 00:08:19.416 A:middle
experience from the Apple

00:08:19.416 --> 00:08:20.066 A:middle
projects.

00:08:20.606 --> 00:08:21.936 A:middle
And, we highly encourage you to

00:08:21.936 --> 00:08:22.396 A:middle
do this.

00:08:22.946 --> 00:08:26.196 A:middle
So, that's just a very

00:08:26.196 --> 00:08:27.776 A:middle
high-level, from a UI

00:08:27.776 --> 00:08:28.906 A:middle
perspective, of some of what's

00:08:28.906 --> 00:08:29.236 A:middle
new.

00:08:29.526 --> 00:08:30.526 A:middle
But, we'd like to take you a

00:08:30.526 --> 00:08:31.166 A:middle
little deeper.

00:08:31.166 --> 00:08:32.176 A:middle
And, to do that, I'd like to

00:08:32.176 --> 00:08:33.586 A:middle
invite to the stage, my

00:08:33.586 --> 00:08:34.446 A:middle
colleague from Photos

00:08:34.446 --> 00:08:35.566 A:middle
engineering, Tobias Conradi.

00:08:35.566 --> 00:08:35.976 A:middle
Tobias.

00:08:36.515 --> 00:08:41.635 A:middle
[ Applause ]

00:08:42.135 --> 00:08:42.736 A:middle
&gt;&gt; Good morning.

00:08:43.145 --> 00:08:43.756 A:middle
Thank you, Eric.

00:08:44.275 --> 00:08:45.376 A:middle
Hello, my name is Tobias

00:08:45.376 --> 00:08:45.986 A:middle
Conradi.

00:08:46.116 --> 00:08:47.256 A:middle
I'm an engineer on the Photos

00:08:47.256 --> 00:08:49.086 A:middle
team, and I will go into detail

00:08:49.086 --> 00:08:50.446 A:middle
for some of the changes we did

00:08:50.446 --> 00:08:51.376 A:middle
around Photos Project

00:08:51.376 --> 00:08:51.966 A:middle
Extensions.

00:08:52.336 --> 00:08:54.516 A:middle
First up, the Create menu.

00:08:55.086 --> 00:08:56.696 A:middle
When we first introduced Photos

00:08:56.696 --> 00:08:58.696 A:middle
Project Extensions in macOS High

00:08:58.696 --> 00:09:00.786 A:middle
Sierra, we put all extensions as

00:08:58.696 --> 00:09:00.786 A:middle
Sierra, we put all extensions as

00:09:00.786 --> 00:09:02.426 A:middle
a flat list into the Create

00:09:02.426 --> 00:09:02.726 A:middle
menu.

00:09:03.226 --> 00:09:04.906 A:middle
But, as it turns out, in some

00:09:04.906 --> 00:09:06.526 A:middle
cases, it's kind of hard to

00:09:06.526 --> 00:09:08.066 A:middle
guess, just from the name of the

00:09:08.066 --> 00:09:09.816 A:middle
extension what kind of projects

00:09:09.816 --> 00:09:10.686 A:middle
you can create with that.

00:09:11.486 --> 00:09:12.706 A:middle
We want to improve the user

00:09:12.706 --> 00:09:14.086 A:middle
experience, so we are

00:09:14.086 --> 00:09:16.116 A:middle
introducing project categories.

00:09:16.566 --> 00:09:18.376 A:middle
The new Create menu in macOS

00:09:18.376 --> 00:09:19.936 A:middle
Mojave looks something like

00:09:19.936 --> 00:09:20.236 A:middle
this.

00:09:20.626 --> 00:09:23.606 A:middle
We have categories, submenus in

00:09:23.646 --> 00:09:24.466 A:middle
the Create menu.

00:09:25.086 --> 00:09:26.216 A:middle
And, the categories we're

00:09:26.216 --> 00:09:28.056 A:middle
introducing this year are Books,

00:09:28.296 --> 00:09:30.566 A:middle
Calendars, Cards, Wall Decor,

00:09:30.886 --> 00:09:33.326 A:middle
Prints, Slideshows, and for any

00:09:33.326 --> 00:09:34.536 A:middle
extension that doesn't fit into

00:09:34.536 --> 00:09:36.086 A:middle
these categories, Other.

00:09:37.526 --> 00:09:38.916 A:middle
Now the user can go into the

00:09:38.916 --> 00:09:40.086 A:middle
menu with a very specific

00:09:40.086 --> 00:09:40.476 A:middle
intent.

00:09:40.476 --> 00:09:42.376 A:middle
For example, I want to create

00:09:42.376 --> 00:09:45.536 A:middle
wall decorations, and these

00:09:45.666 --> 00:09:46.976 A:middle
[inaudible] all extensions that

00:09:46.976 --> 00:09:48.276 A:middle
support projects in that

00:09:48.276 --> 00:09:48.776 A:middle
category.

00:09:49.686 --> 00:09:51.156 A:middle
How does the extension show up

00:09:51.156 --> 00:09:51.836 A:middle
in the category?

00:09:52.736 --> 00:09:54.146 A:middle
We have a new key in the

00:09:54.146 --> 00:09:56.696 A:middle
extensions attribute dictionary

00:09:56.696 --> 00:09:57.856 A:middle
in the extensions info.plist.

00:09:58.206 --> 00:09:59.736 A:middle
It's called PHProjectCategory.

00:10:00.126 --> 00:10:02.216 A:middle
And, the value for the key, is a

00:10:02.216 --> 00:10:04.436 A:middle
list of the supported project

00:10:04.436 --> 00:10:05.006 A:middle
categories.

00:10:05.216 --> 00:10:06.636 A:middle
In this case, it's Wall Decor

00:10:06.896 --> 00:10:07.426 A:middle
and Other.

00:10:09.296 --> 00:10:11.756 A:middle
The next thing the user sees

00:10:11.756 --> 00:10:13.866 A:middle
from the extension, is the

00:10:13.866 --> 00:10:14.176 A:middle
[inaudible] sheet.

00:10:14.766 --> 00:10:16.186 A:middle
You provide us with the data,

00:10:16.726 --> 00:10:21.446 A:middle
and we display the project type

00:10:21.446 --> 00:10:22.606 A:middle
descriptions you provide.

00:10:23.386 --> 00:10:25.446 A:middle
The problem with the API we

00:10:25.446 --> 00:10:27.096 A:middle
introduced last year is that

00:10:27.286 --> 00:10:30.056 A:middle
it's kind of hard to provide

00:10:30.056 --> 00:10:31.356 A:middle
up-to-date price information or

00:10:31.356 --> 00:10:32.106 A:middle
current offers.

00:10:32.606 --> 00:10:34.756 A:middle
That's why we're introducing a

00:10:34.756 --> 00:10:37.156 A:middle
new, improved API to allow for

00:10:37.156 --> 00:10:38.446 A:middle
dynamic updates, which would

00:10:38.446 --> 00:10:39.196 A:middle
look like this.

00:10:39.676 --> 00:10:41.946 A:middle
In addition to dynamic updates,

00:10:42.176 --> 00:10:44.766 A:middle
we now also support display of a

00:10:44.766 --> 00:10:46.966 A:middle
custom footer text at the bottom

00:10:46.966 --> 00:10:48.496 A:middle
of the sheet, which you can use

00:10:48.496 --> 00:10:49.966 A:middle
to display legal text if you

00:10:49.966 --> 00:10:52.716 A:middle
have the requirement to do so.

00:10:53.866 --> 00:10:57.476 A:middle
On an API level, the new dynamic

00:10:57.476 --> 00:10:58.676 A:middle
API looks like this.

00:10:59.166 --> 00:11:00.786 A:middle
We have the new method on the

00:10:59.166 --> 00:11:00.786 A:middle
We have the new method on the

00:11:00.786 --> 00:11:02.456 A:middle
projectExtensionsController

00:11:02.456 --> 00:11:05.646 A:middle
protocol, and we ask for a data

00:11:05.646 --> 00:11:06.726 A:middle
source, instead of a list of

00:11:06.726 --> 00:11:07.676 A:middle
product type descriptions.

00:11:08.006 --> 00:11:10.266 A:middle
And, pass in the category from

00:11:10.266 --> 00:11:11.246 A:middle
the menu in which the

00:11:11.246 --> 00:11:12.816 A:middle
selection-- the extension was

00:11:12.816 --> 00:11:13.216 A:middle
selected.

00:11:13.476 --> 00:11:14.936 A:middle
And also, an invalidator object.

00:11:15.816 --> 00:11:17.416 A:middle
Once you return the data source,

00:11:17.986 --> 00:11:19.776 A:middle
we ask the data source for the

00:11:19.776 --> 00:11:21.366 A:middle
project type descriptions, and

00:11:21.366 --> 00:11:22.586 A:middle
for the optional footer text.

00:11:23.386 --> 00:11:24.726 A:middle
Whenever your extension has the

00:11:24.726 --> 00:11:26.236 A:middle
need to invalidate the

00:11:26.236 --> 00:11:27.946 A:middle
information returned, you can

00:11:27.946 --> 00:11:29.506 A:middle
use invalidator to invalidate

00:11:29.506 --> 00:11:30.566 A:middle
the project type descriptions,

00:11:30.786 --> 00:11:32.586 A:middle
or the footer text, and when

00:11:32.586 --> 00:11:34.536 A:middle
necessary, photos will refetch

00:11:34.786 --> 00:11:36.036 A:middle
the data from the data source,

00:11:36.306 --> 00:11:37.706 A:middle
and display the up-to-date data

00:11:37.706 --> 00:11:37.976 A:middle
in the UI.

00:11:42.326 --> 00:11:43.616 A:middle
The next topic is the

00:11:43.616 --> 00:11:44.376 A:middle
projectInfo.

00:11:45.246 --> 00:11:47.516 A:middle
The projectInfo is structured,

00:11:47.516 --> 00:11:48.906 A:middle
additional information about the

00:11:48.906 --> 00:11:50.146 A:middle
contents of the project.

00:11:50.796 --> 00:11:52.546 A:middle
And, it's structured into

00:11:52.546 --> 00:11:54.646 A:middle
sections, and sectionContents

00:11:54.646 --> 00:11:56.646 A:middle
which reflect creation level.

00:11:57.676 --> 00:11:59.686 A:middle
And, the elements have basic

00:11:59.836 --> 00:12:03.416 A:middle
layout hints, and also weights

00:11:59.836 --> 00:12:03.416 A:middle
layout hints, and also weights

00:12:03.416 --> 00:12:05.046 A:middle
and scores for the assets.

00:12:05.366 --> 00:12:06.706 A:middle
And, assets can contain

00:12:07.176 --> 00:12:09.776 A:middle
important regions in the asset's

00:12:09.776 --> 00:12:10.786 A:middle
regions of interest.

00:12:10.936 --> 00:12:13.096 A:middle
This is just a quick reminder

00:12:13.096 --> 00:12:14.306 A:middle
what the projectInfo looks like.

00:12:14.596 --> 00:12:15.676 A:middle
If you want to know more about

00:12:15.676 --> 00:12:16.976 A:middle
the projectInfo, I highly

00:12:16.976 --> 00:12:18.376 A:middle
recommend last year's session,

00:12:18.646 --> 00:12:19.976 A:middle
What's New in Photos API.

00:12:24.556 --> 00:12:26.556 A:middle
The projectInfo is handed to

00:12:26.556 --> 00:12:29.056 A:middle
your extension during begin

00:12:29.056 --> 00:12:29.506 A:middle
project.

00:12:30.496 --> 00:12:33.976 A:middle
And, whenever the user adds new

00:12:33.976 --> 00:12:35.176 A:middle
assets to the project, the

00:12:35.176 --> 00:12:36.456 A:middle
projectInfo will be outdated,

00:12:36.456 --> 00:12:37.946 A:middle
because it's a static object.

00:12:38.756 --> 00:12:40.056 A:middle
And, we want to solve the

00:12:40.056 --> 00:12:41.446 A:middle
problem by introducing new API

00:12:41.446 --> 00:12:43.406 A:middle
on the projectExtensionsContext

00:12:43.806 --> 00:12:45.906 A:middle
to get updated project info,

00:12:46.266 --> 00:12:47.196 A:middle
with the current state of the

00:12:47.196 --> 00:12:47.726 A:middle
project.

00:12:48.216 --> 00:12:49.886 A:middle
Let's take this as an example.

00:12:49.886 --> 00:12:51.586 A:middle
We handed you this projectInfo

00:12:51.586 --> 00:12:53.296 A:middle
during project creation, and

00:12:53.296 --> 00:12:54.646 A:middle
then the user added some more

00:12:54.646 --> 00:12:55.656 A:middle
assets to the project.

00:12:55.976 --> 00:12:57.286 A:middle
You can then call the

00:12:57.286 --> 00:12:59.156 A:middle
updatedProjectInfo method, with

00:12:59.216 --> 00:13:01.226 A:middle
this projectInfo, and we will

00:12:59.216 --> 00:13:01.226 A:middle
this projectInfo, and we will

00:13:01.226 --> 00:13:02.706 A:middle
update any existing sections,

00:13:03.046 --> 00:13:04.786 A:middle
and append a new section for any

00:13:04.866 --> 00:13:05.666 A:middle
added assets.

00:13:06.106 --> 00:13:07.386 A:middle
If the user adds some more

00:13:07.386 --> 00:13:08.526 A:middle
assets, you can do the same

00:13:08.526 --> 00:13:08.956 A:middle
again.

00:13:09.326 --> 00:13:10.596 A:middle
Pass in this project info, we

00:13:10.596 --> 00:13:11.686 A:middle
will update the existing

00:13:11.686 --> 00:13:13.396 A:middle
sections, and append a new

00:13:13.396 --> 00:13:14.896 A:middle
section for any added assets.

00:13:15.406 --> 00:13:18.546 A:middle
Let's now go into a more

00:13:18.546 --> 00:13:19.516 A:middle
detailed element of the

00:13:19.516 --> 00:13:21.006 A:middle
projectInfo, the regions of

00:13:21.006 --> 00:13:21.466 A:middle
interest.

00:13:22.386 --> 00:13:23.346 A:middle
The regions of interest

00:13:23.346 --> 00:13:25.576 A:middle
highlight important regions in

00:13:25.576 --> 00:13:26.216 A:middle
the asset.

00:13:26.366 --> 00:13:27.576 A:middle
For example, the faces of

00:13:27.636 --> 00:13:27.946 A:middle
people.

00:13:28.656 --> 00:13:31.446 A:middle
And, if the same person appears

00:13:31.446 --> 00:13:33.376 A:middle
in multiple images, the region

00:13:33.376 --> 00:13:35.106 A:middle
of interest identifier will be

00:13:35.106 --> 00:13:37.166 A:middle
the same for the same person.

00:13:38.316 --> 00:13:39.576 A:middle
Let's focus on Person B for a

00:13:39.576 --> 00:13:39.936 A:middle
moment.

00:13:41.906 --> 00:13:43.606 A:middle
In addition to the region of

00:13:43.606 --> 00:13:45.376 A:middle
interest identifier, we have

00:13:45.766 --> 00:13:47.576 A:middle
weight on the regions of

00:13:47.616 --> 00:13:50.316 A:middle
interest, which represents the

00:13:50.316 --> 00:13:52.136 A:middle
importance of the region of

00:13:52.176 --> 00:13:53.986 A:middle
interest in the project.

00:13:55.066 --> 00:13:57.246 A:middle
But, if you want to decide which

00:13:57.476 --> 00:13:58.516 A:middle
image to pick as a

00:13:58.516 --> 00:14:00.376 A:middle
representative image for a

00:13:58.516 --> 00:14:00.376 A:middle
representative image for a

00:14:00.376 --> 00:14:01.426 A:middle
person, or for a region of

00:14:01.426 --> 00:14:02.576 A:middle
interest, it's kind of hard to

00:14:02.576 --> 00:14:03.256 A:middle
do with this API.

00:14:04.286 --> 00:14:05.836 A:middle
That's why we're adding a new

00:14:05.836 --> 00:14:07.896 A:middle
quality score, which represents

00:14:08.086 --> 00:14:10.006 A:middle
the quality of the region of

00:14:10.006 --> 00:14:12.146 A:middle
interest in the asset.

00:14:12.266 --> 00:14:14.026 A:middle
On the left-hand side, the

00:14:14.026 --> 00:14:16.146 A:middle
Person B is kind of out of focus

00:14:16.146 --> 00:14:17.376 A:middle
and not really central to the

00:14:17.376 --> 00:14:18.696 A:middle
image, while on the right-hand

00:14:18.696 --> 00:14:20.556 A:middle
side, he's really in focus.

00:14:20.886 --> 00:14:22.686 A:middle
That's why the quality score on

00:14:22.686 --> 00:14:23.746 A:middle
the right-hand side is higher

00:14:23.746 --> 00:14:26.536 A:middle
than on the left-hand side.

00:14:27.336 --> 00:14:28.726 A:middle
On an API level, that looks like

00:14:28.726 --> 00:14:29.026 A:middle
this.

00:14:29.026 --> 00:14:30.716 A:middle
We have this alt weight, which

00:14:30.716 --> 00:14:32.826 A:middle
is the importance of the region

00:14:32.826 --> 00:14:34.116 A:middle
of interest in the context of

00:14:34.166 --> 00:14:34.776 A:middle
the project.

00:14:35.216 --> 00:14:37.476 A:middle
And then, the quality in the

00:14:38.166 --> 00:14:38.306 A:middle
asset.

00:14:39.136 --> 00:14:41.336 A:middle
I would now like to show you a

00:14:41.336 --> 00:14:43.066 A:middle
quick demo, how you can use

00:14:43.066 --> 00:14:44.806 A:middle
regions of interest in your

00:14:44.806 --> 00:14:45.686 A:middle
extension to improve the

00:14:45.686 --> 00:14:47.656 A:middle
experience, and also listen to a

00:14:47.656 --> 00:14:48.786 A:middle
library notification to get

00:14:48.786 --> 00:14:50.696 A:middle
notified whenever the assets or

00:14:50.696 --> 00:14:51.576 A:middle
the project changes.

00:14:52.156 --> 00:14:54.656 A:middle
And, use a new updateProjectInfo

00:14:54.656 --> 00:14:54.976 A:middle
API.

00:15:03.726 --> 00:15:07.916 A:middle
OK. I created a slideshow

00:15:07.916 --> 00:15:11.126 A:middle
extension, and to show you how

00:15:11.126 --> 00:15:12.786 A:middle
it looks like, I selected some

00:15:12.786 --> 00:15:15.946 A:middle
assets in an album, and will

00:15:15.946 --> 00:15:17.706 A:middle
create a new project with the

00:15:17.706 --> 00:15:18.246 A:middle
extension.

00:15:19.466 --> 00:15:22.096 A:middle
The extension has two views, one

00:15:22.096 --> 00:15:23.586 A:middle
is the overview, which contains

00:15:23.586 --> 00:15:25.086 A:middle
all assets of the project.

00:15:25.546 --> 00:15:27.546 A:middle
And, the other is the playback

00:15:27.546 --> 00:15:28.806 A:middle
modus, which plays the

00:15:28.806 --> 00:15:29.286 A:middle
slideshow.

00:15:31.416 --> 00:15:32.706 A:middle
As you might notice, the

00:15:32.706 --> 00:15:34.296 A:middle
slideshow always zooms into the

00:15:34.296 --> 00:15:36.966 A:middle
center of the image, which is

00:15:36.996 --> 00:15:37.686 A:middle
kind of boring.

00:15:38.456 --> 00:15:39.966 A:middle
And, I want to use regions of

00:15:39.966 --> 00:15:41.406 A:middle
interest to always zoom into

00:15:41.636 --> 00:15:43.066 A:middle
interesting regions in the

00:15:43.066 --> 00:15:43.376 A:middle
photo.

00:15:44.946 --> 00:15:47.566 A:middle
So, let's switch to Xcode to fix

00:15:49.016 --> 00:15:49.276 A:middle
that.

00:15:50.256 --> 00:15:51.986 A:middle
Here in my asset model, I have

00:15:51.986 --> 00:15:53.216 A:middle
this property,

00:15:53.216 --> 00:15:54.976 A:middle
preferredZoomRect, and it always

00:15:54.976 --> 00:15:57.126 A:middle
returns the same rect, which is

00:15:57.376 --> 00:15:58.026 A:middle
kind of boring.

00:15:58.446 --> 00:15:59.926 A:middle
So, let's replace it with the

00:15:59.926 --> 00:16:00.356 A:middle
code.

00:15:59.926 --> 00:16:00.356 A:middle
code.

00:16:06.046 --> 00:16:08.136 A:middle
What I want to do is to get all

00:16:08.136 --> 00:16:09.306 A:middle
regions of interest from the

00:16:09.306 --> 00:16:11.726 A:middle
asset element, and then sort

00:16:11.766 --> 00:16:13.476 A:middle
them by their weight and

00:16:13.476 --> 00:16:14.066 A:middle
quality.

00:16:14.846 --> 00:16:17.496 A:middle
And, from the sorted list of

00:16:17.496 --> 00:16:18.506 A:middle
regions of interest, we want to

00:16:18.506 --> 00:16:20.146 A:middle
get the last element, and return

00:16:20.146 --> 00:16:20.626 A:middle
its rect.

00:16:22.166 --> 00:16:23.976 A:middle
If we now rerun the extension--

00:16:38.196 --> 00:16:40.306 A:middle
We always zoom into the most

00:16:40.306 --> 00:16:42.636 A:middle
important region of interest in

00:16:42.936 --> 00:16:43.316 A:middle
the asset.

00:16:44.066 --> 00:16:44.976 A:middle
I think that looks way better.

00:16:45.516 --> 00:16:48.546 A:middle
[ Applause ]

00:16:49.046 --> 00:16:50.316 A:middle
So, next, I want to add some

00:16:50.316 --> 00:16:51.506 A:middle
more assets to the project.

00:16:51.706 --> 00:16:53.756 A:middle
I grab an album in the sidebar

00:16:53.756 --> 00:16:55.386 A:middle
and drag it over the extension.

00:16:55.656 --> 00:16:56.696 A:middle
There's a plus next to the

00:16:56.696 --> 00:16:57.756 A:middle
cursor, so it looks like the

00:16:57.756 --> 00:16:58.786 A:middle
extension accepts the drag.

00:16:59.366 --> 00:17:01.876 A:middle
I release the mouse and nothing

00:16:59.366 --> 00:17:01.876 A:middle
I release the mouse and nothing

00:17:01.876 --> 00:17:02.296 A:middle
happens.

00:17:02.666 --> 00:17:04.126 A:middle
The assets were added to the

00:17:04.126 --> 00:17:05.986 A:middle
project, but my extension

00:17:06.215 --> 00:17:07.165 A:middle
doesn't list the change

00:17:07.165 --> 00:17:07.776 A:middle
notification.

00:17:08.096 --> 00:17:10.316 A:middle
And, doesn't know that assets

00:17:10.316 --> 00:17:11.146 A:middle
were added to the project.

00:17:12.616 --> 00:17:14.286 A:middle
So, let's switch back to Xcode

00:17:14.286 --> 00:17:15.965 A:middle
and fix that.

00:17:16.736 --> 00:17:18.396 A:middle
In my projectViewController, I

00:17:18.396 --> 00:17:20.205 A:middle
have the begin and resumeProject

00:17:20.205 --> 00:17:21.896 A:middle
method, which are a part of the

00:17:21.896 --> 00:17:24.106 A:middle
projectExtensionController

00:17:24.106 --> 00:17:24.626 A:middle
protocol.

00:17:25.116 --> 00:17:27.006 A:middle
And, here I want to register for

00:17:27.136 --> 00:17:27.965 A:middle
change observation.

00:17:28.465 --> 00:17:32.686 A:middle
And, we add the same code in

00:17:32.746 --> 00:17:33.676 A:middle
both methods.

00:17:33.676 --> 00:17:36.796 A:middle
First, we get the PhotoKit

00:17:37.156 --> 00:17:39.426 A:middle
object we're interested in.

00:17:39.916 --> 00:17:42.286 A:middle
We're interested in additions of

00:17:42.356 --> 00:17:44.326 A:middle
assets to the project, so we are

00:17:44.326 --> 00:17:45.916 A:middle
getting a fetch result for all

00:17:45.916 --> 00:17:47.956 A:middle
assets on the project, and then

00:17:48.026 --> 00:17:49.916 A:middle
we are registering asset change

00:17:49.916 --> 00:17:51.116 A:middle
observer for the library.

00:17:51.816 --> 00:17:53.596 A:middle
In finished project, we

00:17:53.836 --> 00:17:54.626 A:middle
[inaudible] registering.

00:17:55.456 --> 00:17:57.996 A:middle
And, since Xcode complains that

00:17:57.996 --> 00:17:59.546 A:middle
we don't implement the protocol,

00:17:59.696 --> 00:18:01.096 A:middle
we add that.

00:17:59.696 --> 00:18:01.096 A:middle
we add that.

00:18:01.476 --> 00:18:02.236 A:middle
Change observer.

00:18:02.236 --> 00:18:04.876 A:middle
And, down here--

00:18:09.506 --> 00:18:10.146 A:middle
We implement

00:18:10.146 --> 00:18:11.526 A:middle
photoLibraryDidChange.

00:18:12.126 --> 00:18:14.456 A:middle
PhotoLibraryDidChange is called

00:18:14.456 --> 00:18:16.396 A:middle
whenever anything changes in the

00:18:16.396 --> 00:18:19.946 A:middle
photo library, and we get a

00:18:20.026 --> 00:18:22.016 A:middle
change instance as a method

00:18:22.016 --> 00:18:22.396 A:middle
argument.

00:18:22.976 --> 00:18:25.036 A:middle
We can ask the change engine

00:18:25.066 --> 00:18:27.286 A:middle
instance for changeDetails of an

00:18:27.286 --> 00:18:28.286 A:middle
object we're interested in.

00:18:28.876 --> 00:18:30.386 A:middle
We're interested in the changes

00:18:30.386 --> 00:18:32.596 A:middle
of the fetchAllAssets on the

00:18:32.596 --> 00:18:34.106 A:middle
project, so we pass that

00:18:34.106 --> 00:18:34.866 A:middle
fetchResult in.

00:18:35.746 --> 00:18:38.186 A:middle
And, if change results are

00:18:38.186 --> 00:18:41.256 A:middle
returned, we update our locally

00:18:41.256 --> 00:18:43.786 A:middle
cached fetch result with the

00:18:43.786 --> 00:18:45.846 A:middle
fetchResultsAfterChanges, and

00:18:45.846 --> 00:18:47.616 A:middle
get the projectExtensionContext,

00:18:47.616 --> 00:18:49.436 A:middle
and call updatedProjectInfo.

00:18:50.636 --> 00:18:52.256 A:middle
And pass in the project info we

00:18:53.136 --> 00:18:53.226 A:middle
have.

00:18:53.656 --> 00:18:55.876 A:middle
Once the updatedProjectInfo is

00:18:55.876 --> 00:18:57.576 A:middle
returned to us, we call the same

00:18:57.576 --> 00:18:59.176 A:middle
setup code, but you could do

00:18:59.176 --> 00:19:00.626 A:middle
something more sophisticated in

00:18:59.176 --> 00:19:00.626 A:middle
something more sophisticated in

00:19:00.626 --> 00:19:00.876 A:middle
here.

00:19:02.326 --> 00:19:03.976 A:middle
Let's rerun the project again.

00:19:19.416 --> 00:19:23.996 A:middle
OK. I can now drag the album

00:19:23.996 --> 00:19:27.256 A:middle
from the sidebar, release it

00:19:27.746 --> 00:19:30.076 A:middle
over the extension, and the

00:19:30.076 --> 00:19:31.876 A:middle
assets are added to the project,

00:19:32.136 --> 00:19:34.536 A:middle
and the extension listens to the

00:19:34.536 --> 00:19:36.176 A:middle
photo library change

00:19:36.176 --> 00:19:37.676 A:middle
observation, gets notified of

00:19:37.706 --> 00:19:39.316 A:middle
the change, and we update our

00:19:39.316 --> 00:19:39.976 A:middle
project info.

00:19:40.516 --> 00:19:47.656 A:middle
[ Applause ]

00:19:48.156 --> 00:19:51.146 A:middle
So, as you just saw, with only a

00:19:51.146 --> 00:19:52.886 A:middle
few steps, I was able to improve

00:19:52.886 --> 00:19:55.446 A:middle
my extension by using the

00:19:55.446 --> 00:19:57.466 A:middle
projectInfo, and the regions of

00:19:57.466 --> 00:19:59.116 A:middle
interest in the projectInfo, and

00:19:59.116 --> 00:20:01.366 A:middle
also registering asset change

00:19:59.116 --> 00:20:01.366 A:middle
also registering asset change

00:20:01.366 --> 00:20:03.326 A:middle
observer to get notified

00:20:03.326 --> 00:20:04.716 A:middle
whenever anything changes in the

00:20:04.716 --> 00:20:06.536 A:middle
photo lobby, and also update my

00:20:06.536 --> 00:20:06.976 A:middle
project info.

00:20:10.486 --> 00:20:11.526 A:middle
There are two things I want to

00:20:11.526 --> 00:20:12.806 A:middle
highlight with integration.

00:20:13.376 --> 00:20:16.106 A:middle
By default, Photos handles copy

00:20:16.106 --> 00:20:17.816 A:middle
and paste of assets or albums

00:20:17.996 --> 00:20:20.356 A:middle
from Photos into the extension.

00:20:20.896 --> 00:20:22.466 A:middle
But, if your extension also

00:20:22.466 --> 00:20:23.536 A:middle
wants to implement the paste

00:20:23.536 --> 00:20:24.386 A:middle
section, which you should

00:20:24.386 --> 00:20:25.886 A:middle
probably do for text and things

00:20:25.886 --> 00:20:27.886 A:middle
like that, we need your help to

00:20:27.886 --> 00:20:29.586 A:middle
know when your extension should

00:20:29.586 --> 00:20:30.926 A:middle
handle the paste section, and

00:20:30.926 --> 00:20:32.376 A:middle
when Photos should try to handle

00:20:32.376 --> 00:20:32.976 A:middle
the paste section.

00:20:33.196 --> 00:20:34.666 A:middle
So, please implement

00:20:34.666 --> 00:20:37.396 A:middle
validateMenuItem, and if the

00:20:37.396 --> 00:20:39.226 A:middle
menu action is a paste action,

00:20:39.456 --> 00:20:41.406 A:middle
check if your extension can

00:20:41.406 --> 00:20:42.466 A:middle
handle the current pasteboard

00:20:42.466 --> 00:20:44.376 A:middle
contents, and if no, return

00:20:44.376 --> 00:20:46.206 A:middle
false, and we will try to handle

00:20:46.206 --> 00:20:47.296 A:middle
it as Photos.

00:20:47.566 --> 00:20:49.076 A:middle
And, otherwise, if you can

00:20:49.076 --> 00:20:51.146 A:middle
handle it, return true, and your

00:20:51.146 --> 00:20:52.136 A:middle
photos will get the paste

00:20:52.136 --> 00:20:52.456 A:middle
action.

00:20:53.566 --> 00:20:55.436 A:middle
Something similar applies to

00:20:55.436 --> 00:20:55.996 A:middle
drag and drop.

00:20:56.646 --> 00:20:58.836 A:middle
Photos handles any drags of

00:20:58.836 --> 00:21:01.386 A:middle
PhotoKit objects to the

00:20:58.836 --> 00:21:01.386 A:middle
PhotoKit objects to the

00:21:01.386 --> 00:21:03.396 A:middle
extension by default, but your

00:21:03.396 --> 00:21:04.626 A:middle
extension can potentially

00:21:04.626 --> 00:21:05.806 A:middle
interfere with that if you

00:21:05.806 --> 00:21:06.986 A:middle
register for the wrong types.

00:21:07.276 --> 00:21:08.876 A:middle
So, please be careful what types

00:21:08.876 --> 00:21:10.456 A:middle
your extension is registering

00:21:10.456 --> 00:21:12.796 A:middle
for, and only register for

00:21:12.796 --> 00:21:14.746 A:middle
extension internal drags, or

00:21:14.746 --> 00:21:16.096 A:middle
other drags you really want to

00:21:16.096 --> 00:21:16.416 A:middle
handle.

00:21:16.806 --> 00:21:19.166 A:middle
Be especially careful if you use

00:21:19.166 --> 00:21:21.546 A:middle
WKWebView, because it registers

00:21:21.596 --> 00:21:24.926 A:middle
for a bunch of drag types by

00:21:26.046 --> 00:21:26.476 A:middle
default.

00:21:26.556 --> 00:21:28.036 A:middle
That was everything about photo

00:21:28.036 --> 00:21:28.866 A:middle
project extensions.

00:21:29.136 --> 00:21:30.346 A:middle
Let me now hand over to my

00:21:30.346 --> 00:21:32.416 A:middle
colleague Sanaa to talk about

00:21:32.596 --> 00:21:33.856 A:middle
integrating with Photos--

00:21:33.976 --> 00:21:35.666 A:middle
interacting with Photos as a

00:21:35.666 --> 00:21:36.526 A:middle
third-party application.

00:21:36.526 --> 00:21:36.716 A:middle
Thank you.

00:21:37.516 --> 00:21:40.136 A:middle
[ Applause ]

00:21:40.636 --> 00:21:41.156 A:middle
&gt;&gt; Thank you, Tobias.

00:21:41.886 --> 00:21:43.176 A:middle
Hello, everyone.

00:21:43.846 --> 00:21:44.746 A:middle
My name is Sanaa.

00:21:44.746 --> 00:21:46.136 A:middle
I am a Photos engineer, and

00:21:46.136 --> 00:21:47.606 A:middle
today with my colleague Joachim,

00:21:47.606 --> 00:21:48.896 A:middle
we are going to talk about some

00:21:48.896 --> 00:21:51.136 A:middle
best practices for receiving and

00:21:51.136 --> 00:21:52.696 A:middle
providing images or videos

00:21:52.696 --> 00:21:54.886 A:middle
between apps on macOS, using

00:21:54.886 --> 00:21:55.406 A:middle
drag and drop.

00:21:55.856 --> 00:21:59.086 A:middle
Drag and drop is one of the most

00:21:59.086 --> 00:22:00.576 A:middle
intuitive and easiest way to

00:21:59.086 --> 00:22:00.576 A:middle
intuitive and easiest way to

00:22:00.576 --> 00:22:01.916 A:middle
move items from one place to

00:22:01.916 --> 00:22:02.326 A:middle
another.

00:22:03.296 --> 00:22:04.476 A:middle
But, sometimes, you might have

00:22:04.476 --> 00:22:05.726 A:middle
encountered this situation

00:22:05.726 --> 00:22:05.976 A:middle
instead.

00:22:10.206 --> 00:22:11.336 A:middle
If this is something happening

00:22:11.336 --> 00:22:12.656 A:middle
with your app, then you are

00:22:12.656 --> 00:22:13.796 A:middle
sitting in the right session.

00:22:13.866 --> 00:22:13.933 A:middle
So--

00:22:14.516 --> 00:22:18.046 A:middle
[ Applause ]

00:22:18.546 --> 00:22:19.616 A:middle
Let's take a step back to

00:22:19.616 --> 00:22:20.646 A:middle
understand what's happening

00:22:20.646 --> 00:22:20.916 A:middle
here.

00:22:22.656 --> 00:22:24.786 A:middle
Drag and drop on macOS is using

00:22:24.786 --> 00:22:27.186 A:middle
NSPasteboard, and when it's

00:22:27.186 --> 00:22:28.526 A:middle
wrapped in with the pasteboard,

00:22:28.686 --> 00:22:30.276 A:middle
reading and writing data happens

00:22:30.276 --> 00:22:31.866 A:middle
on the main trade, for both the

00:22:31.866 --> 00:22:33.806 A:middle
receiving and providing apps.

00:22:34.326 --> 00:22:36.976 A:middle
In the past, since all local was

00:22:36.976 --> 00:22:38.716 A:middle
stored on local disk, you could

00:22:39.206 --> 00:22:40.526 A:middle
put the file URL's into the

00:22:40.526 --> 00:22:41.066 A:middle
pasteboard.

00:22:41.466 --> 00:22:44.276 A:middle
But, things have changed today.

00:22:44.536 --> 00:22:46.816 A:middle
Images or videos might not be on

00:22:46.816 --> 00:22:48.176 A:middle
disk if the user is using

00:22:48.176 --> 00:22:50.636 A:middle
iCloud, so Photos, we need to

00:22:50.636 --> 00:22:51.906 A:middle
download the full resolution

00:22:51.906 --> 00:22:53.696 A:middle
item first, before putting the

00:22:53.696 --> 00:22:55.246 A:middle
file URL into the pasteboard.

00:22:55.716 --> 00:22:58.966 A:middle
Also, Photos respect the privacy

00:22:58.966 --> 00:23:01.566 A:middle
settings of drag and drop, so if

00:22:58.966 --> 00:23:01.566 A:middle
settings of drag and drop, so if

00:23:01.566 --> 00:23:02.956 A:middle
the user choose to save the

00:23:02.956 --> 00:23:04.566 A:middle
location information, then

00:23:04.566 --> 00:23:06.646 A:middle
Photos will export a new file

00:23:06.646 --> 00:23:07.736 A:middle
which does not contain this

00:23:07.736 --> 00:23:08.296 A:middle
metadata.

00:23:09.246 --> 00:23:10.826 A:middle
Both downloading and exporting

00:23:10.826 --> 00:23:12.746 A:middle
file takes time, and you don't

00:23:12.746 --> 00:23:13.696 A:middle
want to do that on the main

00:23:13.696 --> 00:23:16.776 A:middle
trade, since it's going to block

00:23:16.776 --> 00:23:19.106 A:middle
your app UI.

00:23:19.486 --> 00:23:21.206 A:middle
So, in order to fix this, we

00:23:21.206 --> 00:23:22.926 A:middle
need an asynchronous API.

00:23:24.486 --> 00:23:27.136 A:middle
In fact, we do have one, it's

00:23:27.136 --> 00:23:28.706 A:middle
called file promises.

00:23:30.246 --> 00:23:32.886 A:middle
File promise is a promise of--

00:23:32.986 --> 00:23:34.746 A:middle
that's a file of a certain type

00:23:35.206 --> 00:23:36.776 A:middle
that does not exist yet on disk,

00:23:36.776 --> 00:23:38.446 A:middle
will be written in a provided

00:23:38.446 --> 00:23:39.006 A:middle
location.

00:23:39.726 --> 00:23:41.636 A:middle
It also allows the sender to

00:23:41.636 --> 00:23:42.966 A:middle
write files in the background.

00:23:45.296 --> 00:23:47.446 A:middle
There are two ways to interact

00:23:47.446 --> 00:23:49.426 A:middle
with file promises: receiving

00:23:49.426 --> 00:23:50.556 A:middle
files by using

00:23:50.556 --> 00:23:52.576 A:middle
NSFilePromiseReceiver and

00:23:52.576 --> 00:23:53.846 A:middle
providing files by using

00:23:53.846 --> 00:23:55.006 A:middle
NSFilePromiseProvider.

00:23:55.926 --> 00:23:57.556 A:middle
Both of these modern API's have

00:23:57.556 --> 00:23:59.196 A:middle
been introduced two years ago

00:23:59.196 --> 00:24:00.176 A:middle
with macOS Sierra.

00:23:59.196 --> 00:24:00.176 A:middle
with macOS Sierra.

00:24:00.176 --> 00:24:02.956 A:middle
So, let's start first with

00:24:02.956 --> 00:24:03.966 A:middle
receiving file promises.

00:24:09.046 --> 00:24:11.516 A:middle
As a general rule, apps

00:24:11.516 --> 00:24:12.966 A:middle
supporting drag and drop should

00:24:12.966 --> 00:24:15.656 A:middle
always accept both file URL's

00:24:15.656 --> 00:24:16.646 A:middle
and file promises.

00:24:16.806 --> 00:24:17.916 A:middle
And, I'll explain why.

00:24:18.466 --> 00:24:21.156 A:middle
There are multiple apps

00:24:21.186 --> 00:24:22.416 A:middle
providing file promises.

00:24:23.736 --> 00:24:25.886 A:middle
Photos is using file promises

00:24:25.886 --> 00:24:27.846 A:middle
when dragging an image, a video,

00:24:28.076 --> 00:24:30.766 A:middle
or entire album, and since macOS

00:24:30.766 --> 00:24:32.956 A:middle
Mojave, you can-- we added the

00:24:32.956 --> 00:24:35.696 A:middle
ability to drag the people or

00:24:35.696 --> 00:24:36.296 A:middle
memories.

00:24:37.016 --> 00:24:38.416 A:middle
So, we are not the only app

00:24:38.416 --> 00:24:39.536 A:middle
using file promises.

00:24:40.706 --> 00:24:42.406 A:middle
Mail is using file promises when

00:24:42.406 --> 00:24:44.286 A:middle
dragging a message to Finder, to

00:24:44.286 --> 00:24:45.856 A:middle
save the entire email, including

00:24:45.856 --> 00:24:46.616 A:middle
attachments.

00:24:47.856 --> 00:24:49.626 A:middle
Safari is using file promises

00:24:49.626 --> 00:24:50.576 A:middle
when dragging an image.

00:24:51.176 --> 00:24:54.226 A:middle
And, Keynote is using file

00:24:54.226 --> 00:24:55.536 A:middle
promises when dragging a

00:24:55.536 --> 00:24:57.116 A:middle
selection of slides to create a

00:24:57.116 --> 00:24:58.346 A:middle
new document containing those

00:24:58.346 --> 00:24:58.706 A:middle
slides.

00:24:59.466 --> 00:25:01.966 A:middle
So, if you want to receive files

00:24:59.466 --> 00:25:01.966 A:middle
So, if you want to receive files

00:25:02.036 --> 00:25:04.176 A:middle
from those apps, or any app

00:25:04.226 --> 00:25:05.546 A:middle
providing file promises, then

00:25:05.546 --> 00:25:07.266 A:middle
your app needs to read file

00:25:07.266 --> 00:25:08.426 A:middle
promises, and need to accept

00:25:08.476 --> 00:25:08.986 A:middle
those files.

00:25:09.566 --> 00:25:11.206 A:middle
So, let's see how we can do that

00:25:11.206 --> 00:25:12.246 A:middle
by looking at some code.

00:25:12.676 --> 00:25:17.206 A:middle
First, during setup, a view must

00:25:17.206 --> 00:25:18.546 A:middle
register what types it'll accept

00:25:18.746 --> 00:25:19.406 A:middle
by calling

00:25:19.406 --> 00:25:21.176 A:middle
registerForDraggedTypes.

00:25:21.576 --> 00:25:23.516 A:middle
And, in order to accept file

00:25:23.516 --> 00:25:25.956 A:middle
promises, you can use the class

00:25:25.956 --> 00:25:28.336 A:middle
property readableDraggedTypes on

00:25:28.336 --> 00:25:29.526 A:middle
NSFilePromiseReceiver.

00:25:31.756 --> 00:25:34.736 A:middle
Then, when performing the drag

00:25:34.736 --> 00:25:37.456 A:middle
operation, and when enumerating

00:25:37.456 --> 00:25:40.076 A:middle
or draggingItems, you should add

00:25:40.076 --> 00:25:40.766 A:middle
support to

00:25:40.766 --> 00:25:43.086 A:middle
NSFilePromiseReceiver, and make

00:25:43.086 --> 00:25:44.456 A:middle
sure to handle it first.

00:25:45.066 --> 00:25:46.886 A:middle
Because it's more likely to

00:25:46.886 --> 00:25:48.656 A:middle
contain the highest quality

00:25:48.656 --> 00:25:49.456 A:middle
representation.

00:25:49.646 --> 00:25:54.176 A:middle
For each filePromiseReceiver,

00:25:54.846 --> 00:25:57.506 A:middle
you call in the promise, and

00:25:57.506 --> 00:26:00.786 A:middle
when the file is ready, then the

00:25:57.506 --> 00:26:00.786 A:middle
when the file is ready, then the

00:26:00.786 --> 00:26:02.306 A:middle
reader block is called on the

00:26:02.306 --> 00:26:04.156 A:middle
provided operationQueue, where

00:26:04.156 --> 00:26:05.206 A:middle
you can handle the file.

00:26:05.776 --> 00:26:09.576 A:middle
It's very important to provide a

00:26:09.576 --> 00:26:12.776 A:middle
background operationQueue to not

00:26:12.776 --> 00:26:14.616 A:middle
block the main trades while

00:26:14.616 --> 00:26:15.886 A:middle
waiting for the file to be

00:26:15.886 --> 00:26:18.896 A:middle
downloaded over-- to be

00:26:19.026 --> 00:26:20.716 A:middle
downloaded, to be written by the

00:26:20.716 --> 00:26:21.266 A:middle
source file.

00:26:22.286 --> 00:26:23.896 A:middle
Because this process can take a

00:26:23.896 --> 00:26:26.176 A:middle
long time, and you don't want--

00:26:26.176 --> 00:26:28.936 A:middle
especially if the file needs to

00:26:28.936 --> 00:26:30.096 A:middle
be downloaded over a slow

00:26:30.096 --> 00:26:30.466 A:middle
network.

00:26:30.976 --> 00:26:34.516 A:middle
So, for a better user

00:26:34.516 --> 00:26:36.796 A:middle
experience, you need to display

00:26:37.216 --> 00:26:39.606 A:middle
a loading activity, and when the

00:26:39.606 --> 00:26:41.206 A:middle
file is ready, then you can

00:26:41.406 --> 00:26:42.926 A:middle
replace the UI with the real

00:26:42.926 --> 00:26:43.396 A:middle
content.

00:26:43.816 --> 00:26:47.556 A:middle
Here you will see an example of

00:26:47.686 --> 00:26:51.896 A:middle
Mail, showing a placeholder UI

00:26:51.896 --> 00:26:53.786 A:middle
while waiting for the image to

00:26:53.786 --> 00:26:54.976 A:middle
be downloaded via file promises.

00:27:01.066 --> 00:27:02.736 A:middle
So, that was receiving file

00:27:02.736 --> 00:27:03.216 A:middle
promises.

00:27:03.676 --> 00:27:05.236 A:middle
Now, let's see how we can

00:27:05.236 --> 00:27:06.336 A:middle
provide file promises.

00:27:07.186 --> 00:27:08.736 A:middle
And, you should consider

00:27:09.106 --> 00:27:10.636 A:middle
implementing this in your app,

00:27:11.276 --> 00:27:12.636 A:middle
if the data you want to send

00:27:12.636 --> 00:27:14.296 A:middle
over drag and drop does not

00:27:14.296 --> 00:27:15.416 A:middle
exist yet on disk.

00:27:16.556 --> 00:27:18.196 A:middle
So, let's have a look on how we

00:27:18.196 --> 00:27:20.806 A:middle
can do that by looking at the

00:27:20.806 --> 00:27:20.976 A:middle
API.

00:27:25.336 --> 00:27:27.906 A:middle
First, you will need to create

00:27:27.906 --> 00:27:28.616 A:middle
an instance of

00:27:28.616 --> 00:27:29.896 A:middle
NSFilePromiseProvider.

00:27:31.816 --> 00:27:33.796 A:middle
You should create one instance

00:27:33.796 --> 00:27:34.906 A:middle
for each promised file.

00:27:35.436 --> 00:27:37.236 A:middle
And, before writing the

00:27:37.236 --> 00:27:39.226 A:middle
filePromiseProvider object to

00:27:39.226 --> 00:27:41.186 A:middle
the pasteboard, it must contain

00:27:41.186 --> 00:27:43.416 A:middle
a file type, and a delegate.

00:27:44.296 --> 00:27:45.486 A:middle
These delegate is doing the

00:27:45.486 --> 00:27:46.976 A:middle
heavy lifting of writing files

00:27:46.976 --> 00:27:47.516 A:middle
to disk.

00:27:48.456 --> 00:27:50.696 A:middle
There are only three methods for

00:27:50.696 --> 00:27:52.526 A:middle
NSFilePromiseProvider delegates.

00:27:53.136 --> 00:27:54.746 A:middle
The first one is called by the

00:27:54.746 --> 00:27:57.586 A:middle
drag destination, and returns

00:27:57.586 --> 00:27:58.966 A:middle
the file name, not the full

00:27:58.966 --> 00:27:59.416 A:middle
path.

00:27:59.976 --> 00:28:03.136 A:middle
The second one return an

00:27:59.976 --> 00:28:03.136 A:middle
The second one return an

00:28:03.136 --> 00:28:07.096 A:middle
operationQueue, and when-- an

00:28:07.096 --> 00:28:08.816 A:middle
operationQueue where the file,

00:28:08.816 --> 00:28:10.036 A:middle
it will be written.

00:28:10.996 --> 00:28:12.926 A:middle
And, we highly recommend that

00:28:12.926 --> 00:28:15.056 A:middle
you implement this optional

00:28:15.056 --> 00:28:16.556 A:middle
method, and provide a background

00:28:16.556 --> 00:28:19.426 A:middle
operationQueue, since otherwise,

00:28:19.426 --> 00:28:21.206 A:middle
the main queue will be used

00:28:21.206 --> 00:28:21.636 A:middle
otherwise.

00:28:24.226 --> 00:28:26.636 A:middle
And, finally, writePromise to

00:28:26.636 --> 00:28:28.816 A:middle
file is called, asking you to

00:28:28.816 --> 00:28:29.826 A:middle
write file to disk.

00:28:31.326 --> 00:28:33.066 A:middle
And, when you are done, remember

00:28:33.066 --> 00:28:34.506 A:middle
to call the completion handler.

00:28:35.036 --> 00:28:38.876 A:middle
So, that was receiving file

00:28:38.876 --> 00:28:40.456 A:middle
promises-- providing file

00:28:40.456 --> 00:28:42.686 A:middle
promises, and we have covered

00:28:42.686 --> 00:28:45.406 A:middle
the API to-- that you can use to

00:28:45.406 --> 00:28:47.856 A:middle
adapt your app to receive and

00:28:47.856 --> 00:28:48.836 A:middle
provide file promises.

00:28:48.836 --> 00:28:51.006 A:middle
And now, I'd like to invite

00:28:51.006 --> 00:28:52.826 A:middle
Joachim on stage to show you all

00:28:52.826 --> 00:28:53.976 A:middle
of that in a sample app.

00:28:54.336 --> 00:28:54.686 A:middle
Thank you.

00:28:54.686 --> 00:28:54.866 A:middle
Joachim?

00:28:55.516 --> 00:28:58.626 A:middle
[ Applause ]

00:28:59.126 --> 00:28:59.466 A:middle
&gt;&gt; Thank you.

00:29:02.076 --> 00:29:02.626 A:middle
Good morning.

00:29:03.556 --> 00:29:05.256 A:middle
We're going to look at a simple

00:29:05.256 --> 00:29:07.136 A:middle
beam generator app, which has a

00:29:07.136 --> 00:29:08.506 A:middle
few issues with drag and drop.

00:29:08.506 --> 00:29:09.976 A:middle
And we're going to dive into

00:29:09.976 --> 00:29:11.676 A:middle
Xcode, and try to fix those

00:29:11.676 --> 00:29:11.976 A:middle
issues together.

00:29:20.046 --> 00:29:21.246 A:middle
So, here is my simple app.

00:29:21.576 --> 00:29:23.776 A:middle
And, I can just grab a file I

00:29:23.776 --> 00:29:26.286 A:middle
have here on desktop, and drop

00:29:26.286 --> 00:29:27.576 A:middle
it onto its window.

00:29:27.746 --> 00:29:28.376 A:middle
Just like that.

00:29:29.596 --> 00:29:30.476 A:middle
On the upper right, I have a

00:29:30.476 --> 00:29:32.276 A:middle
little button, where I can add a

00:29:32.396 --> 00:29:35.566 A:middle
text box, and I can add some

00:29:35.656 --> 00:29:37.246 A:middle
text to my image.

00:29:38.496 --> 00:29:40.306 A:middle
I can select it, move it around,

00:29:40.956 --> 00:29:45.066 A:middle
and when I'm ready, I can send

00:29:45.066 --> 00:29:47.466 A:middle
it over iMessage, for example.

00:29:52.756 --> 00:29:55.066 A:middle
So, while this image is great, I

00:29:55.066 --> 00:29:56.506 A:middle
really want to use an image I

00:29:56.506 --> 00:29:57.296 A:middle
found on the web.

00:29:57.826 --> 00:29:59.686 A:middle
So, let's open up Safari, and

00:30:00.276 --> 00:30:03.146 A:middle
try to drag this image onto our

00:30:03.146 --> 00:30:03.266 A:middle
app.

00:30:06.876 --> 00:30:08.516 A:middle
Unfortunately, this doesn't

00:30:08.516 --> 00:30:08.716 A:middle
work.

00:30:09.536 --> 00:30:12.116 A:middle
So, let's jump to Xcode, and see

00:30:12.116 --> 00:30:12.896 A:middle
if we can fix that.

00:30:17.156 --> 00:30:18.226 A:middle
Here I am in the main

00:30:18.226 --> 00:30:19.716 A:middle
viewController of our app.

00:30:20.466 --> 00:30:22.696 A:middle
And, we going to jump straight

00:30:22.816 --> 00:30:23.676 A:middle
to view [inaudible].

00:30:24.456 --> 00:30:26.076 A:middle
And, have a look at what's going

00:30:26.076 --> 00:30:26.326 A:middle
on.

00:30:26.906 --> 00:30:30.606 A:middle
Right here, we're only

00:30:30.606 --> 00:30:32.286 A:middle
registering for file URL's.

00:30:33.136 --> 00:30:35.026 A:middle
So, let's fix that, and register

00:30:35.166 --> 00:30:36.976 A:middle
for FilePromiseReceiver as well.

00:30:41.686 --> 00:30:45.346 A:middle
Next, when handling the drag

00:30:45.346 --> 00:30:47.706 A:middle
operation, we need to take care

00:30:47.706 --> 00:30:50.106 A:middle
of FilePromiseReceiver as well.

00:30:51.166 --> 00:30:54.476 A:middle
So. Let's jump to the next

00:30:54.476 --> 00:30:56.596 A:middle
method right here.

00:30:56.866 --> 00:30:57.746 A:middle
So, here is the list of

00:30:57.746 --> 00:31:00.056 A:middle
supported classes, and we only

00:30:57.746 --> 00:31:00.056 A:middle
supported classes, and we only

00:31:00.056 --> 00:31:01.056 A:middle
have NSURL.

00:31:01.516 --> 00:31:03.706 A:middle
So, we're going to add at the

00:31:03.706 --> 00:31:04.986 A:middle
first index,

00:31:06.126 --> 00:31:07.446 A:middle
NSFilePromiseReceiver.

00:31:15.136 --> 00:31:17.226 A:middle
In the enumeration method here,

00:31:17.766 --> 00:31:18.946 A:middle
we're going to add a new case.

00:31:26.656 --> 00:31:29.546 A:middle
Where we're going to receive the

00:31:29.576 --> 00:31:31.376 A:middle
promised files, and if we get a

00:31:31.376 --> 00:31:33.886 A:middle
file URL, we're going to call

00:31:33.886 --> 00:31:35.806 A:middle
the exact same method we will

00:31:35.806 --> 00:31:37.476 A:middle
have called if we had just

00:31:37.536 --> 00:31:39.076 A:middle
gotten the file URL over drag

00:31:39.076 --> 00:31:39.316 A:middle
and drop.

00:31:39.316 --> 00:31:40.946 A:middle
So, let's see if it works.

00:31:48.306 --> 00:31:49.446 A:middle
So, here's the little app.

00:31:50.366 --> 00:31:52.486 A:middle
Let's go back to Safari, take

00:31:52.486 --> 00:31:54.796 A:middle
the image, and drop it onto the

00:31:54.796 --> 00:31:54.976 A:middle
window.

00:31:55.516 --> 00:32:00.196 A:middle
[ Applause ]

00:31:55.516 --> 00:32:00.196 A:middle
[ Applause ]

00:32:00.696 --> 00:32:01.616 A:middle
So, that was pretty easy.

00:32:01.906 --> 00:32:03.256 A:middle
I only had to modify two

00:32:03.256 --> 00:32:05.456 A:middle
existing methods in order to

00:32:05.456 --> 00:32:06.636 A:middle
accept file promises.

00:32:09.056 --> 00:32:10.976 A:middle
Now. Let's add some text.

00:32:15.296 --> 00:32:15.856 A:middle
Like this.

00:32:16.626 --> 00:32:18.206 A:middle
And, wouldn't it be great if I'm

00:32:18.206 --> 00:32:19.686 A:middle
not quite ready to send out my

00:32:19.686 --> 00:32:20.956 A:middle
meme to somebody, if I could

00:32:20.956 --> 00:32:23.076 A:middle
just drag it onto the desktop to

00:32:23.076 --> 00:32:24.226 A:middle
save it as an image file?

00:32:24.876 --> 00:32:28.376 A:middle
As you can see, this doesn't

00:32:28.376 --> 00:32:28.686 A:middle
work.

00:32:29.326 --> 00:32:31.036 A:middle
So, let's jump back to Xcode and

00:32:31.156 --> 00:32:31.976 A:middle
fix this as well.

00:32:38.076 --> 00:32:39.446 A:middle
At the bottom of the class, we

00:32:39.446 --> 00:32:40.896 A:middle
have this method which returns

00:32:41.116 --> 00:32:42.686 A:middle
an object conforming to

00:32:42.686 --> 00:32:45.636 A:middle
NSPasteboardWriting, and as you

00:32:45.636 --> 00:32:47.296 A:middle
can see, we're just returning a

00:32:47.296 --> 00:32:48.476 A:middle
simple NSImage here.

00:32:49.086 --> 00:32:50.716 A:middle
So, we're going to replace it

00:32:51.616 --> 00:32:52.976 A:middle
with a filePromiseProvider.

00:32:57.046 --> 00:32:58.056 A:middle
So, we're creating a file

00:32:58.056 --> 00:33:00.616 A:middle
provider, and we're going to

00:32:58.056 --> 00:33:00.616 A:middle
provider, and we're going to

00:33:00.616 --> 00:33:02.476 A:middle
provide a JPEG image.

00:33:03.346 --> 00:33:05.276 A:middle
And, we're going to use this

00:33:05.346 --> 00:33:07.236 A:middle
userInfo property to store the

00:33:07.236 --> 00:33:09.496 A:middle
snapshotItem, which we're going

00:33:09.496 --> 00:33:10.856 A:middle
to use later to write out the

00:33:10.856 --> 00:33:11.646 A:middle
file to disk.

00:33:14.016 --> 00:33:16.416 A:middle
As a next step, let's conform to

00:33:16.416 --> 00:33:17.976 A:middle
NSFilePromiseProviderDelegate.

00:33:22.176 --> 00:33:22.966 A:middle
Just like this.

00:33:24.566 --> 00:33:25.466 A:middle
Jump back down.

00:33:26.236 --> 00:33:27.246 A:middle
And, implement the three

00:33:27.246 --> 00:33:28.796 A:middle
delegate methods you heard about

00:33:28.796 --> 00:33:29.396 A:middle
just before.

00:33:30.756 --> 00:33:34.186 A:middle
The first one returns the file

00:33:34.186 --> 00:33:35.256 A:middle
name.

00:33:36.226 --> 00:33:37.896 A:middle
For simplicity, we're just

00:33:37.896 --> 00:33:39.176 A:middle
returning a static file name

00:33:39.176 --> 00:33:39.436 A:middle
here.

00:33:41.296 --> 00:33:42.976 A:middle
The second one returns an

00:33:42.976 --> 00:33:43.766 A:middle
operationQueue.

00:33:44.776 --> 00:33:46.306 A:middle
And, we happen to have one right

00:33:46.306 --> 00:33:46.566 A:middle
here.

00:33:47.956 --> 00:33:49.476 A:middle
And, the third method is

00:33:49.476 --> 00:33:51.676 A:middle
actually going to write the file

00:33:51.676 --> 00:33:51.976 A:middle
to disk.

00:33:58.746 --> 00:34:00.116 A:middle
So, what's happening here, is

00:33:58.746 --> 00:34:00.116 A:middle
So, what's happening here, is

00:34:00.276 --> 00:34:01.016 A:middle
that we're getting the

00:34:01.016 --> 00:34:02.946 A:middle
snapshotObject out of the

00:34:02.946 --> 00:34:06.396 A:middle
filePromiseProvider object, and

00:34:06.536 --> 00:34:08.266 A:middle
we're going to use its JPEG

00:34:08.266 --> 00:34:10.446 A:middle
representation to write the file

00:34:10.626 --> 00:34:11.806 A:middle
to disk.

00:34:12.835 --> 00:34:13.976 A:middle
So, let's have a look.

00:34:19.826 --> 00:34:21.286 A:middle
This time, we're going to jump

00:34:21.286 --> 00:34:21.826 A:middle
to Photos.

00:34:22.206 --> 00:34:28.366 A:middle
Going to take this image, drag

00:34:28.366 --> 00:34:31.966 A:middle
it into our app, add some text.

00:34:36.275 --> 00:34:39.666 A:middle
And, drop it onto the Finder

00:34:39.666 --> 00:34:40.096 A:middle
desktop.

00:34:40.096 --> 00:34:41.335 A:middle
And, here we are.

00:34:42.516 --> 00:34:46.500 A:middle
[ Applause ]

00:34:55.676 --> 00:34:56.866 A:middle
So, if you just follow the

00:34:56.866 --> 00:34:58.396 A:middle
simple steps I just showed you,

00:34:58.576 --> 00:34:59.956 A:middle
you can add support for file

00:34:59.956 --> 00:35:01.916 A:middle
promises to your app, and

00:34:59.956 --> 00:35:01.916 A:middle
promises to your app, and

00:35:01.916 --> 00:35:03.896 A:middle
improve the user experience.

00:35:04.736 --> 00:35:06.276 A:middle
And, with that, I'd like to hand

00:35:06.276 --> 00:35:06.946 A:middle
it back to Eric.

00:35:07.576 --> 00:35:07.856 A:middle
Thank you.

00:35:08.516 --> 00:35:12.356 A:middle
[ Applause ]

00:35:12.856 --> 00:35:13.636 A:middle
&gt;&gt; Great stuff.

00:35:14.106 --> 00:35:14.606 A:middle
Great stuff.

00:35:14.606 --> 00:35:15.666 A:middle
I hope you really enjoyed that.

00:35:15.986 --> 00:35:17.976 A:middle
I just have a few words, just in

00:35:17.976 --> 00:35:18.496 A:middle
summary.

00:35:18.736 --> 00:35:20.796 A:middle
To, kind of, tie this all

00:35:20.796 --> 00:35:21.306 A:middle
together.

00:35:21.306 --> 00:35:23.976 A:middle
And, I'll start by saying, you

00:35:23.976 --> 00:35:26.956 A:middle
know, photos really, really

00:35:26.956 --> 00:35:28.816 A:middle
matter to all of us.

00:35:29.176 --> 00:35:30.906 A:middle
Right? Millions and millions of

00:35:30.906 --> 00:35:32.386 A:middle
people around the world take

00:35:32.386 --> 00:35:34.626 A:middle
millions of photos every day.

00:35:35.686 --> 00:35:37.356 A:middle
And, all of those photos find a

00:35:37.356 --> 00:35:39.316 A:middle
home inside the Photos app.

00:35:39.826 --> 00:35:42.206 A:middle
But, they're nothing if they

00:35:42.206 --> 00:35:43.026 A:middle
can't be shared.

00:35:44.026 --> 00:35:45.586 A:middle
If they can't be shown.

00:35:45.586 --> 00:35:47.616 A:middle
If they can't be preserved into

00:35:47.616 --> 00:35:48.756 A:middle
beautiful keepsakes.

00:35:49.206 --> 00:35:51.836 A:middle
And so, all of these people

00:35:51.836 --> 00:35:53.066 A:middle
capturing all of these images,

00:35:53.066 --> 00:35:55.626 A:middle
they rely on you, the developer,

00:35:55.856 --> 00:35:57.606 A:middle
to create amazing apps that let

00:35:57.606 --> 00:35:58.866 A:middle
them do creative things with

00:35:58.936 --> 00:35:59.756 A:middle
those images.

00:36:00.526 --> 00:36:01.866 A:middle
So, if you only remember two

00:36:01.866 --> 00:36:03.266 A:middle
things from this session today,

00:36:03.266 --> 00:36:04.516 A:middle
please remember this.

00:36:05.446 --> 00:36:07.006 A:middle
Support file promises.

00:36:07.676 --> 00:36:09.846 A:middle
You saw it's really easy to have

00:36:09.846 --> 00:36:11.476 A:middle
some very immediate interaction

00:36:11.476 --> 00:36:12.316 A:middle
with the Photos app.

00:36:13.636 --> 00:36:14.606 A:middle
Please, please do that.

00:36:15.096 --> 00:36:17.096 A:middle
And, secondly, we strongly

00:36:17.096 --> 00:36:19.186 A:middle
encourage you to explore all of

00:36:19.186 --> 00:36:20.956 A:middle
the API that's available to you

00:36:20.956 --> 00:36:22.446 A:middle
in the project extension

00:36:22.976 --> 00:36:24.426 A:middle
experience within Photos.

00:36:24.896 --> 00:36:27.466 A:middle
Going back to what I said at the

00:36:27.466 --> 00:36:29.726 A:middle
beginning, this is a blossoming

00:36:29.726 --> 00:36:30.536 A:middle
ecosystem.

00:36:30.536 --> 00:36:31.476 A:middle
And, there's a tremendous

00:36:31.476 --> 00:36:33.006 A:middle
opportunity to embrace it.

00:36:33.516 --> 00:36:35.046 A:middle
And, collectively for us to

00:36:35.046 --> 00:36:36.276 A:middle
create a better Photos

00:36:36.276 --> 00:36:37.456 A:middle
experience for everybody.

00:36:40.096 --> 00:36:42.526 A:middle
So, with that, please join us in

00:36:42.526 --> 00:36:43.696 A:middle
the lab this afternoon.

00:36:44.326 --> 00:36:46.526 A:middle
We have tons of engineers on

00:36:46.526 --> 00:36:48.806 A:middle
staff to help you with any of

00:36:48.806 --> 00:36:50.946 A:middle
your PhotoKit questions, Photos

00:36:50.946 --> 00:36:53.446 A:middle
extensions, be it iOS, macOS, we

00:36:53.846 --> 00:36:54.936 A:middle
really look forward to talking

00:36:54.936 --> 00:36:55.486 A:middle
to you there.

00:36:56.306 --> 00:36:58.036 A:middle
And, enjoy the rest of your

00:36:58.036 --> 00:36:58.176 A:middle
WWDC.

00:36:58.176 --> 00:36:58.596 A:middle
Thank you.

00:36:59.516 --> 00:37:03.500 A:middle
[ Applause ]

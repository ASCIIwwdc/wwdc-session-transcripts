WEBVTT

00:00:00.506 --> 00:00:04.500 A:middle
[ Music ]

00:00:09.016 --> 00:00:10.636 A:middle
[ Applause ]

00:00:10.636 --> 00:00:11.076 A:middle
&gt;&gt; Good afternoon.

00:00:11.076 --> 00:00:14.466 A:middle
And welcome to Integrating with

00:00:14.466 --> 00:00:15.626 A:middle
Siri Event Suggestions.

00:00:16.245 --> 00:00:17.576 A:middle
My name is Sofiane, and I'm an

00:00:17.576 --> 00:00:18.706 A:middle
Engineer, working on Siri

00:00:18.706 --> 00:00:19.626 A:middle
frameworks here at Apple.

00:00:20.436 --> 00:00:21.666 A:middle
And today, I'll be joined by my

00:00:21.666 --> 00:00:22.496 A:middle
colleague, Magnus.

00:00:23.236 --> 00:00:24.746 A:middle
We're really thrilled to be here

00:00:24.746 --> 00:00:26.646 A:middle
today to tell you all about how

00:00:26.646 --> 00:00:28.416 A:middle
to integrate your apps with Siri

00:00:28.416 --> 00:00:29.206 A:middle
Event Suggestions.

00:00:30.976 --> 00:00:32.766 A:middle
Siri is the virtual assistant we

00:00:32.766 --> 00:00:34.606 A:middle
all know and love, and with

00:00:34.606 --> 00:00:36.746 A:middle
SiriKit, your app can work with

00:00:36.746 --> 00:00:38.806 A:middle
Siri, for things like sending

00:00:38.806 --> 00:00:40.946 A:middle
messages, requesting rides, as

00:00:40.946 --> 00:00:41.986 A:middle
well as expose the key

00:00:41.986 --> 00:00:43.816 A:middle
capabilities of your app using

00:00:43.816 --> 00:00:44.336 A:middle
shortcuts.

00:00:45.696 --> 00:00:47.516 A:middle
Siri is also deeply integrated

00:00:47.766 --> 00:00:49.576 A:middle
across our platforms, adding

00:00:49.576 --> 00:00:51.256 A:middle
on-device intelligence to the

00:00:51.256 --> 00:00:53.296 A:middle
apps you use every day.

00:00:53.486 --> 00:00:55.756 A:middle
In Calendar, Siri is personal

00:00:55.756 --> 00:00:56.756 A:middle
and knows about your

00:00:56.756 --> 00:00:58.096 A:middle
reservations to help you get

00:00:58.096 --> 00:01:00.446 A:middle
organized, and Siri can then use

00:00:58.096 --> 00:01:00.446 A:middle
organized, and Siri can then use

00:01:00.446 --> 00:01:01.906 A:middle
that information about your

00:01:01.906 --> 00:01:03.716 A:middle
reservations to make proactive

00:01:03.716 --> 00:01:04.926 A:middle
suggestions throughout the

00:01:04.926 --> 00:01:05.406 A:middle
system.

00:01:06.356 --> 00:01:08.606 A:middle
So, on the lock screen, Siri

00:01:08.606 --> 00:01:09.936 A:middle
notifies you when it's time to

00:01:09.936 --> 00:01:11.006 A:middle
leave, based on traffic

00:01:11.006 --> 00:01:11.556 A:middle
conditions.

00:01:12.126 --> 00:01:14.196 A:middle
And when you open Maps, you get

00:01:14.196 --> 00:01:15.756 A:middle
Siri suggestions, which make it

00:01:15.826 --> 00:01:17.446 A:middle
super convenient to get

00:01:17.446 --> 00:01:18.646 A:middle
directions right to your

00:01:18.646 --> 00:01:20.696 A:middle
destination with just one tap.

00:01:21.536 --> 00:01:23.326 A:middle
Now, when you get there, Siri

00:01:23.326 --> 00:01:24.826 A:middle
can proactively suggest to turn

00:01:24.826 --> 00:01:26.466 A:middle
on Do Not Disturb and help you

00:01:26.466 --> 00:01:27.816 A:middle
stay focused on what matters.

00:01:28.206 --> 00:01:30.606 A:middle
And all of that starts with the

00:01:30.606 --> 00:01:31.896 A:middle
system knowing about your

00:01:31.896 --> 00:01:33.666 A:middle
reservations, wherever they come

00:01:33.666 --> 00:01:36.076 A:middle
from, whether it's in the car

00:01:36.076 --> 00:01:38.286 A:middle
rental reservation in mail, a

00:01:38.286 --> 00:01:39.646 A:middle
restaurant reservation in

00:01:39.646 --> 00:01:41.756 A:middle
messages, or even when you're

00:01:41.756 --> 00:01:43.396 A:middle
booking a flight directly in

00:01:43.396 --> 00:01:43.796 A:middle
Safari.

00:01:44.786 --> 00:01:47.556 A:middle
Now, in iOS 13, we're really

00:01:47.556 --> 00:01:49.556 A:middle
excited to introduce new APIs

00:01:49.776 --> 00:01:51.316 A:middle
for your apps, to integrate

00:01:51.316 --> 00:01:52.756 A:middle
directly with this ecosystem.

00:01:53.516 --> 00:01:57.776 A:middle
[ Applause ]

00:01:58.276 --> 00:02:00.166 A:middle
So for example, when you view

00:01:58.276 --> 00:02:00.166 A:middle
So for example, when you view

00:02:00.166 --> 00:02:01.846 A:middle
your flight reservation inside

00:02:01.846 --> 00:02:03.876 A:middle
the American Airline app, the

00:02:03.876 --> 00:02:05.286 A:middle
app donates that information to

00:02:05.286 --> 00:02:05.766 A:middle
the system.

00:02:06.706 --> 00:02:08.026 A:middle
Siri can then use it to

00:02:08.026 --> 00:02:09.106 A:middle
automatically show a

00:02:09.106 --> 00:02:11.026 A:middle
notification and add that flight

00:02:11.026 --> 00:02:12.306 A:middle
to your calendar.

00:02:12.866 --> 00:02:14.366 A:middle
Siri will then go on to make

00:02:14.366 --> 00:02:15.976 A:middle
proactive suggestions for that

00:02:15.976 --> 00:02:17.596 A:middle
flight, at the right time, in

00:02:17.596 --> 00:02:18.416 A:middle
all of the places that I

00:02:18.416 --> 00:02:19.116 A:middle
mentioned before.

00:02:20.086 --> 00:02:21.146 A:middle
And all of that intelligence

00:02:21.376 --> 00:02:23.496 A:middle
happens directly on the device.

00:02:24.476 --> 00:02:25.816 A:middle
But we didn't want to stop here.

00:02:26.366 --> 00:02:28.426 A:middle
This year, we wanted to extend

00:02:28.426 --> 00:02:30.506 A:middle
that deep system integration and

00:02:30.506 --> 00:02:32.046 A:middle
promote your app in even more

00:02:32.046 --> 00:02:33.036 A:middle
places in the system.

00:02:34.326 --> 00:02:36.346 A:middle
So, in iOS 13, if your app

00:02:36.346 --> 00:02:38.056 A:middle
supports check-in, it can get

00:02:38.056 --> 00:02:39.576 A:middle
promoted right on the lock

00:02:39.576 --> 00:02:41.596 A:middle
screen, taking users directly

00:02:41.596 --> 00:02:44.616 A:middle
into your app at the right time.

00:02:44.756 --> 00:02:46.596 A:middle
Also new in iOS 13, with maps,

00:02:47.246 --> 00:02:48.396 A:middle
when the time is right, when a

00:02:48.396 --> 00:02:50.206 A:middle
user goes into maps, they can

00:02:50.206 --> 00:02:52.016 A:middle
get up to date information about

00:02:52.016 --> 00:02:53.306 A:middle
their flight, and even get

00:02:53.446 --> 00:02:55.456 A:middle
directions, indoor directions

00:02:55.526 --> 00:02:58.276 A:middle
directly to their gate.

00:02:58.476 --> 00:02:59.826 A:middle
So Siri is there to help at

00:02:59.976 --> 00:03:02.096 A:middle
every step of the way, from the

00:02:59.976 --> 00:03:02.096 A:middle
every step of the way, from the

00:03:02.096 --> 00:03:03.426 A:middle
moment you make your reservation

00:03:03.696 --> 00:03:04.706 A:middle
to the moment you walk in.

00:03:05.616 --> 00:03:07.326 A:middle
So, by now, I hope you're all

00:03:07.326 --> 00:03:09.186 A:middle
thinking that is pretty cool,

00:03:09.316 --> 00:03:09.746 A:middle
hopefully.

00:03:10.546 --> 00:03:11.776 A:middle
But how does that all work?

00:03:12.266 --> 00:03:14.776 A:middle
Well, the API is built as part

00:03:14.776 --> 00:03:16.466 A:middle
of SiriKit which allow you to do

00:03:16.466 --> 00:03:17.876 A:middle
many things, like setting up

00:03:17.876 --> 00:03:19.616 A:middle
shortcuts, sending payments, and

00:03:19.616 --> 00:03:20.156 A:middle
much more.

00:03:20.876 --> 00:03:21.836 A:middle
And more specifically,

00:03:22.316 --> 00:03:23.186 A:middle
everything we will talk about

00:03:23.186 --> 00:03:24.796 A:middle
today is exposed as part of the

00:03:24.796 --> 00:03:25.606 A:middle
intense framework.

00:03:26.076 --> 00:03:28.496 A:middle
We support reservations across

00:03:28.496 --> 00:03:30.086 A:middle
many categories, ranging from

00:03:30.086 --> 00:03:31.736 A:middle
restaurants to ticketed events,

00:03:31.866 --> 00:03:34.136 A:middle
to various forms of transit, and

00:03:34.136 --> 00:03:35.846 A:middle
this year, we're introducing new

00:03:35.846 --> 00:03:37.736 A:middle
classes in the intense framework

00:03:38.156 --> 00:03:39.926 A:middle
to represent details for all of

00:03:39.926 --> 00:03:41.186 A:middle
these reservation categories.

00:03:42.016 --> 00:03:43.026 A:middle
Now, all of these classes

00:03:43.026 --> 00:03:44.276 A:middle
inherit from the new IN

00:03:44.276 --> 00:03:45.026 A:middle
Reservation Class.

00:03:45.536 --> 00:03:47.096 A:middle
So, for instance, to represent a

00:03:47.096 --> 00:03:48.786 A:middle
restaurant reservation, you can

00:03:48.786 --> 00:03:49.476 A:middle
create an

00:03:49.476 --> 00:03:50.996 A:middle
INRestaurantReservation object.

00:03:52.676 --> 00:03:53.916 A:middle
Those of you familiar with

00:03:53.916 --> 00:03:55.546 A:middle
SiriKit will recognize the

00:03:55.546 --> 00:03:57.266 A:middle
INInteraction API, which is also

00:03:57.266 --> 00:03:58.796 A:middle
used for shortcut donations.

00:03:58.796 --> 00:04:00.756 A:middle
So when a user views a

00:03:58.796 --> 00:04:00.756 A:middle
So when a user views a

00:04:00.756 --> 00:04:02.556 A:middle
reservation inside your app,

00:04:02.776 --> 00:04:05.016 A:middle
your app creates an interaction

00:04:05.016 --> 00:04:06.116 A:middle
and donate to the system.

00:04:07.016 --> 00:04:08.416 A:middle
Interactions are made up of an

00:04:08.416 --> 00:04:09.766 A:middle
intent, an intent response,

00:04:10.156 --> 00:04:11.436 A:middle
which together represent a full

00:04:11.436 --> 00:04:13.406 A:middle
user interaction.

00:04:15.056 --> 00:04:16.146 A:middle
Now, this year, we're

00:04:16.146 --> 00:04:17.146 A:middle
introducing the new

00:04:17.286 --> 00:04:18.946 A:middle
INGetReservationDetailsIntent,

00:04:19.185 --> 00:04:20.856 A:middle
an intent response that are

00:04:20.856 --> 00:04:22.996 A:middle
intended to capture details that

00:04:23.026 --> 00:04:24.636 A:middle
pertain to user's reservations.

00:04:25.016 --> 00:04:26.646 A:middle
This provides a way for your app

00:04:27.066 --> 00:04:28.076 A:middle
to share those details with

00:04:28.076 --> 00:04:28.376 A:middle
Siri.

00:04:28.916 --> 00:04:31.036 A:middle
Now, the intent response takes a

00:04:31.036 --> 00:04:32.626 A:middle
list of INReservation objects,

00:04:32.626 --> 00:04:34.506 A:middle
as we just saw previously, which

00:04:34.506 --> 00:04:35.486 A:middle
represent your specific

00:04:35.486 --> 00:04:36.146 A:middle
reservations.

00:04:36.736 --> 00:04:38.416 A:middle
So here, for example, we are

00:04:38.416 --> 00:04:40.106 A:middle
creating an INLodgingReservation

00:04:40.106 --> 00:04:41.306 A:middle
and attaching it to the intent

00:04:41.306 --> 00:04:42.756 A:middle
response to represent the

00:04:42.756 --> 00:04:43.876 A:middle
details of a hotel state.

00:04:43.876 --> 00:04:46.446 A:middle
Now, all that is left for you is

00:04:46.446 --> 00:04:47.966 A:middle
to donate that interaction to

00:04:47.966 --> 00:04:50.076 A:middle
the system, so that Siri can use

00:04:50.076 --> 00:04:51.566 A:middle
it in places like Siri event

00:04:51.566 --> 00:04:53.366 A:middle
suggestions, or Siri shortcuts,

00:04:53.366 --> 00:04:54.056 A:middle
for example.

00:04:55.266 --> 00:04:57.226 A:middle
Okay, now, let's move on and

00:04:57.226 --> 00:04:58.686 A:middle
talk about the three easy steps

00:04:58.986 --> 00:05:00.756 A:middle
that your app should follow to

00:04:58.986 --> 00:05:00.756 A:middle
that your app should follow to

00:05:00.756 --> 00:05:02.166 A:middle
take advantage of all these

00:05:02.166 --> 00:05:02.766 A:middle
great features.

00:05:03.546 --> 00:05:05.396 A:middle
And first, we will talk about

00:05:05.396 --> 00:05:06.776 A:middle
how to create and donate good

00:05:06.776 --> 00:05:07.636 A:middle
interactions.

00:05:08.486 --> 00:05:10.116 A:middle
Next, we will look into how to

00:05:10.116 --> 00:05:11.556 A:middle
adopt the new reservation

00:05:11.556 --> 00:05:13.306 A:middle
actions API, so your app can

00:05:13.306 --> 00:05:14.666 A:middle
benefit from the new check-in

00:05:14.666 --> 00:05:15.386 A:middle
shortcut feature.

00:05:16.296 --> 00:05:17.846 A:middle
And finally, your app may be

00:05:17.846 --> 00:05:18.946 A:middle
launched with a reservation that

00:05:18.946 --> 00:05:20.006 A:middle
you previously donated.

00:05:20.696 --> 00:05:22.146 A:middle
So we will talk about various

00:05:22.146 --> 00:05:23.326 A:middle
launch scenarios that you should

00:05:23.326 --> 00:05:24.026 A:middle
handle.

00:05:24.986 --> 00:05:26.736 A:middle
And now, I'd like to invite my

00:05:26.736 --> 00:05:28.366 A:middle
colleague, Magnus, up to tell us

00:05:28.366 --> 00:05:29.026 A:middle
all about the API.

00:05:29.026 --> 00:05:29.886 A:middle
Magnus?

00:05:30.516 --> 00:05:34.286 A:middle
[ Cheers and Applause ]

00:05:34.786 --> 00:05:36.186 A:middle
&gt;&gt; Thank you, Sofiane.

00:05:36.796 --> 00:05:37.636 A:middle
Hey, everyone.

00:05:37.916 --> 00:05:38.846 A:middle
My name is Magnus.

00:05:39.446 --> 00:05:40.786 A:middle
I'm excited to be here today to

00:05:40.786 --> 00:05:42.416 A:middle
talk to you about Siri event

00:05:42.416 --> 00:05:43.136 A:middle
suggestions.

00:05:44.256 --> 00:05:45.766 A:middle
First, I'll show you a demo of

00:05:45.766 --> 00:05:47.666 A:middle
how to use the API, and then we

00:05:47.666 --> 00:05:48.626 A:middle
will talk a little bit about the

00:05:48.666 --> 00:05:49.766 A:middle
details later on.

00:05:50.596 --> 00:05:55.426 A:middle
Let's jump into the demo.

00:05:55.616 --> 00:05:56.636 A:middle
So, I'm working on this flight

00:05:56.636 --> 00:05:58.036 A:middle
app called My Flights.

00:05:58.746 --> 00:06:00.046 A:middle
Let's open it, and see what it

00:05:58.746 --> 00:06:00.046 A:middle
Let's open it, and see what it

00:06:00.126 --> 00:06:01.046 A:middle
looks like.

00:06:02.016 --> 00:06:03.696 A:middle
So it displays a list of all my

00:06:03.746 --> 00:06:04.676 A:middle
flight reservations.

00:06:05.716 --> 00:06:07.336 A:middle
If I tap one, I can see more

00:06:07.336 --> 00:06:08.706 A:middle
details about the reservation.

00:06:09.166 --> 00:06:11.646 A:middle
I want to take advantage of the

00:06:11.646 --> 00:06:13.106 A:middle
Siri event suggestions API, and

00:06:13.386 --> 00:06:14.786 A:middle
donate the reservation details

00:06:14.786 --> 00:06:15.746 A:middle
when it is displayed to the

00:06:15.746 --> 00:06:15.956 A:middle
user.

00:06:18.616 --> 00:06:21.996 A:middle
Let's switch over to Xcode.

00:06:22.136 --> 00:06:23.706 A:middle
Now, my app consists of some

00:06:23.706 --> 00:06:25.246 A:middle
view controllers and a server,

00:06:25.246 --> 00:06:26.276 A:middle
where I get my reservation

00:06:26.276 --> 00:06:27.116 A:middle
details from.

00:06:27.776 --> 00:06:28.566 A:middle
Since I want to donate the

00:06:28.566 --> 00:06:30.546 A:middle
reservation details when they're

00:06:30.546 --> 00:06:31.926 A:middle
displayed to the user, let's

00:06:31.926 --> 00:06:32.496 A:middle
take a look at my

00:06:32.496 --> 00:06:33.466 A:middle
ReservationDetails

00:06:33.466 --> 00:06:34.066 A:middle
ViewController.

00:06:34.616 --> 00:06:38.446 A:middle
The view controller gets the

00:06:38.446 --> 00:06:39.746 A:middle
reservations from the server.

00:06:39.746 --> 00:06:42.096 A:middle
For the purposes of this demo,

00:06:42.176 --> 00:06:43.546 A:middle
the server returns

00:06:43.546 --> 00:06:45.216 A:middle
INReservations SiriKit objects.

00:06:46.446 --> 00:06:47.416 A:middle
I started doing some work on

00:06:47.416 --> 00:06:48.636 A:middle
this already, but there is still

00:06:48.636 --> 00:06:49.776 A:middle
some missing code here, marked

00:06:49.776 --> 00:06:50.486 A:middle
by to-dos.

00:06:50.986 --> 00:06:53.686 A:middle
Let's go to the server, and see

00:06:53.686 --> 00:06:55.286 A:middle
what makes up the INReservation

00:06:55.286 --> 00:06:55.606 A:middle
object.

00:06:59.136 --> 00:07:00.456 A:middle
In my server code, I have a

00:06:59.136 --> 00:07:00.456 A:middle
In my server code, I have a

00:07:00.456 --> 00:07:01.066 A:middle
method called

00:07:01.066 --> 00:07:02.696 A:middle
createFlightReservation, to

00:07:02.696 --> 00:07:04.086 A:middle
create and save the reservation

00:07:04.306 --> 00:07:05.506 A:middle
so I can access it from my view

00:07:05.506 --> 00:07:05.946 A:middle
controller.

00:07:07.386 --> 00:07:07.946 A:middle
I'll create the

00:07:07.946 --> 00:07:08.976 A:middle
INFlightReservation object here.

00:07:17.046 --> 00:07:18.106 A:middle
Now, this method creates an

00:07:18.106 --> 00:07:19.206 A:middle
INFlightReservation object.

00:07:19.856 --> 00:07:21.116 A:middle
This object contains all the

00:07:21.116 --> 00:07:22.506 A:middle
reservation details about the

00:07:22.536 --> 00:07:22.766 A:middle
flight.

00:07:23.466 --> 00:07:25.636 A:middle
Let's take a look at some of the

00:07:25.636 --> 00:07:26.096 A:middle
properties.

00:07:26.756 --> 00:07:31.116 A:middle
First up is the itemReference.

00:07:31.966 --> 00:07:33.646 A:middle
This is a unique identifier for

00:07:33.646 --> 00:07:34.546 A:middle
this reservation item.

00:07:34.646 --> 00:07:36.576 A:middle
It will be used when the system

00:07:36.576 --> 00:07:38.426 A:middle
launches my app to tell it which

00:07:38.426 --> 00:07:39.746 A:middle
specific reservation item to

00:07:39.746 --> 00:07:39.976 A:middle
show.

00:07:41.756 --> 00:07:43.506 A:middle
In my app, the reservationNumber

00:07:43.506 --> 00:07:44.546 A:middle
is unique for this flight.

00:07:44.546 --> 00:07:46.076 A:middle
So I will use that for the

00:07:46.076 --> 00:07:47.546 A:middle
vocabulary identifier.

00:07:47.546 --> 00:07:50.846 A:middle
I also said a spoken phrase that

00:07:51.166 --> 00:07:52.376 A:middle
can be displayed to the user.

00:07:53.466 --> 00:07:55.886 A:middle
I'm using Flight XX815, which is

00:07:55.886 --> 00:07:57.626 A:middle
short, and descriptive.

00:08:00.596 --> 00:08:02.046 A:middle
Here are some common properties

00:08:03.336 --> 00:08:04.496 A:middle
that are shared among all

00:08:04.496 --> 00:08:05.456 A:middle
reservation types.

00:08:05.856 --> 00:08:07.146 A:middle
Like the reservationNumber, and

00:08:07.146 --> 00:08:07.686 A:middle
the name of the

00:08:07.686 --> 00:08:08.506 A:middle
reservationHolder.

00:08:12.136 --> 00:08:13.206 A:middle
We also want to capture

00:08:13.206 --> 00:08:14.426 A:middle
information about the flight.

00:08:15.656 --> 00:08:16.916 A:middle
It's created here in a separate

00:08:16.916 --> 00:08:18.086 A:middle
method called createFlight.

00:08:18.886 --> 00:08:19.446 A:middle
Let's jump to the

00:08:19.446 --> 00:08:19.976 A:middle
implementation.

00:08:28.046 --> 00:08:29.726 A:middle
Here, I'm creating an INFlight

00:08:29.726 --> 00:08:30.176 A:middle
object.

00:08:30.826 --> 00:08:32.166 A:middle
This represents all the details

00:08:32.166 --> 00:08:33.716 A:middle
about the flight, such as the

00:08:33.716 --> 00:08:35.306 A:middle
flight number, the airline,

00:08:35.936 --> 00:08:36.996 A:middle
along with the information about

00:08:36.996 --> 00:08:37.946 A:middle
departure and arrival.

00:08:37.946 --> 00:08:40.756 A:middle
I still have some to-dos here,

00:08:41.135 --> 00:08:42.246 A:middle
so let's go ahead and fix that

00:08:42.506 --> 00:08:43.966 A:middle
starting with the airline and

00:08:43.966 --> 00:08:44.976 A:middle
airport information.

00:08:54.046 --> 00:08:54.946 A:middle
These objects represent the

00:08:54.946 --> 00:08:56.386 A:middle
airline, and information about

00:08:56.386 --> 00:08:57.486 A:middle
the flight departure and

00:08:57.486 --> 00:08:57.866 A:middle
arrival.

00:08:58.866 --> 00:09:00.156 A:middle
In this case, the flight is from

00:08:58.866 --> 00:09:00.156 A:middle
In this case, the flight is from

00:09:00.156 --> 00:09:01.656 A:middle
San Francisco to Paris.

00:09:03.226 --> 00:09:04.676 A:middle
Both airlines and airports are

00:09:04.676 --> 00:09:06.206 A:middle
identified using either an IATA

00:09:06.246 --> 00:09:07.456 A:middle
or ICAO code.

00:09:08.456 --> 00:09:10.086 A:middle
For airports, this is also used

00:09:11.016 --> 00:09:12.246 A:middle
to determine the physical

00:09:12.246 --> 00:09:13.406 A:middle
location of the airport.

00:09:14.016 --> 00:09:17.396 A:middle
I'm adding gate and terminal

00:09:17.396 --> 00:09:19.346 A:middle
information for departure, since

00:09:19.346 --> 00:09:20.616 A:middle
it's already known at this time.

00:09:21.586 --> 00:09:22.426 A:middle
I don't know the gate

00:09:22.426 --> 00:09:23.726 A:middle
information for the arrival, so

00:09:23.726 --> 00:09:24.616 A:middle
I set that nil.

00:09:29.056 --> 00:09:30.696 A:middle
Next, I also need to specify the

00:09:30.696 --> 00:09:31.596 A:middle
departure and arrival time for

00:09:31.596 --> 00:09:31.976 A:middle
my flight.

00:09:37.276 --> 00:09:38.176 A:middle
We are using the

00:09:38.176 --> 00:09:39.786 A:middle
INDateComponentsRangeClass to

00:09:39.786 --> 00:09:40.976 A:middle
represent the departure and

00:09:40.976 --> 00:09:41.586 A:middle
arrival time.

00:09:41.586 --> 00:09:43.876 A:middle
For the best user experience,

00:09:44.586 --> 00:09:45.786 A:middle
I'm also setting the local time

00:09:45.786 --> 00:09:48.136 A:middle
zone, sorry, I'm also setting

00:09:48.136 --> 00:09:49.936 A:middle
the local time zone for the

00:09:49.936 --> 00:09:51.576 A:middle
departure and arrival airports.

00:09:52.116 --> 00:09:54.736 A:middle
Okay. So we set all the

00:09:54.736 --> 00:09:56.496 A:middle
information we need to represent

00:09:56.496 --> 00:09:56.816 A:middle
the flight.

00:09:57.616 --> 00:09:58.896 A:middle
Let's go back and look at the

00:09:58.966 --> 00:09:59.976 A:middle
rest of the reservation.

00:10:07.316 --> 00:10:08.746 A:middle
I want to provide my users with

00:10:08.746 --> 00:10:10.616 A:middle
a great check-in experience, so

00:10:10.616 --> 00:10:12.436 A:middle
I want to take advantage of the

00:10:12.436 --> 00:10:13.316 A:middle
new check-in shortcut.

00:10:14.606 --> 00:10:16.766 A:middle
To do that, I need to create a

00:10:16.766 --> 00:10:17.496 A:middle
check-in action.

00:10:18.316 --> 00:10:19.026 A:middle
Let's jump to my

00:10:19.026 --> 00:10:19.976 A:middle
createCheckInAction method.

00:10:27.386 --> 00:10:28.506 A:middle
This method creates an

00:10:28.506 --> 00:10:30.566 A:middle
INReservation action, which

00:10:30.566 --> 00:10:32.266 A:middle
consists of a type, a valid

00:10:32.266 --> 00:10:33.876 A:middle
duration, and a user activity.

00:10:35.276 --> 00:10:36.446 A:middle
In my case, the type is

00:10:36.446 --> 00:10:38.606 A:middle
Check-In, and the valid duration

00:10:38.606 --> 00:10:40.586 A:middle
is the time when the user can

00:10:40.586 --> 00:10:41.276 A:middle
check-in online.

00:10:41.876 --> 00:10:44.126 A:middle
During this time, the user

00:10:44.126 --> 00:10:46.136 A:middle
activity I specify will be

00:10:46.136 --> 00:10:47.326 A:middle
displayed as a suggested

00:10:47.326 --> 00:10:47.706 A:middle
shortcut.

00:10:50.016 --> 00:10:50.556 A:middle
I'll start by creating the

00:10:50.556 --> 00:10:50.966 A:middle
NSUserActivity.

00:11:03.046 --> 00:11:04.366 A:middle
I'm creating the NSUserActivity

00:11:04.366 --> 00:11:05.876 A:middle
with an activityType that lets

00:11:05.876 --> 00:11:07.466 A:middle
my app know that this is a

00:11:07.466 --> 00:11:09.076 A:middle
check-in activity when it is

00:11:09.546 --> 00:11:09.706 A:middle
launched.

00:11:10.496 --> 00:11:12.586 A:middle
I set the title to Check-In for

00:11:12.586 --> 00:11:13.456 A:middle
Flight XX815.

00:11:13.516 --> 00:11:16.366 A:middle
This is displayed to the user in

00:11:16.366 --> 00:11:17.936 A:middle
the shortcut, so make sure it's

00:11:17.936 --> 00:11:22.536 A:middle
short and descriptive.

00:11:22.536 --> 00:11:24.186 A:middle
Next, I'm adding the details I

00:11:24.186 --> 00:11:25.756 A:middle
need to know to start the

00:11:25.756 --> 00:11:27.156 A:middle
check-in process when my app is

00:11:27.156 --> 00:11:27.556 A:middle
launched.

00:11:27.986 --> 00:11:29.496 A:middle
I add them to both the user info

00:11:29.496 --> 00:11:30.796 A:middle
under requiredUserInfoKeys

00:11:30.796 --> 00:11:31.436 A:middle
properties.

00:11:34.956 --> 00:11:37.026 A:middle
I also add a webpage URL value.

00:11:38.306 --> 00:11:39.856 A:middle
So the check-in process can be

00:11:39.856 --> 00:11:41.086 A:middle
used even if my app is not

00:11:41.086 --> 00:11:41.676 A:middle
installed.

00:11:43.116 --> 00:11:44.256 A:middle
So I'm pretty happy with this

00:11:44.256 --> 00:11:46.016 A:middle
user activity, but I also need

00:11:46.016 --> 00:11:46.976 A:middle
to specify the valid duration.

00:11:53.626 --> 00:11:54.866 A:middle
We're using EndDateComponents

00:11:54.866 --> 00:11:55.526 A:middle
range again here.

00:11:56.116 --> 00:11:57.596 A:middle
This time, to represent a start

00:11:57.596 --> 00:11:58.926 A:middle
and end time for the valid

00:11:58.926 --> 00:11:59.346 A:middle
duration.

00:12:00.306 --> 00:12:02.526 A:middle
In this case check-in starts 24

00:12:02.526 --> 00:12:04.466 A:middle
hours before departure, and ends

00:12:04.466 --> 00:12:06.356 A:middle
one hour before departure, so

00:12:06.356 --> 00:12:07.526 A:middle
that will be my valid duration.

00:12:08.066 --> 00:12:10.336 A:middle
That's really all we need to

00:12:10.336 --> 00:12:11.076 A:middle
create the great check-in

00:12:11.076 --> 00:12:11.726 A:middle
shortcut.

00:12:12.226 --> 00:12:13.856 A:middle
Let's go back and summarize what

00:12:13.856 --> 00:12:14.926 A:middle
the reservation we created.

00:12:21.046 --> 00:12:22.126 A:middle
Now, we have all the information

00:12:22.126 --> 00:12:23.126 A:middle
we need including the

00:12:23.126 --> 00:12:24.996 A:middle
reservation details, the flight

00:12:24.996 --> 00:12:26.536 A:middle
information, and the check-in

00:12:26.536 --> 00:12:26.936 A:middle
action.

00:12:28.016 --> 00:12:28.916 A:middle
Let's go back to the

00:12:28.916 --> 00:12:29.816 A:middle
ReservationDetails

00:12:30.616 --> 00:12:32.626 A:middle
ViewController, to add the

00:12:32.626 --> 00:12:33.946 A:middle
donation code.

00:12:34.836 --> 00:12:36.456 A:middle
So, our view controller already

00:12:36.456 --> 00:12:37.626 A:middle
knows about the reservation we

00:12:37.626 --> 00:12:38.266 A:middle
just created.

00:12:38.916 --> 00:12:40.716 A:middle
I set up a method here to donate

00:12:40.716 --> 00:12:41.346 A:middle
the reservation.

00:12:42.156 --> 00:12:42.976 A:middle
So let's add the donation code.

00:12:56.056 --> 00:12:57.486 A:middle
Let me just remove the

00:12:57.486 --> 00:12:58.526 A:middle
navigator, so you can see

00:12:58.526 --> 00:12:58.806 A:middle
better.

00:12:59.466 --> 00:13:03.036 A:middle
So I'm starting by creating the

00:12:59.466 --> 00:13:03.036 A:middle
So I'm starting by creating the

00:13:03.036 --> 00:13:03.386 A:middle
intent.

00:13:04.116 --> 00:13:05.616 A:middle
The intent tells Siri which

00:13:05.616 --> 00:13:07.006 A:middle
reservation was displayed to the

00:13:07.006 --> 00:13:07.396 A:middle
user.

00:13:08.516 --> 00:13:10.326 A:middle
It takes two parameters, the

00:13:10.326 --> 00:13:11.696 A:middle
ContainerReference, and the

00:13:11.696 --> 00:13:12.356 A:middle
ItemReference.

00:13:13.596 --> 00:13:14.876 A:middle
The ContainerReference uniquely

00:13:14.876 --> 00:13:16.586 A:middle
identifies the reservation as a

00:13:16.586 --> 00:13:16.976 A:middle
whole.

00:13:18.086 --> 00:13:19.176 A:middle
In this case, I only have a

00:13:19.176 --> 00:13:20.906 A:middle
single reservation item, the

00:13:20.906 --> 00:13:21.156 A:middle
flight.

00:13:21.156 --> 00:13:23.486 A:middle
So I will use the ItemReference

00:13:23.486 --> 00:13:25.376 A:middle
I set on the ReservationItem, as

00:13:25.376 --> 00:13:26.366 A:middle
the ContainerReference.

00:13:27.486 --> 00:13:28.206 A:middle
If I have multiple

00:13:28.206 --> 00:13:30.316 A:middle
ReservationItems, such as a

00:13:30.316 --> 00:13:32.236 A:middle
hotel and a flight, I would

00:13:32.236 --> 00:13:33.636 A:middle
create a new ContainerReference

00:13:33.916 --> 00:13:36.566 A:middle
to represent that reservation as

00:13:36.566 --> 00:13:37.046 A:middle
a whole.

00:13:39.226 --> 00:13:39.546 A:middle
I'll set the

00:13:39.546 --> 00:13:40.686 A:middle
ReservationItemReference as

00:13:40.686 --> 00:13:41.536 A:middle
property to nil.

00:13:42.326 --> 00:13:44.246 A:middle
This is populated by the system

00:13:44.246 --> 00:13:45.646 A:middle
when launching my app.

00:13:48.176 --> 00:13:49.986 A:middle
In addition to the Intent, I

00:13:49.986 --> 00:13:51.606 A:middle
also specify an intentResponse,

00:13:51.786 --> 00:13:53.076 A:middle
and add my reservation to it.

00:13:53.976 --> 00:13:55.386 A:middle
This informs Siri about what

00:13:55.386 --> 00:13:57.446 A:middle
reservation details I display to

00:13:57.996 --> 00:13:58.856 A:middle
the user.

00:13:58.996 --> 00:14:00.856 A:middle
Finally, I'll add the intent and

00:13:58.996 --> 00:14:00.856 A:middle
Finally, I'll add the intent and

00:14:00.856 --> 00:14:02.076 A:middle
intentResponse to an

00:14:02.166 --> 00:14:03.936 A:middle
INInteraction, and donate that

00:14:03.936 --> 00:14:04.586 A:middle
to the system.

00:14:05.166 --> 00:14:07.296 A:middle
So, now we've written all the

00:14:07.296 --> 00:14:08.566 A:middle
code we need to donate this

00:14:08.566 --> 00:14:10.046 A:middle
reservation, but there is one

00:14:10.046 --> 00:14:10.876 A:middle
more thing we need to check

00:14:11.126 --> 00:14:11.976 A:middle
before we can launch the app.

00:14:18.266 --> 00:14:19.106 A:middle
I need to add

00:14:19.106 --> 00:14:20.656 A:middle
INGetReservationDetailsIntent,

00:14:20.656 --> 00:14:22.466 A:middle
and my custom CheckInActivity to

00:14:22.466 --> 00:14:23.816 A:middle
the list of supported activity

00:14:23.816 --> 00:14:25.276 A:middle
types in my info.plist.

00:14:26.116 --> 00:14:27.616 A:middle
Luckily, I already did this

00:14:27.616 --> 00:14:28.936 A:middle
earlier, so we're good to go.

00:14:34.156 --> 00:14:35.786 A:middle
First, let's recap.

00:14:37.066 --> 00:14:38.406 A:middle
We created and donated an

00:14:38.496 --> 00:14:39.846 A:middle
INFlightReservation that

00:14:39.846 --> 00:14:41.076 A:middle
contains all the information

00:14:41.326 --> 00:14:42.226 A:middle
about the reservation.

00:14:43.666 --> 00:14:44.676 A:middle
Now, Siri knows about the

00:14:44.676 --> 00:14:46.436 A:middle
reservation, and can provide

00:14:46.436 --> 00:14:48.396 A:middle
proactive suggestions throughout

00:14:49.096 --> 00:14:49.986 A:middle
the system.

00:14:50.126 --> 00:14:51.486 A:middle
We also added an INReservation

00:14:51.486 --> 00:14:52.886 A:middle
action, to provide a great

00:14:52.886 --> 00:14:54.136 A:middle
check-in experience, with a

00:14:54.136 --> 00:14:55.646 A:middle
shortcut that is displayed to

00:14:55.646 --> 00:14:57.206 A:middle
the user, and takes them

00:14:57.206 --> 00:14:58.636 A:middle
directly into the check-in flow

00:14:58.636 --> 00:14:59.326 A:middle
at the right time.

00:15:00.676 --> 00:15:02.316 A:middle
Let's see this in action.

00:15:06.266 --> 00:15:07.226 A:middle
So, I'm back in my app.

00:15:07.636 --> 00:15:08.806 A:middle
Let's view the flight to Paris

00:15:08.806 --> 00:15:10.356 A:middle
reservation like we did before.

00:15:10.356 --> 00:15:14.156 A:middle
When I view the reservation this

00:15:14.156 --> 00:15:15.676 A:middle
time, I see a notification

00:15:16.296 --> 00:15:17.326 A:middle
telling me Siri found an event

00:15:17.326 --> 00:15:17.976 A:middle
and put it in my calendar.

00:15:18.016 --> 00:15:19.766 A:middle
[ Applause ]

00:15:19.766 --> 00:15:19.976 A:middle
Thank you.

00:15:20.516 --> 00:15:22.846 A:middle
[ Applause ]

00:15:23.346 --> 00:15:24.656 A:middle
I'll tap the notification and

00:15:24.656 --> 00:15:26.086 A:middle
see what it looks like.

00:15:27.346 --> 00:15:28.896 A:middle
So, as we can see, Siri used the

00:15:28.896 --> 00:15:30.916 A:middle
information I donated to create

00:15:30.916 --> 00:15:32.396 A:middle
an event in My Siri Suggestions

00:15:32.396 --> 00:15:32.836 A:middle
Calendar.

00:15:32.836 --> 00:15:35.326 A:middle
Now, there is also a link back

00:15:35.326 --> 00:15:35.896 A:middle
to my app.

00:15:37.086 --> 00:15:38.786 A:middle
When I tap it, I am brought

00:15:38.786 --> 00:15:40.196 A:middle
right back into my app.

00:15:40.566 --> 00:15:41.156 A:middle
So that's great.

00:15:42.056 --> 00:15:43.206 A:middle
However, I don't see the

00:15:43.206 --> 00:15:44.616 A:middle
reservation details about the

00:15:44.616 --> 00:15:45.396 A:middle
event that I was viewing in

00:15:45.396 --> 00:15:47.216 A:middle
Calendar, and I think we can do

00:15:47.216 --> 00:15:47.516 A:middle
better.

00:15:47.956 --> 00:15:49.416 A:middle
Let's go back to Xcode and see

00:15:49.416 --> 00:15:53.886 A:middle
how to implement app launch.

00:15:54.076 --> 00:15:55.556 A:middle
To handle app launch, I'm going

00:15:55.746 --> 00:15:59.006 A:middle
to go to my AppDelegate.

00:15:59.006 --> 00:16:00.426 A:middle
When Siri launches my app, it's

00:15:59.006 --> 00:16:00.426 A:middle
When Siri launches my app, it's

00:16:00.426 --> 00:16:01.596 A:middle
going to be launched using an

00:16:01.596 --> 00:16:02.486 A:middle
NSUserActivity.

00:16:02.706 --> 00:16:03.646 A:middle
So I need to implement the

00:16:03.646 --> 00:16:04.306 A:middle
application

00:16:04.306 --> 00:16:05.996 A:middle
ContinueUserActivity, Delegate

00:16:05.996 --> 00:16:06.316 A:middle
Method.

00:16:10.356 --> 00:16:11.566 A:middle
I'm adding support for two

00:16:11.566 --> 00:16:12.516 A:middle
activity types here.

00:16:13.266 --> 00:16:14.396 A:middle
The first is the

00:16:14.396 --> 00:16:15.846 A:middle
INGetReservationDetailsIntent.

00:16:16.856 --> 00:16:18.526 A:middle
This activity type indicates

00:16:18.586 --> 00:16:19.596 A:middle
that a user wanted to see

00:16:19.876 --> 00:16:21.096 A:middle
details about a specific

00:16:21.096 --> 00:16:22.276 A:middle
reservation in my app.

00:16:22.916 --> 00:16:24.296 A:middle
I'll call my

00:16:24.296 --> 00:16:25.846 A:middle
handleShowReservation method,

00:16:26.246 --> 00:16:27.286 A:middle
which will display the relevant

00:16:27.286 --> 00:16:27.976 A:middle
reservation to the user.

00:16:35.316 --> 00:16:37.876 A:middle
The second one is the activity

00:16:37.876 --> 00:16:39.116 A:middle
type I define for the check-in

00:16:39.116 --> 00:16:39.636 A:middle
shortcut.

00:16:40.236 --> 00:16:41.576 A:middle
This is used when the user taps

00:16:41.576 --> 00:16:42.906 A:middle
the check-in shortcut on the

00:16:42.906 --> 00:16:44.196 A:middle
lock screen or in search.

00:16:44.746 --> 00:16:46.876 A:middle
I'll call my handleCheckIn

00:16:46.876 --> 00:16:48.136 A:middle
method when this happens, to

00:16:48.136 --> 00:16:49.366 A:middle
start the check-in process.

00:16:51.586 --> 00:16:53.056 A:middle
So, now handling both cases,

00:16:53.606 --> 00:16:54.826 A:middle
let's launch the app and see

00:16:54.826 --> 00:16:55.976 A:middle
this in action.

00:17:02.066 --> 00:17:04.046 A:middle
First, let's go back to

00:17:04.046 --> 00:17:06.026 A:middle
Calendar, and tap the show in My

00:17:06.026 --> 00:17:06.986 A:middle
Flights button again.

00:17:07.576 --> 00:17:10.896 A:middle
As you can see, my app now

00:17:10.896 --> 00:17:12.076 A:middle
launches directly into the

00:17:12.076 --> 00:17:13.226 A:middle
reservation details for this

00:17:13.226 --> 00:17:13.536 A:middle
event.

00:17:14.096 --> 00:17:15.246 A:middle
Now, this is a much better user

00:17:15.246 --> 00:17:15.856 A:middle
experience.

00:17:16.516 --> 00:17:20.786 A:middle
[ Applause ]

00:17:21.286 --> 00:17:22.386 A:middle
I also added support for the

00:17:22.386 --> 00:17:24.626 A:middle
check-in shortcut, and my flight

00:17:24.626 --> 00:17:26.876 A:middle
leaves tomorrow at 2:50 PM, so

00:17:26.876 --> 00:17:28.205 A:middle
check-in should already be open.

00:17:29.406 --> 00:17:30.306 A:middle
Let's see how that works.

00:17:31.756 --> 00:17:32.756 A:middle
Now, the check-in shortcut

00:17:32.756 --> 00:17:34.136 A:middle
appears both on the lock screen

00:17:34.646 --> 00:17:35.386 A:middle
and in the Search UI.

00:17:35.386 --> 00:17:38.246 A:middle
When I tap it, I'm launched

00:17:38.246 --> 00:17:39.706 A:middle
directly into the check-in flow

00:17:39.706 --> 00:17:40.126 A:middle
of my app.

00:17:40.126 --> 00:17:40.956 A:middle
That's pretty awesome.

00:17:41.516 --> 00:17:47.416 A:middle
[ Applause ]

00:17:47.916 --> 00:17:48.936 A:middle
So let's recap.

00:17:49.746 --> 00:17:51.136 A:middle
We created and donated a

00:17:51.136 --> 00:17:51.746 A:middle
reservation.

00:17:53.106 --> 00:17:54.496 A:middle
We provided a check-in action,

00:17:55.546 --> 00:17:56.866 A:middle
and we made sure to handle app

00:17:56.866 --> 00:17:57.136 A:middle
launch.

00:17:58.646 --> 00:17:59.686 A:middle
This is how we see it, is to

00:17:59.686 --> 00:18:01.206 A:middle
take advantage of the Siri Event

00:17:59.686 --> 00:18:01.206 A:middle
take advantage of the Siri Event

00:18:01.206 --> 00:18:03.026 A:middle
Suggestions API, to provide deep

00:18:03.026 --> 00:18:04.806 A:middle
system integration and the great

00:18:04.806 --> 00:18:05.766 A:middle
user experience.

00:18:06.446 --> 00:18:07.776 A:middle
Now, I would like to tell you

00:18:07.776 --> 00:18:11.366 A:middle
more about the API.

00:18:11.606 --> 00:18:12.986 A:middle
We'll begin with Donations, and

00:18:12.986 --> 00:18:14.126 A:middle
talk about how Siri used the

00:18:14.126 --> 00:18:16.126 A:middle
information you donate in places

00:18:16.126 --> 00:18:18.356 A:middle
like Shortcut Suggestions, and

00:18:18.356 --> 00:18:18.776 A:middle
Calendar.

00:18:20.486 --> 00:18:22.336 A:middle
As we saw in the demo, your app

00:18:22.336 --> 00:18:23.656 A:middle
is front and center in the

00:18:23.656 --> 00:18:24.486 A:middle
check-in shortcut.

00:18:24.486 --> 00:18:26.596 A:middle
We display your app name and

00:18:26.596 --> 00:18:28.026 A:middle
icon along with the information

00:18:28.026 --> 00:18:28.966 A:middle
about the reservation.

00:18:30.266 --> 00:18:32.046 A:middle
Again, we use the title you set

00:18:32.046 --> 00:18:33.766 A:middle
on the NSUserActivity in the

00:18:33.766 --> 00:18:34.316 A:middle
shortcut.

00:18:34.936 --> 00:18:36.386 A:middle
So, make sure you use a string

00:18:36.386 --> 00:18:37.616 A:middle
that is accurate and

00:18:37.616 --> 00:18:38.826 A:middle
descriptive.

00:18:40.576 --> 00:18:42.026 A:middle
Now, Siri automatically

00:18:42.026 --> 00:18:43.066 A:middle
synchronized the reservation

00:18:43.066 --> 00:18:44.236 A:middle
details across the user's

00:18:44.286 --> 00:18:45.846 A:middle
devices using end-to-end

00:18:45.846 --> 00:18:46.306 A:middle
encryption.

00:18:46.536 --> 00:18:48.136 A:middle
So the user might see the

00:18:48.136 --> 00:18:49.576 A:middle
check-in shortcut on the device

00:18:49.576 --> 00:18:50.716 A:middle
where your app is not installed.

00:18:51.296 --> 00:18:52.616 A:middle
In this case, an iPad.

00:18:54.056 --> 00:18:55.556 A:middle
When this happens, we'll use the

00:18:55.556 --> 00:18:57.486 A:middle
web page URL property you set on

00:18:57.486 --> 00:18:59.476 A:middle
the NSUserActivity to provide a

00:18:59.476 --> 00:19:01.056 A:middle
web base check-in flow using

00:18:59.476 --> 00:19:01.056 A:middle
web base check-in flow using

00:19:01.056 --> 00:19:01.506 A:middle
Safari.

00:19:02.176 --> 00:19:04.236 A:middle
So that is a check-in shortcut.

00:19:04.776 --> 00:19:07.476 A:middle
Let's take a look at Calendar.

00:19:07.566 --> 00:19:09.076 A:middle
Now, first up is the Title.

00:19:10.016 --> 00:19:11.376 A:middle
The title is auto-generated by

00:19:11.376 --> 00:19:13.726 A:middle
Siri using the reservation

00:19:13.726 --> 00:19:14.836 A:middle
details you provided.

00:19:15.846 --> 00:19:17.376 A:middle
As you can see, Siri adds a

00:19:17.376 --> 00:19:19.086 A:middle
localized reservation type to

00:19:19.086 --> 00:19:20.186 A:middle
the title.

00:19:20.696 --> 00:19:22.046 A:middle
Depending on the reservation

00:19:22.046 --> 00:19:23.436 A:middle
type, different parts of the

00:19:23.436 --> 00:19:24.656 A:middle
information may be used to

00:19:24.656 --> 00:19:25.476 A:middle
generate the title.

00:19:26.286 --> 00:19:27.416 A:middle
So make sure you provide all

00:19:27.416 --> 00:19:30.306 A:middle
details as is, and do not

00:19:30.516 --> 00:19:30.956 A:middle
prepend or append anything for display

00:19:30.956 --> 00:19:31.606 A:middle
purposes.

00:19:32.066 --> 00:19:34.646 A:middle
Next is Location.

00:19:35.756 --> 00:19:37.236 A:middle
Location is a key component to

00:19:37.236 --> 00:19:39.106 A:middle
the user experience, and it

00:19:39.376 --> 00:19:41.006 A:middle
drives system integrations such

00:19:41.006 --> 00:19:42.516 A:middle
as a time-to-leave notification

00:19:42.516 --> 00:19:43.606 A:middle
and Maps integration.

00:19:44.666 --> 00:19:46.046 A:middle
For most reservation types,

00:19:46.256 --> 00:19:47.846 A:middle
SiriKit uses the CLPlacemark

00:19:47.846 --> 00:19:49.406 A:middle
class to represent locations.

00:19:50.806 --> 00:19:52.046 A:middle
You can create the CLPlacemark

00:19:52.046 --> 00:19:53.666 A:middle
object yourself, or if your app

00:19:53.666 --> 00:19:55.366 A:middle
uses MapKit, you can get it off

00:19:55.366 --> 00:19:56.116 A:middle
the MapKit item.

00:19:56.486 --> 00:19:59.346 A:middle
If you do create a CLPlacemark

00:19:59.346 --> 00:20:01.106 A:middle
object yourself, be sure to

00:19:59.346 --> 00:20:01.106 A:middle
object yourself, be sure to

00:20:01.106 --> 00:20:02.996 A:middle
include both location and postal

00:20:02.996 --> 00:20:04.986 A:middle
address if you have both.

00:20:05.956 --> 00:20:07.076 A:middle
If you do not know the

00:20:07.076 --> 00:20:09.066 A:middle
coordinates, set them to 00.

00:20:09.746 --> 00:20:11.106 A:middle
This will let Siri know to use

00:20:11.106 --> 00:20:12.216 A:middle
only the postal address.

00:20:12.666 --> 00:20:15.996 A:middle
Next step is the start and end

00:20:15.996 --> 00:20:17.106 A:middle
time of the reservation.

00:20:18.466 --> 00:20:19.916 A:middle
As you can see, the event

00:20:20.306 --> 00:20:22.006 A:middle
displays both the start and end

00:20:22.006 --> 00:20:23.746 A:middle
time using the user's current

00:20:23.746 --> 00:20:25.506 A:middle
time zone, and the time zone of

00:20:25.556 --> 00:20:26.836 A:middle
the reservation.

00:20:27.636 --> 00:20:29.416 A:middle
So, make sure you set the local

00:20:29.416 --> 00:20:31.486 A:middle
time zone for the reservation or

00:20:31.486 --> 00:20:33.176 A:middle
use UTC if you don't have that

00:20:33.176 --> 00:20:35.646 A:middle
available in your app.

00:20:35.916 --> 00:20:37.106 A:middle
Some reservation types have a

00:20:37.106 --> 00:20:38.316 A:middle
clear start and end time.

00:20:39.286 --> 00:20:41.026 A:middle
For instance, for a flight, use

00:20:41.026 --> 00:20:42.836 A:middle
the scheduled departure and the

00:20:42.836 --> 00:20:43.876 A:middle
scheduled arrival time.

00:20:45.146 --> 00:20:46.856 A:middle
For reservations like lodging

00:20:46.856 --> 00:20:49.056 A:middle
and car rental, use the check-in

00:20:49.056 --> 00:20:51.526 A:middle
and check-out time.

00:20:51.736 --> 00:20:52.776 A:middle
If your reservation doesn't have

00:20:52.776 --> 00:20:54.526 A:middle
a specific end time, set at nil,

00:20:55.466 --> 00:20:56.796 A:middle
that way Siri will use the

00:20:56.796 --> 00:20:58.486 A:middle
de-filterization based on the

00:20:58.486 --> 00:20:59.626 A:middle
reservation type.

00:21:00.116 --> 00:21:03.366 A:middle
Next is the Notes section.

00:21:04.086 --> 00:21:05.996 A:middle
Siri uses the Notes section to

00:21:05.996 --> 00:21:07.096 A:middle
populate it with more

00:21:07.096 --> 00:21:08.096 A:middle
information from your

00:21:08.096 --> 00:21:09.586 A:middle
reservation details that might

00:21:09.586 --> 00:21:11.406 A:middle
be useful to the user, such as

00:21:11.406 --> 00:21:12.626 A:middle
the reservation number or

00:21:12.626 --> 00:21:13.496 A:middle
seating information.

00:21:14.706 --> 00:21:15.856 A:middle
Be sure you populate all the

00:21:15.856 --> 00:21:17.096 A:middle
reservation details for which

00:21:17.096 --> 00:21:18.716 A:middle
you have information, as it may

00:21:18.716 --> 00:21:20.356 A:middle
be displayed to the user.

00:21:21.816 --> 00:21:24.166 A:middle
Finally, Siri provides a link

00:21:24.166 --> 00:21:25.596 A:middle
directly from Calendar into your

00:21:25.596 --> 00:21:25.766 A:middle
app.

00:21:26.786 --> 00:21:28.566 A:middle
Tapping on it launches your app,

00:21:28.676 --> 00:21:30.146 A:middle
so it can display more details

00:21:30.416 --> 00:21:31.356 A:middle
about the reservation.

00:21:31.356 --> 00:21:33.776 A:middle
So, let's take a look at what

00:21:33.776 --> 00:21:35.196 A:middle
you need to know to handle this

00:21:35.196 --> 00:21:36.406 A:middle
in your app.

00:21:38.156 --> 00:21:40.316 A:middle
To understand app launch, let's

00:21:40.316 --> 00:21:42.736 A:middle
take a step back and look at

00:21:42.736 --> 00:21:43.696 A:middle
what we're donating.

00:21:44.636 --> 00:21:46.586 A:middle
Earlier in the demo, we donated

00:21:46.586 --> 00:21:47.866 A:middle
a single reservation item.

00:21:48.426 --> 00:21:50.486 A:middle
But let's consider a case when

00:21:50.486 --> 00:21:51.616 A:middle
there are multiple reservation

00:21:51.616 --> 00:21:52.066 A:middle
items.

00:21:52.796 --> 00:21:53.906 A:middle
For instance, a round trip

00:21:53.906 --> 00:21:54.196 A:middle
flight.

00:21:54.916 --> 00:21:57.096 A:middle
In that case, we have two

00:21:57.096 --> 00:21:58.436 A:middle
reservation items that might

00:21:58.436 --> 00:21:59.426 A:middle
share the same reservation

00:21:59.426 --> 00:21:59.776 A:middle
number.

00:22:01.206 --> 00:22:02.876 A:middle
As such, the reservation number

00:22:02.876 --> 00:22:04.466 A:middle
can be used to uniquely identify

00:22:04.466 --> 00:22:07.656 A:middle
a specific reservation item.

00:22:08.046 --> 00:22:09.186 A:middle
For this reason, your app must

00:22:09.256 --> 00:22:10.716 A:middle
always provide an additional

00:22:10.716 --> 00:22:12.356 A:middle
identifier called the

00:22:12.356 --> 00:22:13.086 A:middle
itemReference.

00:22:13.596 --> 00:22:16.346 A:middle
The itemReference must be unique

00:22:16.396 --> 00:22:18.086 A:middle
for every reservation item in

00:22:18.086 --> 00:22:19.326 A:middle
your app.

00:22:19.606 --> 00:22:20.536 A:middle
How you structure the

00:22:20.536 --> 00:22:21.836 A:middle
itemReference is really up to

00:22:21.836 --> 00:22:23.416 A:middle
you, as long as you're able to

00:22:23.416 --> 00:22:24.896 A:middle
reason about which reservation

00:22:24.896 --> 00:22:25.876 A:middle
it belongs to later on.

00:22:27.306 --> 00:22:29.206 A:middle
In this example, we're creating

00:22:29.206 --> 00:22:30.656 A:middle
a reservation item by combining

00:22:30.656 --> 00:22:31.906 A:middle
the shared reservation number

00:22:32.276 --> 00:22:33.716 A:middle
and the specific flight number.

00:22:37.896 --> 00:22:39.526 A:middle
Next, we add the two reservation

00:22:39.526 --> 00:22:40.376 A:middle
items to an

00:22:40.456 --> 00:22:41.906 A:middle
INGetReservationDetailsIntent

00:22:41.906 --> 00:22:43.816 A:middle
response, and to complete our

00:22:43.816 --> 00:22:45.466 A:middle
donation, we also need to create

00:22:45.466 --> 00:22:45.636 A:middle
the

00:22:45.636 --> 00:22:47.186 A:middle
INGetReservationDetailsIntent.

00:22:50.046 --> 00:22:51.606 A:middle
When creating the intent, we

00:22:51.606 --> 00:22:52.856 A:middle
need to tell Siri which

00:22:52.856 --> 00:22:54.236 A:middle
reservation the user was

00:22:54.236 --> 00:22:54.606 A:middle
viewing.

00:22:55.106 --> 00:22:57.166 A:middle
This is represented by the

00:22:57.166 --> 00:22:58.126 A:middle
ContainerReference.

00:22:58.676 --> 00:23:01.186 A:middle
In this example, we're donating

00:22:58.676 --> 00:23:01.186 A:middle
In this example, we're donating

00:23:01.186 --> 00:23:02.806 A:middle
two flights that are part of the

00:23:02.806 --> 00:23:03.776 A:middle
same reservation.

00:23:04.566 --> 00:23:05.136 A:middle
So we are setting the

00:23:05.136 --> 00:23:06.736 A:middle
ContainerReference to the shared

00:23:06.736 --> 00:23:08.436 A:middle
reservation number, since it

00:23:08.436 --> 00:23:09.596 A:middle
uniquely identifies the

00:23:09.596 --> 00:23:10.676 A:middle
reservation as a whole.

00:23:12.616 --> 00:23:13.996 A:middle
Finally, we are setting the

00:23:13.996 --> 00:23:15.766 A:middle
Reservation Item References area

00:23:15.766 --> 00:23:16.186 A:middle
to nil.

00:23:16.856 --> 00:23:18.046 A:middle
This is only used when launching

00:23:18.046 --> 00:23:19.396 A:middle
your app, to let it know which

00:23:19.396 --> 00:23:21.056 A:middle
specific reservation the user

00:23:21.056 --> 00:23:22.406 A:middle
wants to see.

00:23:23.866 --> 00:23:24.756 A:middle
So that's our donation.

00:23:25.306 --> 00:23:27.486 A:middle
Let's take a look at how this

00:23:27.486 --> 00:23:28.836 A:middle
information is used when

00:23:28.836 --> 00:23:30.126 A:middle
launching your app.

00:23:31.676 --> 00:23:33.556 A:middle
When your app is launched to

00:23:33.556 --> 00:23:34.756 A:middle
show reservation details, it

00:23:35.026 --> 00:23:36.016 A:middle
will be launched using an

00:23:36.106 --> 00:23:37.586 A:middle
INGetReservationDetailsIntent.

00:23:39.056 --> 00:23:40.796 A:middle
This represents what reservation

00:23:40.796 --> 00:23:41.976 A:middle
the user wants to see details

00:23:41.976 --> 00:23:42.326 A:middle
about.

00:23:43.216 --> 00:23:45.296 A:middle
In this example, we're launching

00:23:45.296 --> 00:23:46.596 A:middle
the app with an intent saying

00:23:46.596 --> 00:23:47.976 A:middle
the user wants detail about a

00:23:47.976 --> 00:23:49.976 A:middle
reservation identified as B9C8.

00:23:51.666 --> 00:23:52.706 A:middle
If the reservation item

00:23:52.706 --> 00:23:54.306 A:middle
reference array is set to nil,

00:23:54.756 --> 00:23:55.896 A:middle
your app should show a UI

00:23:55.896 --> 00:23:57.376 A:middle
displaying this reservation as a

00:23:57.376 --> 00:23:57.876 A:middle
whole.

00:23:58.816 --> 00:24:00.216 A:middle
In our previous example, that

00:23:58.816 --> 00:24:00.216 A:middle
In our previous example, that

00:24:00.216 --> 00:24:01.466 A:middle
would mean showing both flights.

00:24:02.956 --> 00:24:05.266 A:middle
The user might also want to see

00:24:05.476 --> 00:24:06.596 A:middle
details about a specific

00:24:06.596 --> 00:24:08.456 A:middle
reservation, such as one of the

00:24:08.456 --> 00:24:09.756 A:middle
flights from our previous

00:24:09.756 --> 00:24:10.166 A:middle
example.

00:24:11.426 --> 00:24:13.056 A:middle
In that case, your app will be

00:24:13.056 --> 00:24:14.776 A:middle
launched with a Reservation Item

00:24:14.776 --> 00:24:16.426 A:middle
References Array populated with

00:24:16.426 --> 00:24:17.156 A:middle
a single item.

00:24:18.336 --> 00:24:19.736 A:middle
This will be the item reference

00:24:19.736 --> 00:24:21.236 A:middle
you set on the INReservation

00:24:21.236 --> 00:24:22.546 A:middle
object for this reservation.

00:24:23.906 --> 00:24:24.976 A:middle
In that case, your app should

00:24:24.976 --> 00:24:26.706 A:middle
show a UI displaying details

00:24:26.706 --> 00:24:27.756 A:middle
about only the specific

00:24:27.756 --> 00:24:28.386 A:middle
reservation.

00:24:31.496 --> 00:24:33.066 A:middle
Before launching your app, we

00:24:33.066 --> 00:24:34.096 A:middle
wrap the intent in an

00:24:34.166 --> 00:24:35.956 A:middle
INInteraction and NSUserActivity

00:24:35.956 --> 00:24:36.316 A:middle
object.

00:24:36.936 --> 00:24:38.276 A:middle
With the activity type, set the

00:24:38.276 --> 00:24:40.016 A:middle
name of the Intent and launch

00:24:40.016 --> 00:24:41.646 A:middle
your app using that, like we saw

00:24:41.646 --> 00:24:41.976 A:middle
in the demo.

00:24:45.646 --> 00:24:46.826 A:middle
So, we looked at how Siri uses

00:24:46.826 --> 00:24:47.976 A:middle
the reservation details you

00:24:47.976 --> 00:24:49.576 A:middle
donate, and how that information

00:24:49.576 --> 00:24:51.246 A:middle
is used later on to launch your

00:24:51.956 --> 00:24:52.026 A:middle
app.

00:24:52.656 --> 00:24:54.906 A:middle
But as we know, life happens.

00:24:55.886 --> 00:24:57.136 A:middle
A user might change or even

00:24:57.136 --> 00:24:58.896 A:middle
cancel their reservation, and

00:24:58.896 --> 00:25:00.026 A:middle
that can happen inside or

00:24:58.896 --> 00:25:00.026 A:middle
that can happen inside or

00:25:00.026 --> 00:25:00.696 A:middle
outside your app.

00:25:01.086 --> 00:25:02.556 A:middle
For instance, from a web page.

00:25:03.916 --> 00:25:04.756 A:middle
Let's take a look at how to

00:25:04.756 --> 00:25:06.096 A:middle
handle some of those cases.

00:25:06.576 --> 00:25:09.916 A:middle
First, let's talk about when is

00:25:09.916 --> 00:25:11.146 A:middle
the right time for your app to

00:25:11.146 --> 00:25:11.516 A:middle
donate.

00:25:12.056 --> 00:25:14.746 A:middle
In this example, the user is

00:25:14.746 --> 00:25:15.766 A:middle
looking at details for a

00:25:15.766 --> 00:25:16.736 A:middle
specific reservation.

00:25:17.916 --> 00:25:19.256 A:middle
Now, this is an excellent time

00:25:19.256 --> 00:25:21.116 A:middle
for your app to donate, because

00:25:21.116 --> 00:25:23.016 A:middle
like we saw earlier in the demo,

00:25:23.076 --> 00:25:24.256 A:middle
we might show a notification to

00:25:24.256 --> 00:25:24.776 A:middle
the user.

00:25:26.056 --> 00:25:27.736 A:middle
Seeing the notification and the

00:25:27.736 --> 00:25:29.216 A:middle
reservation details at the same

00:25:29.216 --> 00:25:31.046 A:middle
time provides a great contextual

00:25:31.046 --> 00:25:32.006 A:middle
user experience.

00:25:32.526 --> 00:25:34.996 A:middle
But life also happens when your

00:25:34.996 --> 00:25:37.046 A:middle
app is in the background, and

00:25:37.046 --> 00:25:38.386 A:middle
users should always have up to

00:25:38.386 --> 00:25:39.186 A:middle
date information.

00:25:40.056 --> 00:25:41.636 A:middle
So a new or updated reservation

00:25:41.636 --> 00:25:43.206 A:middle
information becomes available,

00:25:44.276 --> 00:25:45.416 A:middle
donate that from the background.

00:25:46.826 --> 00:25:48.146 A:middle
In that case, we won't show a

00:25:48.146 --> 00:25:49.366 A:middle
notification to the user.

00:25:49.966 --> 00:25:52.446 A:middle
So those are great times for

00:25:52.446 --> 00:25:53.956 A:middle
your app to donate, while there

00:25:53.956 --> 00:25:55.106 A:middle
are some not so great times for

00:25:55.106 --> 00:25:55.726 A:middle
your app to donate.

00:25:56.296 --> 00:25:59.036 A:middle
As we showed earlier in the

00:25:59.036 --> 00:26:01.116 A:middle
demo, your app should not donate

00:25:59.036 --> 00:26:01.116 A:middle
demo, your app should not donate

00:26:01.176 --> 00:26:02.716 A:middle
when showing a list of unrelated

00:26:02.716 --> 00:26:03.516 A:middle
reservations.

00:26:05.176 --> 00:26:06.396 A:middle
Showing a notification at that

00:26:06.396 --> 00:26:08.456 A:middle
point might surprise the user

00:26:08.626 --> 00:26:09.806 A:middle
because of a lack of context.

00:26:10.376 --> 00:26:12.346 A:middle
To provide a seamless

00:26:12.346 --> 00:26:14.016 A:middle
experience, your app should not

00:26:14.016 --> 00:26:15.146 A:middle
provide UI elements that

00:26:15.146 --> 00:26:16.606 A:middle
explicitly donate to Siri.

00:26:17.216 --> 00:26:20.066 A:middle
In this example, the app should

00:26:20.066 --> 00:26:21.246 A:middle
donate when the reservation

00:26:21.246 --> 00:26:22.476 A:middle
details are being displayed.

00:26:22.476 --> 00:26:26.436 A:middle
Next, let's look at some changes

00:26:26.436 --> 00:26:27.726 A:middle
that might happen to the

00:26:27.726 --> 00:26:28.306 A:middle
reservation.

00:26:28.866 --> 00:26:31.736 A:middle
Here, we use the example of a

00:26:31.736 --> 00:26:33.146 A:middle
user selecting a seat for a

00:26:33.146 --> 00:26:33.446 A:middle
flight.

00:26:35.016 --> 00:26:36.256 A:middle
We previously donated this

00:26:36.256 --> 00:26:36.826 A:middle
reservation.

00:26:37.346 --> 00:26:39.626 A:middle
At the time, seating information

00:26:39.626 --> 00:26:41.146 A:middle
was not available, so we set the

00:26:41.146 --> 00:26:42.176 A:middle
seat property to nil.

00:26:43.366 --> 00:26:44.546 A:middle
Now, the user has selected a

00:26:44.546 --> 00:26:46.826 A:middle
seat, so we are going to donate

00:26:46.826 --> 00:26:48.126 A:middle
the updated reservation details

00:26:48.626 --> 00:26:49.696 A:middle
with the seating information

00:26:49.696 --> 00:26:50.066 A:middle
set.

00:26:51.526 --> 00:26:52.906 A:middle
Keep in mind that the item

00:26:52.906 --> 00:26:54.586 A:middle
reference must remain the same

00:26:54.816 --> 00:26:55.906 A:middle
throughout the reservation life

00:26:55.906 --> 00:26:56.286 A:middle
cycle.

00:26:57.806 --> 00:26:59.176 A:middle
Once donated, Siri will

00:26:59.176 --> 00:27:00.816 A:middle
propagate this information to

00:26:59.176 --> 00:27:00.816 A:middle
propagate this information to

00:27:00.816 --> 00:27:01.846 A:middle
all the relevant places,

00:27:02.206 --> 00:27:02.976 A:middle
including Calendar.

00:27:03.456 --> 00:27:05.636 A:middle
Next, let's talk about

00:27:05.636 --> 00:27:06.396 A:middle
cancellations.

00:27:07.836 --> 00:27:09.696 A:middle
Cancellations are a special type

00:27:09.696 --> 00:27:10.546 A:middle
of modification.

00:27:11.566 --> 00:27:13.246 A:middle
In this example, we already

00:27:13.246 --> 00:27:15.636 A:middle
donated this reservation with a

00:27:15.636 --> 00:27:16.786 A:middle
status that confirmed.

00:27:17.886 --> 00:27:19.326 A:middle
Unfortunately, the user had to

00:27:19.326 --> 00:27:20.456 A:middle
cancel the reservation.

00:27:21.126 --> 00:27:22.106 A:middle
So we are going to donate the

00:27:22.106 --> 00:27:23.776 A:middle
updated reservation details with

00:27:23.776 --> 00:27:25.056 A:middle
a status set to cancel.

00:27:25.476 --> 00:27:28.356 A:middle
Like with all modifications, the

00:27:28.356 --> 00:27:29.786 A:middle
itemReference must remain the

00:27:29.786 --> 00:27:30.146 A:middle
same.

00:27:30.696 --> 00:27:32.786 A:middle
So, that's how your app should

00:27:32.786 --> 00:27:33.976 A:middle
handle some of the things that

00:27:33.976 --> 00:27:34.716 A:middle
can happen during the

00:27:34.716 --> 00:27:35.776 A:middle
reservation life cycle.

00:27:37.086 --> 00:27:38.496 A:middle
Now, let's summarize what we

00:27:38.496 --> 00:27:39.896 A:middle
talked about today.

00:27:41.336 --> 00:27:43.026 A:middle
So, we've seen how easy it is to

00:27:43.026 --> 00:27:44.486 A:middle
take advantage of the Siri Event

00:27:44.486 --> 00:27:46.156 A:middle
Suggestions API, and how we

00:27:46.196 --> 00:27:47.836 A:middle
provide a great user experience

00:27:47.996 --> 00:27:49.056 A:middle
throughout the reservation life

00:27:49.056 --> 00:27:49.426 A:middle
cycle.

00:27:50.516 --> 00:27:51.726 A:middle
Here are the three main

00:27:51.726 --> 00:27:52.376 A:middle
takeaways.

00:27:52.886 --> 00:27:55.086 A:middle
Your app should donate

00:27:55.086 --> 00:27:56.386 A:middle
reservation details when they

00:27:56.386 --> 00:27:58.336 A:middle
are displayed to the user, or

00:27:58.336 --> 00:27:59.416 A:middle
when they are received in the

00:27:59.416 --> 00:27:59.896 A:middle
background.

00:28:02.056 --> 00:28:03.196 A:middle
Make sure you keep your users up

00:28:03.196 --> 00:28:04.506 A:middle
to date by donating when the

00:28:04.506 --> 00:28:05.756 A:middle
reservation details change.

00:28:06.966 --> 00:28:09.206 A:middle
And finally, remember to handle

00:28:09.206 --> 00:28:11.366 A:middle
app launch, so the users can get

00:28:11.366 --> 00:28:13.206 A:middle
back into your app at the right

00:28:13.206 --> 00:28:16.866 A:middle
time, and the right place.

00:28:17.046 --> 00:28:18.406 A:middle
For more information, and to get

00:28:18.406 --> 00:28:19.916 A:middle
access to our sample code, you

00:28:19.916 --> 00:28:21.166 A:middle
can visit our session link on

00:28:21.166 --> 00:28:22.026 A:middle
the Developer Portal.

00:28:22.976 --> 00:28:24.026 A:middle
We also have some related

00:28:24.026 --> 00:28:25.456 A:middle
sessions from previous years

00:28:25.546 --> 00:28:26.666 A:middle
that we encourage you to check

00:28:27.356 --> 00:28:27.426 A:middle
out.

00:28:28.216 --> 00:28:29.776 A:middle
Thank you, and I hope you had a

00:28:29.776 --> 00:28:30.616 A:middle
great conference.

00:28:31.516 --> 00:28:38.460 A:middle
[ Applause ]

WEBVTT

00:00:00.506 --> 00:00:06.076 A:middle
[ Music ]

00:00:06.576 --> 00:00:08.306 A:middle
&gt;&gt; Hello, my name is James

00:00:08.306 --> 00:00:09.656 A:middle
Kelly, and I'm a Software

00:00:09.656 --> 00:00:10.746 A:middle
Engineer on the Game

00:00:10.746 --> 00:00:12.146 A:middle
Technologies Team at Apple.

00:00:12.936 --> 00:00:14.506 A:middle
In this video, we'll be talking

00:00:14.506 --> 00:00:15.866 A:middle
about the new features and

00:00:15.866 --> 00:00:17.136 A:middle
changes coming to the Game

00:00:17.136 --> 00:00:18.576 A:middle
Controller framework this year

00:00:19.006 --> 00:00:20.366 A:middle
to help you adopt newly

00:00:20.366 --> 00:00:21.706 A:middle
supported game controllers.

00:00:24.066 --> 00:00:25.126 A:middle
The Game Controller framework

00:00:25.126 --> 00:00:26.506 A:middle
has been making it easy to add

00:00:26.506 --> 00:00:28.356 A:middle
support for MFi Game Controllers

00:00:28.616 --> 00:00:31.126 A:middle
to your games on iOS, tvOS, and

00:00:31.126 --> 00:00:31.726 A:middle
macOS.

00:00:32.786 --> 00:00:33.856 A:middle
By abstracting controller

00:00:33.856 --> 00:00:35.166 A:middle
hardware through a common API,

00:00:35.916 --> 00:00:37.026 A:middle
the Game Controller framework

00:00:37.376 --> 00:00:38.676 A:middle
lets you write your code once

00:00:39.206 --> 00:00:40.166 A:middle
without you having to worry

00:00:40.166 --> 00:00:41.606 A:middle
about how controller data is

00:00:41.606 --> 00:00:41.966 A:middle
mapped.

00:00:43.986 --> 00:00:45.806 A:middle
And this year, we're excited to

00:00:45.806 --> 00:00:47.456 A:middle
announce new support for some

00:00:47.456 --> 00:00:48.746 A:middle
fantastic controllers.

00:00:49.416 --> 00:00:51.096 A:middle
First is the Bluetooth-enabled

00:00:51.096 --> 00:00:52.916 A:middle
Xbox Wireless controller from

00:00:52.916 --> 00:00:53.536 A:middle
Microsoft.

00:00:54.066 --> 00:00:55.236 A:middle
This will now seamlessly

00:00:55.236 --> 00:00:56.526 A:middle
integrate into any Game

00:00:56.526 --> 00:00:57.726 A:middle
Controller framework-enabled

00:00:57.726 --> 00:00:58.036 A:middle
game.

00:00:58.436 --> 00:01:00.156 A:middle
And that's not all.

00:00:58.436 --> 00:01:00.156 A:middle
And that's not all.

00:01:00.996 --> 00:01:02.606 A:middle
The DualShock 4 Controller from

00:01:02.606 --> 00:01:04.416 A:middle
Sony is now supported by the

00:01:04.416 --> 00:01:05.436 A:middle
Game Controller framework.

00:01:05.826 --> 00:01:07.856 A:middle
It will just work with any games

00:01:07.896 --> 00:01:08.906 A:middle
that already have controller

00:01:08.906 --> 00:01:09.936 A:middle
support through the Game

00:01:09.936 --> 00:01:10.716 A:middle
Controller framework.

00:01:13.406 --> 00:01:14.766 A:middle
Many developers have already

00:01:14.766 --> 00:01:16.136 A:middle
been creating some great games

00:01:16.136 --> 00:01:17.026 A:middle
with controller support.

00:01:18.076 --> 00:01:20.446 A:middle
Rayman Adventures, Transistor,

00:01:21.146 --> 00:01:23.276 A:middle
Sky Force Reloaded, and Alto's

00:01:23.276 --> 00:01:24.426 A:middle
Adventure are some great

00:01:24.426 --> 00:01:26.276 A:middle
examples, and just a few of the

00:01:26.276 --> 00:01:27.546 A:middle
games on the App Store that

00:01:27.546 --> 00:01:28.396 A:middle
support controllers.

00:01:29.316 --> 00:01:30.286 A:middle
By using the Game Controller

00:01:30.286 --> 00:01:31.476 A:middle
framework, games will

00:01:31.476 --> 00:01:32.966 A:middle
automatically support the Xbox

00:01:32.966 --> 00:01:34.126 A:middle
Wireless and DualShock 4

00:01:34.126 --> 00:01:37.486 A:middle
Controllers in iOS 13, tvOS 13,

00:01:37.796 --> 00:01:39.056 A:middle
and macOS Catalina.

00:01:40.826 --> 00:01:42.276 A:middle
In this video, we'll talk about

00:01:42.276 --> 00:01:43.526 A:middle
how to grab a reference to these

00:01:43.526 --> 00:01:44.876 A:middle
new controllers through the Game

00:01:44.876 --> 00:01:46.096 A:middle
Controller framework, how to

00:01:46.096 --> 00:01:48.166 A:middle
access their inputs, some UI

00:01:48.166 --> 00:01:49.406 A:middle
best practices for probably

00:01:49.406 --> 00:01:51.746 A:middle
supporting MFi, Xbox Wireless,

00:01:51.746 --> 00:01:53.716 A:middle
and DualShock 4 Controllers, and

00:01:53.716 --> 00:01:55.236 A:middle
our recommendations for how to

00:01:55.236 --> 00:01:57.156 A:middle
update your games on macOS, if

00:01:57.156 --> 00:01:58.626 A:middle
they previously supported Game

00:01:58.626 --> 00:01:59.836 A:middle
Controllers through lower level

00:01:59.836 --> 00:02:01.606 A:middle
frameworks such as IOKit.

00:01:59.836 --> 00:02:01.606 A:middle
frameworks such as IOKit.

00:02:02.716 --> 00:02:04.546 A:middle
First, let's talk about changes

00:02:04.546 --> 00:02:05.556 A:middle
coming to the Game Controller

00:02:05.556 --> 00:02:06.886 A:middle
framework in support of these

00:02:06.886 --> 00:02:07.616 A:middle
new controllers.

00:02:08.086 --> 00:02:11.706 A:middle
As a quick reminder, games that

00:02:11.706 --> 00:02:12.776 A:middle
already use the Game Controller

00:02:12.776 --> 00:02:13.996 A:middle
framework will gain support for

00:02:13.996 --> 00:02:15.936 A:middle
free, meaning if your game

00:02:15.936 --> 00:02:17.536 A:middle
supports MFi controllers, it

00:02:17.536 --> 00:02:19.106 A:middle
will also automatically support

00:02:19.166 --> 00:02:20.746 A:middle
the Xbox Wireless controller and

00:02:20.746 --> 00:02:21.486 A:middle
the DualShock 4.

00:02:22.016 --> 00:02:24.576 A:middle
The controller's inputs can be

00:02:24.576 --> 00:02:26.586 A:middle
accessed via a GCController's

00:02:26.736 --> 00:02:28.716 A:middle
GCExtendedGamepad profile.

00:02:31.146 --> 00:02:32.366 A:middle
For those of you who are new to

00:02:32.366 --> 00:02:33.446 A:middle
the Game Controller framework,

00:02:33.606 --> 00:02:34.856 A:middle
let's talk briefly about how to

00:02:34.856 --> 00:02:35.866 A:middle
detect a controller.

00:02:36.846 --> 00:02:38.356 A:middle
Each controller is represented

00:02:38.356 --> 00:02:40.566 A:middle
by a class named GCController.

00:02:41.206 --> 00:02:42.426 A:middle
It's the same class for all

00:02:42.426 --> 00:02:45.246 A:middle
controllers, MFi, Xbox Wireless,

00:02:45.486 --> 00:02:47.166 A:middle
and DualShock 4 controllers, as

00:02:47.166 --> 00:02:48.506 A:middle
well as the serial remote, are

00:02:48.506 --> 00:02:50.316 A:middle
all instances of GCController.

00:02:52.366 --> 00:02:53.456 A:middle
The first thing you want to do

00:02:53.456 --> 00:02:54.566 A:middle
is get a list of currently

00:02:54.566 --> 00:02:55.586 A:middle
connected controllers.

00:02:56.326 --> 00:02:58.516 A:middle
To do this, use GCController's

00:02:58.636 --> 00:03:00.036 A:middle
controllers class method.

00:02:58.636 --> 00:03:00.036 A:middle
controllers class method.

00:03:01.006 --> 00:03:02.376 A:middle
It returns an array of

00:03:02.376 --> 00:03:03.766 A:middle
GCController instances

00:03:04.146 --> 00:03:05.326 A:middle
representing all connected

00:03:05.326 --> 00:03:05.936 A:middle
controllers.

00:03:06.476 --> 00:03:08.226 A:middle
The array will be empty if no

00:03:08.226 --> 00:03:09.216 A:middle
controllers are connected.

00:03:10.216 --> 00:03:11.656 A:middle
You should check this array when

00:03:11.656 --> 00:03:12.996 A:middle
your app launches and set up the

00:03:12.996 --> 00:03:14.106 A:middle
controllers as appropriate.

00:03:17.576 --> 00:03:18.836 A:middle
Now it's common for controllers

00:03:18.836 --> 00:03:20.376 A:middle
to connect and disconnect while

00:03:20.376 --> 00:03:21.056 A:middle
your app is running.

00:03:21.596 --> 00:03:23.386 A:middle
For example, the player may turn

00:03:23.386 --> 00:03:24.326 A:middle
on their controller after

00:03:24.326 --> 00:03:25.856 A:middle
launching your game, their

00:03:25.856 --> 00:03:26.716 A:middle
controller may run out of

00:03:26.716 --> 00:03:28.546 A:middle
batteries, or they may just take

00:03:28.546 --> 00:03:29.776 A:middle
the controller out of range.

00:03:31.226 --> 00:03:32.596 A:middle
To be notified of these events,

00:03:32.946 --> 00:03:34.996 A:middle
add observers for GCController

00:03:34.996 --> 00:03:37.146 A:middle
did connect notification and

00:03:37.146 --> 00:03:38.886 A:middle
GCController did disconnect

00:03:38.886 --> 00:03:39.636 A:middle
notification.

00:03:40.406 --> 00:03:41.856 A:middle
Your application did finish

00:03:41.856 --> 00:03:43.626 A:middle
launching with options method is

00:03:43.626 --> 00:03:44.736 A:middle
a great place to do this.

00:03:46.606 --> 00:03:48.306 A:middle
So, now that you've grabbed onto

00:03:48.306 --> 00:03:49.406 A:middle
an instance of a connected

00:03:49.406 --> 00:03:50.886 A:middle
controller, let's talk about the

00:03:50.886 --> 00:03:52.316 A:middle
buttons and other inputs it may

00:03:52.316 --> 00:03:53.916 A:middle
have and how to access them.

00:03:56.076 --> 00:03:57.856 A:middle
First, let's recap what inputs

00:03:57.856 --> 00:03:59.176 A:middle
are available on a controller.

00:04:00.186 --> 00:04:02.356 A:middle
There are two triggers, a

00:04:02.356 --> 00:04:04.556 A:middle
directional pad, two

00:04:04.556 --> 00:04:08.896 A:middle
thumbsticks, a menu button, four

00:04:08.896 --> 00:04:11.746 A:middle
face buttons, a programmable

00:04:11.746 --> 00:04:14.226 A:middle
4-LED strip, and two shoulder

00:04:14.226 --> 00:04:14.746 A:middle
buttons.

00:04:18.336 --> 00:04:19.776 A:middle
Let's take a closer look at how

00:04:19.776 --> 00:04:21.565 A:middle
physical buttons map to the API

00:04:22.276 --> 00:04:23.906 A:middle
using the four face buttons as

00:04:23.906 --> 00:04:24.426 A:middle
an example.

00:04:25.586 --> 00:04:27.156 A:middle
Here we can see a table listing

00:04:27.156 --> 00:04:28.436 A:middle
the four face button properties

00:04:28.786 --> 00:04:30.556 A:middle
found on a controller's extended

00:04:30.556 --> 00:04:31.526 A:middle
gamepad profile.

00:04:32.456 --> 00:04:33.956 A:middle
The face buttons of MFi

00:04:33.956 --> 00:04:35.436 A:middle
controllers map directly to this

00:04:35.436 --> 00:04:38.306 A:middle
API as do the face buttons of an

00:04:38.306 --> 00:04:39.596 A:middle
Xbox Wireless controller.

00:04:42.196 --> 00:04:43.706 A:middle
Note that there is some subtlety

00:04:43.706 --> 00:04:45.246 A:middle
to consider with DualShock 4

00:04:45.246 --> 00:04:47.226 A:middle
controllers as they use symbols

00:04:47.276 --> 00:04:48.826 A:middle
instead of letters to represent

00:04:48.826 --> 00:04:49.666 A:middle
their face buttons.

00:04:50.656 --> 00:04:51.766 A:middle
In cases where there may be

00:04:51.766 --> 00:04:53.476 A:middle
ambiguity when mapping an input

00:04:53.476 --> 00:04:55.786 A:middle
to API, we use the notion of

00:04:55.786 --> 00:04:57.146 A:middle
positional equivalents to

00:04:57.146 --> 00:04:58.206 A:middle
resolve these mappings.

00:04:59.716 --> 00:05:01.546 A:middle
For example, if we consider the

00:04:59.716 --> 00:05:01.546 A:middle
For example, if we consider the

00:05:01.546 --> 00:05:03.266 A:middle
face buttons to be four buttons

00:05:03.266 --> 00:05:04.576 A:middle
arranged in a diamond on the

00:05:04.576 --> 00:05:06.726 A:middle
right side of a controller, then

00:05:06.726 --> 00:05:08.246 A:middle
the bottom cross button is

00:05:08.246 --> 00:05:09.736 A:middle
positionally equivalent to the

00:05:09.736 --> 00:05:11.566 A:middle
bottom A button of an MFi

00:05:11.566 --> 00:05:12.056 A:middle
controller.

00:05:12.476 --> 00:05:14.036 A:middle
So, it maps to the button A

00:05:14.036 --> 00:05:14.556 A:middle
property.

00:05:15.076 --> 00:05:18.286 A:middle
The right face button with a

00:05:18.286 --> 00:05:20.186 A:middle
circle button maps to the button

00:05:20.186 --> 00:05:21.636 A:middle
B property and so on.

00:05:24.286 --> 00:05:26.066 A:middle
Next, let's talk about clickable

00:05:26.066 --> 00:05:27.976 A:middle
thumbsticks or L3 and R3.

00:05:30.906 --> 00:05:31.846 A:middle
We added support for these

00:05:31.846 --> 00:05:33.146 A:middle
inputs to the Game Controller

00:05:33.146 --> 00:05:35.936 A:middle
framework in iOS 12.1, tvOS

00:05:35.936 --> 00:05:39.596 A:middle
12.1, and macOS Mojave 10.14.1.

00:05:40.496 --> 00:05:41.926 A:middle
While the Xbox Wireless and

00:05:41.926 --> 00:05:43.676 A:middle
DualShock 4 controllers all have

00:05:43.676 --> 00:05:44.636 A:middle
clickable thumbsticks,

00:05:45.046 --> 00:05:46.656 A:middle
thumbsticks on some models of

00:05:46.656 --> 00:05:48.086 A:middle
MFi controllers may not be

00:05:48.086 --> 00:05:48.516 A:middle
clickable.

00:05:49.186 --> 00:05:50.466 A:middle
Let's dive into a code example

00:05:50.466 --> 00:05:51.676 A:middle
to see how we can handle this.

00:05:53.346 --> 00:05:54.236 A:middle
Let's say we want to make the

00:05:54.236 --> 00:05:55.926 A:middle
player character crouch when the

00:05:55.926 --> 00:05:57.296 A:middle
player clicks L3.

00:05:57.296 --> 00:05:59.786 A:middle
If we're supporting older

00:05:59.786 --> 00:06:02.606 A:middle
versions of iOS, tvOS, or macOS,

00:05:59.786 --> 00:06:02.606 A:middle
versions of iOS, tvOS, or macOS,

00:06:03.086 --> 00:06:04.446 A:middle
we should first check to see if

00:06:04.446 --> 00:06:05.396 A:middle
we have the clickable

00:06:05.396 --> 00:06:07.376 A:middle
thumbsticks API available to us.

00:06:09.926 --> 00:06:11.436 A:middle
Even if we do though, the

00:06:11.436 --> 00:06:12.346 A:middle
specific controller we're

00:06:12.346 --> 00:06:14.216 A:middle
mapping may not physically have

00:06:14.216 --> 00:06:15.306 A:middle
clickable thumbsticks.

00:06:16.176 --> 00:06:17.856 A:middle
So, we check to see if the left

00:06:17.856 --> 00:06:19.086 A:middle
thumbstick button is new.

00:06:19.636 --> 00:06:21.406 A:middle
And if it is, we should ensure

00:06:21.406 --> 00:06:22.616 A:middle
that the user interaction we

00:06:22.616 --> 00:06:24.566 A:middle
were intending to map to L3, in

00:06:24.566 --> 00:06:25.856 A:middle
this case, crouching the player,

00:06:26.386 --> 00:06:27.676 A:middle
is available through some other

00:06:27.676 --> 00:06:28.056 A:middle
means.

00:06:31.486 --> 00:06:32.506 A:middle
Once we are working with a

00:06:32.506 --> 00:06:33.866 A:middle
controller that we know has

00:06:33.866 --> 00:06:35.256 A:middle
clickable thumbsticks, we can

00:06:35.256 --> 00:06:36.856 A:middle
just assign our behavior to the

00:06:36.856 --> 00:06:38.626 A:middle
press handler of L3.

00:06:38.946 --> 00:06:40.136 A:middle
Now, when a player clicks the

00:06:40.136 --> 00:06:41.936 A:middle
left thumbstick button, the game

00:06:41.936 --> 00:06:42.716 A:middle
will toggle the player

00:06:42.716 --> 00:06:43.576 A:middle
character's crouch.

00:06:46.476 --> 00:06:47.706 A:middle
If our game is running on

00:06:47.706 --> 00:06:50.226 A:middle
versions of iOS, tvOS, or macOS

00:06:50.226 --> 00:06:52.176 A:middle
that don't have this API, we

00:06:52.176 --> 00:06:52.956 A:middle
still need to code an

00:06:52.956 --> 00:06:54.416 A:middle
alternative path to the player

00:06:54.416 --> 00:06:54.906 A:middle
crouch.

00:06:57.856 --> 00:06:59.336 A:middle
Next, let's talk about some new

00:06:59.336 --> 00:07:00.846 A:middle
buttons that have been added to

00:06:59.336 --> 00:07:00.846 A:middle
buttons that have been added to

00:07:00.846 --> 00:07:02.516 A:middle
the API in support of the Xbox

00:07:02.516 --> 00:07:03.786 A:middle
wireless and DualShock 4

00:07:03.786 --> 00:07:05.466 A:middle
Controllers, what we're calling

00:07:05.646 --> 00:07:06.806 A:middle
the auxiliary buttons.

00:07:07.546 --> 00:07:08.636 A:middle
These buttons are typically

00:07:08.636 --> 00:07:09.656 A:middle
found in the middle of

00:07:09.656 --> 00:07:10.306 A:middle
controllers.

00:07:12.526 --> 00:07:13.966 A:middle
First, we have the menu button.

00:07:14.546 --> 00:07:15.606 A:middle
It should be used to pause

00:07:15.606 --> 00:07:16.766 A:middle
gameplay and bring up the

00:07:16.766 --> 00:07:17.806 A:middle
in-game pause menu.

00:07:18.476 --> 00:07:19.986 A:middle
All supported controllers have

00:07:19.986 --> 00:07:20.516 A:middle
this button.

00:07:22.186 --> 00:07:23.306 A:middle
Now let's look at the options

00:07:23.306 --> 00:07:23.646 A:middle
button.

00:07:24.336 --> 00:07:25.646 A:middle
It's a general purpose button,

00:07:25.896 --> 00:07:26.956 A:middle
but you should avoid using it

00:07:26.956 --> 00:07:28.546 A:middle
for time critical actions, as

00:07:28.546 --> 00:07:29.966 A:middle
it's generally positioned out of

00:07:29.966 --> 00:07:30.286 A:middle
the way.

00:07:31.296 --> 00:07:32.386 A:middle
Note that not all controllers

00:07:32.386 --> 00:07:33.116 A:middle
have this button.

00:07:36.316 --> 00:07:37.596 A:middle
Let's take a look at how these

00:07:37.596 --> 00:07:39.566 A:middle
new APIs map to existing MFi

00:07:39.566 --> 00:07:40.216 A:middle
controllers.

00:07:41.596 --> 00:07:43.086 A:middle
The center menu button maps

00:07:43.086 --> 00:07:44.266 A:middle
directly to the button menu

00:07:44.266 --> 00:07:46.506 A:middle
property of GCExtendedGamepad.

00:07:48.236 --> 00:07:49.876 A:middle
Note that in this example, this

00:07:49.906 --> 00:07:51.346 A:middle
MFi controller doesn't have an

00:07:51.346 --> 00:07:52.056 A:middle
options button.

00:07:52.396 --> 00:07:53.966 A:middle
So, the button options property

00:07:54.056 --> 00:07:55.836 A:middle
of GCExtendedGamepad is new.

00:07:57.496 --> 00:07:59.276 A:middle
Next up is the Xbox Wireless

00:07:59.276 --> 00:07:59.786 A:middle
controller.

00:07:59.856 --> 00:08:02.606 A:middle
When a controller has multiple

00:07:59.856 --> 00:08:02.606 A:middle
When a controller has multiple

00:08:02.646 --> 00:08:04.506 A:middle
auxiliary buttons, we determine

00:08:04.506 --> 00:08:05.796 A:middle
its button mapping using

00:08:05.796 --> 00:08:06.856 A:middle
positional equivalents.

00:08:08.426 --> 00:08:10.176 A:middle
The right auxiliary button, in

00:08:10.176 --> 00:08:11.756 A:middle
this case, the Xbox Wireless

00:08:11.756 --> 00:08:13.606 A:middle
controller's menu button maps

00:08:13.606 --> 00:08:14.956 A:middle
directly to the button menu

00:08:14.956 --> 00:08:18.326 A:middle
property, whereas the left

00:08:18.326 --> 00:08:20.276 A:middle
Auxiliary button or the Xbox

00:08:20.276 --> 00:08:21.276 A:middle
Wireless controller's view

00:08:21.276 --> 00:08:22.886 A:middle
button maps to the button

00:08:22.886 --> 00:08:23.796 A:middle
options property.

00:08:25.786 --> 00:08:27.626 A:middle
The Xbox button in the center of

00:08:27.626 --> 00:08:29.046 A:middle
the controller has been reserved

00:08:29.046 --> 00:08:29.896 A:middle
for system use.

00:08:32.395 --> 00:08:33.856 A:middle
The same approach can be applied

00:08:33.966 --> 00:08:35.006 A:middle
for the DualShock 4.

00:08:36.486 --> 00:08:38.096 A:middle
Again, we can use positional

00:08:38.096 --> 00:08:39.336 A:middle
equivalents to determine the

00:08:39.336 --> 00:08:40.155 A:middle
button mappings.

00:08:41.905 --> 00:08:43.366 A:middle
The right auxiliary button or

00:08:43.366 --> 00:08:45.046 A:middle
the DualShock 4's options button

00:08:45.396 --> 00:08:46.526 A:middle
maps to the button menu

00:08:46.526 --> 00:08:49.376 A:middle
property, whereas the left

00:08:49.376 --> 00:08:51.276 A:middle
auxiliary button, the DualShock

00:08:51.276 --> 00:08:53.276 A:middle
4's share button maps to the

00:08:53.276 --> 00:08:54.486 A:middle
button options property.

00:08:54.986 --> 00:08:57.566 A:middle
The PS button in the center of

00:08:57.566 --> 00:08:58.846 A:middle
the controller has also been

00:08:58.846 --> 00:08:59.286 A:middle
reserved.

00:09:03.276 --> 00:09:04.676 A:middle
Note that we've deprecated the

00:09:04.676 --> 00:09:05.876 A:middle
controller paused handler.

00:09:06.716 --> 00:09:07.976 A:middle
You should now use the new

00:09:07.976 --> 00:09:09.576 A:middle
button menu API instead.

00:09:10.346 --> 00:09:11.696 A:middle
Let's dive into a code example

00:09:11.696 --> 00:09:12.986 A:middle
to see how we can handle this.

00:09:17.036 --> 00:09:18.256 A:middle
Let's say we want to pause or

00:09:18.256 --> 00:09:19.686 A:middle
unpause the game whenever the

00:09:19.686 --> 00:09:21.156 A:middle
player presses the menu button.

00:09:21.766 --> 00:09:23.426 A:middle
If we're supporting older

00:09:23.426 --> 00:09:26.136 A:middle
versions of iOS, tvOS or macOS,

00:09:26.426 --> 00:09:27.576 A:middle
we should first check to see if

00:09:27.576 --> 00:09:29.536 A:middle
we have the new menu button API.

00:09:31.226 --> 00:09:33.076 A:middle
If we do, we simply register a

00:09:33.076 --> 00:09:35.056 A:middle
pressed changed handler on the

00:09:35.056 --> 00:09:36.816 A:middle
extended gamepad's button menu

00:09:36.816 --> 00:09:37.306 A:middle
property.

00:09:39.566 --> 00:09:41.046 A:middle
Within the handler, we toggle

00:09:41.046 --> 00:09:41.816 A:middle
the pause menu.

00:09:42.386 --> 00:09:43.746 A:middle
Typically, when players want to

00:09:43.746 --> 00:09:45.316 A:middle
pause the game, they want to do

00:09:45.316 --> 00:09:47.066 A:middle
it as fast as possible, so we

00:09:47.066 --> 00:09:47.886 A:middle
make sure to trigger this

00:09:47.886 --> 00:09:49.946 A:middle
behavior on button press rather

00:09:49.946 --> 00:09:50.906 A:middle
than button release.

00:09:53.686 --> 00:09:55.426 A:middle
If the new API isn't available,

00:09:55.826 --> 00:09:56.736 A:middle
we should still register our

00:09:56.736 --> 00:09:58.046 A:middle
functionality with the old

00:09:58.046 --> 00:09:59.226 A:middle
controller PausedHandler.

00:09:59.546 --> 00:10:01.026 A:middle
This will trigger whenever the

00:09:59.546 --> 00:10:01.026 A:middle
This will trigger whenever the

00:10:01.026 --> 00:10:02.196 A:middle
menu button is pressed.

00:10:02.196 --> 00:10:06.076 A:middle
So that was the menu button.

00:10:07.496 --> 00:10:08.736 A:middle
Now let's look at the options

00:10:08.736 --> 00:10:09.076 A:middle
button.

00:10:09.816 --> 00:10:11.456 A:middle
Again, remember that not all

00:10:11.456 --> 00:10:12.526 A:middle
controllers may have this

00:10:12.526 --> 00:10:12.926 A:middle
button.

00:10:13.756 --> 00:10:14.816 A:middle
Let's dive into another code

00:10:14.816 --> 00:10:16.036 A:middle
example to see how we should

00:10:16.036 --> 00:10:16.626 A:middle
handle this.

00:10:18.656 --> 00:10:20.076 A:middle
Here, we want to bring up an

00:10:20.076 --> 00:10:21.726 A:middle
in-game settings menu whenever

00:10:21.726 --> 00:10:23.106 A:middle
the player presses the options

00:10:23.106 --> 00:10:23.556 A:middle
button.

00:10:24.016 --> 00:10:26.026 A:middle
If we're supporting older

00:10:26.026 --> 00:10:28.476 A:middle
versions of iOS, tvOS, or macOS,

00:10:28.906 --> 00:10:30.186 A:middle
we should first check to see if

00:10:30.186 --> 00:10:31.616 A:middle
we have the new options button.

00:10:33.496 --> 00:10:34.926 A:middle
But even if we do, the

00:10:34.926 --> 00:10:36.176 A:middle
controller we're mapping may not

00:10:36.176 --> 00:10:37.576 A:middle
physically have an options

00:10:37.576 --> 00:10:37.986 A:middle
button.

00:10:39.026 --> 00:10:40.056 A:middle
So we check to see if the

00:10:40.056 --> 00:10:41.076 A:middle
options button is new.

00:10:41.546 --> 00:10:43.386 A:middle
And if it is, we need to ensure

00:10:43.386 --> 00:10:44.506 A:middle
that the settings menu is

00:10:44.506 --> 00:10:46.256 A:middle
accessible via some other means.

00:10:46.496 --> 00:10:48.616 A:middle
For example, we can list it as

00:10:48.616 --> 00:10:49.906 A:middle
an item in the pause menu.

00:10:51.736 --> 00:10:53.196 A:middle
If the controller has an options

00:10:53.196 --> 00:10:54.616 A:middle
button, we can just assign our

00:10:54.616 --> 00:10:56.256 A:middle
behavior to the button options

00:10:56.396 --> 00:10:57.146 A:middle
pressed handler.

00:10:57.936 --> 00:10:59.056 A:middle
Now, when a player clicks the

00:10:59.056 --> 00:11:00.446 A:middle
options button, the game will

00:10:59.056 --> 00:11:00.446 A:middle
options button, the game will

00:11:00.446 --> 00:11:01.656 A:middle
toggle the settings menu.

00:11:04.236 --> 00:11:06.076 A:middle
If the new API isn't available,

00:11:06.406 --> 00:11:07.436 A:middle
we still need to make sure

00:11:07.576 --> 00:11:08.916 A:middle
there's an alternative path to

00:11:08.916 --> 00:11:09.946 A:middle
reach the settings menu.

00:11:10.436 --> 00:11:12.326 A:middle
So that was a quick look at the

00:11:12.326 --> 00:11:13.676 A:middle
new API coming to the Game

00:11:13.676 --> 00:11:14.826 A:middle
Controller framework this year

00:11:15.036 --> 00:11:16.106 A:middle
in support of the newly added

00:11:16.106 --> 00:11:17.876 A:middle
Xbox Wireless and DualShock 4

00:11:17.876 --> 00:11:18.486 A:middle
controllers.

00:11:20.666 --> 00:11:22.276 A:middle
Now, let's talk about some UI

00:11:22.276 --> 00:11:23.876 A:middle
best practices for handling

00:11:23.876 --> 00:11:25.086 A:middle
different controllers so that

00:11:25.086 --> 00:11:26.426 A:middle
your users can experience your

00:11:26.426 --> 00:11:27.896 A:middle
game in the best possible way.

00:11:30.496 --> 00:11:31.166 A:middle
With the Game Controller

00:11:31.166 --> 00:11:32.416 A:middle
framework being expanded to

00:11:32.416 --> 00:11:33.866 A:middle
support more than just MFi

00:11:33.866 --> 00:11:35.606 A:middle
controllers, a new consideration

00:11:35.606 --> 00:11:36.176 A:middle
arises.

00:11:36.776 --> 00:11:38.616 A:middle
Buttons and other inputs may no

00:11:38.616 --> 00:11:40.066 A:middle
longer be visually consistent

00:11:40.116 --> 00:11:40.996 A:middle
between controllers.

00:11:41.736 --> 00:11:43.426 A:middle
In this example, the B button in

00:11:43.426 --> 00:11:45.346 A:middle
the prompt only matches the MFi

00:11:45.346 --> 00:11:47.346 A:middle
controller while the Xbox

00:11:47.346 --> 00:11:48.806 A:middle
Wireless controller's B button

00:11:48.976 --> 00:11:51.476 A:middle
is red and the DualShock 4 has a

00:11:51.476 --> 00:11:52.616 A:middle
circle button instead.

00:11:54.306 --> 00:11:55.346 A:middle
Let's dive deeper into this

00:11:55.346 --> 00:11:56.536 A:middle
example to see how we could

00:11:56.536 --> 00:11:57.086 A:middle
handle this.

00:11:57.836 --> 00:11:58.816 A:middle
Let's say you're introducing

00:11:58.816 --> 00:11:59.776 A:middle
your player to the base

00:11:59.776 --> 00:12:01.356 A:middle
mechanics of your game and you

00:11:59.776 --> 00:12:01.356 A:middle
mechanics of your game and you

00:12:01.356 --> 00:12:02.486 A:middle
want to display an in-game

00:12:02.486 --> 00:12:03.676 A:middle
prompt that tells them how to

00:12:03.676 --> 00:12:04.006 A:middle
block.

00:12:04.006 --> 00:12:05.876 A:middle
In this case, your block

00:12:05.876 --> 00:12:07.336 A:middle
function is mapped to the button

00:12:07.336 --> 00:12:09.926 A:middle
B property of GCExtendedGamepad.

00:12:11.406 --> 00:12:13.026 A:middle
For an MFi controller, we

00:12:13.026 --> 00:12:14.976 A:middle
display our MFi B button asset

00:12:15.076 --> 00:12:15.906 A:middle
as we did before.

00:12:16.216 --> 00:12:18.876 A:middle
For the Xbox Wireless

00:12:18.876 --> 00:12:20.356 A:middle
controller, however, we need to

00:12:20.356 --> 00:12:22.066 A:middle
slightly tweak the asset, in

00:12:22.066 --> 00:12:23.196 A:middle
this case, by making the B

00:12:23.196 --> 00:12:23.766 A:middle
button red.

00:12:25.256 --> 00:12:26.736 A:middle
Finally, we display a circle

00:12:26.736 --> 00:12:28.396 A:middle
button when the DualShock 4 is

00:12:28.396 --> 00:12:29.336 A:middle
the active controller.

00:12:30.036 --> 00:12:31.126 A:middle
Now, regardless of what

00:12:31.126 --> 00:12:32.466 A:middle
controller the player is using,

00:12:32.656 --> 00:12:34.136 A:middle
they can easily understand your

00:12:34.136 --> 00:12:34.926 A:middle
in-game prompts.

00:12:35.676 --> 00:12:36.616 A:middle
Let's take a look at a code

00:12:36.616 --> 00:12:37.746 A:middle
example to see how we can

00:12:37.746 --> 00:12:38.376 A:middle
achieve this.

00:12:41.346 --> 00:12:42.736 A:middle
Here, we have a simple function

00:12:42.736 --> 00:12:45.576 A:middle
called getBlockButtonAsset that

00:12:45.576 --> 00:12:46.566 A:middle
returns the appropriate art

00:12:46.566 --> 00:12:47.846 A:middle
asset for the block button.

00:12:49.216 --> 00:12:50.806 A:middle
First, we switch over the

00:12:50.806 --> 00:12:53.026 A:middle
controller's product category, a

00:12:53.026 --> 00:12:54.676 A:middle
new property added this year to

00:12:54.676 --> 00:12:56.406 A:middle
GCController to determine what

00:12:56.406 --> 00:12:57.456 A:middle
kind of controller it is.

00:12:57.536 --> 00:12:59.936 A:middle
If it's an Xbox Wireless

00:12:59.936 --> 00:13:01.766 A:middle
controller, we will return the

00:12:59.936 --> 00:13:01.766 A:middle
controller, we will return the

00:13:01.766 --> 00:13:03.156 A:middle
red B button asset.

00:13:03.616 --> 00:13:05.666 A:middle
If it's a DualShock 4

00:13:05.666 --> 00:13:07.456 A:middle
controller, we'll return the red

00:13:07.596 --> 00:13:08.566 A:middle
circle button asset.

00:13:09.696 --> 00:13:11.106 A:middle
And finally, by default,

00:13:11.556 --> 00:13:13.636 A:middle
overturn the MFi green B button

00:13:13.636 --> 00:13:14.026 A:middle
asset.

00:13:14.886 --> 00:13:16.346 A:middle
This way, your game will support

00:13:16.346 --> 00:13:17.566 A:middle
the diverse range of MFi

00:13:17.566 --> 00:13:18.896 A:middle
controllers currently available

00:13:19.146 --> 00:13:20.446 A:middle
and gracefully fall back to a

00:13:20.446 --> 00:13:21.816 A:middle
sensible asset should new

00:13:21.816 --> 00:13:22.966 A:middle
controller support be added in

00:13:22.966 --> 00:13:23.416 A:middle
the future.

00:13:24.356 --> 00:13:25.516 A:middle
Let's return to our previous

00:13:25.516 --> 00:13:26.286 A:middle
block example.

00:13:27.176 --> 00:13:28.496 A:middle
Instead of creating unique art

00:13:28.496 --> 00:13:29.516 A:middle
assets for each type of

00:13:29.516 --> 00:13:31.556 A:middle
controller, another option is to

00:13:31.556 --> 00:13:32.826 A:middle
use generic symbols in your

00:13:32.826 --> 00:13:34.246 A:middle
in-game tutorials and prompts.

00:13:36.226 --> 00:13:37.706 A:middle
By providing a generic prompt

00:13:37.916 --> 00:13:39.126 A:middle
that doesn't rely on anything

00:13:39.126 --> 00:13:39.926 A:middle
other than positional

00:13:39.926 --> 00:13:41.446 A:middle
equivalents, you can rest

00:13:41.446 --> 00:13:42.336 A:middle
assured knowing that your

00:13:42.336 --> 00:13:43.966 A:middle
players will be able to easily

00:13:43.966 --> 00:13:45.576 A:middle
understand your in-game guidance

00:13:45.966 --> 00:13:46.926 A:middle
regardless of what type of

00:13:46.926 --> 00:13:48.046 A:middle
controller is connected.

00:13:48.786 --> 00:13:50.726 A:middle
In this example, it's clear that

00:13:50.726 --> 00:13:51.746 A:middle
the players should press the

00:13:51.746 --> 00:13:52.696 A:middle
right face button.

00:13:54.966 --> 00:13:57.246 A:middle
One last note, players may have

00:13:57.246 --> 00:13:58.506 A:middle
multiple controllers connected

00:13:58.506 --> 00:14:00.016 A:middle
to their device at the same time

00:13:58.506 --> 00:14:00.016 A:middle
to their device at the same time

00:14:00.406 --> 00:14:01.446 A:middle
even if they're playing alone.

00:14:02.316 --> 00:14:03.566 A:middle
You should gracefully support

00:14:03.666 --> 00:14:04.726 A:middle
all connected controllers in

00:14:04.726 --> 00:14:06.216 A:middle
this case, as a player may

00:14:06.216 --> 00:14:07.476 A:middle
switch between them at any

00:14:07.476 --> 00:14:07.886 A:middle
moment.

00:14:08.816 --> 00:14:09.656 A:middle
This means that you'll need to

00:14:09.656 --> 00:14:10.936 A:middle
recognize input from all

00:14:10.936 --> 00:14:12.746 A:middle
connected controllers either by

00:14:12.746 --> 00:14:14.186 A:middle
pulling them each frame or

00:14:14.186 --> 00:14:15.606 A:middle
registering input handlers with

00:14:15.606 --> 00:14:16.146 A:middle
each of them.

00:14:17.226 --> 00:14:18.396 A:middle
You should also update your

00:14:18.396 --> 00:14:20.216 A:middle
in-game guidance and visuals to

00:14:20.216 --> 00:14:21.356 A:middle
match the most recently used

00:14:21.356 --> 00:14:21.966 A:middle
controllers.

00:14:22.326 --> 00:14:25.426 A:middle
For example, if a player is

00:14:25.426 --> 00:14:26.656 A:middle
using their MFi controller,

00:14:26.926 --> 00:14:28.876 A:middle
display the appropriate MFi art

00:14:28.876 --> 00:14:29.406 A:middle
assets.

00:14:30.856 --> 00:14:32.356 A:middle
But if the player pressed an

00:14:32.356 --> 00:14:33.526 A:middle
input on their connected

00:14:33.526 --> 00:14:35.926 A:middle
DualShock 4, all in-game visuals

00:14:35.926 --> 00:14:37.356 A:middle
should automatically adjust to

00:14:37.356 --> 00:14:39.176 A:middle
use the DualShock 4 art assets.

00:14:40.246 --> 00:14:41.396 A:middle
By dynamically adapting your

00:14:41.396 --> 00:14:42.586 A:middle
visuals to the most recently

00:14:42.586 --> 00:14:43.966 A:middle
used controller, you will

00:14:43.966 --> 00:14:45.036 A:middle
provide your players an

00:14:45.036 --> 00:14:46.176 A:middle
intuitive and polished

00:14:46.176 --> 00:14:47.426 A:middle
controller-driven experience.

00:14:49.566 --> 00:14:50.786 A:middle
Now, for those of you who have

00:14:50.786 --> 00:14:52.086 A:middle
previously implemented the game

00:14:52.086 --> 00:14:53.536 A:middle
controller support outside of

00:14:53.536 --> 00:14:54.526 A:middle
the Game Controller framework on

00:14:54.526 --> 00:14:56.386 A:middle
macOS, we have some new guidance

00:14:56.386 --> 00:14:57.096 A:middle
for your games.

00:14:58.976 --> 00:14:59.866 A:middle
When you adopt the Game

00:14:59.866 --> 00:15:01.026 A:middle
Controller framework, game

00:14:59.866 --> 00:15:01.026 A:middle
Controller framework, game

00:15:01.026 --> 00:15:02.896 A:middle
controllers will just work, so

00:15:02.896 --> 00:15:05.036 A:middle
you should use it for MFi, Xbox

00:15:05.036 --> 00:15:06.326 A:middle
Wireless, and DualShock 4

00:15:06.326 --> 00:15:07.886 A:middle
controller support on macOS.

00:15:08.476 --> 00:15:10.716 A:middle
As we abstract away any hardware

00:15:10.716 --> 00:15:11.906 A:middle
intricacies that may differ

00:15:11.906 --> 00:15:13.936 A:middle
between controllers, we provide

00:15:13.936 --> 00:15:15.196 A:middle
you consistency in your app

00:15:15.246 --> 00:15:17.886 A:middle
across iOS, tvOS, and macOS.

00:15:18.946 --> 00:15:20.256 A:middle
This will also help to ensure

00:15:20.256 --> 00:15:21.806 A:middle
that your apps remain compatible

00:15:21.806 --> 00:15:23.226 A:middle
with current and future OS

00:15:23.226 --> 00:15:23.766 A:middle
updates.

00:15:24.196 --> 00:15:26.886 A:middle
For those of you who have

00:15:26.886 --> 00:15:28.286 A:middle
previously hardcoded support for

00:15:28.286 --> 00:15:29.576 A:middle
these controllers through lower

00:15:29.576 --> 00:15:31.896 A:middle
level APIs such as IOKit, we

00:15:31.896 --> 00:15:33.306 A:middle
highly recommend that you move

00:15:33.306 --> 00:15:34.686 A:middle
your implementation over to the

00:15:34.686 --> 00:15:35.666 A:middle
Game Controller framework.

00:15:36.786 --> 00:15:38.086 A:middle
As new controllers will appear

00:15:38.086 --> 00:15:39.426 A:middle
in both IOKit and the Game

00:15:39.426 --> 00:15:41.156 A:middle
Controller framework, you should

00:15:41.156 --> 00:15:42.756 A:middle
drop your IOKit implementation

00:15:42.806 --> 00:15:43.556 A:middle
to ensure there are no

00:15:43.556 --> 00:15:44.226 A:middle
conflicts.

00:15:45.496 --> 00:15:46.856 A:middle
This will allow you to code to a

00:15:46.856 --> 00:15:48.496 A:middle
single interface and receive new

00:15:48.496 --> 00:15:49.716 A:middle
game controller support for

00:15:49.716 --> 00:15:50.036 A:middle
free.

00:15:53.746 --> 00:15:55.016 A:middle
So let's summarize what we've

00:15:55.016 --> 00:15:56.046 A:middle
discussed in this video.

00:15:57.776 --> 00:15:59.006 A:middle
The Game Controller framework

00:15:59.006 --> 00:16:00.196 A:middle
abstracts hardware through a

00:15:59.006 --> 00:16:00.196 A:middle
abstracts hardware through a

00:16:00.196 --> 00:16:01.586 A:middle
common API, letting you write

00:16:01.586 --> 00:16:03.356 A:middle
your code once without having to

00:16:03.356 --> 00:16:04.336 A:middle
worry about the low-level

00:16:04.336 --> 00:16:05.786 A:middle
differences between controller

00:16:05.786 --> 00:16:06.286 A:middle
models.

00:16:07.256 --> 00:16:08.466 A:middle
This has the great benefit of

00:16:08.466 --> 00:16:09.446 A:middle
allowing your game to

00:16:09.446 --> 00:16:10.726 A:middle
automatically support newly

00:16:10.726 --> 00:16:12.096 A:middle
added controllers such as the

00:16:12.096 --> 00:16:13.776 A:middle
Xbox Wireless and the DualShock

00:16:13.776 --> 00:16:14.506 A:middle
4 controllers.

00:16:15.816 --> 00:16:17.706 A:middle
However, in order to provide the

00:16:17.706 --> 00:16:18.926 A:middle
best user experience for your

00:16:18.926 --> 00:16:20.716 A:middle
players, you should take care to

00:16:20.716 --> 00:16:22.216 A:middle
adapt your game's UI and

00:16:22.216 --> 00:16:23.536 A:middle
on-screen indicators to the

00:16:23.536 --> 00:16:24.316 A:middle
active controller.

00:16:25.576 --> 00:16:27.396 A:middle
And finally, ensure your macOS

00:16:27.396 --> 00:16:29.096 A:middle
apps stay compatible with future

00:16:29.096 --> 00:16:31.066 A:middle
OS updates by migrating existing

00:16:31.066 --> 00:16:32.436 A:middle
controller support from lower

00:16:32.436 --> 00:16:33.746 A:middle
level APIs to the Game

00:16:33.746 --> 00:16:34.546 A:middle
Controller framework.

00:16:35.966 --> 00:16:37.136 A:middle
More information about this

00:16:37.136 --> 00:16:38.616 A:middle
year's game controller update

00:16:38.616 --> 00:16:39.616 A:middle
can be found on the Apple

00:16:39.616 --> 00:16:40.296 A:middle
developer site.

00:16:43.106 --> 00:16:44.236 A:middle
That's it for this year's game

00:16:44.236 --> 00:16:44.946 A:middle
controller's update.

00:16:45.296 --> 00:16:46.346 A:middle
Thank you for watching.

00:16:46.886 --> 00:16:47.626 A:middle
We hope you found this

00:16:47.626 --> 00:16:49.386 A:middle
information helpful and you can

00:16:49.386 --> 00:16:50.486 A:middle
use it to create some awesome

00:16:50.486 --> 00:16:51.546 A:middle
games with game controller

00:16:51.546 --> 00:16:51.936 A:middle
support.

WEBVTT

00:00:00.506 --> 00:00:04.500 A:middle
[ Music ]

00:00:12.106 --> 00:00:13.536 A:middle
&gt;&gt; Good morning, everyone.

00:00:14.256 --> 00:00:16.175 A:middle
And thanks for joining us today.

00:00:17.616 --> 00:00:19.086 A:middle
My name is Garrett, and I work

00:00:19.086 --> 00:00:20.236 A:middle
on the security engineering and

00:00:20.236 --> 00:00:21.446 A:middle
architecture team here at Apple.

00:00:21.986 --> 00:00:22.876 A:middle
And today, we're here to talk

00:00:22.876 --> 00:00:23.926 A:middle
about some of the advances in

00:00:23.926 --> 00:00:25.646 A:middle
security coming in macOS

00:00:25.646 --> 00:00:26.056 A:middle
Catalina.

00:00:29.046 --> 00:00:29.896 A:middle
Here's a quick agenda for the

00:00:29.896 --> 00:00:30.226 A:middle
talk.

00:00:30.716 --> 00:00:31.606 A:middle
We're going to talk a little bit

00:00:31.606 --> 00:00:32.686 A:middle
about the security principle of

00:00:32.686 --> 00:00:34.156 A:middle
defense in depth and how it's

00:00:34.156 --> 00:00:35.256 A:middle
applied in macOS.

00:00:36.016 --> 00:00:37.666 A:middle
Then we'll dig into two very

00:00:37.666 --> 00:00:38.686 A:middle
different parts of the macOS

00:00:38.686 --> 00:00:40.926 A:middle
security model, Gatekeeper and

00:00:40.926 --> 00:00:42.146 A:middle
user privacy protection.

00:00:45.146 --> 00:00:45.966 A:middle
So let's get started with

00:00:45.966 --> 00:00:46.606 A:middle
Defense in Depth.

00:00:47.466 --> 00:00:50.356 A:middle
Now, with a product as complex

00:00:50.356 --> 00:00:51.906 A:middle
and with as many use cases as

00:00:51.906 --> 00:00:55.396 A:middle
macOS, it's-- there is no single

00:00:55.396 --> 00:00:57.056 A:middle
technology or feature that can

00:00:57.056 --> 00:00:58.526 A:middle
deliver perfect security alone.

00:00:59.776 --> 00:01:01.976 A:middle
So instead, macOS is designed

00:00:59.776 --> 00:01:01.976 A:middle
So instead, macOS is designed

00:01:01.976 --> 00:01:03.086 A:middle
with many different layers of

00:01:03.086 --> 00:01:03.706 A:middle
security.

00:01:04.366 --> 00:01:05.626 A:middle
Each designed with a specific

00:01:05.626 --> 00:01:06.886 A:middle
purpose or goal.

00:01:08.226 --> 00:01:10.656 A:middle
And every year, we improve the

00:01:10.656 --> 00:01:12.996 A:middle
technologies and policies at

00:01:12.996 --> 00:01:14.796 A:middle
each of these layers to help

00:01:14.796 --> 00:01:15.606 A:middle
keep you safe.

00:01:16.396 --> 00:01:19.606 A:middle
And this is an application of

00:01:19.606 --> 00:01:20.496 A:middle
the principle of Defense in

00:01:20.496 --> 00:01:20.686 A:middle
Depth.

00:01:20.686 --> 00:01:23.806 A:middle
And the goal is to ensure that

00:01:23.806 --> 00:01:25.356 A:middle
one layer of security failing

00:01:26.136 --> 00:01:27.736 A:middle
doesn't defeat the entire

00:01:27.736 --> 00:01:31.616 A:middle
security model of the system.

00:01:31.726 --> 00:01:33.666 A:middle
Instead, we rely on multiple

00:01:33.666 --> 00:01:35.196 A:middle
layers of protection with

00:01:35.196 --> 00:01:35.916 A:middle
different properties.

00:01:36.796 --> 00:01:38.706 A:middle
Some layers are designed to

00:01:38.706 --> 00:01:39.626 A:middle
delay the advance of an

00:01:39.626 --> 00:01:42.566 A:middle
attacker, others to reduce the

00:01:42.566 --> 00:01:43.686 A:middle
attack surface of a component,

00:01:44.576 --> 00:01:46.726 A:middle
and some to create choke points

00:01:46.976 --> 00:01:48.216 A:middle
that make it easier to defend a

00:01:48.216 --> 00:01:48.976 A:middle
specific asset.

00:01:52.546 --> 00:01:54.636 A:middle
And today, we're here to talk

00:01:54.636 --> 00:01:56.186 A:middle
about two very different layers

00:01:56.796 --> 00:01:57.836 A:middle
of security in macOS.

00:01:59.166 --> 00:02:00.806 A:middle
First, we'll talk a little bit

00:01:59.166 --> 00:02:00.806 A:middle
First, we'll talk a little bit

00:02:00.806 --> 00:02:02.676 A:middle
about Gatekeeper, which is an

00:02:02.676 --> 00:02:03.916 A:middle
important outer layer of

00:02:03.916 --> 00:02:05.886 A:middle
security, designed to prevent

00:02:05.886 --> 00:02:07.316 A:middle
malicious software from ever

00:02:07.316 --> 00:02:08.756 A:middle
running on your system in the

00:02:09.455 --> 00:02:10.916 A:middle
first place.

00:02:11.066 --> 00:02:12.856 A:middle
Then, we'll talk about user

00:02:12.896 --> 00:02:14.796 A:middle
privacy protection, which is

00:02:14.796 --> 00:02:16.236 A:middle
designed to ensure that even if

00:02:16.236 --> 00:02:17.686 A:middle
malicious software is able to

00:02:17.686 --> 00:02:19.376 A:middle
get around Gatekeeper, it

00:02:19.376 --> 00:02:20.896 A:middle
doesn't necessarily have access

00:02:20.896 --> 00:02:22.526 A:middle
to your most sensitive data and

00:02:22.526 --> 00:02:23.006 A:middle
resources.

00:02:23.006 --> 00:02:26.936 A:middle
So let's talk about Gatekeeper.

00:02:27.986 --> 00:02:29.186 A:middle
When Gatekeeper was originally

00:02:29.186 --> 00:02:30.876 A:middle
introduced, along with the

00:02:30.876 --> 00:02:33.136 A:middle
Developer ID program, its goal

00:02:33.136 --> 00:02:34.596 A:middle
was to prevent the widespread--

00:02:35.236 --> 00:02:36.676 A:middle
prevent the outbreak, a

00:02:36.676 --> 00:02:38.476 A:middle
widespread outbreak of malicious

00:02:38.476 --> 00:02:38.836 A:middle
software.

00:02:39.526 --> 00:02:41.426 A:middle
But over the years, its goals

00:02:41.686 --> 00:02:42.576 A:middle
have broadened a bit.

00:02:43.296 --> 00:02:45.126 A:middle
And now, it's designed to

00:02:45.126 --> 00:02:46.626 A:middle
protect users from running

00:02:46.626 --> 00:02:48.496 A:middle
malicious software while leaving

00:02:48.496 --> 00:02:50.516 A:middle
them in control of what they run

00:02:50.516 --> 00:02:51.946 A:middle
on their Mac.

00:02:53.006 --> 00:02:55.056 A:middle
Now, exactly how it does this

00:02:55.056 --> 00:02:56.676 A:middle
has changed over the years too.

00:02:56.986 --> 00:02:57.736 A:middle
And while there's a lot of

00:02:57.736 --> 00:03:00.316 A:middle
nuances, Gatekeeper's intent can

00:02:57.736 --> 00:03:00.316 A:middle
nuances, Gatekeeper's intent can

00:03:00.316 --> 00:03:02.256 A:middle
generally be boiled down to a

00:03:02.256 --> 00:03:03.516 A:middle
few simple questions.

00:03:04.426 --> 00:03:05.426 A:middle
So let's talk about how

00:03:05.426 --> 00:03:06.756 A:middle
Gatekeeper achieves this goal

00:03:07.176 --> 00:03:08.006 A:middle
today.

00:03:10.156 --> 00:03:11.456 A:middle
There's four things that we

00:03:11.456 --> 00:03:15.526 A:middle
think of as part of a Gatekeeper

00:03:17.436 --> 00:03:17.566 A:middle
scan.

00:03:19.096 --> 00:03:22.016 A:middle
The first is a malicious content

00:03:22.526 --> 00:03:24.476 A:middle
scan to ensure that there's

00:03:24.476 --> 00:03:26.436 A:middle
nothing known malicious in the

00:03:26.436 --> 00:03:27.726 A:middle
app it's about to run.

00:03:28.156 --> 00:03:32.156 A:middle
Second, there's a signature

00:03:32.156 --> 00:03:34.246 A:middle
validation, to ensure that the

00:03:34.246 --> 00:03:35.476 A:middle
app hasn't been tampered with

00:03:35.876 --> 00:03:37.006 A:middle
since it was signed by the

00:03:37.006 --> 00:03:37.626 A:middle
developer.

00:03:38.246 --> 00:03:42.276 A:middle
Third, there's an identity

00:03:42.276 --> 00:03:42.886 A:middle
validation.

00:03:43.456 --> 00:03:44.526 A:middle
And this is what we use to

00:03:44.526 --> 00:03:45.776 A:middle
enforce the computer's local

00:03:45.776 --> 00:03:46.586 A:middle
security policy.

00:03:46.586 --> 00:03:48.426 A:middle
If the user has selected that

00:03:48.426 --> 00:03:49.656 A:middle
they only want to run software

00:03:49.656 --> 00:03:51.506 A:middle
from the App Store or identify

00:03:51.506 --> 00:03:53.176 A:middle
developers, then we don't want

00:03:53.176 --> 00:03:54.116 A:middle
to allow something that's been

00:03:54.116 --> 00:03:55.986 A:middle
signed by anyone else, or that

00:03:55.986 --> 00:03:57.196 A:middle
doesn't have a signature at all.

00:03:57.196 --> 00:04:01.716 A:middle
And finally, there's a first

00:03:57.196 --> 00:04:01.716 A:middle
And finally, there's a first

00:04:01.716 --> 00:04:03.466 A:middle
launch prompt, which is meant to

00:04:03.466 --> 00:04:05.146 A:middle
ensure that the user actually

00:04:05.206 --> 00:04:09.246 A:middle
wants to run this application.

00:04:09.566 --> 00:04:10.936 A:middle
Now, we can't talk about what

00:04:10.936 --> 00:04:12.656 A:middle
Gatekeeper checks without

00:04:12.656 --> 00:04:14.046 A:middle
talking about when Gatekeeper

00:04:14.046 --> 00:04:14.486 A:middle
checks it.

00:04:14.486 --> 00:04:18.755 A:middle
And in macOS Mojave, Gatekeeper

00:04:18.755 --> 00:04:21.146 A:middle
runs its scans on the first

00:04:21.146 --> 00:04:23.726 A:middle
launch of quarantined software

00:04:24.226 --> 00:04:25.526 A:middle
launched via LaunchServices.

00:04:25.526 --> 00:04:28.506 A:middle
Now, to understand that a little

00:04:28.506 --> 00:04:30.046 A:middle
better, we need to dig in on

00:04:30.046 --> 00:04:31.936 A:middle
what quarantine means and what

00:04:31.936 --> 00:04:32.996 A:middle
it means to be launched by

00:04:32.996 --> 00:04:33.966 A:middle
LaunchServices.

00:04:34.616 --> 00:04:36.776 A:middle
So let's jump into that.

00:04:38.956 --> 00:04:41.426 A:middle
Quarantine is a technology built

00:04:41.426 --> 00:04:44.046 A:middle
into macOS to mark files that

00:04:44.046 --> 00:04:46.476 A:middle
have arrived from somewhere else

00:04:46.576 --> 00:04:47.416 A:middle
off of the device.

00:04:48.166 --> 00:04:49.446 A:middle
When you download a file in a

00:04:49.446 --> 00:04:51.646 A:middle
web browser or when someone

00:04:51.646 --> 00:04:52.996 A:middle
sends you something via

00:04:52.996 --> 00:04:55.546 A:middle
iMessages, or if you get an

00:04:55.546 --> 00:04:57.226 A:middle
AirDrop, those files all get

00:04:57.226 --> 00:04:57.816 A:middle
quarantined.

00:04:59.026 --> 00:05:01.046 A:middle
Additionally, macOS will add

00:04:59.026 --> 00:05:01.046 A:middle
Additionally, macOS will add

00:05:01.046 --> 00:05:03.506 A:middle
metadata to that file about

00:05:03.506 --> 00:05:04.236 A:middle
where it came from.

00:05:05.146 --> 00:05:06.146 A:middle
So when we present a first

00:05:06.146 --> 00:05:07.676 A:middle
launch prompt, we can give you

00:05:07.676 --> 00:05:10.146 A:middle
more contexts about where that

00:05:10.286 --> 00:05:10.966 A:middle
file came from.

00:05:12.406 --> 00:05:14.776 A:middle
Now, quarantine is an opt-in

00:05:14.776 --> 00:05:16.666 A:middle
model, which means that apps

00:05:16.986 --> 00:05:18.496 A:middle
have to opt in to quarantining

00:05:18.496 --> 00:05:19.496 A:middle
the files that they place on

00:05:19.496 --> 00:05:19.846 A:middle
disk.

00:05:19.846 --> 00:05:22.876 A:middle
And that generally means that

00:05:22.876 --> 00:05:24.756 A:middle
when an app downloads files in

00:05:24.756 --> 00:05:26.486 A:middle
the background as part of, for

00:05:26.486 --> 00:05:28.076 A:middle
example, a self-update, those

00:05:28.076 --> 00:05:29.406 A:middle
files generally never get

00:05:29.456 --> 00:05:30.016 A:middle
quarantined.

00:05:31.406 --> 00:05:33.336 A:middle
The exception there is if the

00:05:33.336 --> 00:05:34.416 A:middle
app is App Sandboxed.

00:05:35.116 --> 00:05:36.456 A:middle
Because quarantining files is

00:05:36.456 --> 00:05:37.826 A:middle
the default for Sandboxed

00:05:37.826 --> 00:05:38.436 A:middle
applications.

00:05:39.166 --> 00:05:42.126 A:middle
So that helps you understand a

00:05:42.126 --> 00:05:43.496 A:middle
little bit more about what files

00:05:43.496 --> 00:05:44.286 A:middle
on a system will get

00:05:44.286 --> 00:05:44.816 A:middle
quarantined.

00:05:45.556 --> 00:05:47.336 A:middle
Now, let's talk about Launch

00:05:47.336 --> 00:05:48.016 A:middle
Services.

00:05:49.976 --> 00:05:52.916 A:middle
Launch Services is a framework

00:05:52.916 --> 00:05:53.936 A:middle
for finding and launching

00:05:53.936 --> 00:05:54.696 A:middle
applications.

00:05:54.696 --> 00:05:57.226 A:middle
And it's generally responsible

00:05:57.226 --> 00:05:58.606 A:middle
for most of the ways that you

00:05:58.606 --> 00:05:59.836 A:middle
think of launching applications

00:05:59.836 --> 00:06:00.226 A:middle
on your Mac.

00:05:59.836 --> 00:06:00.226 A:middle
on your Mac.

00:06:01.286 --> 00:06:02.686 A:middle
For example, when you open an

00:06:02.966 --> 00:06:04.786 A:middle
app in Finder or the Dock that

00:06:04.786 --> 00:06:05.846 A:middle
will use Launch Services.

00:06:06.896 --> 00:06:08.906 A:middle
If you use the NSWorkspace APIs,

00:06:09.346 --> 00:06:10.416 A:middle
those generally go through

00:06:10.416 --> 00:06:11.366 A:middle
Launch Services also.

00:06:12.656 --> 00:06:13.656 A:middle
And when apps get open via

00:06:13.656 --> 00:06:15.266 A:middle
document handlers or directly

00:06:15.266 --> 00:06:16.976 A:middle
through URLs, that all goes

00:06:16.976 --> 00:06:17.846 A:middle
through Launch Services.

00:06:18.546 --> 00:06:21.396 A:middle
Now, for the rest of the

00:06:21.396 --> 00:06:23.056 A:middle
presentation, I'll use this

00:06:23.056 --> 00:06:24.396 A:middle
Finder icon when I'm

00:06:24.396 --> 00:06:25.476 A:middle
specifically talking about

00:06:25.476 --> 00:06:26.396 A:middle
something that goes through the

00:06:26.396 --> 00:06:27.976 A:middle
Launch Services path.

00:06:32.756 --> 00:06:34.556 A:middle
But there are also many ways of

00:06:34.556 --> 00:06:36.436 A:middle
loading code that don't go

00:06:36.436 --> 00:06:37.476 A:middle
through Launch Services.

00:06:38.436 --> 00:06:39.766 A:middle
Some examples that are not

00:06:39.766 --> 00:06:41.896 A:middle
exhaustive, include using NSTask

00:06:42.826 --> 00:06:45.336 A:middle
to start a process, or the exec

00:06:45.336 --> 00:06:48.126 A:middle
and posix spawn's calls or

00:06:48.126 --> 00:06:49.316 A:middle
loading a library into your

00:06:49.316 --> 00:06:50.966 A:middle
process using the NSBundle APIs

00:06:50.966 --> 00:06:52.916 A:middle
for loading or dlopen.

00:06:53.596 --> 00:06:55.616 A:middle
And for the rest of the

00:06:55.616 --> 00:06:58.166 A:middle
presentation, I'll use this

00:06:58.166 --> 00:07:00.296 A:middle
terminal icon when I want to

00:06:58.166 --> 00:07:00.296 A:middle
terminal icon when I want to

00:07:00.296 --> 00:07:02.326 A:middle
refer to loading code off of the

00:07:02.326 --> 00:07:04.046 A:middle
Launch Services path.

00:07:06.386 --> 00:07:07.856 A:middle
Now, let's quickly summarize

00:07:07.916 --> 00:07:08.916 A:middle
everything that we've learned

00:07:08.916 --> 00:07:10.686 A:middle
about Gatekeeper in a format

00:07:10.686 --> 00:07:12.026 A:middle
that will make it easier to talk

00:07:12.026 --> 00:07:13.636 A:middle
about what's changed this year.

00:07:14.306 --> 00:07:18.886 A:middle
So here, we can see Gatekeeper's

00:07:18.886 --> 00:07:21.286 A:middle
behavior and macOS Mojave that

00:07:21.286 --> 00:07:22.966 A:middle
on the first launch of

00:07:23.066 --> 00:07:25.096 A:middle
quarantine software on the

00:07:25.096 --> 00:07:27.536 A:middle
Launch Services path, Gatekeeper

00:07:27.536 --> 00:07:28.956 A:middle
will perform a malicious content

00:07:28.956 --> 00:07:30.956 A:middle
scan and a signature check to

00:07:30.956 --> 00:07:31.966 A:middle
ensure that there's no known

00:07:31.966 --> 00:07:33.056 A:middle
malicious content and that the

00:07:33.056 --> 00:07:34.396 A:middle
application hasn't been tampered

00:07:34.396 --> 00:07:34.586 A:middle
with.

00:07:35.206 --> 00:07:37.586 A:middle
Then it will perform a local

00:07:37.586 --> 00:07:39.576 A:middle
policy check where the default

00:07:39.576 --> 00:07:40.506 A:middle
is that it must be signed with

00:07:40.506 --> 00:07:42.556 A:middle
the Developer ID certificate or

00:07:42.556 --> 00:07:43.256 A:middle
by the App Store.

00:07:44.676 --> 00:07:45.746 A:middle
And finally, it will present the

00:07:45.746 --> 00:07:47.226 A:middle
first launch prompt to the user,

00:07:47.436 --> 00:07:48.986 A:middle
so that the user must approve

00:07:49.656 --> 00:07:50.776 A:middle
the application.

00:07:50.776 --> 00:07:52.556 A:middle
Now, starting with the latest

00:07:52.556 --> 00:07:56.366 A:middle
release of macOS Mojave 10.14.5,

00:07:57.306 --> 00:07:59.066 A:middle
the default policy was changed

00:07:59.066 --> 00:08:01.026 A:middle
slightly such that new Mac

00:07:59.066 --> 00:08:01.026 A:middle
slightly such that new Mac

00:08:01.116 --> 00:08:03.426 A:middle
developer certificates required

00:08:03.426 --> 00:08:04.836 A:middle
their software to be notarized

00:08:05.166 --> 00:08:09.166 A:middle
to pass Gatekeeper, which brings

00:08:09.166 --> 00:08:10.766 A:middle
us to the first improvement in

00:08:10.936 --> 00:08:11.636 A:middle
macOS Catalina.

00:08:12.586 --> 00:08:14.036 A:middle
We're expanding on this policy

00:08:14.546 --> 00:08:16.176 A:middle
such that all new software

00:08:16.586 --> 00:08:17.746 A:middle
requires notarization.

00:08:18.396 --> 00:08:22.326 A:middle
And in this case, new means that

00:08:22.326 --> 00:08:24.546 A:middle
the software was signed or built

00:08:24.546 --> 00:08:28.736 A:middle
after June 1st, 2019.

00:08:28.946 --> 00:08:30.476 A:middle
This means that all existing

00:08:30.476 --> 00:08:32.265 A:middle
software will continue to pass

00:08:32.265 --> 00:08:34.275 A:middle
through Gatekeeper as is, with

00:08:34.275 --> 00:08:35.816 A:middle
just a Developer ID certificate

00:08:35.816 --> 00:08:36.206 A:middle
signature.

00:08:37.035 --> 00:08:38.916 A:middle
But that all new software must

00:08:38.916 --> 00:08:40.246 A:middle
be notarized to pass Gatekeeper.

00:08:44.436 --> 00:08:47.406 A:middle
Now, the next improvement that

00:08:47.406 --> 00:08:49.716 A:middle
we've made in macOS Catalina is

00:08:49.716 --> 00:08:50.776 A:middle
that Gatekeeper is going to be

00:08:50.776 --> 00:08:53.486 A:middle
expanding to enforce the same

00:08:53.486 --> 00:08:56.096 A:middle
policy on all quarantine

00:08:56.096 --> 00:08:56.576 A:middle
software.

00:08:58.076 --> 00:08:59.586 A:middle
And that means that regardless

00:08:59.776 --> 00:09:01.256 A:middle
of how the software is loaded,

00:08:59.776 --> 00:09:01.256 A:middle
of how the software is loaded,

00:09:01.306 --> 00:09:04.376 A:middle
if it's quarantined, it must

00:09:04.876 --> 00:09:06.086 A:middle
contain no known malicious

00:09:06.086 --> 00:09:08.246 A:middle
content, it must not be tampered

00:09:08.246 --> 00:09:10.936 A:middle
with, new software will require

00:09:10.936 --> 00:09:11.636 A:middle
notarization.

00:09:11.636 --> 00:09:13.886 A:middle
And the first launch policy will

00:09:13.886 --> 00:09:15.416 A:middle
be slightly different, where we

00:09:15.416 --> 00:09:17.366 A:middle
won't be requiring first launch

00:09:17.506 --> 00:09:20.176 A:middle
user approval for standalone

00:09:20.246 --> 00:09:22.596 A:middle
executables or libraries, but

00:09:22.596 --> 00:09:24.566 A:middle
all bundled software will show

00:09:24.566 --> 00:09:26.046 A:middle
first launch prompt.

00:09:28.776 --> 00:09:30.106 A:middle
So now, Gatekeeper has been

00:09:30.106 --> 00:09:31.966 A:middle
expanded to scan and enforce

00:09:31.966 --> 00:09:33.826 A:middle
policy on all quarantine

00:09:33.826 --> 00:09:34.266 A:middle
software.

00:09:35.746 --> 00:09:36.906 A:middle
And that brings me to the final

00:09:36.906 --> 00:09:38.596 A:middle
improvement in macOS Catalina,

00:09:39.706 --> 00:09:41.236 A:middle
Gatekeeper will be further

00:09:41.236 --> 00:09:43.786 A:middle
protecting you by ensuring that

00:09:43.786 --> 00:09:45.966 A:middle
all software gets a malicious

00:09:45.966 --> 00:09:46.676 A:middle
content scan.

00:09:47.316 --> 00:09:50.696 A:middle
And that means that regardless

00:09:50.696 --> 00:09:51.516 A:middle
of whether software is

00:09:51.516 --> 00:09:53.666 A:middle
quarantined, and regardless of

00:09:53.666 --> 00:09:56.056 A:middle
how that code is loaded, if any

00:09:56.056 --> 00:09:57.136 A:middle
known malicious content is

00:09:57.136 --> 00:09:59.126 A:middle
found, it will be blocked and

00:10:00.156 --> 00:10:03.096 A:middle
the user will be alerted.

00:10:04.406 --> 00:10:06.276 A:middle
So this is a summary of all the

00:10:06.276 --> 00:10:08.196 A:middle
ways that Gatekeeper has been

00:10:08.196 --> 00:10:10.646 A:middle
expanded to help protect you in

00:10:10.786 --> 00:10:11.396 A:middle
macOS Catalina.

00:10:12.916 --> 00:10:14.816 A:middle
But it's important to keep one

00:10:14.816 --> 00:10:18.116 A:middle
thing in mind.

00:10:18.276 --> 00:10:19.866 A:middle
Our goal is to make every Mac

00:10:19.866 --> 00:10:23.106 A:middle
user safe by default, but not to

00:10:23.106 --> 00:10:24.216 A:middle
prevent you from running the

00:10:24.216 --> 00:10:26.126 A:middle
software that you want to run on

00:10:26.126 --> 00:10:26.436 A:middle
your Mac.

00:10:28.036 --> 00:10:29.586 A:middle
And that means that there will

00:10:29.586 --> 00:10:31.366 A:middle
always be a way to run a

00:10:31.366 --> 00:10:33.056 A:middle
specific piece of software that

00:10:33.056 --> 00:10:34.926 A:middle
you want to run on your system.

00:10:39.416 --> 00:10:41.346 A:middle
Now, I talked a little bit

00:10:41.346 --> 00:10:42.516 A:middle
earlier about how every year

00:10:42.516 --> 00:10:44.266 A:middle
we're continuously improving the

00:10:44.266 --> 00:10:46.056 A:middle
technologies and policies that

00:10:46.056 --> 00:10:46.946 A:middle
we have at every layer.

00:10:47.836 --> 00:10:49.186 A:middle
So I'd also like to take a

00:10:49.186 --> 00:10:50.106 A:middle
minute to talk a little bit

00:10:50.106 --> 00:10:52.436 A:middle
about what's next for

00:10:52.436 --> 00:10:52.886 A:middle
Gatekeeper.

00:10:53.586 --> 00:10:56.886 A:middle
Now, we have a really big goal

00:10:57.546 --> 00:10:58.356 A:middle
on the security engineering

00:10:58.356 --> 00:10:58.546 A:middle
team.

00:10:58.906 --> 00:11:01.216 A:middle
We want to make macOS just as

00:10:58.906 --> 00:11:01.216 A:middle
We want to make macOS just as

00:11:01.216 --> 00:11:04.496 A:middle
secure as iOS, while still

00:11:04.496 --> 00:11:06.126 A:middle
maintaining all the flexibility

00:11:06.126 --> 00:11:07.856 A:middle
that you've come to expect out

00:11:07.856 --> 00:11:08.256 A:middle
of your Mac.

00:11:09.566 --> 00:11:10.656 A:middle
And that presents some really

00:11:10.656 --> 00:11:11.626 A:middle
interesting challenges.

00:11:13.006 --> 00:11:14.176 A:middle
But one thing has become really

00:11:14.176 --> 00:11:16.956 A:middle
clear, the security of the

00:11:16.956 --> 00:11:18.556 A:middle
platform has become increasingly

00:11:18.556 --> 00:11:20.416 A:middle
reliant on the validity of code

00:11:20.416 --> 00:11:20.926 A:middle
signatures.

00:11:21.576 --> 00:11:26.416 A:middle
And this means that if an app

00:11:26.416 --> 00:11:29.456 A:middle
has no signature, it's

00:11:29.686 --> 00:11:31.516 A:middle
impossible to detect tampering.

00:11:32.256 --> 00:11:36.686 A:middle
And further, if a bundle

00:11:36.686 --> 00:11:39.466 A:middle
signature has become broken at

00:11:40.776 --> 00:11:42.366 A:middle
runtime, it's very difficult to

00:11:42.366 --> 00:11:44.006 A:middle
differentiate malicious

00:11:44.006 --> 00:11:46.356 A:middle
tampering from mundane tampering

00:11:46.546 --> 00:11:47.926 A:middle
when in out modifies itself at

00:11:47.926 --> 00:11:48.186 A:middle
runtime.

00:11:53.076 --> 00:11:54.376 A:middle
And in a future version of

00:11:54.376 --> 00:11:57.026 A:middle
macOS, unsigned code will not

00:11:57.026 --> 00:11:57.976 A:middle
run by default anymore.

00:12:02.056 --> 00:12:03.156 A:middle
And to get there, there's a

00:12:03.156 --> 00:12:04.566 A:middle
couple of things that you can do

00:12:04.566 --> 00:12:06.786 A:middle
to help improve the security of

00:12:06.786 --> 00:12:07.266 A:middle
the platform.

00:12:08.706 --> 00:12:12.256 A:middle
First, sign and notarize all the

00:12:12.256 --> 00:12:14.006 A:middle
software that you distribute,

00:12:14.516 --> 00:12:15.376 A:middle
even if it doesn't get

00:12:15.376 --> 00:12:15.976 A:middle
quarantined today.

00:12:20.616 --> 00:12:24.406 A:middle
Second, don't break application

00:12:24.406 --> 00:12:25.816 A:middle
or bundle signatures at runtime.

00:12:26.886 --> 00:12:28.176 A:middle
If you do need to update an

00:12:28.176 --> 00:12:29.616 A:middle
application, make sure that it

00:12:29.616 --> 00:12:31.136 A:middle
results in an application on

00:12:31.136 --> 00:12:33.016 A:middle
disk that is properly signed and

00:12:33.016 --> 00:12:34.546 A:middle
notarized still.

00:12:37.096 --> 00:12:39.636 A:middle
And finally, remember that

00:12:39.636 --> 00:12:41.126 A:middle
loading code can fail.

00:12:41.656 --> 00:12:43.036 A:middle
If you try to load a quarantine

00:12:43.036 --> 00:12:44.436 A:middle
library or process and the user

00:12:44.436 --> 00:12:46.626 A:middle
chooses not to run it, that will

00:12:46.626 --> 00:12:48.786 A:middle
fail and ensure that your apps

00:12:48.896 --> 00:12:50.006 A:middle
gracefully handle these

00:12:50.006 --> 00:12:50.486 A:middle
failures.

00:12:56.426 --> 00:12:57.846 A:middle
So these are all the ways that

00:12:57.846 --> 00:12:59.706 A:middle
Gatekeeper has been expanded to

00:12:59.706 --> 00:13:00.626 A:middle
try to prevent malicious

00:12:59.706 --> 00:13:00.626 A:middle
try to prevent malicious

00:13:00.626 --> 00:13:01.866 A:middle
software from ever running on

00:13:01.866 --> 00:13:02.116 A:middle
your Mac.

00:13:03.216 --> 00:13:04.686 A:middle
Now, let's bring up Kelly to

00:13:04.686 --> 00:13:06.246 A:middle
talk about advancements in user

00:13:06.286 --> 00:13:07.196 A:middle
privacy protection.

00:13:08.226 --> 00:13:08.536 A:middle
Kelly.

00:13:09.516 --> 00:13:13.376 A:middle
[ Applause ]

00:13:13.876 --> 00:13:14.666 A:middle
&gt;&gt; Well, thank you, Garrett.

00:13:15.046 --> 00:13:16.186 A:middle
Good morning, everyone.

00:13:16.386 --> 00:13:17.616 A:middle
My name is Kelly Yancey.

00:13:17.616 --> 00:13:18.756 A:middle
I work with Garrett in the

00:13:18.756 --> 00:13:19.606 A:middle
security engineering and

00:13:19.606 --> 00:13:20.726 A:middle
architecture team at Apple.

00:13:21.276 --> 00:13:24.746 A:middle
And last year at WWDC 2018, it

00:13:24.746 --> 00:13:26.596 A:middle
was my privilege to introduce

00:13:26.596 --> 00:13:28.306 A:middle
the new privacy protections in

00:13:28.306 --> 00:13:30.416 A:middle
macOS Mojave, broadly

00:13:30.416 --> 00:13:31.466 A:middle
characterized-- sorry.

00:13:31.466 --> 00:13:32.766 A:middle
Let's get to that.

00:13:32.766 --> 00:13:34.406 A:middle
These protections were designed

00:13:34.406 --> 00:13:36.476 A:middle
to improve user's transparency

00:13:36.476 --> 00:13:38.066 A:middle
over their-- how their data was

00:13:38.096 --> 00:13:39.476 A:middle
being accessed and give them

00:13:39.476 --> 00:13:40.966 A:middle
control over those accesses.

00:13:41.226 --> 00:13:42.096 A:middle
And I'm really excited to be

00:13:42.096 --> 00:13:43.606 A:middle
back here today to talk about

00:13:43.606 --> 00:13:44.686 A:middle
the improvements that we've made

00:13:44.926 --> 00:13:45.996 A:middle
in macOS Catalina.

00:13:47.446 --> 00:13:49.046 A:middle
Now, broadly characterized,

00:13:49.176 --> 00:13:51.496 A:middle
their privacy protections

00:13:51.496 --> 00:13:53.396 A:middle
require user consent to access

00:13:53.396 --> 00:13:54.646 A:middle
hardware that could record the

00:13:54.646 --> 00:13:56.336 A:middle
users, such as the camera or

00:13:56.336 --> 00:13:58.806 A:middle
microphone, or to access the

00:13:58.806 --> 00:14:00.566 A:middle
user's privacy sensitive files

00:13:58.806 --> 00:14:00.566 A:middle
user's privacy sensitive files

00:14:00.566 --> 00:14:03.056 A:middle
or folders, such as photos, mail

00:14:03.056 --> 00:14:03.746 A:middle
or messages.

00:14:04.916 --> 00:14:07.596 A:middle
In addition, they also protect

00:14:07.596 --> 00:14:08.896 A:middle
the ability to automate other

00:14:08.896 --> 00:14:10.986 A:middle
apps, so that the user is in

00:14:10.986 --> 00:14:12.456 A:middle
control over how their data is

00:14:12.456 --> 00:14:13.586 A:middle
being shared between apps.

00:14:14.666 --> 00:14:16.096 A:middle
I like to start today by looking

00:14:16.096 --> 00:14:17.276 A:middle
at the recording capabilities.

00:14:18.456 --> 00:14:20.766 A:middle
Beginning in macOS Mojave, users

00:14:20.766 --> 00:14:22.386 A:middle
have to consent before an app

00:14:22.386 --> 00:14:23.456 A:middle
can access the camera or

00:14:23.456 --> 00:14:24.026 A:middle
microphone.

00:14:24.796 --> 00:14:26.946 A:middle
And then macOS Catalina further

00:14:26.946 --> 00:14:29.106 A:middle
requires consent to record the

00:14:29.106 --> 00:14:31.166 A:middle
contents of your screen or the

00:14:31.166 --> 00:14:32.056 A:middle
keys that you type on your

00:14:32.056 --> 00:14:32.416 A:middle
keyboard.

00:14:32.486 --> 00:14:35.566 A:middle
And this is important because

00:14:35.666 --> 00:14:36.766 A:middle
just like we don't want people

00:14:36.766 --> 00:14:38.136 A:middle
shoulder surfing, looking over

00:14:38.136 --> 00:14:38.976 A:middle
our shoulder to see what we're

00:14:38.976 --> 00:14:41.746 A:middle
doing or are typing, we don't

00:14:41.746 --> 00:14:45.416 A:middle
want apps to eavesdrop on our

00:14:45.416 --> 00:14:47.206 A:middle
contact information, our bank

00:14:47.206 --> 00:14:49.746 A:middle
details or passwords and so on,

00:14:49.746 --> 00:14:50.956 A:middle
whether that's intentionally or

00:14:50.956 --> 00:14:51.606 A:middle
accidentally.

00:14:52.136 --> 00:14:54.246 A:middle
So how do we do that?

00:14:54.646 --> 00:14:55.796 A:middle
Let's start by looking at screen

00:14:55.796 --> 00:14:56.196 A:middle
recording.

00:14:56.636 --> 00:14:59.686 A:middle
Here's a simple example of using

00:14:59.736 --> 00:15:01.586 A:middle
CGDisplayStream to record the

00:14:59.736 --> 00:15:01.586 A:middle
CGDisplayStream to record the

00:15:01.586 --> 00:15:02.856 A:middle
contents of a display in real

00:15:02.856 --> 00:15:03.166 A:middle
time.

00:15:03.806 --> 00:15:05.636 A:middle
On macOS Catalina, the first

00:15:05.636 --> 00:15:09.456 A:middle
time this app runs and this call

00:15:09.626 --> 00:15:12.156 A:middle
to create the CGDisplayStream is

00:15:12.156 --> 00:15:14.776 A:middle
made that'll return nil, and a

00:15:14.776 --> 00:15:16.876 A:middle
dialogue is displayed directing

00:15:16.876 --> 00:15:17.876 A:middle
the user to the security and

00:15:17.876 --> 00:15:20.656 A:middle
privacy preference pane, where

00:15:20.656 --> 00:15:22.226 A:middle
the user can approve the app to

00:15:22.226 --> 00:15:24.076 A:middle
record the screen if that's what

00:15:24.076 --> 00:15:26.786 A:middle
they want to do.

00:15:26.986 --> 00:15:28.466 A:middle
The same is true when reading

00:15:28.466 --> 00:15:29.896 A:middle
the contents of other apps

00:15:29.896 --> 00:15:30.366 A:middle
windows.

00:15:30.796 --> 00:15:32.306 A:middle
For example, here's a function

00:15:32.596 --> 00:15:33.656 A:middle
that saves the contents of a

00:15:33.656 --> 00:15:35.326 A:middle
window to an image on disk.

00:15:36.786 --> 00:15:38.186 A:middle
Now, notably, the call to

00:15:38.246 --> 00:15:41.166 A:middle
CGWindowListCreateImage can

00:15:41.166 --> 00:15:43.136 A:middle
return nil, if passed the window

00:15:43.276 --> 00:15:46.056 A:middle
ID that does not belong to the

00:15:46.056 --> 00:15:48.846 A:middle
calling app, and doesn't belong

00:15:48.846 --> 00:15:50.766 A:middle
to the desktop background image

00:15:51.206 --> 00:15:52.146 A:middle
or to the menu bar.

00:15:52.146 --> 00:15:53.366 A:middle
And I like to emphasize, this is

00:15:53.366 --> 00:15:54.636 A:middle
the background image, it doesn't

00:15:54.636 --> 00:15:56.916 A:middle
include the icons or names of

00:15:56.916 --> 00:15:58.476 A:middle
any files on the desktop.

00:16:00.656 --> 00:16:03.056 A:middle
Again, an authorization dialog,

00:16:03.266 --> 00:16:04.816 A:middle
directing the user to approve

00:16:04.816 --> 00:16:06.946 A:middle
the app for screen recording,

00:16:06.946 --> 00:16:07.846 A:middle
may be displayed.

00:16:08.026 --> 00:16:09.446 A:middle
And I say may, because the

00:16:09.446 --> 00:16:10.746 A:middle
dialog is only displayed the

00:16:10.746 --> 00:16:11.606 A:middle
first time

00:16:11.606 --> 00:16:14.356 A:middle
CGWindowListCreateImage or

00:16:14.356 --> 00:16:16.336 A:middle
CGDisplayStream fails due to a

00:16:16.336 --> 00:16:17.946 A:middle
lack of approval for screen

00:16:17.946 --> 00:16:18.316 A:middle
recording.

00:16:18.786 --> 00:16:22.226 A:middle
Another topic I'd like to cover

00:16:22.306 --> 00:16:23.676 A:middle
that's peripherally related to

00:16:23.676 --> 00:16:25.096 A:middle
screen recording is window

00:16:25.096 --> 00:16:25.586 A:middle
metadata.

00:16:26.776 --> 00:16:28.376 A:middle
Apps can query metadata about

00:16:28.376 --> 00:16:29.666 A:middle
the windows that are on or off

00:16:29.666 --> 00:16:31.766 A:middle
screen using the core graphics

00:16:31.906 --> 00:16:33.946 A:middle
CGWindowListCopyWindowInfo

00:16:35.136 --> 00:16:35.796 A:middle
function.

00:16:36.696 --> 00:16:39.176 A:middle
The metadata returned includes

00:16:39.176 --> 00:16:40.806 A:middle
the size and position of the

00:16:40.806 --> 00:16:42.576 A:middle
window and the unique window

00:16:42.576 --> 00:16:44.036 A:middle
identifier, as well as the name

00:16:44.036 --> 00:16:45.896 A:middle
and process of identifier of the

00:16:45.896 --> 00:16:47.086 A:middle
app that owns the window.

00:16:47.536 --> 00:16:50.326 A:middle
However, the window name and

00:16:50.326 --> 00:16:52.176 A:middle
sharing state are not available,

00:16:52.456 --> 00:16:54.196 A:middle
unless the user has preapproved

00:16:54.196 --> 00:16:55.696 A:middle
the app for screen recording.

00:16:56.506 --> 00:16:57.706 A:middle
And this is because some apps

00:16:57.936 --> 00:16:59.166 A:middle
put sensitive data such as

00:16:59.166 --> 00:17:01.736 A:middle
account names or more likely web

00:16:59.166 --> 00:17:01.736 A:middle
account names or more likely web

00:17:01.736 --> 00:17:04.016 A:middle
page URLs in the window's name.

00:17:05.435 --> 00:17:08.465 A:middle
And CGWindowListCopyWindowInfo

00:17:08.986 --> 00:17:10.346 A:middle
never triggers an authorization

00:17:10.346 --> 00:17:11.766 A:middle
prompt, instead it filters the

00:17:11.766 --> 00:17:13.066 A:middle
set of metadata that it returns

00:17:13.066 --> 00:17:13.606 A:middle
to the caller.

00:17:14.136 --> 00:17:16.626 A:middle
So, if in your app you depend on

00:17:16.626 --> 00:17:17.816 A:middle
getting the window name, for

00:17:17.816 --> 00:17:19.896 A:middle
example, and you find that the

00:17:19.896 --> 00:17:20.976 A:middle
metadata that's being returned

00:17:20.976 --> 00:17:22.116 A:middle
doesn't include the window name,

00:17:22.415 --> 00:17:24.586 A:middle
you may want to alert the user

00:17:24.586 --> 00:17:26.536 A:middle
and direct them to the privacy--

00:17:26.776 --> 00:17:28.096 A:middle
security and privacy preference

00:17:28.596 --> 00:17:28.686 A:middle
pane.

00:17:29.716 --> 00:17:32.986 A:middle
So, here's an example of a

00:17:32.986 --> 00:17:34.216 A:middle
function that gets the unique

00:17:34.216 --> 00:17:36.086 A:middle
window identifiers for the

00:17:36.086 --> 00:17:37.426 A:middle
desktop background image for

00:17:37.426 --> 00:17:38.066 A:middle
each display.

00:17:38.066 --> 00:17:40.356 A:middle
And once again, the background

00:17:40.356 --> 00:17:42.696 A:middle
image doesn't include the icons

00:17:42.696 --> 00:17:43.426 A:middle
on the desktop.

00:17:46.136 --> 00:17:48.066 A:middle
This function first gets a list

00:17:48.066 --> 00:17:49.616 A:middle
of all of the windows on the

00:17:49.616 --> 00:17:50.606 A:middle
screen, using the

00:17:50.686 --> 00:17:52.876 A:middle
CGWindowListCopyWindowInfo

00:17:52.876 --> 00:17:53.206 A:middle
function.

00:17:54.436 --> 00:17:56.886 A:middle
But then, it gets the window

00:17:56.886 --> 00:17:58.496 A:middle
level or Z order that core

00:17:58.496 --> 00:17:59.876 A:middle
graphics uses for the desktop

00:17:59.876 --> 00:18:01.276 A:middle
background image window.

00:17:59.876 --> 00:18:01.276 A:middle
background image window.

00:18:02.856 --> 00:18:04.636 A:middle
Then it filters that whole

00:18:04.636 --> 00:18:06.626 A:middle
window list to just those

00:18:06.626 --> 00:18:07.946 A:middle
windows at the desktop

00:18:07.946 --> 00:18:09.126 A:middle
background window level.

00:18:10.106 --> 00:18:11.396 A:middle
So if you look on the internet,

00:18:11.396 --> 00:18:12.186 A:middle
you'll find a lot of code

00:18:12.186 --> 00:18:14.796 A:middle
samples filter by the kCG window

00:18:14.796 --> 00:18:16.806 A:middle
name which, since the window

00:18:16.806 --> 00:18:17.986 A:middle
names may contain privacy

00:18:17.986 --> 00:18:19.636 A:middle
sensitive information, would

00:18:19.636 --> 00:18:20.636 A:middle
require the app to be

00:18:20.636 --> 00:18:21.736 A:middle
preapproved for screen

00:18:21.736 --> 00:18:22.166 A:middle
recording.

00:18:23.146 --> 00:18:24.636 A:middle
However, by identifying the

00:18:24.636 --> 00:18:26.676 A:middle
desktop background windows by

00:18:26.676 --> 00:18:27.976 A:middle
their window level rather than

00:18:27.976 --> 00:18:30.206 A:middle
by the window name, this works

00:18:30.206 --> 00:18:31.536 A:middle
regardless of whether the user

00:18:31.536 --> 00:18:32.726 A:middle
has preapproved the app for

00:18:32.726 --> 00:18:33.416 A:middle
screen recording.

00:18:33.756 --> 00:18:34.846 A:middle
And this is an example of how a

00:18:34.846 --> 00:18:37.726 A:middle
small change in your-- the

00:18:37.726 --> 00:18:40.196 A:middle
design of your app can make a

00:18:40.196 --> 00:18:42.246 A:middle
big difference in the user

00:18:42.246 --> 00:18:42.796 A:middle
experience.

00:18:43.366 --> 00:18:46.916 A:middle
So that's how macOS Catalina

00:18:46.916 --> 00:18:48.836 A:middle
protects the contents of your

00:18:48.836 --> 00:18:50.026 A:middle
screen from being recorded

00:18:50.026 --> 00:18:50.856 A:middle
without your permission.

00:18:51.356 --> 00:18:52.606 A:middle
Apps can freely record the

00:18:52.606 --> 00:18:55.016 A:middle
contents of their own windows,

00:18:56.216 --> 00:18:57.786 A:middle
the menu bar and the desktop

00:18:57.786 --> 00:18:58.616 A:middle
background image.

00:18:59.746 --> 00:19:00.926 A:middle
But the user must use the

00:18:59.746 --> 00:19:00.926 A:middle
But the user must use the

00:19:00.926 --> 00:19:02.386 A:middle
security and privacy preference

00:19:02.386 --> 00:19:04.616 A:middle
pane to preapprove apps to

00:19:04.616 --> 00:19:07.746 A:middle
record the entire screen or the

00:19:07.746 --> 00:19:08.826 A:middle
contents of windows other than

00:19:08.826 --> 00:19:08.976 A:middle
their own.

00:19:12.066 --> 00:19:13.086 A:middle
Now, I'd like to present the

00:19:13.086 --> 00:19:14.316 A:middle
other recording capability now

00:19:14.316 --> 00:19:15.756 A:middle
protected in macOS Catalina,

00:19:15.996 --> 00:19:18.586 A:middle
your keyboard.

00:19:18.586 --> 00:19:20.266 A:middle
Most users have an expectation

00:19:20.636 --> 00:19:22.546 A:middle
that their keystrokes are only

00:19:22.546 --> 00:19:23.436 A:middle
going to the app that they're

00:19:23.436 --> 00:19:24.876 A:middle
interacting with, the front most

00:19:25.076 --> 00:19:27.566 A:middle
app, and most apps only require

00:19:27.566 --> 00:19:28.846 A:middle
a keyboard input when the user

00:19:28.846 --> 00:19:29.796 A:middle
is actively using them.

00:19:30.166 --> 00:19:31.736 A:middle
And in fact, if your app uses

00:19:31.776 --> 00:19:33.536 A:middle
the standard UI components, they

00:19:33.536 --> 00:19:34.586 A:middle
handle those keyboard events

00:19:34.586 --> 00:19:35.556 A:middle
that are being delivered to your

00:19:35.556 --> 00:19:36.426 A:middle
app automatically.

00:19:36.426 --> 00:19:38.896 A:middle
Now, some apps want to be able

00:19:38.896 --> 00:19:40.956 A:middle
to intercept those events as

00:19:40.956 --> 00:19:41.886 A:middle
they're being delivered to their

00:19:41.886 --> 00:19:42.126 A:middle
app.

00:19:42.126 --> 00:19:43.636 A:middle
And that's fine, they can

00:19:43.636 --> 00:19:46.436 A:middle
subclass NSApplication and

00:19:46.436 --> 00:19:47.916 A:middle
override the sendEvent method,

00:19:48.346 --> 00:19:50.346 A:middle
or as shown here, you can use

00:19:50.346 --> 00:19:51.066 A:middle
NSEvent's

00:19:51.066 --> 00:19:53.206 A:middle
addLocalMonitorForEvents

00:19:56.606 --> 00:19:56.836 A:middle
function.

00:19:56.936 --> 00:19:58.636 A:middle
Monitoring all keyboard events,

00:19:59.076 --> 00:20:00.346 A:middle
including those for other apps,

00:19:59.076 --> 00:20:00.346 A:middle
including those for other apps,

00:20:00.346 --> 00:20:02.076 A:middle
however, requires user approval.

00:20:03.156 --> 00:20:04.466 A:middle
And here you can see an example

00:20:04.466 --> 00:20:07.776 A:middle
of using CGEventTapCreate to

00:20:07.776 --> 00:20:09.856 A:middle
invoke a callback for key press

00:20:09.856 --> 00:20:10.596 A:middle
and release events.

00:20:11.706 --> 00:20:12.836 A:middle
Now, the first time this code

00:20:12.836 --> 00:20:14.556 A:middle
runs, this call, the

00:20:14.556 --> 00:20:18.136 A:middle
CGEventTapCreate will fail and

00:20:18.136 --> 00:20:21.776 A:middle
return nil.

00:20:22.006 --> 00:20:24.086 A:middle
Meanwhile, a dialog is displayed

00:20:24.086 --> 00:20:25.026 A:middle
directing the user to the

00:20:25.026 --> 00:20:26.226 A:middle
security and privacy preference

00:20:26.226 --> 00:20:28.416 A:middle
pane, where the user can approve

00:20:28.416 --> 00:20:29.816 A:middle
your app to monitor keyboard

00:20:29.816 --> 00:20:31.546 A:middle
events in the background, if

00:20:31.546 --> 00:20:32.556 A:middle
they so desire.

00:20:32.966 --> 00:20:35.906 A:middle
Now, apps may check the

00:20:35.906 --> 00:20:37.636 A:middle
authorization status without

00:20:37.636 --> 00:20:38.896 A:middle
triggering the approval prompt,

00:20:39.976 --> 00:20:42.366 A:middle
using the IOHIDCheckAccess

00:20:42.366 --> 00:20:42.946 A:middle
function with the

00:20:42.946 --> 00:20:45.516 A:middle
kIOHIDRequestTypeListenEvent

00:20:45.516 --> 00:20:45.936 A:middle
parameter.

00:20:46.486 --> 00:20:50.576 A:middle
And apps can request an approval

00:20:50.576 --> 00:20:51.986 A:middle
dialog to be displayed without

00:20:51.986 --> 00:20:54.466 A:middle
creating an event tab or trying

00:20:54.466 --> 00:20:56.796 A:middle
to post an event by using the

00:20:56.796 --> 00:20:58.776 A:middle
IOHIDRequestAccess function,

00:20:58.776 --> 00:20:59.816 A:middle
again with the same parameter.

00:21:00.406 --> 00:21:03.856 A:middle
So in summary, macOS Catalina

00:21:03.856 --> 00:21:05.436 A:middle
now requires user consent for

00:21:05.436 --> 00:21:07.176 A:middle
apps to record the contents of

00:21:07.176 --> 00:21:08.976 A:middle
your screen or the keys that you

00:21:08.976 --> 00:21:09.826 A:middle
type on your keyboard.

00:21:11.196 --> 00:21:12.186 A:middle
Now, I'd like to turn your

00:21:12.186 --> 00:21:15.116 A:middle
attention to how macOS protects

00:21:15.116 --> 00:21:16.776 A:middle
access to your privacy sensitive

00:21:16.776 --> 00:21:17.126 A:middle
files.

00:21:17.766 --> 00:21:20.776 A:middle
So continuing the approach in

00:21:20.776 --> 00:21:24.056 A:middle
Mojave, macOS Catalina offers

00:21:24.056 --> 00:21:25.606 A:middle
two broad levels of privacy

00:21:25.606 --> 00:21:27.426 A:middle
protection for the user's files

00:21:27.426 --> 00:21:27.976 A:middle
and folders.

00:21:28.756 --> 00:21:30.496 A:middle
First, user data that apps may

00:21:30.526 --> 00:21:31.696 A:middle
generally access such as

00:21:31.736 --> 00:21:33.456 A:middle
contacts or photos, and for

00:21:33.456 --> 00:21:35.146 A:middle
these, macOS will confirm that

00:21:35.146 --> 00:21:36.916 A:middle
the user consents before sharing

00:21:36.916 --> 00:21:38.476 A:middle
that data with apps.

00:21:39.756 --> 00:21:41.256 A:middle
But second, there's also user

00:21:41.256 --> 00:21:43.156 A:middle
data which-- for which the file

00:21:43.156 --> 00:21:43.936 A:middle
system is really just an

00:21:43.936 --> 00:21:45.496 A:middle
implementation detail, it's not

00:21:45.496 --> 00:21:46.086 A:middle
part of their API.

00:21:46.086 --> 00:21:47.896 A:middle
And these are things like mail

00:21:47.896 --> 00:21:49.906 A:middle
or messages and Safari browsing

00:21:49.906 --> 00:21:50.306 A:middle
history.

00:21:50.976 --> 00:21:52.306 A:middle
And these have a high barrier to

00:21:52.306 --> 00:21:53.656 A:middle
access because the files are

00:21:53.656 --> 00:21:55.306 A:middle
typically only accessed by

00:21:55.306 --> 00:21:56.666 A:middle
specialized apps such as disk

00:21:56.666 --> 00:21:58.326 A:middle
management or backup utilities.

00:21:59.716 --> 00:22:00.876 A:middle
But first, let's talk about

00:21:59.716 --> 00:22:00.876 A:middle
But first, let's talk about

00:22:00.876 --> 00:22:01.816 A:middle
those files and folders that

00:22:01.816 --> 00:22:05.036 A:middle
require user consent to access.

00:22:05.206 --> 00:22:06.696 A:middle
Now, macOS Mojave introduced

00:22:06.696 --> 00:22:08.636 A:middle
user consent requirements to

00:22:08.636 --> 00:22:10.766 A:middle
access your contacts, calendars,

00:22:10.766 --> 00:22:12.106 A:middle
reminders, or your photos

00:22:12.106 --> 00:22:13.746 A:middle
library via the file system.

00:22:14.636 --> 00:22:15.696 A:middle
And what that looks like is a

00:22:15.696 --> 00:22:18.186 A:middle
prompt like this, when an app

00:22:18.186 --> 00:22:19.586 A:middle
tries to access files in one of

00:22:19.586 --> 00:22:20.306 A:middle
these categories.

00:22:20.906 --> 00:22:23.616 A:middle
Now, this is different than the

00:22:23.616 --> 00:22:24.916 A:middle
authorization dialogs that we

00:22:24.916 --> 00:22:26.386 A:middle
just saw for screen recording

00:22:26.806 --> 00:22:28.426 A:middle
and keyboard event recording,

00:22:29.236 --> 00:22:30.896 A:middle
rather than denying the access

00:22:30.896 --> 00:22:31.956 A:middle
and displaying an alert to the

00:22:31.956 --> 00:22:34.876 A:middle
user, the calling thread is

00:22:34.876 --> 00:22:36.486 A:middle
actually blocked, waiting for

00:22:36.486 --> 00:22:37.946 A:middle
the user to approve or deny the

00:22:37.946 --> 00:22:39.156 A:middle
app access to files in the

00:22:39.156 --> 00:22:39.656 A:middle
category.

00:22:41.896 --> 00:22:43.776 A:middle
In macOS Catalina, we

00:22:43.776 --> 00:22:45.156 A:middle
complemented these categories

00:22:45.966 --> 00:22:47.876 A:middle
with these additional categories

00:22:48.016 --> 00:22:49.336 A:middle
for data where the file system

00:22:49.396 --> 00:22:49.966 A:middle
is API.

00:22:51.356 --> 00:22:52.266 A:middle
These represent various

00:22:52.266 --> 00:22:53.586 A:middle
locations where the users store

00:22:53.586 --> 00:22:54.386 A:middle
their documents.

00:22:55.696 --> 00:22:56.826 A:middle
They double click on them in

00:22:56.826 --> 00:22:57.296 A:middle
Finder.

00:22:58.256 --> 00:22:59.486 A:middle
They select them via Open or

00:22:59.486 --> 00:23:01.656 A:middle
Save panels, and so on.

00:22:59.486 --> 00:23:01.656 A:middle
Save panels, and so on.

00:23:02.536 --> 00:23:04.276 A:middle
The user's desktop and document

00:23:04.276 --> 00:23:05.366 A:middle
folders were prime candidates

00:23:05.366 --> 00:23:06.516 A:middle
for protection since that's the

00:23:06.516 --> 00:23:07.656 A:middle
default location where many

00:23:07.656 --> 00:23:08.716 A:middle
users store their files.

00:23:10.126 --> 00:23:12.176 A:middle
And downloads because some apps,

00:23:12.176 --> 00:23:13.756 A:middle
including Safari, save

00:23:13.756 --> 00:23:14.796 A:middle
downloaded files there by

00:23:14.796 --> 00:23:18.736 A:middle
default, also protecting

00:23:18.736 --> 00:23:20.776 A:middle
documents stored in iCloud Drive

00:23:20.906 --> 00:23:23.236 A:middle
or third-party cloud storage

00:23:23.236 --> 00:23:26.246 A:middle
providers or on removable volumes

00:23:26.246 --> 00:23:27.206 A:middle
and if you've been around as

00:23:27.206 --> 00:23:28.116 A:middle
long as I have, you may be

00:23:28.116 --> 00:23:29.276 A:middle
thinking floppy disks.

00:23:29.706 --> 00:23:31.906 A:middle
But here I mean any storage that

00:23:31.906 --> 00:23:33.186 A:middle
can be physically removed,

00:23:33.466 --> 00:23:35.276 A:middle
including USB thumb drives or

00:23:35.276 --> 00:23:36.136 A:middle
external disks.

00:23:37.846 --> 00:23:39.086 A:middle
And as I'm sure you

00:23:39.086 --> 00:23:40.066 A:middle
photographers out there can

00:23:40.066 --> 00:23:41.416 A:middle
attest, some people have their

00:23:41.416 --> 00:23:43.086 A:middle
entire lives chronicled on

00:23:43.156 --> 00:23:45.466 A:middle
external disks, or on

00:23:45.536 --> 00:23:46.666 A:middle
network-attached storage.

00:23:48.876 --> 00:23:50.886 A:middle
So, macOS Catalina is now

00:23:50.886 --> 00:23:52.876 A:middle
protecting many of the most

00:23:52.876 --> 00:23:54.306 A:middle
common locations where we store

00:23:54.306 --> 00:23:56.256 A:middle
our files.

00:23:56.986 --> 00:24:00.186 A:middle
Now, user consent is not

00:23:56.986 --> 00:24:00.186 A:middle
Now, user consent is not

00:24:00.186 --> 00:24:01.976 A:middle
required for an app to create

00:24:01.976 --> 00:24:03.276 A:middle
new documents in any of these

00:24:03.276 --> 00:24:05.956 A:middle
protected locations, just to

00:24:05.956 --> 00:24:08.086 A:middle
read existing contents, the

00:24:08.536 --> 00:24:09.776 A:middle
contents of files that are

00:24:09.776 --> 00:24:10.186 A:middle
already there.

00:24:10.456 --> 00:24:13.416 A:middle
So, for example, a file transfer

00:24:13.416 --> 00:24:15.806 A:middle
app can continue to save new

00:24:15.806 --> 00:24:17.506 A:middle
files to the user's downloads

00:24:17.506 --> 00:24:20.486 A:middle
folder without triggering a

00:24:21.156 --> 00:24:21.896 A:middle
consent prompt.

00:24:21.896 --> 00:24:23.446 A:middle
And user privacy protections in

00:24:23.446 --> 00:24:26.206 A:middle
macOS Catalina now support the

00:24:26.206 --> 00:24:29.126 A:middle
notion of user intent, when--

00:24:29.346 --> 00:24:31.936 A:middle
which is inferred when double

00:24:31.936 --> 00:24:33.336 A:middle
clicking on files in Finder,

00:24:33.986 --> 00:24:35.716 A:middle
when dragging and dropping from

00:24:35.716 --> 00:24:37.466 A:middle
another application or when

00:24:37.466 --> 00:24:39.276 A:middle
selecting files in an Open or

00:24:39.276 --> 00:24:39.806 A:middle
Save panel.

00:24:41.256 --> 00:24:42.486 A:middle
And when the user performs any

00:24:42.486 --> 00:24:44.656 A:middle
of these actions, the file--

00:24:44.866 --> 00:24:48.066 A:middle
performing any of these actions

00:24:48.066 --> 00:24:49.386 A:middle
on a file protected location,

00:24:50.336 --> 00:24:52.036 A:middle
your app gets access to the file

00:24:52.036 --> 00:24:54.146 A:middle
or files that the user selected

00:24:54.196 --> 00:24:55.816 A:middle
without the need for a consent

00:24:56.446 --> 00:24:56.626 A:middle
prompt.

00:24:57.356 --> 00:24:59.976 A:middle
So let's see how Catalina's

00:25:00.376 --> 00:25:02.106 A:middle
inference of user intent

00:25:02.286 --> 00:25:03.666 A:middle
compares with user consent.

00:25:05.536 --> 00:25:08.736 A:middle
Sorry. So, first of all, user

00:25:08.736 --> 00:25:10.166 A:middle
consent is reactive.

00:25:10.976 --> 00:25:13.216 A:middle
Access may be granted only after

00:25:13.556 --> 00:25:15.186 A:middle
your app tries to read or write

00:25:15.186 --> 00:25:17.016 A:middle
a file, whereas user intent is

00:25:17.136 --> 00:25:17.716 A:middle
proactive.

00:25:18.306 --> 00:25:19.696 A:middle
Access is granted before the

00:25:19.696 --> 00:25:22.766 A:middle
app, even tries to read or write

00:25:24.016 --> 00:25:24.326 A:middle
the file.

00:25:24.326 --> 00:25:26.736 A:middle
And user consent prompts to kind

00:25:26.736 --> 00:25:27.536 A:middle
of interrupt the user's

00:25:27.536 --> 00:25:30.286 A:middle
workflow, whereas user intent is

00:25:30.286 --> 00:25:31.526 A:middle
inferred from standard UI

00:25:31.526 --> 00:25:32.126 A:middle
interactions.

00:25:33.386 --> 00:25:34.346 A:middle
In order to minimize those

00:25:34.346 --> 00:25:36.066 A:middle
interruptions, user consent

00:25:36.066 --> 00:25:37.746 A:middle
applies to an entire class of

00:25:37.746 --> 00:25:39.456 A:middle
data, for example, all files on

00:25:39.456 --> 00:25:40.146 A:middle
your desktop.

00:25:40.576 --> 00:25:41.926 A:middle
Whereas user intent is inferred

00:25:41.926 --> 00:25:43.416 A:middle
for just the file or files that

00:25:43.416 --> 00:25:44.836 A:middle
the user is interacting with.

00:25:46.126 --> 00:25:47.456 A:middle
Now, that said, the two are not

00:25:47.456 --> 00:25:48.356 A:middle
mutually exclusive.

00:25:49.156 --> 00:25:50.426 A:middle
So long as your app is accessing

00:25:50.456 --> 00:25:52.176 A:middle
files it created or which the

00:25:52.176 --> 00:25:54.356 A:middle
user selected, no consent

00:25:54.356 --> 00:25:55.356 A:middle
prompts are necessary.

00:25:56.446 --> 00:25:57.766 A:middle
But if your app accesses files

00:25:57.766 --> 00:25:59.336 A:middle
in a privacy protected location,

00:25:59.756 --> 00:26:00.986 A:middle
other than ones that it created

00:25:59.756 --> 00:26:00.986 A:middle
other than ones that it created

00:26:00.986 --> 00:26:03.316 A:middle
itself or ones that the user has

00:26:03.316 --> 00:26:05.496 A:middle
selected, the user will need to

00:26:05.496 --> 00:26:07.326 A:middle
approve that access via consent

00:26:07.326 --> 00:26:07.586 A:middle
prompt.

00:26:08.816 --> 00:26:10.766 A:middle
Now, one common scenario where

00:26:10.766 --> 00:26:12.426 A:middle
an app might need to access a

00:26:12.426 --> 00:26:14.426 A:middle
file other than one that the

00:26:14.466 --> 00:26:16.686 A:middle
user selected are sidecar files.

00:26:17.746 --> 00:26:19.356 A:middle
For example, to automatically

00:26:19.356 --> 00:26:21.516 A:middle
open a subtitle file that's--

00:26:22.216 --> 00:26:23.706 A:middle
with-- of the same name but next

00:26:23.706 --> 00:26:25.656 A:middle
to a movie file.

00:26:26.816 --> 00:26:28.406 A:middle
So using the related items

00:26:28.506 --> 00:26:30.216 A:middle
support in NSFileCoordinator,

00:26:30.736 --> 00:26:33.646 A:middle
it's possible for the inferred

00:26:33.646 --> 00:26:35.176 A:middle
permissions for one file to be

00:26:35.176 --> 00:26:37.426 A:middle
extended to other files.

00:26:41.076 --> 00:26:43.116 A:middle
To use NSFileCoordinator to open

00:26:43.166 --> 00:26:44.806 A:middle
a sidecar file, you need to

00:26:44.806 --> 00:26:46.936 A:middle
first declare the extension of

00:26:46.936 --> 00:26:48.546 A:middle
the sidecar file in your apps,

00:26:49.546 --> 00:26:52.256 A:middle
CFBundleDocumentTypes Info.plist

00:26:52.326 --> 00:26:52.486 A:middle
key.

00:26:53.216 --> 00:26:57.726 A:middle
And, set the NSIsRelatedItemType

00:26:58.306 --> 00:26:59.046 A:middle
to Boolean true.

00:27:00.046 --> 00:27:03.146 A:middle
Then in your code, you subclass

00:27:03.146 --> 00:27:05.706 A:middle
NSFilePresenter, set the

00:27:05.706 --> 00:27:07.956 A:middle
primaryPresentedItemURL to the

00:27:07.956 --> 00:27:09.376 A:middle
file that the user selected.

00:27:09.486 --> 00:27:11.056 A:middle
So that's the one that your app

00:27:11.056 --> 00:27:12.116 A:middle
already has access to.

00:27:12.906 --> 00:27:14.526 A:middle
And the PresentedItemURL to the

00:27:14.526 --> 00:27:15.466 A:middle
sidecar file.

00:27:15.656 --> 00:27:16.596 A:middle
That's the one that you want to

00:27:16.596 --> 00:27:17.076 A:middle
access to.

00:27:18.316 --> 00:27:19.626 A:middle
And note that the sidecar file

00:27:19.626 --> 00:27:21.136 A:middle
may have a different extension

00:27:21.476 --> 00:27:23.026 A:middle
as the user selected file, but

00:27:23.026 --> 00:27:25.006 A:middle
all other path components must

00:27:25.006 --> 00:27:25.516 A:middle
be identical.

00:27:26.896 --> 00:27:29.996 A:middle
Finally, you create an

00:27:30.306 --> 00:27:32.446 A:middle
NSFileCoordinator referencing

00:27:32.446 --> 00:27:33.746 A:middle
the NSFilePresenter instance.

00:27:35.006 --> 00:27:36.206 A:middle
And when you call the

00:27:36.206 --> 00:27:37.876 A:middle
NSFileCoordinator's coordinate

00:27:37.906 --> 00:27:39.846 A:middle
method, your app gets access to

00:27:39.916 --> 00:27:42.026 A:middle
the sidecar file as well for the

00:27:42.026 --> 00:27:43.226 A:middle
duration of that block.

00:27:43.676 --> 00:27:46.756 A:middle
And that's a quick rundown of

00:27:46.756 --> 00:27:47.786 A:middle
how your apps can use

00:27:47.786 --> 00:27:49.706 A:middle
NSFileCoordinator to gain access

00:27:49.736 --> 00:27:51.336 A:middle
to files with the same name, but

00:27:51.336 --> 00:27:52.806 A:middle
a different filename extension

00:27:53.546 --> 00:27:54.646 A:middle
as ones that the user has

00:27:54.646 --> 00:27:56.276 A:middle
selected without triggering a

00:27:56.276 --> 00:27:57.236 A:middle
user consent prompt.

00:27:58.616 --> 00:28:00.386 A:middle
Now, to securely infer user

00:27:58.616 --> 00:28:00.386 A:middle
Now, to securely infer user

00:28:00.386 --> 00:28:02.176 A:middle
intent, the Open and Save panels

00:28:02.626 --> 00:28:04.426 A:middle
are now always hosted out of

00:28:04.426 --> 00:28:04.986 A:middle
process.

00:28:05.936 --> 00:28:07.186 A:middle
As a result, the class

00:28:07.186 --> 00:28:08.666 A:middle
inheritance and view hierarchies

00:28:08.966 --> 00:28:10.906 A:middle
have changed, which could affect

00:28:10.906 --> 00:28:12.436 A:middle
your app if you have subclass

00:28:12.436 --> 00:28:14.126 A:middle
NSOpenPanel or NSSavePanel.

00:28:14.696 --> 00:28:17.686 A:middle
And apps can no longer

00:28:17.976 --> 00:28:20.136 A:middle
programmatically accept the

00:28:20.136 --> 00:28:22.116 A:middle
panels by calling the OK method,

00:28:22.486 --> 00:28:23.476 A:middle
the user must do that

00:28:23.476 --> 00:28:23.986 A:middle
themselves.

00:28:25.656 --> 00:28:27.626 A:middle
There are also slight changes to

00:28:27.626 --> 00:28:29.856 A:middle
the NSOpenSavePanelDelegate

00:28:29.856 --> 00:28:30.766 A:middle
methods as well.

00:28:30.766 --> 00:28:33.536 A:middle
Apps can no longer rewrite the

00:28:33.536 --> 00:28:35.246 A:middle
user selection using this

00:28:35.246 --> 00:28:35.596 A:middle
method.

00:28:36.166 --> 00:28:39.446 A:middle
And accessing the files that

00:28:39.446 --> 00:28:41.126 A:middle
URLs provided to these methods

00:28:41.386 --> 00:28:42.736 A:middle
may trigger user consent

00:28:42.776 --> 00:28:44.416 A:middle
prompts, because these methods

00:28:44.416 --> 00:28:46.946 A:middle
are invoked by the panels while

00:28:46.946 --> 00:28:48.256 A:middle
the user is still interacting

00:28:48.256 --> 00:28:49.446 A:middle
with the panel, so they haven't

00:28:49.446 --> 00:28:50.796 A:middle
selected the file yet.

00:28:51.336 --> 00:28:52.466 A:middle
So therefore, your app has not

00:28:52.616 --> 00:28:53.706 A:middle
yet been granted access.

00:28:54.286 --> 00:28:56.976 A:middle
Now, apps can test whether a

00:28:56.976 --> 00:28:58.126 A:middle
given file is readable or

00:28:58.126 --> 00:28:59.696 A:middle
writable without triggering

00:28:59.696 --> 00:29:02.546 A:middle
consent prompts using these

00:28:59.696 --> 00:29:02.546 A:middle
consent prompts using these

00:29:03.966 --> 00:29:04.106 A:middle
APIs.

00:29:04.316 --> 00:29:06.256 A:middle
And, so long as your app only

00:29:06.576 --> 00:29:08.486 A:middle
accesses files that the-- that

00:29:08.486 --> 00:29:10.836 A:middle
in itself creates or that the

00:29:10.836 --> 00:29:13.366 A:middle
user-- that it receives via file

00:29:13.366 --> 00:29:16.256 A:middle
open events or drag and drop or

00:29:16.256 --> 00:29:17.446 A:middle
Open panel or Save panel

00:29:17.496 --> 00:29:19.036 A:middle
selections, your app's

00:29:19.036 --> 00:29:20.436 A:middle
permission to access those files

00:29:20.606 --> 00:29:22.416 A:middle
is inferred and no user consent

00:29:22.456 --> 00:29:23.786 A:middle
prompt is necessary.

00:29:24.616 --> 00:29:27.356 A:middle
However, if a consent prompt is

00:29:27.356 --> 00:29:29.196 A:middle
required, all of the new

00:29:29.196 --> 00:29:30.776 A:middle
protected file system locations

00:29:31.116 --> 00:29:32.146 A:middle
support purpose strings.

00:29:32.726 --> 00:29:33.626 A:middle
And purpose strings can be

00:29:33.626 --> 00:29:34.916 A:middle
specified in your Info.plist to

00:29:34.916 --> 00:29:36.866 A:middle
explain the context of the

00:29:36.866 --> 00:29:38.396 A:middle
access when a consent prompt is

00:29:38.446 --> 00:29:38.856 A:middle
displayed.

00:29:43.416 --> 00:29:45.066 A:middle
And while purpose strings for

00:29:45.066 --> 00:29:46.336 A:middle
these categories are optional,

00:29:46.996 --> 00:29:48.326 A:middle
if your app access is one of

00:29:48.326 --> 00:29:49.586 A:middle
these protected locations,

00:29:50.246 --> 00:29:52.786 A:middle
intentionally, a purpose string

00:29:52.866 --> 00:29:54.126 A:middle
for that location is highly

00:29:54.126 --> 00:29:55.466 A:middle
recommended so that the user

00:29:55.466 --> 00:29:56.946 A:middle
understands why your app is

00:29:56.946 --> 00:29:58.636 A:middle
accessing their documents.

00:29:59.296 --> 00:30:01.006 A:middle
Now, if you find in your testing

00:29:59.296 --> 00:30:01.006 A:middle
Now, if you find in your testing

00:30:01.196 --> 00:30:02.386 A:middle
your app is triggering consent

00:30:02.416 --> 00:30:03.726 A:middle
prompts that you don't expect,

00:30:04.246 --> 00:30:05.506 A:middle
you can click the Don't Allow

00:30:05.506 --> 00:30:07.236 A:middle
button and go to the console app

00:30:07.236 --> 00:30:08.206 A:middle
and look for the resulting

00:30:08.206 --> 00:30:09.806 A:middle
Sandbox violation, that'll tell

00:30:09.806 --> 00:30:11.266 A:middle
you the file that your app was

00:30:11.266 --> 00:30:13.396 A:middle
trying to access and the

00:30:13.396 --> 00:30:17.446 A:middle
backtrace that caused to require

00:30:18.706 --> 00:30:19.726 A:middle
the consent prompt.

00:30:20.286 --> 00:30:23.286 A:middle
So that's how macOS Catalina is

00:30:23.316 --> 00:30:25.406 A:middle
protecting user's documents and

00:30:25.406 --> 00:30:26.986 A:middle
how the standard UI and how it's

00:30:26.986 --> 00:30:28.316 A:middle
using standard UI interactions

00:30:28.356 --> 00:30:29.696 A:middle
to infer which documents they

00:30:29.696 --> 00:30:30.846 A:middle
expect apps to access.

00:30:32.186 --> 00:30:34.536 A:middle
So let's look at how macOS

00:30:34.536 --> 00:30:36.216 A:middle
protects user data that's

00:30:36.216 --> 00:30:37.706 A:middle
managed by the system and how

00:30:37.706 --> 00:30:39.126 A:middle
your apps can request access to

00:30:39.126 --> 00:30:40.076 A:middle
that data if necessary.

00:30:41.836 --> 00:30:43.306 A:middle
Here, we see the categories of

00:30:43.306 --> 00:30:45.616 A:middle
data protected starting in macOS

00:30:45.616 --> 00:30:46.036 A:middle
Mojave.

00:30:46.706 --> 00:30:49.666 A:middle
Now, some software such as disk

00:30:49.666 --> 00:30:51.196 A:middle
management or backup software

00:30:51.636 --> 00:30:53.086 A:middle
work with all files regardless

00:30:53.086 --> 00:30:53.806 A:middle
of their content.

00:30:54.636 --> 00:30:56.716 A:middle
And those software-- those apps

00:30:56.716 --> 00:30:58.366 A:middle
can use the same APIs that we

00:30:58.366 --> 00:31:00.986 A:middle
just saw a minute ago to

00:30:58.366 --> 00:31:00.986 A:middle
just saw a minute ago to

00:31:00.986 --> 00:31:02.276 A:middle
determine whether a given file

00:31:02.276 --> 00:31:03.176 A:middle
is readable or writable.

00:31:03.176 --> 00:31:04.516 A:middle
And then depending on what's

00:31:04.516 --> 00:31:05.516 A:middle
appropriate for the app, they

00:31:05.566 --> 00:31:07.216 A:middle
could skip inaccessible pass or

00:31:07.216 --> 00:31:08.736 A:middle
they could alert the user and

00:31:08.736 --> 00:31:10.286 A:middle
direct them to approve the app

00:31:10.286 --> 00:31:11.606 A:middle
in the security and privacy

00:31:11.606 --> 00:31:12.706 A:middle
preference pane to have full

00:31:12.706 --> 00:31:13.296 A:middle
functionality.

00:31:13.926 --> 00:31:17.646 A:middle
And here's where they would

00:31:17.646 --> 00:31:18.696 A:middle
approve that for Full Disk

00:31:18.696 --> 00:31:19.146 A:middle
Access.

00:31:19.786 --> 00:31:22.596 A:middle
And while we're here, I'd like

00:31:22.596 --> 00:31:23.776 A:middle
to talk about one of the

00:31:23.776 --> 00:31:25.076 A:middle
enhancements that we've made in

00:31:25.226 --> 00:31:29.296 A:middle
macOS Catalina to how apps are

00:31:29.296 --> 00:31:30.596 A:middle
approved for Full Disk Access,

00:31:30.906 --> 00:31:32.196 A:middle
while users can still manually

00:31:32.196 --> 00:31:34.076 A:middle
add apps to the list using the

00:31:34.546 --> 00:31:35.376 A:middle
plus button here.

00:31:36.616 --> 00:31:37.646 A:middle
One piece of feedback that we've

00:31:37.646 --> 00:31:39.386 A:middle
gotten from developers is that

00:31:39.386 --> 00:31:40.916 A:middle
it can be awkward for users to

00:31:40.916 --> 00:31:43.196 A:middle
locate their app's privileged

00:31:43.196 --> 00:31:43.646 A:middle
helpers.

00:31:44.486 --> 00:31:46.666 A:middle
So, now in macOS Catalina,

00:31:47.076 --> 00:31:48.466 A:middle
executables that are denied

00:31:48.466 --> 00:31:50.156 A:middle
access to files due to a lack of

00:31:50.226 --> 00:31:52.026 A:middle
Full Disk Access approval are

00:31:52.026 --> 00:31:53.986 A:middle
now prepopulated unchecked.

00:31:55.066 --> 00:31:56.266 A:middle
Here, we see one such helper

00:31:56.556 --> 00:31:57.856 A:middle
identified by its executable

00:31:57.856 --> 00:31:58.046 A:middle
name.

00:31:58.656 --> 00:32:01.776 A:middle
If that helper were embedded in

00:31:58.656 --> 00:32:01.776 A:middle
If that helper were embedded in

00:32:01.776 --> 00:32:03.656 A:middle
a bundle, the display name in

00:32:03.656 --> 00:32:06.356 A:middle
icon specifying the bundles

00:32:06.356 --> 00:32:08.046 A:middle
Info.plist would be displayed

00:32:08.046 --> 00:32:09.166 A:middle
instead.

00:32:12.136 --> 00:32:13.586 A:middle
So, again, this data is

00:32:13.586 --> 00:32:15.096 A:middle
accessible for apps that have

00:32:15.096 --> 00:32:16.406 A:middle
been preapproved for Full Disk

00:32:16.406 --> 00:32:18.546 A:middle
Access, apps can test for

00:32:18.546 --> 00:32:20.316 A:middle
authorization using FileManager

00:32:20.316 --> 00:32:23.306 A:middle
or POSIX level APIs, and if

00:32:23.306 --> 00:32:25.136 A:middle
necessary, can guide the user to

00:32:25.136 --> 00:32:25.996 A:middle
the security and privacy

00:32:25.996 --> 00:32:28.246 A:middle
preference pane, where the user

00:32:28.246 --> 00:32:30.226 A:middle
can then approve the app if

00:32:30.226 --> 00:32:33.526 A:middle
that's what they want.

00:32:33.526 --> 00:32:34.716 A:middle
Now, in Catalina, the universe

00:32:34.716 --> 00:32:36.186 A:middle
of data that requires

00:32:36.186 --> 00:32:37.966 A:middle
preapproval for Full Disk Access

00:32:38.336 --> 00:32:40.406 A:middle
has been expanded to include

00:32:40.946 --> 00:32:41.456 A:middle
trash.

00:32:43.316 --> 00:32:44.776 A:middle
Now, a lot of people think of

00:32:44.776 --> 00:32:46.656 A:middle
files as being gone when they

00:32:46.656 --> 00:32:47.786 A:middle
move them to their trash.

00:32:48.206 --> 00:32:49.386 A:middle
So the last thing they would

00:32:49.386 --> 00:32:51.086 A:middle
expect is for something to go

00:32:51.146 --> 00:32:52.056 A:middle
digging through their trash

00:32:52.056 --> 00:32:52.456 A:middle
files.

00:32:53.086 --> 00:32:54.926 A:middle
That's terrifying, at this size.

00:32:59.106 --> 00:33:00.786 A:middle
As with these other categories,

00:32:59.106 --> 00:33:00.786 A:middle
As with these other categories,

00:33:01.166 --> 00:33:02.436 A:middle
trash may contain lots of

00:33:02.436 --> 00:33:03.816 A:middle
privacy sensitive data.

00:33:03.876 --> 00:33:04.956 A:middle
However, unlike these other

00:33:04.956 --> 00:33:07.006 A:middle
categories, trash is file

00:33:07.006 --> 00:33:08.706 A:middle
centric and does have API for

00:33:08.776 --> 00:33:09.966 A:middle
manipulating those files.

00:33:10.496 --> 00:33:13.006 A:middle
APIs like these, which move

00:33:13.006 --> 00:33:14.296 A:middle
files into the user's trash.

00:33:15.796 --> 00:33:17.216 A:middle
Now, I'd like to drill down on

00:33:17.216 --> 00:33:19.216 A:middle
the FileManager trash item API a

00:33:19.216 --> 00:33:19.616 A:middle
little.

00:33:20.086 --> 00:33:23.076 A:middle
It takes a URL of the file to

00:33:23.076 --> 00:33:23.996 A:middle
move to the trash as it's

00:33:23.996 --> 00:33:24.446 A:middle
argument.

00:33:25.046 --> 00:33:28.706 A:middle
Now, the caller needs to already

00:33:28.706 --> 00:33:29.856 A:middle
have access to that file, you

00:33:29.856 --> 00:33:31.236 A:middle
can't move files to the trash

00:33:31.236 --> 00:33:32.176 A:middle
that you're-- you don't have

00:33:32.176 --> 00:33:33.106 A:middle
access to yourself.

00:33:34.396 --> 00:33:35.846 A:middle
But when successful, it

00:33:35.846 --> 00:33:37.646 A:middle
populates the out resulting URL

00:33:37.646 --> 00:33:39.336 A:middle
parameter, with an NSURL for the

00:33:39.386 --> 00:33:41.866 A:middle
file at its new location in the

00:33:41.866 --> 00:33:42.556 A:middle
user's trash.

00:33:43.736 --> 00:33:45.656 A:middle
And it still has access to that

00:33:45.656 --> 00:33:45.876 A:middle
URL.

00:33:46.486 --> 00:33:47.616 A:middle
To make sense, it had access to

00:33:47.616 --> 00:33:48.636 A:middle
the file before it moved it.

00:33:48.746 --> 00:33:49.856 A:middle
It still has access to the file

00:33:49.856 --> 00:33:50.546 A:middle
after it moved it.

00:33:50.686 --> 00:33:51.696 A:middle
And this allows you to use

00:33:51.936 --> 00:33:53.566 A:middle
FileManager APIs, for example,

00:33:53.746 --> 00:33:55.826 A:middle
to move the file back out of the

00:33:57.196 --> 00:33:57.326 A:middle
trash.

00:33:57.516 --> 00:33:58.686 A:middle
So in summary, while apps

00:33:58.686 --> 00:34:00.456 A:middle
require Full Disk Access to

00:33:58.686 --> 00:34:00.456 A:middle
require Full Disk Access to

00:34:00.456 --> 00:34:01.906 A:middle
enumerate the files in the trash

00:34:02.326 --> 00:34:03.786 A:middle
or to see those files contents,

00:34:04.416 --> 00:34:06.016 A:middle
no authorization is required to

00:34:06.016 --> 00:34:08.246 A:middle
move files into the trash or to

00:34:08.246 --> 00:34:09.466 A:middle
access files that they had

00:34:09.516 --> 00:34:10.786 A:middle
previously put in the trash.

00:34:12.936 --> 00:34:14.606 A:middle
Finally, I like to talk briefly

00:34:14.606 --> 00:34:15.366 A:middle
about automation.

00:34:16.716 --> 00:34:18.755 A:middle
macOS Mojave introduced consent

00:34:18.755 --> 00:34:20.686 A:middle
requirements for automation of

00:34:20.686 --> 00:34:22.606 A:middle
the system or of other apps.

00:34:22.856 --> 00:34:23.966 A:middle
And this is important to prevent

00:34:23.966 --> 00:34:25.366 A:middle
malware from abusing apps that

00:34:25.366 --> 00:34:26.406 A:middle
you've trusted with your data.

00:34:31.156 --> 00:34:32.545 A:middle
So, first, there's synthetic

00:34:32.545 --> 00:34:33.056 A:middle
events.

00:34:33.286 --> 00:34:34.835 A:middle
And synthetic input events are

00:34:34.835 --> 00:34:36.706 A:middle
typically used by accessibility

00:34:36.755 --> 00:34:39.116 A:middle
software in providing aid for

00:34:39.616 --> 00:34:41.996 A:middle
keyboard or mouse input.

00:34:42.565 --> 00:34:46.295 A:middle
But because user consent

00:34:46.295 --> 00:34:48.576 A:middle
dialogs, user intent inference

00:34:48.576 --> 00:34:49.896 A:middle
or various other security

00:34:49.896 --> 00:34:53.005 A:middle
prompts all rely on user input,

00:34:53.835 --> 00:34:54.906 A:middle
it's important that synthetic

00:34:54.906 --> 00:34:56.716 A:middle
input events are only allowed

00:34:56.876 --> 00:34:58.146 A:middle
from apps that the user has

00:34:58.146 --> 00:35:00.356 A:middle
installed for the purpose of

00:34:58.146 --> 00:35:00.356 A:middle
installed for the purpose of

00:35:00.356 --> 00:35:01.356 A:middle
acting as their proxy.

00:35:01.926 --> 00:35:05.396 A:middle
Here's a sample code-- Here's an

00:35:05.486 --> 00:35:09.476 A:middle
example of code that simulates a

00:35:09.476 --> 00:35:10.936 A:middle
key press and key release.

00:35:11.496 --> 00:35:13.716 A:middle
The first time this code runs

00:35:13.716 --> 00:35:16.856 A:middle
and tries to post these events

00:35:16.856 --> 00:35:17.906 A:middle
as if they were actually typed

00:35:17.906 --> 00:35:20.096 A:middle
by the user, the events are

00:35:20.256 --> 00:35:20.756 A:middle
discarded.

00:35:20.756 --> 00:35:23.156 A:middle
And a dialog like this one is

00:35:23.216 --> 00:35:25.256 A:middle
displayed alerting the user that

00:35:25.256 --> 00:35:25.996 A:middle
they will need to go to the

00:35:25.996 --> 00:35:27.306 A:middle
security and privacy preference

00:35:27.366 --> 00:35:29.446 A:middle
pane to authorize the app for

00:35:29.446 --> 00:35:30.486 A:middle
accessibility features.

00:35:32.556 --> 00:35:34.796 A:middle
Now, earlier, we looked at this

00:35:34.796 --> 00:35:36.186 A:middle
sample code for listening to

00:35:36.186 --> 00:35:37.636 A:middle
keyboard events.

00:35:38.416 --> 00:35:40.646 A:middle
If I change the listenOnly

00:35:41.946 --> 00:35:44.426 A:middle
parameter to defaultTap, like

00:35:45.316 --> 00:35:49.516 A:middle
that, CGEventTapCreate now

00:35:49.516 --> 00:35:51.636 A:middle
creates a modifying event tab,

00:35:51.636 --> 00:35:53.456 A:middle
where the callback can alter the

00:35:53.456 --> 00:35:54.066 A:middle
event stream.

00:35:54.186 --> 00:35:55.796 A:middle
And this means now your app has

00:35:56.006 --> 00:35:57.356 A:middle
a way to influence what events

00:35:57.356 --> 00:35:58.186 A:middle
are delivered to the rest of the

00:35:58.186 --> 00:36:01.306 A:middle
system, where a listen-only

00:35:58.186 --> 00:36:01.306 A:middle
system, where a listen-only

00:36:01.306 --> 00:36:03.026 A:middle
event requires authorization for

00:36:03.026 --> 00:36:04.826 A:middle
input monitoring, a modifying

00:36:04.826 --> 00:36:06.266 A:middle
event app requires authorization

00:36:06.266 --> 00:36:07.456 A:middle
for accessibility features.

00:36:08.086 --> 00:36:10.496 A:middle
Now, apps can test whether the

00:36:10.496 --> 00:36:13.026 A:middle
user has approved the app to

00:36:13.026 --> 00:36:15.516 A:middle
synthesize local-- synthesize

00:36:15.516 --> 00:36:16.946 A:middle
input events using the

00:36:16.946 --> 00:36:18.676 A:middle
IOHIDCheckAccess function.

00:36:19.266 --> 00:36:20.646 A:middle
And this is the same API for

00:36:20.646 --> 00:36:22.446 A:middle
checking authorization for

00:36:22.616 --> 00:36:23.686 A:middle
keyboard input monitoring.

00:36:24.236 --> 00:36:25.996 A:middle
But, here you can see that we're

00:36:25.996 --> 00:36:27.206 A:middle
passing the

00:36:27.206 --> 00:36:29.386 A:middle
kIOHIDRequestTypePostEvent

00:36:29.386 --> 00:36:30.066 A:middle
instead.

00:36:30.486 --> 00:36:33.766 A:middle
So, that was automation via

00:36:33.806 --> 00:36:34.576 A:middle
synthetic events.

00:36:35.306 --> 00:36:36.726 A:middle
Now, let's talk about automating

00:36:36.726 --> 00:36:37.946 A:middle
apps via Apple Events.

00:36:39.456 --> 00:36:41.016 A:middle
So, the user must consent before

00:36:41.016 --> 00:36:43.156 A:middle
one app can use AppleScript or

00:36:43.156 --> 00:36:44.646 A:middle
raw Apple Events to control the

00:36:44.646 --> 00:36:46.876 A:middle
actions of another app.

00:36:46.876 --> 00:36:47.986 A:middle
These consent prompts make it

00:36:47.986 --> 00:36:49.706 A:middle
clear, which apps are acting

00:36:49.706 --> 00:36:50.626 A:middle
under the influence of which

00:36:50.626 --> 00:36:52.596 A:middle
other apps and give the user

00:36:52.596 --> 00:36:53.926 A:middle
control over that automation.

00:36:54.676 --> 00:36:57.226 A:middle
Now, there are exceptions for

00:36:57.346 --> 00:37:02.206 A:middle
Apple Events that don't give the

00:36:57.346 --> 00:37:02.206 A:middle
Apple Events that don't give the

00:37:02.526 --> 00:37:03.806 A:middle
sending process access to

00:37:03.846 --> 00:37:04.906 A:middle
privacy sensitive data.

00:37:04.906 --> 00:37:07.406 A:middle
Many of these events are exposed

00:37:07.406 --> 00:37:09.426 A:middle
via NSWorkspace APIs.

00:37:10.876 --> 00:37:10.946 A:middle
The

00:37:11.176 --> 00:37:13.766 A:middle
AEDeterminePermissionToAutomate

00:37:13.766 --> 00:37:16.376 A:middle
Target function can be used to

00:37:16.376 --> 00:37:17.626 A:middle
test whether authorization would

00:37:17.626 --> 00:37:19.356 A:middle
be required to send Apple Events

00:37:19.356 --> 00:37:20.636 A:middle
to a target application.

00:37:21.526 --> 00:37:23.556 A:middle
And here's an example, testing

00:37:23.556 --> 00:37:25.006 A:middle
whether the caller can send any

00:37:25.006 --> 00:37:26.236 A:middle
Apple event to Keynote.

00:37:26.756 --> 00:37:30.986 A:middle
And by passing Boolean true for

00:37:30.986 --> 00:37:32.596 A:middle
the askUserIfNeeded parameter,

00:37:33.066 --> 00:37:34.376 A:middle
you could ask that a approval

00:37:34.376 --> 00:37:35.916 A:middle
prompt is triggered if

00:37:35.916 --> 00:37:36.506 A:middle
necessary.

00:37:37.606 --> 00:37:38.506 A:middle
But I will point out that if a

00:37:38.506 --> 00:37:39.976 A:middle
prompt is displayed, the calling

00:37:39.976 --> 00:37:41.156 A:middle
thread is blocked waiting for

00:37:41.156 --> 00:37:42.786 A:middle
the user's interaction, so you

00:37:42.786 --> 00:37:43.886 A:middle
wouldn't want to call this on

00:37:43.886 --> 00:37:44.956 A:middle
your app's main thread.

00:37:45.966 --> 00:37:47.956 A:middle
Now, this API is pretty low

00:37:47.956 --> 00:37:49.146 A:middle
level, returning an OSStatus

00:37:49.146 --> 00:37:50.156 A:middle
code indicating whether the

00:37:50.156 --> 00:37:52.256 A:middle
caller is permitted to send the

00:37:52.256 --> 00:37:55.256 A:middle
Apple event to the target or

00:37:55.256 --> 00:37:58.126 A:middle
not, whether trying to send the

00:37:58.126 --> 00:37:59.336 A:middle
Apple event would result in a

00:37:59.336 --> 00:38:00.976 A:middle
prompt confirming the user's

00:37:59.336 --> 00:38:00.976 A:middle
prompt confirming the user's

00:38:00.976 --> 00:38:03.136 A:middle
consent, or whether the target

00:38:03.136 --> 00:38:04.236 A:middle
is not running at the moment and

00:38:04.236 --> 00:38:05.306 A:middle
that trying to send the Apple

00:38:05.416 --> 00:38:06.726 A:middle
even would cause it to launch,

00:38:07.826 --> 00:38:09.476 A:middle
or whether some error occurred.

00:38:10.026 --> 00:38:12.296 A:middle
So that was a quick summary of

00:38:12.296 --> 00:38:15.076 A:middle
how macOS captures user consent

00:38:15.076 --> 00:38:16.376 A:middle
before allowing apps to automate

00:38:16.376 --> 00:38:18.066 A:middle
other apps, and how your apps

00:38:18.066 --> 00:38:19.226 A:middle
can determine whether consent

00:38:19.226 --> 00:38:20.366 A:middle
was given and adjust

00:38:20.366 --> 00:38:20.806 A:middle
accordingly.

00:38:23.096 --> 00:38:25.486 A:middle
So, now, in macOS Catalina, user

00:38:25.486 --> 00:38:27.256 A:middle
consent is required to record

00:38:27.256 --> 00:38:29.146 A:middle
your screen or keyboard, that's

00:38:29.146 --> 00:38:30.336 A:middle
an addition to the existing

00:38:30.336 --> 00:38:31.256 A:middle
protections for camera and

00:38:31.256 --> 00:38:31.816 A:middle
microphone.

00:38:32.466 --> 00:38:34.036 A:middle
And now, a number of common

00:38:34.036 --> 00:38:35.386 A:middle
location-- common document

00:38:35.386 --> 00:38:37.016 A:middle
locations are also protected

00:38:37.016 --> 00:38:39.116 A:middle
such as user's desktop documents

00:38:39.556 --> 00:38:41.756 A:middle
downloads, their iCloud Drive or

00:38:41.856 --> 00:38:43.866 A:middle
third-party storage, removable

00:38:43.866 --> 00:38:45.346 A:middle
network volumes and, of course,

00:38:45.416 --> 00:38:45.866 A:middle
trash.

00:38:46.506 --> 00:38:49.586 A:middle
Now, the Privacy Preferences

00:38:49.976 --> 00:38:52.386 A:middle
Policy Control MDM payload has

00:38:52.386 --> 00:38:54.346 A:middle
also been extended with services

00:38:54.526 --> 00:38:55.876 A:middle
for the new protected resources

00:38:55.876 --> 00:38:56.846 A:middle
in macOS Catalina.

00:38:57.586 --> 00:38:59.386 A:middle
And, I'd like to point out that

00:38:59.386 --> 00:39:01.126 A:middle
during development, you may want

00:38:59.386 --> 00:39:01.126 A:middle
during development, you may want

00:39:01.126 --> 00:39:02.506 A:middle
to trigger-- be able to

00:39:02.506 --> 00:39:03.666 A:middle
retrigger prompts while you're

00:39:03.666 --> 00:39:04.766 A:middle
testing your app behavior.

00:39:05.286 --> 00:39:06.346 A:middle
And you can use these same

00:39:06.346 --> 00:39:07.936 A:middle
service names that you see on

00:39:07.936 --> 00:39:11.046 A:middle
the left side, with a tccutil

00:39:11.046 --> 00:39:12.786 A:middle
command line tool to reset the

00:39:12.786 --> 00:39:13.956 A:middle
prompting status for the

00:39:13.956 --> 00:39:15.356 A:middle
respective protected resources.

00:39:17.356 --> 00:39:18.826 A:middle
So, earlier, we heard from

00:39:18.826 --> 00:39:20.076 A:middle
Garrett about the enhancements

00:39:20.076 --> 00:39:21.976 A:middle
in Gatekeeper, and we just

00:39:21.976 --> 00:39:22.916 A:middle
discussed some of the

00:39:22.916 --> 00:39:26.226 A:middle
improvements in the user privacy

00:39:26.226 --> 00:39:28.676 A:middle
protections in macOS Catalina.

00:39:29.346 --> 00:39:32.956 A:middle
I'd like to recap by saying,

00:39:33.606 --> 00:39:35.016 A:middle
remember to sign and notarize

00:39:35.096 --> 00:39:36.116 A:middle
all of the software that you

00:39:36.116 --> 00:39:36.646 A:middle
distribute.

00:39:37.326 --> 00:39:39.856 A:middle
And, don't modify those bundles

00:39:39.856 --> 00:39:40.496 A:middle
once signed.

00:39:40.836 --> 00:39:42.176 A:middle
If you do need to modify the

00:39:42.176 --> 00:39:44.006 A:middle
bundles, be sure that you just

00:39:44.006 --> 00:39:45.626 A:middle
transform them into another

00:39:45.626 --> 00:39:51.566 A:middle
bundle that is also signed.

00:39:51.746 --> 00:39:53.986 A:middle
And, for user privacy

00:39:53.986 --> 00:39:55.756 A:middle
protections, try to leverage

00:39:55.756 --> 00:39:57.326 A:middle
standard UI as much as possible.

00:39:57.586 --> 00:39:59.356 A:middle
Be sure to handle errors and

00:39:59.356 --> 00:40:01.746 A:middle
APIs that may return, if the

00:39:59.356 --> 00:40:01.746 A:middle
APIs that may return, if the

00:40:01.746 --> 00:40:04.136 A:middle
user-- sorry, handle any errors,

00:40:04.136 --> 00:40:05.456 A:middle
APIs may return if the user

00:40:05.456 --> 00:40:05.966 A:middle
declines consent.

00:40:06.126 --> 00:40:08.136 A:middle
And remember that once users

00:40:08.546 --> 00:40:10.066 A:middle
authorize your app to access

00:40:10.066 --> 00:40:11.986 A:middle
their personal data, it's-- the

00:40:11.986 --> 00:40:13.196 A:middle
responsibility to protect their

00:40:13.196 --> 00:40:14.466 A:middle
privacy passes to you.

00:40:14.816 --> 00:40:16.176 A:middle
So handle user's data with care.

00:40:17.836 --> 00:40:18.936 A:middle
Thank you very much.

00:40:18.936 --> 00:40:20.326 A:middle
I hope you enjoy the rest of the

00:40:20.326 --> 00:40:21.336 A:middle
week here at WWDC.

00:40:21.426 --> 00:40:22.466 A:middle
There's a security lab

00:40:22.466 --> 00:40:23.636 A:middle
immediately afterwards if you

00:40:23.636 --> 00:40:25.846 A:middle
have any questions about these

00:40:25.846 --> 00:40:27.056 A:middle
or any other of the privacy or

00:40:27.056 --> 00:40:28.626 A:middle
security protections in macOS.

00:40:28.626 --> 00:40:29.726 A:middle
Thank you very much.

00:40:30.516 --> 00:40:34.500 A:middle
[ Applause ]

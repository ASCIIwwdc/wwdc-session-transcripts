WEBVTT

00:00:00.506 --> 00:00:05.516 A:middle
[ Music ]

00:00:06.516 --> 00:00:13.356 A:middle
[ Applause and Cheering ]

00:00:13.856 --> 00:00:14.116 A:middle
&gt;&gt; Thank you.

00:00:14.906 --> 00:00:15.426 A:middle
Good afternoon.

00:00:15.426 --> 00:00:17.516 A:middle
My name is Ken Ferry from iOS

00:00:17.516 --> 00:00:19.556 A:middle
System UI, or Springboard if you

00:00:19.556 --> 00:00:19.966 A:middle
know that name.

00:00:20.536 --> 00:00:23.056 A:middle
And today, myself, and Steve

00:00:23.056 --> 00:00:24.866 A:middle
Holt, and James Savage are going

00:00:24.866 --> 00:00:26.076 A:middle
to talk to you about multiple

00:00:26.076 --> 00:00:27.196 A:middle
windows on iPad.

00:00:28.626 --> 00:00:29.536 A:middle
So what are we talking about?

00:00:30.106 --> 00:00:32.665 A:middle
Well, on iOS 12 and before, if

00:00:32.665 --> 00:00:33.936 A:middle
you swipe up in the switcher,

00:00:34.066 --> 00:00:35.916 A:middle
you got this nice little grid,

00:00:35.916 --> 00:00:37.406 A:middle
you can tap on things, gets you

00:00:37.406 --> 00:00:38.496 A:middle
to applications, it's great.

00:00:39.556 --> 00:00:42.216 A:middle
On iOS 13, it looks pretty much

00:00:42.216 --> 00:00:43.516 A:middle
the same, but those are no

00:00:43.516 --> 00:00:44.696 A:middle
longer applications.

00:00:44.996 --> 00:00:47.836 A:middle
Those are Windows, or as you'll

00:00:47.836 --> 00:00:48.926 A:middle
see it's called the in API

00:00:48.926 --> 00:00:49.376 A:middle
scenes.

00:00:50.586 --> 00:00:51.896 A:middle
So that's what we're going to

00:00:51.896 --> 00:00:52.516 A:middle
talk about today.

00:00:53.006 --> 00:00:53.766 A:middle
We're going to talk about what

00:00:53.766 --> 00:00:54.916 A:middle
does this mean for your app.

00:00:55.296 --> 00:00:56.486 A:middle
And it's an introductory talk so

00:00:56.486 --> 00:00:57.586 A:middle
we're going to do it really from

00:00:57.586 --> 00:00:58.236 A:middle
top to bottom.

00:00:58.376 --> 00:00:59.716 A:middle
We're going to start out with

00:00:59.716 --> 00:01:00.646 A:middle
design issues.

00:00:59.716 --> 00:01:00.646 A:middle
design issues.

00:01:01.226 --> 00:01:02.966 A:middle
So, just what are you going to

00:01:02.966 --> 00:01:04.196 A:middle
want to be thinking about doing

00:01:04.196 --> 00:01:05.756 A:middle
at all in your app for multiple

00:01:05.756 --> 00:01:06.176 A:middle
windows?

00:01:07.006 --> 00:01:08.426 A:middle
We'll go on from there to the

00:01:08.426 --> 00:01:10.166 A:middle
how of multiple windows,

00:01:10.516 --> 00:01:11.996 A:middle
starting out with application

00:01:11.996 --> 00:01:13.516 A:middle
lifecycle, which is the biggest

00:01:13.516 --> 00:01:15.286 A:middle
change to the application

00:01:15.286 --> 00:01:15.946 A:middle
programming model.

00:01:16.096 --> 00:01:16.856 A:middle
That's like foreground,

00:01:16.856 --> 00:01:17.606 A:middle
background and active.

00:01:18.626 --> 00:01:19.606 A:middle
Go on from there to drag and

00:01:19.606 --> 00:01:21.156 A:middle
drop, which is how you mostly

00:01:21.156 --> 00:01:21.886 A:middle
make windows.

00:01:22.396 --> 00:01:24.516 A:middle
And then, James will walk you

00:01:24.516 --> 00:01:27.406 A:middle
through next steps of further

00:01:27.406 --> 00:01:29.156 A:middle
adoption that you might want or

00:01:29.156 --> 00:01:30.936 A:middle
need to do in your app in order

00:01:30.936 --> 00:01:32.686 A:middle
to be a good multiple window

00:01:32.816 --> 00:01:33.036 A:middle
app.

00:01:33.276 --> 00:01:35.646 A:middle
So let's get started.

00:01:35.646 --> 00:01:37.296 A:middle
We're going to talk about these

00:01:37.296 --> 00:01:38.416 A:middle
design issues.

00:01:38.856 --> 00:01:41.086 A:middle
And, first, we just want to talk

00:01:41.086 --> 00:01:43.256 A:middle
about what these windows or

00:01:43.386 --> 00:01:44.696 A:middle
again scenes are.

00:01:45.946 --> 00:01:46.926 A:middle
It is -- there's really kind of

00:01:46.926 --> 00:01:48.046 A:middle
two questions we want to try to

00:01:48.046 --> 00:01:50.446 A:middle
answer here, is first, does it

00:01:50.446 --> 00:01:52.086 A:middle
make sense for my application to

00:01:52.086 --> 00:01:54.046 A:middle
support windows at all, multiple

00:01:54.046 --> 00:01:54.486 A:middle
windows?

00:01:54.976 --> 00:01:57.906 A:middle
And then, if it does, what would

00:01:57.906 --> 00:01:58.806 A:middle
those windows be?

00:01:59.036 --> 00:02:01.476 A:middle
Like how do they act, what are

00:01:59.036 --> 00:02:01.476 A:middle
Like how do they act, what are

00:02:01.476 --> 00:02:02.516 A:middle
they, you know, how does the

00:02:02.516 --> 00:02:03.186 A:middle
user think of them?

00:02:04.276 --> 00:02:05.746 A:middle
We'll answer those questions by

00:02:05.746 --> 00:02:07.496 A:middle
looking at examples from Apple's

00:02:07.496 --> 00:02:09.985 A:middle
own apps and generalizing to how

00:02:09.985 --> 00:02:10.886 A:middle
it might apply to yours.

00:02:10.886 --> 00:02:11.956 A:middle
So that's what you're going to

00:02:11.956 --> 00:02:12.516 A:middle
be thinking about.

00:02:13.656 --> 00:02:16.216 A:middle
So we'll start out with Safari.

00:02:16.216 --> 00:02:18.116 A:middle
Safari is a poster child for

00:02:18.116 --> 00:02:20.096 A:middle
this kind of multitasking, that

00:02:20.096 --> 00:02:21.546 A:middle
it was kind of already there.

00:02:21.546 --> 00:02:23.676 A:middle
This is actually a screenshot

00:02:23.676 --> 00:02:26.216 A:middle
from iOS 12 where Safari already

00:02:26.216 --> 00:02:27.806 A:middle
supported the split-screen view.

00:02:28.716 --> 00:02:30.306 A:middle
In iOS 13, it looks like this,

00:02:30.306 --> 00:02:32.496 A:middle
or iPadOS, it looks like this,

00:02:33.136 --> 00:02:34.486 A:middle
which is not really that

00:02:34.556 --> 00:02:34.966 A:middle
different.

00:02:34.966 --> 00:02:36.666 A:middle
That's because it was just so

00:02:36.666 --> 00:02:37.826 A:middle
important that we did it in

00:02:37.826 --> 00:02:39.476 A:middle
Safari even before we could --

00:02:39.556 --> 00:02:40.876 A:middle
we brought it to a whole rest of

00:02:40.876 --> 00:02:41.676 A:middle
the operating system.

00:02:42.176 --> 00:02:46.146 A:middle
For generalization purposes,

00:02:46.586 --> 00:02:48.006 A:middle
though, what is it that we want

00:02:48.006 --> 00:02:50.786 A:middle
to be thinking about here?

00:02:50.986 --> 00:02:52.276 A:middle
The first thing to be realizing

00:02:52.276 --> 00:02:53.736 A:middle
is that every -- there's only

00:02:53.736 --> 00:02:55.916 A:middle
one kind of window in Safari.

00:02:56.036 --> 00:02:58.046 A:middle
They're all the same as each

00:02:58.046 --> 00:02:58.306 A:middle
other.

00:02:58.306 --> 00:02:59.266 A:middle
They're just kind of clones of

00:02:59.266 --> 00:02:59.906 A:middle
the interface.

00:03:00.086 --> 00:03:01.576 A:middle
And each one can do everything

00:03:01.576 --> 00:03:02.376 A:middle
in the application.

00:03:03.116 --> 00:03:05.266 A:middle
That's important because for --

00:03:05.266 --> 00:03:07.556 A:middle
on the iPad, the user should be

00:03:07.556 --> 00:03:09.406 A:middle
able to do everything from just

00:03:09.406 --> 00:03:10.886 A:middle
one window if they want to.

00:03:11.516 --> 00:03:12.316 A:middle
They should be able to create

00:03:12.316 --> 00:03:14.276 A:middle
more windows f they think that's

00:03:14.276 --> 00:03:15.006 A:middle
useful.

00:03:15.486 --> 00:03:17.426 A:middle
But if your application requires

00:03:17.426 --> 00:03:18.626 A:middle
multiple windows to you -- to

00:03:18.626 --> 00:03:20.486 A:middle
work, then something has gone

00:03:20.486 --> 00:03:20.806 A:middle
wrong.

00:03:21.506 --> 00:03:22.816 A:middle
So, it's not important that it

00:03:22.816 --> 00:03:24.286 A:middle
always be quite like this where

00:03:24.286 --> 00:03:25.496 A:middle
they're all just clones of each

00:03:25.496 --> 00:03:27.336 A:middle
other, but it is important that

00:03:27.336 --> 00:03:29.036 A:middle
the first window that the user

00:03:29.036 --> 00:03:30.596 A:middle
create be able to do everything.

00:03:31.136 --> 00:03:34.336 A:middle
Now, that said, in this case,

00:03:35.016 --> 00:03:36.026 A:middle
they are all the same.

00:03:36.026 --> 00:03:36.976 A:middle
And you'll actually see that in

00:03:36.976 --> 00:03:38.046 A:middle
most of Apple's apps, that's

00:03:38.046 --> 00:03:38.676 A:middle
what we've done.

00:03:39.066 --> 00:03:40.906 A:middle
So, and that's -- so that's not

00:03:40.906 --> 00:03:41.486 A:middle
a bad thing.

00:03:41.486 --> 00:03:42.546 A:middle
That's the easiest thing for you

00:03:42.546 --> 00:03:43.826 A:middle
to do and it very well might be

00:03:43.826 --> 00:03:44.316 A:middle
the right thing.

00:03:44.476 --> 00:03:45.546 A:middle
We'll look at the examples.

00:03:45.936 --> 00:03:47.456 A:middle
Though before I go on, I just

00:03:47.456 --> 00:03:48.616 A:middle
want to note that like because

00:03:48.616 --> 00:03:51.126 A:middle
we did adopt, you know, the

00:03:51.126 --> 00:03:52.346 A:middle
system-wide support for this, it

00:03:52.346 --> 00:03:53.416 A:middle
did get better in Safari.

00:03:53.786 --> 00:03:55.086 A:middle
Now, you can like tear off one

00:03:55.086 --> 00:03:56.806 A:middle
of these things and throw it off

00:03:56.806 --> 00:03:58.306 A:middle
to the side and concentrate on

00:03:58.306 --> 00:03:59.016 A:middle
something else for a little

00:03:59.016 --> 00:03:59.406 A:middle
while.

00:03:59.556 --> 00:04:00.466 A:middle
You know, it's fancy.

00:03:59.556 --> 00:04:00.466 A:middle
You know, it's fancy.

00:04:01.756 --> 00:04:07.696 A:middle
Going on, document-based apps.

00:04:09.406 --> 00:04:11.036 A:middle
Here, we're looking at pages.

00:04:11.376 --> 00:04:13.546 A:middle
And in any document-based app

00:04:13.546 --> 00:04:15.076 A:middle
really, the user would have the

00:04:15.076 --> 00:04:17.486 A:middle
expectation that they're able to

00:04:17.696 --> 00:04:19.466 A:middle
view documents in different

00:04:19.466 --> 00:04:20.505 A:middle
windows at the same time.

00:04:20.716 --> 00:04:21.856 A:middle
So you're definitely going to

00:04:21.856 --> 00:04:23.336 A:middle
want to support that.

00:04:23.336 --> 00:04:24.266 A:middle
But there's something you might

00:04:24.446 --> 00:04:25.576 A:middle
or might not be a little bit

00:04:25.576 --> 00:04:26.376 A:middle
surprised by here.

00:04:26.376 --> 00:04:27.516 A:middle
If you look at the top left,

00:04:28.206 --> 00:04:29.586 A:middle
there's a button there that says

00:04:29.586 --> 00:04:30.676 A:middle
documents on both of those

00:04:30.676 --> 00:04:31.136 A:middle
windows.

00:04:31.966 --> 00:04:32.906 A:middle
Each of these windows is

00:04:32.906 --> 00:04:34.086 A:middle
actually a full browser.

00:04:34.326 --> 00:04:35.506 A:middle
You can go back from the

00:04:35.506 --> 00:04:36.506 A:middle
document you're looking at and

00:04:36.506 --> 00:04:37.316 A:middle
look at a different one.

00:04:37.696 --> 00:04:38.836 A:middle
So it's actually the same case

00:04:38.836 --> 00:04:39.456 A:middle
as Safari.

00:04:39.796 --> 00:04:41.146 A:middle
There's only one kind of window

00:04:41.146 --> 00:04:41.706 A:middle
and pages.

00:04:42.626 --> 00:04:45.886 A:middle
That's not necessarily going to

00:04:45.886 --> 00:04:47.216 A:middle
be the case in every document,

00:04:47.216 --> 00:04:48.276 A:middle
not even necessarily in every

00:04:48.276 --> 00:04:49.446 A:middle
document-based app I think.

00:04:49.836 --> 00:04:52.496 A:middle
But in here, it does make sense.

00:04:52.496 --> 00:04:53.616 A:middle
And we'll look at cases where it

00:04:53.616 --> 00:04:57.276 A:middle
doesn't going on.

00:04:57.486 --> 00:05:00.706 A:middle
Maps also is -- there's only one

00:04:57.486 --> 00:05:00.706 A:middle
Maps also is -- there's only one

00:05:00.706 --> 00:05:01.326 A:middle
kind of window.

00:05:01.606 --> 00:05:02.566 A:middle
But the reason I still want to

00:05:02.606 --> 00:05:03.726 A:middle
-- we still want to talk about

00:05:03.726 --> 00:05:05.186 A:middle
it is because it illustrates

00:05:05.346 --> 00:05:07.176 A:middle
something to that other point of

00:05:07.176 --> 00:05:08.726 A:middle
should my application even

00:05:08.726 --> 00:05:09.816 A:middle
support multiple windows.

00:05:10.166 --> 00:05:12.686 A:middle
That's because at first, this

00:05:12.686 --> 00:05:14.346 A:middle
didn't necessarily seem like

00:05:14.396 --> 00:05:15.906 A:middle
that attractive of a case

00:05:16.166 --> 00:05:17.246 A:middle
because it seems like you just,

00:05:17.246 --> 00:05:18.646 A:middle
you know, you open maps, you go

00:05:18.646 --> 00:05:19.726 A:middle
somewhere and then you close it.

00:05:20.086 --> 00:05:21.076 A:middle
And that's how it works.

00:05:21.076 --> 00:05:23.636 A:middle
That's actually not the case.

00:05:23.716 --> 00:05:26.276 A:middle
If you're planning an evening

00:05:26.276 --> 00:05:27.556 A:middle
here, you might be going to

00:05:27.556 --> 00:05:28.676 A:middle
dinner and then after dinner,

00:05:28.676 --> 00:05:29.586 A:middle
you're going to a show.

00:05:30.216 --> 00:05:32.516 A:middle
It's really useful to be able to

00:05:32.516 --> 00:05:34.476 A:middle
do each of those two legs in a

00:05:34.476 --> 00:05:35.256 A:middle
different window.

00:05:35.586 --> 00:05:36.966 A:middle
So you can think about them or

00:05:36.966 --> 00:05:38.976 A:middle
change them without losing all

00:05:38.976 --> 00:05:40.096 A:middle
your state in between.

00:05:41.506 --> 00:05:43.806 A:middle
And that seems specific to maps,

00:05:43.846 --> 00:05:45.386 A:middle
but the reason to bring that up

00:05:45.386 --> 00:05:47.126 A:middle
is that we've pretty much always

00:05:47.126 --> 00:05:47.656 A:middle
found that.

00:05:48.026 --> 00:05:49.916 A:middle
So, for all the cases where we

00:05:50.166 --> 00:05:51.826 A:middle
weren't sure if multiple windows

00:05:51.826 --> 00:05:53.546 A:middle
would be useful or not, we

00:05:53.546 --> 00:05:54.586 A:middle
pretty much came around to that

00:05:54.586 --> 00:05:54.986 A:middle
it is.

00:05:55.276 --> 00:05:56.916 A:middle
So, I'll go through more

00:05:56.916 --> 00:05:59.216 A:middle
examples of cases where it is,

00:05:59.216 --> 00:06:00.576 A:middle
but be thinking about that when

00:05:59.216 --> 00:06:00.576 A:middle
but be thinking about that when

00:06:00.576 --> 00:06:01.686 A:middle
you're when you're doing yours.

00:06:03.076 --> 00:06:06.096 A:middle
Oh, and, you know, because it is

00:06:06.536 --> 00:06:07.826 A:middle
using the system multi-window,

00:06:08.246 --> 00:06:09.596 A:middle
that does mean that once you

00:06:09.596 --> 00:06:10.666 A:middle
want to focus on one of them,

00:06:10.666 --> 00:06:11.596 A:middle
say where I'm going to dinner,

00:06:11.596 --> 00:06:12.696 A:middle
you know, I can rearrange my

00:06:12.696 --> 00:06:15.196 A:middle
spaces and pull out notes and do

00:06:15.196 --> 00:06:16.426 A:middle
things that you otherwise

00:06:16.426 --> 00:06:18.496 A:middle
wouldn't be able to do if it was

00:06:18.496 --> 00:06:19.756 A:middle
just inside of one application.

00:06:21.286 --> 00:06:23.536 A:middle
So, Mail is the first case where

00:06:23.536 --> 00:06:24.586 A:middle
there are different kinds of

00:06:24.586 --> 00:06:26.546 A:middle
windows that we've looked at.

00:06:27.266 --> 00:06:28.276 A:middle
Craig showed this in the

00:06:28.276 --> 00:06:29.716 A:middle
keynote, but when you reply to a

00:06:29.716 --> 00:06:31.376 A:middle
message, that brings up this

00:06:31.376 --> 00:06:32.456 A:middle
modal interface same as it

00:06:32.456 --> 00:06:34.276 A:middle
always has, but you can tear it

00:06:34.276 --> 00:06:34.596 A:middle
off.

00:06:35.426 --> 00:06:36.966 A:middle
And then you might even want to

00:06:36.966 --> 00:06:39.386 A:middle
use your slide over stack as

00:06:39.386 --> 00:06:41.396 A:middle
almost like a to-do list of

00:06:41.526 --> 00:06:44.336 A:middle
actions that you are pended and

00:06:44.336 --> 00:06:45.116 A:middle
still need to perform.

00:06:46.256 --> 00:06:48.926 A:middle
So in this case, if you look at

00:06:48.926 --> 00:06:49.816 A:middle
the window again, look at the

00:06:49.816 --> 00:06:50.126 A:middle
top.

00:06:50.216 --> 00:06:51.546 A:middle
There's a Send button, that's

00:06:51.546 --> 00:06:52.746 A:middle
the blue arrow, and there's a

00:06:52.746 --> 00:06:53.506 A:middle
Cancel button.

00:06:53.506 --> 00:06:55.386 A:middle
But there's no way to get back

00:06:55.386 --> 00:06:57.816 A:middle
from here to see the rest of

00:06:58.006 --> 00:06:59.306 A:middle
your mailboxes or anything like

00:06:59.306 --> 00:06:59.546 A:middle
that.

00:06:59.806 --> 00:07:01.126 A:middle
These windows are dedicated.

00:06:59.806 --> 00:07:01.126 A:middle
These windows are dedicated.

00:07:01.656 --> 00:07:04.116 A:middle
And then, when you and -- so

00:07:04.776 --> 00:07:07.276 A:middle
when you hit one of those

00:07:07.276 --> 00:07:09.196 A:middle
buttons, it will close the

00:07:09.196 --> 00:07:09.516 A:middle
window.

00:07:09.786 --> 00:07:12.006 A:middle
So I think Craig showed sending

00:07:12.006 --> 00:07:12.956 A:middle
in the keynote, so I'm just

00:07:12.956 --> 00:07:13.886 A:middle
going to show dismissing.

00:07:14.266 --> 00:07:15.986 A:middle
If you first click to get out of

00:07:15.986 --> 00:07:17.836 A:middle
the slide overview to just view

00:07:17.836 --> 00:07:18.926 A:middle
one of them and then click

00:07:18.926 --> 00:07:20.006 A:middle
Cancel, it looks like that.

00:07:20.296 --> 00:07:22.206 A:middle
And all those animations are

00:07:22.206 --> 00:07:23.896 A:middle
available in your app too.

00:07:24.066 --> 00:07:25.826 A:middle
They're talked about in some of

00:07:25.826 --> 00:07:27.266 A:middle
the later talks.

00:07:29.996 --> 00:07:32.756 A:middle
Messages also has different

00:07:32.756 --> 00:07:34.346 A:middle
kinds of windows, but it's not

00:07:34.346 --> 00:07:35.716 A:middle
just like a to-do list.

00:07:35.716 --> 00:07:37.436 A:middle
It's not just like a transaction

00:07:37.436 --> 00:07:38.776 A:middle
or an action like in the other

00:07:38.776 --> 00:07:39.116 A:middle
case.

00:07:39.686 --> 00:07:41.416 A:middle
Here, when you pull off a thread

00:07:41.636 --> 00:07:43.296 A:middle
into its own window, that's just

00:07:43.296 --> 00:07:44.866 A:middle
a dedicated window that pertain

00:07:44.866 --> 00:07:46.246 A:middle
-- that is only for that one

00:07:46.246 --> 00:07:46.566 A:middle
thread.

00:07:46.566 --> 00:07:47.806 A:middle
And you can see it as a Done

00:07:47.806 --> 00:07:48.766 A:middle
button at the top from when

00:07:48.766 --> 00:07:49.886 A:middle
you're finished with it.

00:07:50.856 --> 00:07:52.836 A:middle
That's more of an organizational

00:07:52.836 --> 00:07:55.226 A:middle
tool, but it's a very handy

00:07:55.226 --> 00:07:57.856 A:middle
organizational tool.

00:07:57.856 --> 00:07:59.506 A:middle
And then going back for a minute

00:07:59.506 --> 00:08:00.476 A:middle
to that question of should my

00:07:59.506 --> 00:08:00.476 A:middle
to that question of should my

00:08:00.476 --> 00:08:01.566 A:middle
applications support multiple

00:08:01.566 --> 00:08:04.956 A:middle
windows, here in Messages, using

00:08:04.956 --> 00:08:06.366 A:middle
this, I found it incredibly

00:08:06.366 --> 00:08:08.876 A:middle
useful to be able to look at one

00:08:08.876 --> 00:08:10.456 A:middle
conversation and scroll up and

00:08:10.456 --> 00:08:11.506 A:middle
find some information and

00:08:11.506 --> 00:08:13.426 A:middle
reference it while I talk to

00:08:13.426 --> 00:08:14.476 A:middle
someone in the other window.

00:08:14.646 --> 00:08:15.806 A:middle
And I can tell them, and if they

00:08:15.806 --> 00:08:16.966 A:middle
have more questions, I don't

00:08:16.966 --> 00:08:18.626 A:middle
have to somehow go back and

00:08:18.626 --> 00:08:18.976 A:middle
forth.

00:08:18.976 --> 00:08:20.006 A:middle
I've still got it there.

00:08:20.406 --> 00:08:22.406 A:middle
So, in general, I think the

00:08:22.406 --> 00:08:24.286 A:middle
generalizable principle there is

00:08:24.286 --> 00:08:25.226 A:middle
being able to refer to

00:08:25.226 --> 00:08:26.966 A:middle
something, being able to see one

00:08:26.966 --> 00:08:27.976 A:middle
thing while you're acting in a

00:08:27.976 --> 00:08:29.106 A:middle
different window.

00:08:31.356 --> 00:08:33.716 A:middle
The last example of an Apple app

00:08:33.716 --> 00:08:35.316 A:middle
I want to talk about today is

00:08:35.426 --> 00:08:35.905 A:middle
Calendar.

00:08:37.155 --> 00:08:38.446 A:middle
What's interesting here is that

00:08:38.446 --> 00:08:40.176 A:middle
Calendar supported drag and drop

00:08:40.176 --> 00:08:41.696 A:middle
for events already.

00:08:41.696 --> 00:08:44.996 A:middle
But by adopting multi-window,

00:08:44.996 --> 00:08:46.876 A:middle
now, if you view say two

00:08:46.876 --> 00:08:48.486 A:middle
different weeks at the same time

00:08:48.486 --> 00:08:50.116 A:middle
in Calendar, you can drag and

00:08:50.116 --> 00:08:51.846 A:middle
drop from one of those weeks to

00:08:51.846 --> 00:08:52.276 A:middle
the other.

00:08:53.066 --> 00:08:55.486 A:middle
And that didn't require any

00:08:55.486 --> 00:08:56.686 A:middle
additional changes in Calendar

00:08:56.686 --> 00:08:57.356 A:middle
to support that.

00:08:57.596 --> 00:08:58.836 A:middle
That's just the drag and drop

00:08:58.836 --> 00:08:59.456 A:middle
they already had.

00:09:00.106 --> 00:09:01.586 A:middle
So if your app supports drag and

00:09:01.586 --> 00:09:04.136 A:middle
drop by supporting multiple

00:09:04.136 --> 00:09:05.596 A:middle
windows, also you can kind of

00:09:05.596 --> 00:09:07.526 A:middle
magnify the power of both of

00:09:07.526 --> 00:09:08.736 A:middle
those features working together.

00:09:09.206 --> 00:09:12.086 A:middle
So, yeah. And so like I said,

00:09:12.206 --> 00:09:13.966 A:middle
pretty much what we found when

00:09:13.966 --> 00:09:16.046 A:middle
we looked at this is that any

00:09:16.046 --> 00:09:17.846 A:middle
app of sort of reasonable

00:09:18.396 --> 00:09:20.476 A:middle
robustness pretty much benefits

00:09:20.476 --> 00:09:20.756 A:middle
from it.

00:09:20.756 --> 00:09:22.536 A:middle
So, you know, I can't completely

00:09:22.536 --> 00:09:23.446 A:middle
answer the question for your

00:09:23.446 --> 00:09:23.626 A:middle
apps.

00:09:23.626 --> 00:09:24.406 A:middle
You'll have to think about it.

00:09:24.406 --> 00:09:25.196 A:middle
But hopefully some of these

00:09:25.196 --> 00:09:28.486 A:middle
examples will help you think of

00:09:28.486 --> 00:09:29.516 A:middle
those cases where it would be

00:09:29.516 --> 00:09:30.586 A:middle
useful for your users.

00:09:31.036 --> 00:09:34.126 A:middle
Last thing I wanted to note here

00:09:34.126 --> 00:09:35.126 A:middle
before we go on to the next

00:09:35.126 --> 00:09:36.966 A:middle
topic is, you know, we talked

00:09:36.966 --> 00:09:38.626 A:middle
about iPad apps on the Mac this

00:09:38.626 --> 00:09:38.836 A:middle
year.

00:09:39.166 --> 00:09:41.856 A:middle
And Mac apps have windows and

00:09:42.026 --> 00:09:43.216 A:middle
without all this API, you

00:09:43.216 --> 00:09:44.456 A:middle
couldn't make new ones, so it's

00:09:44.456 --> 00:09:45.336 A:middle
going to be kind of a weird Mac

00:09:45.336 --> 00:09:45.476 A:middle
app.

00:09:45.526 --> 00:09:46.116 A:middle
But now you can.

00:09:46.566 --> 00:09:46.976 A:middle
So do that.

00:09:50.186 --> 00:09:52.286 A:middle
Alright. So that's everything

00:09:52.286 --> 00:09:54.036 A:middle
about what are these windows at

00:09:54.036 --> 00:09:54.326 A:middle
all.

00:09:54.726 --> 00:09:56.376 A:middle
But now, still from a design

00:09:56.376 --> 00:09:58.236 A:middle
perspective, what interactions

00:09:58.236 --> 00:10:00.026 A:middle
do you want to enable in your

00:09:58.236 --> 00:10:00.026 A:middle
do you want to enable in your

00:10:00.026 --> 00:10:01.546 A:middle
app so that the user can create

00:10:01.546 --> 00:10:02.176 A:middle
new windows?

00:10:04.176 --> 00:10:05.656 A:middle
We're going to explore that by

00:10:05.656 --> 00:10:07.156 A:middle
first showing what the system

00:10:07.156 --> 00:10:08.686 A:middle
can do for you for free, and

00:10:08.686 --> 00:10:10.786 A:middle
then extrapolating to what users

00:10:10.786 --> 00:10:12.256 A:middle
would expect to be able to do

00:10:12.256 --> 00:10:13.556 A:middle
based on what is already there.

00:10:14.346 --> 00:10:16.386 A:middle
So for starters, Craig showed

00:10:16.386 --> 00:10:17.446 A:middle
App Expose already.

00:10:17.446 --> 00:10:19.746 A:middle
And in App Expose, there's

00:10:19.906 --> 00:10:21.976 A:middle
always this little button in the

00:10:21.976 --> 00:10:23.816 A:middle
top right, and that that little

00:10:23.816 --> 00:10:24.876 A:middle
button is make new window.

00:10:25.546 --> 00:10:26.336 A:middle
So that's something that's

00:10:26.336 --> 00:10:27.236 A:middle
completely for free.

00:10:27.636 --> 00:10:28.256 A:middle
If your app supports

00:10:28.256 --> 00:10:30.216 A:middle
multi-window, that will make new

00:10:30.216 --> 00:10:30.636 A:middle
windows.

00:10:31.096 --> 00:10:33.766 A:middle
There's only one other thing

00:10:33.766 --> 00:10:35.966 A:middle
that we can really do for all

00:10:35.966 --> 00:10:37.666 A:middle
applications, but this is the

00:10:37.666 --> 00:10:38.836 A:middle
one that kind of becomes the

00:10:38.836 --> 00:10:39.816 A:middle
foundation for everything.

00:10:40.646 --> 00:10:41.766 A:middle
If you're already looking at

00:10:41.766 --> 00:10:43.756 A:middle
your application and you grab

00:10:43.756 --> 00:10:45.476 A:middle
the application icon and drag it

00:10:45.476 --> 00:10:48.226 A:middle
over to the edge, that seems

00:10:48.226 --> 00:10:49.466 A:middle
like it's really explicitly

00:10:49.466 --> 00:10:50.886 A:middle
saying, I want to make another

00:10:50.886 --> 00:10:51.816 A:middle
window right here.

00:10:52.336 --> 00:10:53.576 A:middle
Just what else could that mean?

00:10:54.516 --> 00:10:56.146 A:middle
And we have all the contexts

00:10:56.146 --> 00:10:57.096 A:middle
that we need to make that work,

00:10:57.096 --> 00:10:58.426 A:middle
so it does.

00:10:58.966 --> 00:11:02.106 A:middle
But given that, now if the user

00:10:58.966 --> 00:11:02.106 A:middle
But given that, now if the user

00:11:02.106 --> 00:11:03.726 A:middle
picks up something else, say a

00:11:03.726 --> 00:11:06.376 A:middle
tab in Safari and they do that

00:11:06.376 --> 00:11:07.926 A:middle
drag, they're also going to

00:11:07.926 --> 00:11:10.186 A:middle
expect that to work, and that

00:11:10.186 --> 00:11:11.826 A:middle
the system can't just do it for

00:11:11.826 --> 00:11:11.996 A:middle
you.

00:11:12.546 --> 00:11:15.506 A:middle
It's not a lot of work to adopt

00:11:15.506 --> 00:11:16.646 A:middle
the API to do that, but you do

00:11:16.646 --> 00:11:18.046 A:middle
have to actually adopt something

00:11:18.046 --> 00:11:18.726 A:middle
to make that work.

00:11:19.216 --> 00:11:20.316 A:middle
And that really extrapolate --

00:11:20.316 --> 00:11:22.126 A:middle
that extends to all drag and

00:11:22.126 --> 00:11:22.376 A:middle
drop.

00:11:22.866 --> 00:11:24.526 A:middle
Pretty much if the user can pick

00:11:24.526 --> 00:11:26.446 A:middle
something up and it makes any

00:11:26.446 --> 00:11:28.546 A:middle
kind of sense for that to result

00:11:28.546 --> 00:11:30.736 A:middle
in a new window, they're going

00:11:30.736 --> 00:11:31.736 A:middle
to expect that it can.

00:11:31.956 --> 00:11:33.386 A:middle
And you should enable that.

00:11:34.016 --> 00:11:35.936 A:middle
A really common case for that is

00:11:35.936 --> 00:11:37.676 A:middle
any kind of master detail view.

00:11:38.346 --> 00:11:40.256 A:middle
So here in message -- in Mail,

00:11:40.806 --> 00:11:43.006 A:middle
you know, there's this left-hand

00:11:43.006 --> 00:11:44.976 A:middle
table view that represents --

00:11:44.976 --> 00:11:46.456 A:middle
each cell represents a message.

00:11:46.546 --> 00:11:47.766 A:middle
And if you tap on the cell, then

00:11:47.766 --> 00:11:48.826 A:middle
you see the whole thing, right?

00:11:49.366 --> 00:11:50.476 A:middle
So the user is going to expect

00:11:50.476 --> 00:11:51.476 A:middle
that if you drag out of the

00:11:51.476 --> 00:11:53.566 A:middle
table view that that's going to

00:11:53.566 --> 00:11:55.376 A:middle
pull out a window for a message.

00:11:57.696 --> 00:12:01.416 A:middle
OK. So mostly drag and drop.

00:11:57.696 --> 00:12:01.416 A:middle
OK. So mostly drag and drop.

00:12:01.536 --> 00:12:02.996 A:middle
You can also create windows

00:12:02.996 --> 00:12:04.106 A:middle
through explicit action.

00:12:04.806 --> 00:12:07.026 A:middle
So in an application like Safari

00:12:07.026 --> 00:12:08.016 A:middle
or really anything that has

00:12:08.016 --> 00:12:09.766 A:middle
links at all, you might want to

00:12:09.766 --> 00:12:11.256 A:middle
support that if you press and

00:12:11.256 --> 00:12:13.416 A:middle
hold on a link that that might

00:12:13.416 --> 00:12:14.976 A:middle
pull up a popover and the

00:12:14.976 --> 00:12:16.956 A:middle
popover might have a button that

00:12:16.956 --> 00:12:18.086 A:middle
says Open in New Window.

00:12:18.766 --> 00:12:20.016 A:middle
And that is the case in Safari.

00:12:20.106 --> 00:12:20.616 A:middle
You can do that.

00:12:20.946 --> 00:12:22.316 A:middle
And that's how it reads, it says

00:12:22.316 --> 00:12:23.096 A:middle
Open in New Window.

00:12:24.196 --> 00:12:26.116 A:middle
So that pretty much implies that

00:12:26.116 --> 00:12:27.536 A:middle
there must be -- we are, there

00:12:27.536 --> 00:12:29.576 A:middle
is an API in UIKit that just

00:12:29.576 --> 00:12:30.886 A:middle
whenever you call it, it will

00:12:30.886 --> 00:12:31.556 A:middle
open a new window.

00:12:32.786 --> 00:12:34.346 A:middle
So, you could do a lot with

00:12:34.346 --> 00:12:34.736 A:middle
that, you know.

00:12:34.736 --> 00:12:36.196 A:middle
You could set up like a voice

00:12:36.196 --> 00:12:37.546 A:middle
recognition thing so that like

00:12:37.546 --> 00:12:40.026 A:middle
whenever I sneeze, it like

00:12:40.026 --> 00:12:42.096 A:middle
creates like a new sneeze window

00:12:42.516 --> 00:12:43.936 A:middle
like for analyzing my sneeze

00:12:43.936 --> 00:12:46.346 A:middle
like kind of like Shazam or

00:12:47.046 --> 00:12:47.656 A:middle
something like that.

00:12:47.656 --> 00:12:49.006 A:middle
But -- you could do that, but it

00:12:49.006 --> 00:12:49.626 A:middle
would be weird.

00:12:50.206 --> 00:12:52.196 A:middle
So you shouldn't.

00:12:52.196 --> 00:12:54.386 A:middle
The -- though it actually sounds

00:12:54.386 --> 00:12:56.456 A:middle
kind of fun, but you know.

00:12:56.876 --> 00:12:58.466 A:middle
As we were saying before, the

00:12:58.466 --> 00:13:01.696 A:middle
user should not be forced into

00:12:58.466 --> 00:13:01.696 A:middle
user should not be forced into

00:13:01.966 --> 00:13:02.916 A:middle
using multiple windows.

00:13:02.916 --> 00:13:04.026 A:middle
That should always be an action

00:13:04.026 --> 00:13:05.096 A:middle
they take for themselves.

00:13:05.486 --> 00:13:06.366 A:middle
So it always needs to be

00:13:06.366 --> 00:13:08.096 A:middle
something that they recognize as

00:13:08.096 --> 00:13:09.456 A:middle
very explicitly creating a new

00:13:09.456 --> 00:13:11.316 A:middle
window like this Open in New

00:13:11.316 --> 00:13:11.696 A:middle
Window.

00:13:12.186 --> 00:13:13.916 A:middle
So -- but that's just -- that's

00:13:13.916 --> 00:13:14.616 A:middle
design level.

00:13:14.616 --> 00:13:15.746 A:middle
So that's something you have to

00:13:15.746 --> 00:13:16.836 A:middle
do for yourselves in your own

00:13:16.836 --> 00:13:17.476 A:middle
applications.

00:13:18.556 --> 00:13:21.246 A:middle
Anyway, that is everything we

00:13:21.246 --> 00:13:22.606 A:middle
have to say about design and the

00:13:22.606 --> 00:13:23.466 A:middle
what.

00:13:23.466 --> 00:13:25.906 A:middle
So to talk about how you can go

00:13:25.906 --> 00:13:28.036 A:middle
adopting this, I'm going to turn

00:13:28.036 --> 00:13:29.356 A:middle
it over to Steve Holt.

00:13:30.516 --> 00:13:34.736 A:middle
[ Applause ]

00:13:35.236 --> 00:13:38.396 A:middle
&gt;&gt; Thank you.

00:13:38.576 --> 00:13:39.236 A:middle
Thank you, Ken.

00:13:39.496 --> 00:13:41.296 A:middle
My name is Steve Holt and I'm an

00:13:41.296 --> 00:13:42.826 A:middle
engineer in the UIKit Team.

00:13:43.216 --> 00:13:44.986 A:middle
And hopefully, you've seen some

00:13:44.986 --> 00:13:47.216 A:middle
great examples of how to adopt

00:13:47.216 --> 00:13:48.086 A:middle
this new feature in your

00:13:48.086 --> 00:13:48.886 A:middle
applications.

00:13:49.456 --> 00:13:50.696 A:middle
And you're probably wondering,

00:13:51.356 --> 00:13:52.996 A:middle
how do you actually adopt it in

00:13:52.996 --> 00:13:53.796 A:middle
your applications?

00:13:54.686 --> 00:13:56.146 A:middle
That's great because we're going

00:13:56.146 --> 00:13:57.116 A:middle
to talk about that right now.

00:13:57.756 --> 00:13:59.976 A:middle
So there are two classes you

00:13:59.976 --> 00:14:01.636 A:middle
need to know about in general to

00:13:59.976 --> 00:14:01.636 A:middle
need to know about in general to

00:14:01.636 --> 00:14:03.226 A:middle
work with this new feature on

00:14:03.226 --> 00:14:05.756 A:middle
iOS and iPadOS, which is

00:14:05.756 --> 00:14:08.006 A:middle
UIWindowScene and SceneSession.

00:14:08.656 --> 00:14:11.886 A:middle
You might be familiar with how

00:14:11.886 --> 00:14:13.616 A:middle
UIs in UIKit are structured

00:14:13.666 --> 00:14:14.026 A:middle
today.

00:14:14.026 --> 00:14:15.926 A:middle
You have a screen, you have all

00:14:15.926 --> 00:14:17.216 A:middle
window or maybe multiple windows

00:14:17.216 --> 00:14:18.246 A:middle
depending on your application.

00:14:18.246 --> 00:14:19.946 A:middle
And then you have your views

00:14:19.946 --> 00:14:21.256 A:middle
contained inside that window

00:14:21.256 --> 00:14:22.626 A:middle
alongside your view controllers.

00:14:23.746 --> 00:14:25.306 A:middle
UIWindowScene inserts itself

00:14:25.526 --> 00:14:27.696 A:middle
right in between the screen and

00:14:27.696 --> 00:14:28.376 A:middle
your windows.

00:14:29.496 --> 00:14:30.666 A:middle
This lets you contain your

00:14:30.666 --> 00:14:32.246 A:middle
windows to a single instance of

00:14:32.246 --> 00:14:34.986 A:middle
user interface without forcing

00:14:34.986 --> 00:14:36.216 A:middle
you to change your application

00:14:36.216 --> 00:14:37.496 A:middle
or user interface structure too

00:14:37.496 --> 00:14:38.756 A:middle
much from what you already

00:14:38.756 --> 00:14:43.246 A:middle
should have today.

00:14:43.346 --> 00:14:45.776 A:middle
So basically, a scene, it

00:14:45.776 --> 00:14:47.296 A:middle
contains your user interface,

00:14:47.896 --> 00:14:49.596 A:middle
and the system will create an on

00:14:49.596 --> 00:14:50.556 A:middle
demand for you.

00:14:51.276 --> 00:14:53.256 A:middle
Whenever the user performs a

00:14:53.256 --> 00:14:54.726 A:middle
drag and drop interaction,

00:14:55.126 --> 00:14:56.956 A:middle
requests a new window opened up

00:14:57.026 --> 00:14:58.676 A:middle
through your own interfaces or

00:14:58.886 --> 00:15:00.846 A:middle
however that's achieved, the

00:14:58.886 --> 00:15:00.846 A:middle
however that's achieved, the

00:15:00.846 --> 00:15:03.546 A:middle
system will ask you to put UI

00:15:03.546 --> 00:15:04.236 A:middle
onto the screen.

00:15:05.466 --> 00:15:07.806 A:middle
And then, if that scene should

00:15:07.806 --> 00:15:10.206 A:middle
go background and it's not being

00:15:10.206 --> 00:15:12.786 A:middle
interacted with anymore, the

00:15:12.786 --> 00:15:15.976 A:middle
system can decide that it's just

00:15:16.256 --> 00:15:17.306 A:middle
kind of hanging out there, we

00:15:17.306 --> 00:15:18.766 A:middle
don't need it anymore, and we

00:15:18.766 --> 00:15:19.906 A:middle
may destroy that scene.

00:15:21.026 --> 00:15:23.896 A:middle
So, if we're going to take that

00:15:23.896 --> 00:15:28.036 A:middle
scene away, but clearly the user

00:15:28.036 --> 00:15:29.246 A:middle
thinks something is there.

00:15:29.246 --> 00:15:30.466 A:middle
I mean your application is still

00:15:30.466 --> 00:15:31.416 A:middle
in the switcher right where it

00:15:31.416 --> 00:15:32.096 A:middle
was before.

00:15:33.686 --> 00:15:36.586 A:middle
You need a way to understand

00:15:36.586 --> 00:15:38.086 A:middle
what is actually in the switcher

00:15:39.116 --> 00:15:42.056 A:middle
without having to rely on the

00:15:42.056 --> 00:15:44.066 A:middle
actual concrete interfaces being

00:15:44.066 --> 00:15:44.976 A:middle
suspended out of your

00:15:44.976 --> 00:15:45.586 A:middle
application.

00:15:46.096 --> 00:15:48.066 A:middle
And that's where SceneSession

00:15:48.066 --> 00:15:49.726 A:middle
comes in.

00:15:50.486 --> 00:15:52.096 A:middle
The SceneSession represents the

00:15:52.096 --> 00:15:53.856 A:middle
persisted interface state that

00:15:53.856 --> 00:15:56.006 A:middle
the user of your applications

00:15:56.416 --> 00:15:58.836 A:middle
were doing last.

00:15:59.166 --> 00:16:00.316 A:middle
Now, they have a defined system

00:15:59.166 --> 00:16:00.316 A:middle
Now, they have a defined system

00:16:00.316 --> 00:16:00.566 A:middle
role.

00:16:00.866 --> 00:16:02.416 A:middle
This could be a standard

00:16:02.416 --> 00:16:04.056 A:middle
application interface that you

00:16:04.056 --> 00:16:06.216 A:middle
interact with on the display of

00:16:06.216 --> 00:16:08.236 A:middle
the actual device, or could be

00:16:08.236 --> 00:16:09.246 A:middle
for an external display.

00:16:09.246 --> 00:16:14.676 A:middle
And every time a new window gets

00:16:14.676 --> 00:16:16.216 A:middle
created on the system, your

00:16:16.216 --> 00:16:17.536 A:middle
application is informed through

00:16:17.536 --> 00:16:19.436 A:middle
the application delegate that a

00:16:19.436 --> 00:16:20.896 A:middle
new session has been made.

00:16:21.766 --> 00:16:23.406 A:middle
And every time one has been

00:16:23.406 --> 00:16:25.006 A:middle
destroyed by the user, either

00:16:25.006 --> 00:16:26.546 A:middle
through interactions with our

00:16:26.716 --> 00:16:29.786 A:middle
APIs, or because they swiped up

00:16:29.786 --> 00:16:30.896 A:middle
in the switcher and destroyed

00:16:30.896 --> 00:16:32.636 A:middle
that space, you get informed

00:16:32.636 --> 00:16:34.546 A:middle
that that session has been

00:16:34.546 --> 00:16:35.516 A:middle
destroyed.

00:16:36.276 --> 00:16:37.826 A:middle
And your UI scenes from the

00:16:37.826 --> 00:16:40.736 A:middle
previous slide connect and

00:16:40.736 --> 00:16:42.706 A:middle
disconnect from these sessions

00:16:42.906 --> 00:16:43.916 A:middle
over the lifetime of your

00:16:43.916 --> 00:16:44.506 A:middle
application.

00:16:45.306 --> 00:16:47.396 A:middle
Now, this has some interesting

00:16:47.396 --> 00:16:48.506 A:middle
effects with your application

00:16:48.506 --> 00:16:50.146 A:middle
lifecycle as you might expect.

00:16:51.136 --> 00:16:54.526 A:middle
To represent that, there is a

00:16:54.526 --> 00:16:57.156 A:middle
handy chart we made up.

00:16:57.786 --> 00:16:58.766 A:middle
We have three sessions in our

00:16:58.766 --> 00:17:00.566 A:middle
application, which represents

00:16:58.766 --> 00:17:00.566 A:middle
application, which represents

00:17:00.786 --> 00:17:02.036 A:middle
three different spaces in the

00:17:02.036 --> 00:17:03.946 A:middle
system that my application is

00:17:03.946 --> 00:17:04.945 A:middle
showing its interface.

00:17:05.986 --> 00:17:07.556 A:middle
And right now, they're

00:17:07.556 --> 00:17:08.266 A:middle
disconnected.

00:17:08.266 --> 00:17:09.396 A:middle
They're below that background

00:17:09.396 --> 00:17:09.606 A:middle
line.

00:17:10.156 --> 00:17:12.536 A:middle
So, my application just reports

00:17:12.536 --> 00:17:13.756 A:middle
that its application state is

00:17:14.175 --> 00:17:15.195 A:middle
background.

00:17:15.746 --> 00:17:17.536 A:middle
Now, if I should activate one of

00:17:17.536 --> 00:17:19.116 A:middle
the spaces that my session is

00:17:19.116 --> 00:17:23.826 A:middle
on, the application state will

00:17:23.826 --> 00:17:25.836 A:middle
go up and go all the way up to

00:17:25.836 --> 00:17:27.326 A:middle
foreground active along with

00:17:27.326 --> 00:17:28.226 A:middle
that connected scene.

00:17:29.596 --> 00:17:30.776 A:middle
When I send that scene back to

00:17:30.776 --> 00:17:33.386 A:middle
the background, the application

00:17:33.386 --> 00:17:35.466 A:middle
state descends down with that

00:17:35.466 --> 00:17:35.706 A:middle
scene.

00:17:37.006 --> 00:17:38.966 A:middle
If I were to switch to any of

00:17:38.966 --> 00:17:40.916 A:middle
the other two sessions, then my

00:17:40.916 --> 00:17:42.586 A:middle
application state would remain

00:17:43.016 --> 00:17:44.666 A:middle
at the foreground active state

00:17:44.896 --> 00:17:45.966 A:middle
to represent the fact that the

00:17:45.966 --> 00:17:47.506 A:middle
overall state of the application

00:17:47.506 --> 00:17:47.946 A:middle
hasn't changed.

00:17:52.416 --> 00:17:53.546 A:middle
When it comes to your

00:17:53.546 --> 00:17:54.896 A:middle
application class and your

00:17:54.896 --> 00:17:56.936 A:middle
application delegate class, we

00:17:57.306 --> 00:17:59.626 A:middle
used to put the combination of

00:17:59.716 --> 00:18:00.976 A:middle
the interface with the rest of

00:17:59.716 --> 00:18:00.976 A:middle
the interface with the rest of

00:18:00.976 --> 00:18:03.646 A:middle
the system, and the lifecycle in

00:18:03.646 --> 00:18:04.906 A:middle
that ApplicationDelegate and

00:18:04.906 --> 00:18:05.906 A:middle
Application object.

00:18:06.426 --> 00:18:07.506 A:middle
This doesn't really work too

00:18:07.506 --> 00:18:08.176 A:middle
well anymore.

00:18:09.336 --> 00:18:10.916 A:middle
So, we split it up.

00:18:10.916 --> 00:18:13.736 A:middle
We have your application which

00:18:13.736 --> 00:18:15.256 A:middle
still represents the state of

00:18:15.316 --> 00:18:17.646 A:middle
the system as a system process,

00:18:17.646 --> 00:18:19.756 A:middle
and the ApplicationDelegate

00:18:19.756 --> 00:18:21.896 A:middle
which gets events and delegate

00:18:21.896 --> 00:18:24.016 A:middle
notifications about processes,

00:18:24.356 --> 00:18:27.196 A:middle
things, and launching and

00:18:27.196 --> 00:18:28.896 A:middle
terminating the app as a

00:18:29.406 --> 00:18:29.946 A:middle
process.

00:18:30.476 --> 00:18:32.126 A:middle
But now your scene actually

00:18:32.126 --> 00:18:33.486 A:middle
encapsulates the UI state and

00:18:33.486 --> 00:18:34.096 A:middle
full.

00:18:34.576 --> 00:18:35.766 A:middle
Any questions you have about the

00:18:35.766 --> 00:18:37.816 A:middle
status bar, you ask those to the

00:18:37.816 --> 00:18:38.326 A:middle
scene now.

00:18:39.446 --> 00:18:41.616 A:middle
And your SceneDelegate gets

00:18:41.616 --> 00:18:44.416 A:middle
informed about opening up URLs

00:18:44.416 --> 00:18:46.706 A:middle
in a particular context,

00:18:47.616 --> 00:18:49.236 A:middle
returning from the background,

00:18:49.366 --> 00:18:50.716 A:middle
going to foreground, et cetera.

00:18:50.796 --> 00:18:51.996 A:middle
And of course, you have

00:18:51.996 --> 00:18:53.256 A:middle
SceneSession which represents

00:18:53.256 --> 00:18:54.546 A:middle
that persisted UI state.

00:18:55.926 --> 00:18:57.846 A:middle
Now, you might think that this

00:18:57.846 --> 00:18:59.436 A:middle
is a lot of complicated API.

00:19:00.816 --> 00:19:02.816 A:middle
So, if you have code like this

00:19:02.816 --> 00:19:04.126 A:middle
in your application right now,

00:19:04.706 --> 00:19:05.416 A:middle
you're going have to make a

00:19:05.416 --> 00:19:07.446 A:middle
really big change and move your

00:19:07.446 --> 00:19:08.866 A:middle
implementation of these methods

00:19:10.026 --> 00:19:10.986 A:middle
into these methods.

00:19:12.386 --> 00:19:15.336 A:middle
For the most part, we've kept it

00:19:15.336 --> 00:19:16.486 A:middle
as similar as we could.

00:19:16.806 --> 00:19:18.716 A:middle
Application didn't finish

00:19:18.716 --> 00:19:21.236 A:middle
launching, becomes willConnectTo

00:19:21.236 --> 00:19:21.616 A:middle
session.

00:19:22.926 --> 00:19:24.816 A:middle
EnterForeground is enter

00:19:24.816 --> 00:19:25.286 A:middle
foreground.

00:19:25.286 --> 00:19:26.646 A:middle
It's just on the scene now

00:19:26.646 --> 00:19:28.846 A:middle
instead of the application, and

00:19:28.846 --> 00:19:30.206 A:middle
so on.

00:19:31.826 --> 00:19:34.736 A:middle
Now, there is a hitch here with

00:19:34.736 --> 00:19:35.446 A:middle
state restoration.

00:19:35.856 --> 00:19:36.836 A:middle
It's going to be really

00:19:36.836 --> 00:19:37.296 A:middle
important.

00:19:37.916 --> 00:19:41.066 A:middle
So, your users can look at the

00:19:41.066 --> 00:19:42.826 A:middle
state of the switcher, go to a

00:19:42.826 --> 00:19:45.636 A:middle
particular space, and then have

00:19:45.636 --> 00:19:46.876 A:middle
their information come back

00:19:47.006 --> 00:19:48.306 A:middle
exactly as they left it.

00:19:49.726 --> 00:19:52.096 A:middle
So to help you with that, we've

00:19:52.096 --> 00:19:54.856 A:middle
borrowed a little bit of API

00:19:55.116 --> 00:19:56.076 A:middle
from the Handoff.

00:19:57.096 --> 00:19:58.636 A:middle
And we represent

00:19:58.636 --> 00:19:59.856 A:middle
stateRestoration as an

00:19:59.856 --> 00:20:00.876 A:middle
NSUserActivity now.

00:19:59.856 --> 00:20:00.876 A:middle
NSUserActivity now.

00:20:01.866 --> 00:20:02.996 A:middle
You can put whatever information

00:20:02.996 --> 00:20:03.436 A:middle
you wanted.

00:20:04.546 --> 00:20:06.376 A:middle
And at various points in the

00:20:06.376 --> 00:20:08.356 A:middle
lifecycle, you like, it will

00:20:08.356 --> 00:20:11.316 A:middle
request that user activity from

00:20:11.316 --> 00:20:12.386 A:middle
the SceneDelegate.

00:20:12.616 --> 00:20:15.186 A:middle
And then, when you're seeing

00:20:15.186 --> 00:20:16.796 A:middle
restores, will pass it right

00:20:16.796 --> 00:20:19.236 A:middle
back in as the connection

00:20:19.936 --> 00:20:22.246 A:middle
delegate callback.

00:20:22.246 --> 00:20:24.596 A:middle
And should no scene actually

00:20:24.596 --> 00:20:26.626 A:middle
exist for that particular

00:20:26.626 --> 00:20:28.616 A:middle
session, you can access the

00:20:28.616 --> 00:20:29.806 A:middle
stateRestorationActivity

00:20:29.806 --> 00:20:32.586 A:middle
directly on the session so that

00:20:32.586 --> 00:20:33.876 A:middle
should you do a background fetch

00:20:33.876 --> 00:20:35.456 A:middle
and need to update a particular

00:20:35.456 --> 00:20:37.366 A:middle
one, you can go and find which

00:20:37.366 --> 00:20:38.596 A:middle
one you'd change data for.

00:20:38.836 --> 00:20:43.076 A:middle
So, I'm going to give you a

00:20:43.076 --> 00:20:46.126 A:middle
quick demo to show you what it's

00:20:46.126 --> 00:20:47.836 A:middle
like to adopt this new API in

00:20:48.396 --> 00:20:49.296 A:middle
your application.

00:20:56.326 --> 00:21:00.356 A:middle
So, I have an application here

00:20:56.326 --> 00:21:00.356 A:middle
So, I have an application here

00:21:00.356 --> 00:21:02.486 A:middle
and it was authored by a good

00:21:02.486 --> 00:21:03.526 A:middle
friend of mine and colleague on

00:21:03.526 --> 00:21:05.386 A:middle
my team, John Ham.

00:21:05.386 --> 00:21:09.186 A:middle
And he wrote what is, to me, one

00:21:09.186 --> 00:21:10.566 A:middle
of my favorite apps ever.

00:21:11.236 --> 00:21:12.326 A:middle
You'll see it in just a second

00:21:12.326 --> 00:21:13.706 A:middle
when the simulator comes up, but

00:21:14.066 --> 00:21:16.916 A:middle
it's fantastic.

00:21:16.916 --> 00:21:19.586 A:middle
What you'll see when this boots

00:21:19.626 --> 00:21:22.816 A:middle
is a fantastic gallery app that

00:21:22.816 --> 00:21:25.506 A:middle
exercises all of collection view

00:21:25.506 --> 00:21:26.036 A:middle
flow layout.

00:21:27.866 --> 00:21:29.596 A:middle
But it's going to show a really

00:21:29.596 --> 00:21:30.286 A:middle
important point.

00:21:30.286 --> 00:21:32.386 A:middle
It's a nice charming

00:21:32.386 --> 00:21:33.036 A:middle
application.

00:21:33.646 --> 00:21:36.346 A:middle
And we're going to go from

00:21:36.346 --> 00:21:39.586 A:middle
having just a single instance of

00:21:39.586 --> 00:21:42.056 A:middle
it and bring multiple windows.

00:21:43.976 --> 00:21:45.716 A:middle
Because when I use this

00:21:45.716 --> 00:21:49.266 A:middle
application, I really want to be

00:21:49.266 --> 00:21:51.256 A:middle
able to see more than one photo

00:21:51.256 --> 00:21:51.706 A:middle
at a time.

00:21:51.826 --> 00:21:55.146 A:middle
So we're just going to wait a

00:21:55.146 --> 00:21:55.836 A:middle
little bit more for the

00:21:55.836 --> 00:21:56.766 A:middle
simulator to boot up here.

00:21:56.766 --> 00:21:58.286 A:middle
And here we go.

00:21:58.976 --> 00:22:03.936 A:middle
[Applause] We can launch apps.

00:21:58.976 --> 00:22:03.936 A:middle
[Applause] We can launch apps.

00:22:05.096 --> 00:22:06.486 A:middle
As you can see, it is a

00:22:06.486 --> 00:22:07.816 A:middle
marvelous application.

00:22:08.316 --> 00:22:10.476 A:middle
And I can step in and view any

00:22:10.476 --> 00:22:13.836 A:middle
of these photos and pop back

00:22:13.836 --> 00:22:13.916 A:middle
out.

00:22:14.326 --> 00:22:17.296 A:middle
Now, I can bring it up, and if I

00:22:17.296 --> 00:22:18.536 A:middle
try to go into App Expose, I

00:22:18.536 --> 00:22:19.346 A:middle
can't right here.

00:22:19.796 --> 00:22:20.696 A:middle
And that's because this

00:22:20.696 --> 00:22:21.556 A:middle
application doesn't have

00:22:21.556 --> 00:22:22.256 A:middle
multi-window.

00:22:23.776 --> 00:22:25.736 A:middle
So, the first step to

00:22:25.736 --> 00:22:29.876 A:middle
implementing this is to go into

00:22:29.876 --> 00:22:30.356 A:middle
Xcode.

00:22:30.786 --> 00:22:33.686 A:middle
Right here in the General tab,

00:22:33.686 --> 00:22:36.546 A:middle
we have this nice new checkbox

00:22:36.546 --> 00:22:37.496 A:middle
labeled Supports multiple

00:22:37.496 --> 00:22:38.036 A:middle
windows.

00:22:38.036 --> 00:22:40.176 A:middle
You can take a guess what

00:22:40.176 --> 00:22:41.286 A:middle
happens when I check this.

00:22:42.126 --> 00:22:45.216 A:middle
We make a little edit in our

00:22:45.216 --> 00:22:48.036 A:middle
info.plist, and if we jump to

00:22:48.036 --> 00:22:50.976 A:middle
it, we can see that we have this

00:22:50.976 --> 00:22:52.696 A:middle
new entry here called the

00:22:52.696 --> 00:22:55.066 A:middle
Application Scene Manifest.

00:22:55.066 --> 00:22:57.506 A:middle
This tells the system that the

00:22:57.506 --> 00:23:00.256 A:middle
application supports the new

00:22:57.506 --> 00:23:00.256 A:middle
application supports the new

00:23:00.256 --> 00:23:03.296 A:middle
lifecycle interfaces, and we can

00:23:03.296 --> 00:23:06.596 A:middle
declare statically what

00:23:06.596 --> 00:23:07.886 A:middle
interfaces for which type of

00:23:07.886 --> 00:23:09.326 A:middle
roles we want to use.

00:23:10.096 --> 00:23:12.906 A:middle
Now in this case, I've prebaked

00:23:12.906 --> 00:23:14.986 A:middle
a info.plist entry for you.

00:23:15.046 --> 00:23:15.846 A:middle
So we're going to get rid of

00:23:15.846 --> 00:23:17.006 A:middle
that.

00:23:17.376 --> 00:23:23.986 A:middle
And now we have this right here.

00:23:24.316 --> 00:23:26.716 A:middle
So, we've made this and this has

00:23:26.716 --> 00:23:28.136 A:middle
already moved over our existing

00:23:28.136 --> 00:23:28.766 A:middle
storyboard.

00:23:29.196 --> 00:23:32.496 A:middle
And we've had a very, very basic

00:23:32.496 --> 00:23:34.456 A:middle
SceneDelegate class that we have

00:23:34.456 --> 00:23:34.946 A:middle
right here.

00:23:34.946 --> 00:23:36.866 A:middle
And all this does is declare

00:23:36.956 --> 00:23:38.856 A:middle
just a window, a really, really

00:23:38.856 --> 00:23:40.846 A:middle
basic template class.

00:23:41.456 --> 00:23:42.496 A:middle
We build and run.

00:23:49.036 --> 00:23:50.456 A:middle
And we're right back where we

00:23:50.456 --> 00:23:52.786 A:middle
started, which is good.

00:23:52.786 --> 00:23:55.506 A:middle
But now --

00:24:02.616 --> 00:24:04.226 A:middle
So if I could access the icon in

00:24:04.226 --> 00:24:05.316 A:middle
the dock, I will be able to drag

00:24:05.316 --> 00:24:06.846 A:middle
it up and move it over to the

00:24:06.846 --> 00:24:08.886 A:middle
side of the iPad interface and

00:24:08.886 --> 00:24:10.436 A:middle
create a new window, which is

00:24:10.436 --> 00:24:11.676 A:middle
what that info.plist allows us

00:24:11.816 --> 00:24:12.286 A:middle
to do.

00:24:13.216 --> 00:24:16.256 A:middle
But unfortunately, if I were to

00:24:16.256 --> 00:24:18.366 A:middle
go back to the home screen, let

00:24:19.436 --> 00:24:21.966 A:middle
the application terminate, and

00:24:21.966 --> 00:24:26.866 A:middle
then launch it again, we don't

00:24:26.866 --> 00:24:28.316 A:middle
quite get the same level of

00:24:28.316 --> 00:24:29.736 A:middle
state restoration we did do

00:24:29.736 --> 00:24:31.406 A:middle
before as you can see right

00:24:31.436 --> 00:24:31.976 A:middle
here.

00:24:37.236 --> 00:24:40.556 A:middle
So to get that back, we need to

00:24:40.556 --> 00:24:42.826 A:middle
implement a few things, which is

00:24:42.826 --> 00:24:42.996 A:middle
OK.

00:24:42.996 --> 00:24:46.146 A:middle
Now, like I said, to implement

00:24:46.146 --> 00:24:48.776 A:middle
stateRestoration here, we need

00:24:48.856 --> 00:24:50.566 A:middle
to take our existing

00:24:51.076 --> 00:24:52.996 A:middle
stateRestorationActivity that we

00:24:52.996 --> 00:24:53.426 A:middle
have.

00:24:53.616 --> 00:24:56.336 A:middle
Windows return it from the new

00:24:56.526 --> 00:24:58.746 A:middle
stateRestorationActivity for

00:24:58.746 --> 00:25:00.576 A:middle
scene, delegate call.

00:24:58.746 --> 00:25:00.576 A:middle
scene, delegate call.

00:25:00.746 --> 00:25:03.936 A:middle
And way deep in the

00:25:03.936 --> 00:25:06.306 A:middle
implementation here, we've been

00:25:06.306 --> 00:25:07.546 A:middle
setting it on the application

00:25:07.546 --> 00:25:09.336 A:middle
instance, which is not really

00:25:09.336 --> 00:25:10.186 A:middle
what we want anymore.

00:25:13.996 --> 00:25:16.866 A:middle
We want to set it on to local

00:25:17.106 --> 00:25:19.206 A:middle
windows scene like so.

00:25:19.206 --> 00:25:24.086 A:middle
And then clear it out where we

00:25:24.086 --> 00:25:25.256 A:middle
cleared it out before.

00:25:26.516 --> 00:25:29.306 A:middle
So now, we're returning our user

00:25:29.306 --> 00:25:30.206 A:middle
activity so we can do

00:25:30.206 --> 00:25:30.926 A:middle
stateRestoration.

00:25:32.136 --> 00:25:33.686 A:middle
Let's try it.

00:25:36.256 --> 00:25:38.146 A:middle
So what you'll notice here is

00:25:38.146 --> 00:25:39.596 A:middle
that we're not quite done

00:25:39.646 --> 00:25:40.586 A:middle
implementing the

00:25:40.586 --> 00:25:42.346 A:middle
stateRestoration just yet.

00:25:42.536 --> 00:25:44.426 A:middle
We need to do one more thing

00:25:44.426 --> 00:25:45.366 A:middle
when our scene connects.

00:25:51.196 --> 00:25:52.526 A:middle
When the scene connects to the

00:25:52.526 --> 00:25:54.946 A:middle
SceneSession, we get options and

00:25:54.946 --> 00:25:56.076 A:middle
we get the session reference.

00:25:56.546 --> 00:25:58.106 A:middle
Now, in this template that I

00:25:58.106 --> 00:25:59.526 A:middle
pulled out, we're already

00:25:59.526 --> 00:26:01.596 A:middle
looking for any user activities

00:25:59.526 --> 00:26:01.596 A:middle
looking for any user activities

00:26:01.596 --> 00:26:03.246 A:middle
that we have gotten through

00:26:03.246 --> 00:26:04.696 A:middle
Handoff or any other system

00:26:04.696 --> 00:26:05.946 A:middle
facilities that vend us user

00:26:05.946 --> 00:26:06.446 A:middle
activities.

00:26:06.806 --> 00:26:10.056 A:middle
We want to prefer those user

00:26:10.056 --> 00:26:11.536 A:middle
activities because that's what

00:26:11.536 --> 00:26:13.096 A:middle
the user actually did.

00:26:13.966 --> 00:26:21.166 A:middle
But the stateRestorationActivity

00:26:21.476 --> 00:26:22.496 A:middle
is special and it's on the

00:26:22.496 --> 00:26:22.896 A:middle
session.

00:26:23.296 --> 00:26:24.246 A:middle
So if you don't have one of

00:26:24.246 --> 00:26:26.036 A:middle
those activities, we want to use

00:26:26.036 --> 00:26:27.206 A:middle
our stateRestorationActivity.

00:26:28.146 --> 00:26:31.196 A:middle
So now, when we build and run,

00:26:32.436 --> 00:26:34.096 A:middle
we restore back when the

00:26:34.096 --> 00:26:35.446 A:middle
application is relaunched.

00:26:37.906 --> 00:26:40.626 A:middle
So that's how you adopt multiple

00:26:40.626 --> 00:26:42.476 A:middle
windows in your application.

00:26:42.756 --> 00:26:43.796 A:middle
It's pretty straightforward.

00:26:43.796 --> 00:26:44.836 A:middle
You can use most of your

00:26:44.836 --> 00:26:46.156 A:middle
existing application delegate

00:26:46.156 --> 00:26:47.596 A:middle
logic and just move it to the

00:26:47.596 --> 00:26:50.706 A:middle
scene, and it will run there.

00:26:51.446 --> 00:26:54.406 A:middle
Now, as Ken mentioned, the

00:26:54.736 --> 00:26:57.106 A:middle
preferred way of interfacing

00:26:57.106 --> 00:26:58.586 A:middle
with these drag and drop items

00:26:59.266 --> 00:27:02.046 A:middle
is with drag and drop.

00:26:59.266 --> 00:27:02.046 A:middle
is with drag and drop.

00:27:02.226 --> 00:27:05.036 A:middle
And there are a couple of ways

00:27:05.036 --> 00:27:06.886 A:middle
we can achieve this if you use

00:27:06.886 --> 00:27:09.896 A:middle
existing universal links or

00:27:09.896 --> 00:27:12.046 A:middle
references to file URLs that

00:27:12.046 --> 00:27:13.236 A:middle
your application declares its

00:27:13.236 --> 00:27:15.126 A:middle
own in info.plist, those will

00:27:15.126 --> 00:27:15.536 A:middle
just work.

00:27:15.536 --> 00:27:17.436 A:middle
But if you want to do something

00:27:17.436 --> 00:27:20.476 A:middle
more custom, once again, you can

00:27:20.476 --> 00:27:21.726 A:middle
use NSUserActivity.

00:27:22.396 --> 00:27:23.756 A:middle
You can include that in your

00:27:23.756 --> 00:27:25.026 A:middle
existing DragItem's

00:27:25.026 --> 00:27:26.986 A:middle
NSItemProvider as a different

00:27:26.986 --> 00:27:28.066 A:middle
object representation.

00:27:29.176 --> 00:27:30.456 A:middle
When you drag it off to the rest

00:27:30.456 --> 00:27:32.306 A:middle
of the system, you'll get hit

00:27:32.306 --> 00:27:34.256 A:middle
targets and drop points at

00:27:34.406 --> 00:27:36.006 A:middle
system defined locations just

00:27:36.006 --> 00:27:38.276 A:middle
like any other app icon drag.

00:27:39.856 --> 00:27:42.506 A:middle
And now to talk about the next

00:27:42.506 --> 00:27:44.046 A:middle
steps is my colleague James.

00:27:45.976 --> 00:27:46.596 A:middle
Thank you.

00:27:47.516 --> 00:27:51.996 A:middle
[ Applause ]

00:27:52.496 --> 00:27:52.936 A:middle
&gt;&gt; Thanks, Steve.

00:27:53.396 --> 00:27:57.516 A:middle
So to wrap up this talk, I have

00:27:57.516 --> 00:27:58.996 A:middle
just three more things to talk

00:27:58.996 --> 00:27:59.336 A:middle
about.

00:27:59.966 --> 00:28:01.366 A:middle
The first is going to be a

00:27:59.966 --> 00:28:01.366 A:middle
The first is going to be a

00:28:01.366 --> 00:28:02.166 A:middle
deeper look at the

00:28:02.166 --> 00:28:03.846 A:middle
UISceneSession API.

00:28:04.946 --> 00:28:06.306 A:middle
Next, we're going to cover some

00:28:06.306 --> 00:28:08.356 A:middle
case studies about common issues

00:28:08.356 --> 00:28:09.836 A:middle
that we think you might see when

00:28:09.836 --> 00:28:11.016 A:middle
you start duplicating your

00:28:11.016 --> 00:28:12.266 A:middle
application's interface.

00:28:13.096 --> 00:28:14.726 A:middle
And lastly, I just want to talk

00:28:14.726 --> 00:28:15.776 A:middle
briefly about some of the

00:28:15.776 --> 00:28:17.526 A:middle
deprecations that we've added to

00:28:17.526 --> 00:28:19.416 A:middle
UI application to support this

00:28:19.416 --> 00:28:20.226 A:middle
new lifecycle.

00:28:20.896 --> 00:28:22.846 A:middle
So let's get started by going

00:28:22.846 --> 00:28:24.426 A:middle
over what a scene session is.

00:28:26.286 --> 00:28:27.706 A:middle
Going back to this diagram from

00:28:27.706 --> 00:28:29.686 A:middle
earlier, you can see in the App

00:28:29.686 --> 00:28:31.806 A:middle
Switcher, we have four windows

00:28:31.996 --> 00:28:32.856 A:middle
of our application.

00:28:33.096 --> 00:28:34.226 A:middle
And that is how the user will

00:28:34.226 --> 00:28:35.396 A:middle
think about this, as four

00:28:35.396 --> 00:28:35.886 A:middle
windows.

00:28:36.146 --> 00:28:37.806 A:middle
But I want to encourage you as

00:28:37.806 --> 00:28:39.486 A:middle
developers to think about these

00:28:39.586 --> 00:28:41.456 A:middle
as scenes and scene sessions.

00:28:41.846 --> 00:28:43.426 A:middle
And that distinction is

00:28:43.426 --> 00:28:45.506 A:middle
important because while the

00:28:45.506 --> 00:28:47.016 A:middle
windows that the user sees in

00:28:47.016 --> 00:28:48.826 A:middle
the App Switchers will always be

00:28:48.826 --> 00:28:50.736 A:middle
there as snapshots, the scenes

00:28:50.736 --> 00:28:52.716 A:middle
themselves may not be loaded in

00:28:52.716 --> 00:28:53.556 A:middle
your application.

00:28:54.536 --> 00:28:58.166 A:middle
They can come and go as needed,

00:28:58.656 --> 00:29:00.036 A:middle
but the sessions will always be

00:28:58.656 --> 00:29:00.036 A:middle
but the sessions will always be

00:29:00.036 --> 00:29:00.796 A:middle
available to you.

00:29:01.156 --> 00:29:02.946 A:middle
And because of this, we use the

00:29:02.946 --> 00:29:05.116 A:middle
session for programmatic control

00:29:05.116 --> 00:29:06.196 A:middle
over the windows.

00:29:06.576 --> 00:29:09.156 A:middle
So I think these are some of the

00:29:09.156 --> 00:29:10.516 A:middle
most exciting API that we're

00:29:10.516 --> 00:29:11.996 A:middle
adding to multitasking this year

00:29:12.376 --> 00:29:14.136 A:middle
because they allow you to create

00:29:14.136 --> 00:29:15.536 A:middle
new windows programmatically,

00:29:16.126 --> 00:29:18.136 A:middle
update the snapshots in the App

00:29:18.136 --> 00:29:20.356 A:middle
Switcher, and close them on

00:29:20.356 --> 00:29:21.616 A:middle
response to things like a user

00:29:21.616 --> 00:29:23.436 A:middle
gesture, or if the document that

00:29:23.436 --> 00:29:24.616 A:middle
they represent has expired in

00:29:24.616 --> 00:29:25.056 A:middle
some way.

00:29:25.556 --> 00:29:27.676 A:middle
So to go over when and how you

00:29:27.676 --> 00:29:29.336 A:middle
would use these, let's look at

00:29:29.336 --> 00:29:30.016 A:middle
some sample code.

00:29:30.016 --> 00:29:32.486 A:middle
The first of these is the

00:29:32.546 --> 00:29:34.616 A:middle
requestSceneSessionActivation

00:29:34.616 --> 00:29:34.926 A:middle
API.

00:29:35.756 --> 00:29:37.296 A:middle
And what this lets you do is

00:29:37.396 --> 00:29:39.416 A:middle
bring forward either an existing

00:29:39.416 --> 00:29:40.306 A:middle
or a new scene of your

00:29:40.306 --> 00:29:40.936 A:middle
application.

00:29:41.836 --> 00:29:43.116 A:middle
In this example, I'm trying to

00:29:43.116 --> 00:29:43.946 A:middle
open a document.

00:29:44.416 --> 00:29:45.536 A:middle
And I first check if the

00:29:45.536 --> 00:29:47.436 A:middle
document has an existing scene

00:29:47.576 --> 00:29:48.716 A:middle
somewhere in my application.

00:29:48.866 --> 00:29:50.616 A:middle
And if it does, I pass it to

00:29:50.616 --> 00:29:52.116 A:middle
this API and it will be brought

00:29:52.116 --> 00:29:52.586 A:middle
forward.

00:29:52.826 --> 00:29:54.556 A:middle
But if this document isn't open

00:29:54.556 --> 00:29:56.216 A:middle
yet, I can create an

00:29:56.216 --> 00:29:58.116 A:middle
NSUserActivity that references

00:29:58.116 --> 00:29:59.646 A:middle
the context I need to open it

00:29:59.646 --> 00:30:01.726 A:middle
later and pass nil to create a

00:29:59.646 --> 00:30:01.726 A:middle
later and pass nil to create a

00:30:01.726 --> 00:30:01.976 A:middle
new scene.

00:30:06.196 --> 00:30:06.766 A:middle
Next is the

00:30:06.766 --> 00:30:08.716 A:middle
requestSceneSessionRefresh API.

00:30:08.716 --> 00:30:10.706 A:middle
You'd want to use this in the

00:30:10.706 --> 00:30:12.486 A:middle
context where you may be

00:30:12.486 --> 00:30:14.006 A:middle
received a push notification

00:30:14.006 --> 00:30:16.616 A:middle
about a new message or in an app

00:30:16.616 --> 00:30:18.326 A:middle
like Calendar when an event has

00:30:18.326 --> 00:30:18.836 A:middle
changed.

00:30:19.476 --> 00:30:21.226 A:middle
When you call this method, UIKit

00:30:21.226 --> 00:30:22.796 A:middle
will schedule an update at some

00:30:22.796 --> 00:30:24.216 A:middle
point in the future where it

00:30:24.216 --> 00:30:25.436 A:middle
will connect your scene in the

00:30:25.436 --> 00:30:26.086 A:middle
background.

00:30:26.556 --> 00:30:27.546 A:middle
You'll have a chance to update

00:30:27.546 --> 00:30:29.366 A:middle
the UI, a new snapshot will be

00:30:29.366 --> 00:30:31.416 A:middle
taken, and then that will be

00:30:31.416 --> 00:30:32.996 A:middle
saved into the App Switcher for

00:30:32.996 --> 00:30:33.326 A:middle
later.

00:30:33.966 --> 00:30:35.256 A:middle
You can also use this to update

00:30:35.256 --> 00:30:36.436 A:middle
the stateRestoration user

00:30:36.436 --> 00:30:38.346 A:middle
activity that Steve talked

00:30:40.036 --> 00:30:40.366 A:middle
about.

00:30:40.576 --> 00:30:41.586 A:middle
Lastly, is the

00:30:41.586 --> 00:30:43.226 A:middle
requestSceneSessionDestruction

00:30:43.226 --> 00:30:45.276 A:middle
API, which you can use to close

00:30:45.276 --> 00:30:45.686 A:middle
a scene.

00:30:46.606 --> 00:30:47.786 A:middle
What's really cool about this is

00:30:47.786 --> 00:30:48.846 A:middle
that it also comes with the

00:30:48.846 --> 00:30:50.656 A:middle
scene -- this options object

00:30:50.876 --> 00:30:52.336 A:middle
that lets you pick a semantic

00:30:52.336 --> 00:30:54.286 A:middle
animation for how the scene

00:30:54.286 --> 00:30:55.076 A:middle
should be closed.

00:30:55.966 --> 00:30:57.026 A:middle
You can see this in Mail with

00:30:57.026 --> 00:30:57.976 A:middle
the Compose window.

00:30:58.396 --> 00:30:59.796 A:middle
When the user sends a message,

00:31:00.096 --> 00:31:01.426 A:middle
the sheet animates up off

00:31:01.426 --> 00:31:01.856 A:middle
screen.

00:31:02.156 --> 00:31:03.366 A:middle
And if the user saves it as a

00:31:03.366 --> 00:31:05.256 A:middle
draft, it'll slide down to

00:31:05.256 --> 00:31:06.336 A:middle
remind them that it's been saved

00:31:06.336 --> 00:31:06.796 A:middle
for later.

00:31:07.916 --> 00:31:08.746 A:middle
You can use these same

00:31:08.746 --> 00:31:10.056 A:middle
animations with your scenes and

00:31:10.056 --> 00:31:12.416 A:middle
your apps.

00:31:12.776 --> 00:31:14.896 A:middle
Now, window management isn't all

00:31:14.896 --> 00:31:16.116 A:middle
that the session can do.

00:31:16.716 --> 00:31:17.736 A:middle
We've also added state

00:31:17.736 --> 00:31:19.516 A:middle
restoration to it, as shown with

00:31:19.516 --> 00:31:20.626 A:middle
the NSUserActivity for

00:31:20.626 --> 00:31:21.496 A:middle
stateRestoration.

00:31:22.266 --> 00:31:23.636 A:middle
We think for lots of apps, this

00:31:23.636 --> 00:31:24.936 A:middle
is going to be a really simple

00:31:24.936 --> 00:31:26.406 A:middle
and easy way to start saving

00:31:26.406 --> 00:31:27.906 A:middle
your state, especially if you've

00:31:27.906 --> 00:31:29.636 A:middle
already invested in technologies

00:31:29.716 --> 00:31:30.466 A:middle
like Handoff.

00:31:31.486 --> 00:31:33.306 A:middle
But we also realize that many of

00:31:33.306 --> 00:31:34.566 A:middle
you have apps with existing

00:31:34.566 --> 00:31:35.946 A:middle
state restoration logic and

00:31:35.946 --> 00:31:37.476 A:middle
maybe you don't want to work to

00:31:37.476 --> 00:31:38.096 A:middle
integrate it with

00:31:38.126 --> 00:31:39.026 A:middle
NSUserActivity.

00:31:39.246 --> 00:31:40.776 A:middle
And for that, we have a

00:31:40.776 --> 00:31:42.446 A:middle
persistentIdentifier property.

00:31:42.896 --> 00:31:45.416 A:middle
Now, all this is is a string

00:31:45.416 --> 00:31:46.756 A:middle
that is generated by the system.

00:31:47.406 --> 00:31:48.416 A:middle
You can feel free to write it

00:31:48.416 --> 00:31:50.706 A:middle
down into any databases or any

00:31:50.706 --> 00:31:52.096 A:middle
files in your apps container

00:31:52.096 --> 00:31:53.306 A:middle
that you use for state

00:31:53.306 --> 00:31:53.916 A:middle
restoration.

00:31:54.536 --> 00:31:55.726 A:middle
And it will be the same

00:31:55.726 --> 00:31:57.546 A:middle
identifier for the same scene

00:31:57.846 --> 00:31:59.236 A:middle
every time your app is launched,

00:31:59.376 --> 00:32:01.046 A:middle
even across backups and restores

00:31:59.376 --> 00:32:01.046 A:middle
even across backups and restores

00:32:01.046 --> 00:32:01.776 A:middle
of devices.

00:32:04.026 --> 00:32:05.736 A:middle
Lastly, there's a userInfo

00:32:05.736 --> 00:32:07.136 A:middle
dictionary, which is great for

00:32:07.136 --> 00:32:08.646 A:middle
storing small amounts of data,

00:32:08.916 --> 00:32:10.536 A:middle
such as per scene

00:32:10.596 --> 00:32:11.526 A:middle
customizations.

00:32:12.156 --> 00:32:13.356 A:middle
You might use this for something

00:32:13.356 --> 00:32:14.786 A:middle
like whether a sidebar is being

00:32:14.786 --> 00:32:17.046 A:middle
shown, or the last used color at

00:32:17.046 --> 00:32:17.696 A:middle
an ink picker.

00:32:18.366 --> 00:32:19.496 A:middle
Really a great way to find

00:32:19.496 --> 00:32:20.666 A:middle
things to put in this might be

00:32:20.666 --> 00:32:21.926 A:middle
to go over data that you're

00:32:21.956 --> 00:32:23.436 A:middle
already storing in your user

00:32:23.436 --> 00:32:25.146 A:middle
defaults, because some of those

00:32:25.146 --> 00:32:26.446 A:middle
things you might not actually

00:32:26.446 --> 00:32:27.536 A:middle
want to be global to your whole

00:32:27.536 --> 00:32:27.746 A:middle
app.

00:32:30.226 --> 00:32:32.256 A:middle
So, that's the new API for

00:32:32.456 --> 00:32:33.446 A:middle
UISceneSession.

00:32:34.026 --> 00:32:35.186 A:middle
But next I want to talk about

00:32:35.186 --> 00:32:36.426 A:middle
what your next step should be

00:32:36.426 --> 00:32:37.986 A:middle
after you built and ran your app

00:32:38.206 --> 00:32:39.746 A:middle
with Xcode supporting multiple

00:32:39.746 --> 00:32:40.196 A:middle
scenes.

00:32:40.606 --> 00:32:41.676 A:middle
And that's of course debugging

00:32:41.886 --> 00:32:41.976 A:middle
it.

00:32:43.806 --> 00:32:46.146 A:middle
Now, there's lots of code in

00:32:46.146 --> 00:32:47.936 A:middle
your app that is very custom,

00:32:47.936 --> 00:32:49.776 A:middle
and we've done our best to make

00:32:49.776 --> 00:32:50.866 A:middle
the framework help you along the

00:32:50.866 --> 00:32:51.136 A:middle
way.

00:32:51.836 --> 00:32:53.676 A:middle
But we can't really predict if

00:32:53.676 --> 00:32:54.636 A:middle
there's any changes you'll need

00:32:54.636 --> 00:32:55.926 A:middle
to make or what they might be.

00:32:57.156 --> 00:32:58.846 A:middle
But we think that there probably

00:32:58.846 --> 00:32:59.176 A:middle
are.

00:32:59.176 --> 00:33:00.096 A:middle
And we do want you to think

00:32:59.176 --> 00:33:00.096 A:middle
And we do want you to think

00:33:00.096 --> 00:33:00.896 A:middle
about the code that you've

00:33:00.896 --> 00:33:02.786 A:middle
written in the past.

00:33:02.786 --> 00:33:04.716 A:middle
Adopting this new lifecycle and

00:33:04.716 --> 00:33:06.166 A:middle
especially adopting multiple

00:33:06.166 --> 00:33:07.766 A:middle
scenes might have changed

00:33:07.766 --> 00:33:09.166 A:middle
assumptions that you made about

00:33:09.166 --> 00:33:10.706 A:middle
how your application functioned.

00:33:11.886 --> 00:33:13.146 A:middle
There's no longer just one

00:33:13.146 --> 00:33:14.516 A:middle
interface, and there might no

00:33:14.516 --> 00:33:16.136 A:middle
longer be just one instance of a

00:33:16.136 --> 00:33:16.836 A:middle
view controller.

00:33:17.416 --> 00:33:20.886 A:middle
Of course, if you have automated

00:33:20.886 --> 00:33:22.036 A:middle
test, that's great.

00:33:22.756 --> 00:33:23.956 A:middle
Those tests might continue to

00:33:23.956 --> 00:33:25.326 A:middle
pass though, even when your

00:33:25.326 --> 00:33:26.886 A:middle
users might see real bugs.

00:33:27.386 --> 00:33:28.496 A:middle
And that's again because of

00:33:28.496 --> 00:33:29.956 A:middle
these changes to the assumptions

00:33:29.956 --> 00:33:30.796 A:middle
that you might have made.

00:33:31.266 --> 00:33:32.336 A:middle
So the best way that you can

00:33:32.336 --> 00:33:33.856 A:middle
find these problems before your

00:33:33.856 --> 00:33:35.426 A:middle
customers do is just to play

00:33:35.426 --> 00:33:36.886 A:middle
with your app, play with it,

00:33:36.986 --> 00:33:38.546 A:middle
you're having two copies of it

00:33:38.546 --> 00:33:39.226 A:middle
out at once.

00:33:39.586 --> 00:33:40.786 A:middle
And it's a really great way to

00:33:40.916 --> 00:33:42.216 A:middle
very quickly see when something

00:33:42.216 --> 00:33:43.406 A:middle
doesn't quite line up like you

00:33:43.406 --> 00:33:45.126 A:middle
meant it to.

00:33:45.856 --> 00:33:47.146 A:middle
Now, I've prepared a couple of

00:33:47.146 --> 00:33:48.476 A:middle
case studies to highlight

00:33:49.126 --> 00:33:50.606 A:middle
prototypical bugs that you might

00:33:50.686 --> 00:33:50.966 A:middle
see.

00:33:51.756 --> 00:33:52.996 A:middle
But there's this common theme to

00:33:52.996 --> 00:33:55.056 A:middle
both of them, and the theme is

00:33:55.056 --> 00:33:57.066 A:middle
state, specifically, shared

00:33:57.066 --> 00:33:57.346 A:middle
state.

00:33:58.616 --> 00:33:59.736 A:middle
Now, I'm willing to bet that

00:33:59.736 --> 00:34:01.156 A:middle
almost all of you have used one

00:33:59.736 --> 00:34:01.156 A:middle
almost all of you have used one

00:34:01.156 --> 00:34:02.036 A:middle
of these classes in an

00:34:02.036 --> 00:34:03.436 A:middle
application before because

00:34:03.796 --> 00:34:05.036 A:middle
they're really common and really

00:34:05.036 --> 00:34:06.336 A:middle
useful Cocoa classes.

00:34:06.586 --> 00:34:08.126 A:middle
And they're also really

00:34:08.126 --> 00:34:09.266 A:middle
convenient because of that

00:34:09.266 --> 00:34:10.166 A:middle
singleton property.

00:34:10.815 --> 00:34:13.196 A:middle
You can go be in a model object

00:34:13.196 --> 00:34:14.686 A:middle
deep in your app and reach up to

00:34:14.686 --> 00:34:16.666 A:middle
the UI device singleton and read

00:34:16.666 --> 00:34:17.946 A:middle
off some configuration about

00:34:17.946 --> 00:34:18.835 A:middle
what kind of device you're

00:34:18.835 --> 00:34:19.826 A:middle
running on, and that's really

00:34:19.826 --> 00:34:20.376 A:middle
powerful.

00:34:21.216 --> 00:34:22.936 A:middle
But this pattern also can have

00:34:22.936 --> 00:34:23.505 A:middle
problems.

00:34:23.896 --> 00:34:25.326 A:middle
Because of that loose coupling

00:34:25.326 --> 00:34:27.315 A:middle
between layers and data, you can

00:34:27.315 --> 00:34:28.866 A:middle
kind of lose track of where data

00:34:28.866 --> 00:34:30.446 A:middle
is flowing in your application,

00:34:30.636 --> 00:34:32.005 A:middle
who is reading it and how.

00:34:32.606 --> 00:34:34.476 A:middle
But like I said, these are very,

00:34:34.476 --> 00:34:35.755 A:middle
very powerful patterns because

00:34:35.755 --> 00:34:36.626 A:middle
they're so convenient.

00:34:36.976 --> 00:34:38.536 A:middle
And in fact, I expect most of

00:34:38.536 --> 00:34:39.536 A:middle
you have written your own

00:34:39.536 --> 00:34:40.706 A:middle
singletons at some point.

00:34:41.606 --> 00:34:43.076 A:middle
You might be using something

00:34:43.076 --> 00:34:44.576 A:middle
that isn't quite a singleton

00:34:44.576 --> 00:34:47.235 A:middle
like a global variable, or maybe

00:34:47.235 --> 00:34:48.306 A:middle
you're piggybacking on an

00:34:48.306 --> 00:34:50.096 A:middle
existing singleton in the kit.

00:34:51.005 --> 00:34:52.966 A:middle
Or maybe you're using the file

00:34:52.966 --> 00:34:54.525 A:middle
system, which is itself just one

00:34:54.525 --> 00:34:56.416 A:middle
big vault of data that's shared

00:34:56.525 --> 00:34:58.116 A:middle
by your app.

00:34:58.116 --> 00:34:59.156 A:middle
Now, I'm not here to tell you

00:34:59.156 --> 00:35:00.226 A:middle
that you need to get rid of all

00:34:59.156 --> 00:35:00.226 A:middle
that you need to get rid of all

00:35:00.226 --> 00:35:01.466 A:middle
your singletons or that shared

00:35:01.466 --> 00:35:03.366 A:middle
state is bad, but I do want to

00:35:03.366 --> 00:35:05.006 A:middle
encourage you to think about how

00:35:05.006 --> 00:35:06.346 A:middle
you're sharing it, and whether

00:35:06.346 --> 00:35:07.436 A:middle
you should be sharing that.

00:35:08.106 --> 00:35:09.366 A:middle
There's lots of other advantages

00:35:09.366 --> 00:35:11.036 A:middle
to factoring your data out, such

00:35:11.036 --> 00:35:12.496 A:middle
as an easier time with unit

00:35:12.496 --> 00:35:12.856 A:middle
tests.

00:35:13.886 --> 00:35:16.136 A:middle
So let's get into those case

00:35:16.136 --> 00:35:16.456 A:middle
studies.

00:35:16.886 --> 00:35:18.696 A:middle
The first one rolls around a

00:35:18.786 --> 00:35:19.556 A:middle
state restoration.

00:35:20.726 --> 00:35:23.246 A:middle
And to work on it, I came up

00:35:23.246 --> 00:35:24.326 A:middle
with this sample app before the

00:35:24.326 --> 00:35:24.736 A:middle
talk.

00:35:25.416 --> 00:35:26.596 A:middle
Now, it's just a nice little

00:35:26.596 --> 00:35:27.656 A:middle
sketch pad editor.

00:35:27.656 --> 00:35:29.056 A:middle
You can type some texts into it,

00:35:29.296 --> 00:35:30.286 A:middle
you quit and relaunch it, and

00:35:30.286 --> 00:35:30.956 A:middle
you see it again.

00:35:31.376 --> 00:35:32.936 A:middle
And I follow the steps from the

00:35:32.936 --> 00:35:35.046 A:middle
demo and I enabled support from

00:35:35.046 --> 00:35:36.176 A:middle
multiple screens, and it's

00:35:36.176 --> 00:35:36.906 A:middle
looking pretty good.

00:35:37.716 --> 00:35:39.396 A:middle
But when I quit and relaunch the

00:35:39.396 --> 00:35:40.956 A:middle
app, this happens.

00:35:41.526 --> 00:35:43.026 A:middle
I now I have the same content in

00:35:43.026 --> 00:35:44.626 A:middle
both sides of my application and

00:35:44.626 --> 00:35:46.026 A:middle
that's not really what I wanted.

00:35:46.376 --> 00:35:48.616 A:middle
So I took a look at my database

00:35:49.086 --> 00:35:50.326 A:middle
and the problem was pretty

00:35:50.326 --> 00:35:51.096 A:middle
straightforward really.

00:35:51.646 --> 00:35:53.496 A:middle
I was saving out this text file

00:35:53.566 --> 00:35:55.586 A:middle
as a file in my apps container,

00:35:55.886 --> 00:35:57.406 A:middle
but I was only saving it to one

00:35:57.406 --> 00:35:57.966 A:middle
location.

00:35:58.406 --> 00:36:00.006 A:middle
So every time either side of my

00:35:58.406 --> 00:36:00.006 A:middle
So every time either side of my

00:36:00.006 --> 00:36:01.846 A:middle
application saved data, it

00:36:01.846 --> 00:36:03.036 A:middle
overwrite whatever the other one

00:36:03.036 --> 00:36:03.546 A:middle
had saved.

00:36:04.586 --> 00:36:05.826 A:middle
Now, there's nothing that you

00:36:05.826 --> 00:36:07.076 A:middle
UIKit can really do for free

00:36:07.076 --> 00:36:08.376 A:middle
here because this is code in my

00:36:08.376 --> 00:36:08.666 A:middle
app.

00:36:09.226 --> 00:36:10.876 A:middle
So I had to go and do two

00:36:10.876 --> 00:36:11.346 A:middle
things.

00:36:11.776 --> 00:36:12.936 A:middle
I had to correlate that

00:36:13.056 --> 00:36:14.496 A:middle
persistent identifier for the

00:36:14.496 --> 00:36:16.086 A:middle
scene session with the note for

00:36:16.086 --> 00:36:16.766 A:middle
the right scene.

00:36:16.986 --> 00:36:18.546 A:middle
And then I had to update my

00:36:18.546 --> 00:36:19.646 A:middle
logic so that I could save

00:36:19.646 --> 00:36:21.186 A:middle
multiple files instead of just

00:36:21.186 --> 00:36:21.536 A:middle
one.

00:36:22.326 --> 00:36:24.196 A:middle
Now if you're going this route

00:36:24.456 --> 00:36:25.636 A:middle
and doing manual state

00:36:25.636 --> 00:36:27.006 A:middle
restoration, there's just one

00:36:27.006 --> 00:36:28.056 A:middle
more thing I want you to think

00:36:28.056 --> 00:36:29.806 A:middle
about and that's cleaning up the

00:36:29.806 --> 00:36:30.136 A:middle
data.

00:36:31.496 --> 00:36:33.036 A:middle
When UIKit manages that

00:36:33.036 --> 00:36:35.086 A:middle
NSUserActivity for you, it will

00:36:35.086 --> 00:36:36.476 A:middle
take care of where to write it

00:36:37.016 --> 00:36:38.366 A:middle
in once you remove it for you.

00:36:38.866 --> 00:36:40.286 A:middle
But if you're receiving other

00:36:40.286 --> 00:36:42.676 A:middle
large files tied to the lifetime

00:36:42.676 --> 00:36:44.156 A:middle
of a scene in your app, then

00:36:44.156 --> 00:36:45.226 A:middle
you'll want to clean them up

00:36:45.226 --> 00:36:46.946 A:middle
using the new UI application

00:36:47.006 --> 00:36:48.506 A:middle
diDiscardSceneSessions API.

00:36:49.296 --> 00:36:51.386 A:middle
This gets called with a set of

00:36:51.436 --> 00:36:52.166 A:middle
sceneSessions.

00:36:52.916 --> 00:36:55.116 A:middle
And it's a great time to remove

00:36:55.116 --> 00:36:56.786 A:middle
any data that really doesn't

00:36:56.786 --> 00:36:57.786 A:middle
need to exist anymore.

00:36:58.636 --> 00:37:00.216 A:middle
And a document-based app like

00:36:58.636 --> 00:37:00.216 A:middle
And a document-based app like

00:37:00.216 --> 00:37:01.276 A:middle
pages, you wouldn't want to

00:37:01.276 --> 00:37:02.126 A:middle
delete the document.

00:37:02.176 --> 00:37:03.946 A:middle
That stays in the file system.

00:37:04.536 --> 00:37:06.806 A:middle
But configuration or preferences

00:37:07.416 --> 00:37:08.346 A:middle
aren't needed anymore.

00:37:09.326 --> 00:37:10.396 A:middle
This method will be called

00:37:10.396 --> 00:37:11.796 A:middle
immediately when the user swipes

00:37:11.796 --> 00:37:13.976 A:middle
up on -- in scene of your app in

00:37:14.046 --> 00:37:15.146 A:middle
the App Switcher if your

00:37:15.146 --> 00:37:16.206 A:middle
application is running.

00:37:16.556 --> 00:37:18.176 A:middle
Otherwise, you might receive a

00:37:18.246 --> 00:37:19.846 A:middle
set of multiple sessions

00:37:20.116 --> 00:37:21.616 A:middle
sometime after your next launch.

00:37:24.606 --> 00:37:26.086 A:middle
For our next case study, I want

00:37:26.086 --> 00:37:27.826 A:middle
to look at UserDefaults, which

00:37:27.826 --> 00:37:29.086 A:middle
is another really common and

00:37:29.086 --> 00:37:30.316 A:middle
super useful class for

00:37:30.316 --> 00:37:31.056 A:middle
applications.

00:37:32.276 --> 00:37:33.156 A:middle
UserDefaults are great for

00:37:33.156 --> 00:37:33.846 A:middle
storing settings.

00:37:34.116 --> 00:37:35.206 A:middle
And that's exactly what I'm

00:37:35.206 --> 00:37:36.116 A:middle
using them for here.

00:37:36.876 --> 00:37:38.676 A:middle
I have this toggle for a word

00:37:38.676 --> 00:37:40.186 A:middle
count bar in my app.

00:37:40.256 --> 00:37:41.926 A:middle
And when I switch it on, a word

00:37:41.926 --> 00:37:43.116 A:middle
count bar appears at the bottom

00:37:43.116 --> 00:37:43.676 A:middle
of the screen.

00:37:43.986 --> 00:37:46.126 A:middle
But unfortunately, it only

00:37:46.126 --> 00:37:47.746 A:middle
appeared on the screen where I

00:37:47.746 --> 00:37:48.996 A:middle
had the settings view controller

00:37:48.996 --> 00:37:49.446 A:middle
is showing.

00:37:49.526 --> 00:37:51.986 A:middle
It didn't appear in both windows

00:37:51.986 --> 00:37:52.856 A:middle
and that's not what I wanted.

00:37:52.856 --> 00:37:54.276 A:middle
I want this to be an application

00:37:54.276 --> 00:37:55.196 A:middle
global preference.

00:37:55.796 --> 00:37:57.746 A:middle
And when I looked at why this

00:37:57.746 --> 00:37:58.786 A:middle
was happening, it was again

00:37:58.786 --> 00:37:59.706 A:middle
pretty straightforward.

00:37:59.706 --> 00:38:01.316 A:middle
I had a settings view controller

00:37:59.706 --> 00:38:01.316 A:middle
I had a settings view controller

00:38:01.316 --> 00:38:02.586 A:middle
and a settings view controller

00:38:02.586 --> 00:38:03.076 A:middle
delegate.

00:38:04.466 --> 00:38:05.886 A:middle
Whenever the setting changed, I

00:38:05.886 --> 00:38:07.726 A:middle
told the delegate, which was the

00:38:07.726 --> 00:38:08.796 A:middle
text editor view controller

00:38:08.796 --> 00:38:10.396 A:middle
behind, which then updated its

00:38:10.396 --> 00:38:10.546 A:middle
UI.

00:38:11.116 --> 00:38:12.906 A:middle
That's a very self-contained

00:38:12.906 --> 00:38:13.516 A:middle
process.

00:38:13.516 --> 00:38:15.456 A:middle
And at no point is the second

00:38:15.536 --> 00:38:16.916 A:middle
scene in my application ever

00:38:16.916 --> 00:38:17.906 A:middle
informed that anything is

00:38:17.906 --> 00:38:18.376 A:middle
updated.

00:38:19.406 --> 00:38:20.766 A:middle
There's a couple of ways that we

00:38:20.766 --> 00:38:21.936 A:middle
can solve this, but a really

00:38:21.936 --> 00:38:23.796 A:middle
elegant way is using key value

00:38:23.796 --> 00:38:24.346 A:middle
observing.

00:38:25.596 --> 00:38:27.226 A:middle
And I can do this in two steps.

00:38:27.886 --> 00:38:30.056 A:middle
The first is to define a

00:38:30.056 --> 00:38:31.956 A:middle
property on UserDefaults via an

00:38:31.956 --> 00:38:32.496 A:middle
extension.

00:38:32.936 --> 00:38:34.246 A:middle
This will give me a key path

00:38:34.316 --> 00:38:35.556 A:middle
that I can use for key value

00:38:35.556 --> 00:38:36.106 A:middle
observing.

00:38:36.716 --> 00:38:38.426 A:middle
Here, I have my isInfoButton --

00:38:38.756 --> 00:38:40.346 A:middle
or, sorry, isInforBarHidden

00:38:40.346 --> 00:38:41.556 A:middle
Boolean property, and I

00:38:41.556 --> 00:38:43.136 A:middle
implement it in terms of the

00:38:43.136 --> 00:38:44.466 A:middle
existing get and set methods on

00:38:44.466 --> 00:38:45.186 A:middle
UserDefaults.

00:38:46.086 --> 00:38:48.136 A:middle
Next, I go over to my view

00:38:48.136 --> 00:38:49.626 A:middle
controller where I register an

00:38:49.626 --> 00:38:51.076 A:middle
observation on the standard

00:38:51.076 --> 00:38:51.786 A:middle
UserDefaults.

00:38:52.306 --> 00:38:53.616 A:middle
It takes that key path that I

00:38:53.696 --> 00:38:55.316 A:middle
just defined in my extension and

00:38:55.316 --> 00:38:56.726 A:middle
the change handler which

00:38:56.726 --> 00:38:58.046 A:middle
encapsulates for the work that I

00:38:58.046 --> 00:38:59.666 A:middle
want done anytime that value

00:38:59.666 --> 00:39:00.216 A:middle
changes.

00:38:59.666 --> 00:39:00.216 A:middle
changes.

00:39:01.946 --> 00:39:03.596 A:middle
Importantly, I've also passed

00:39:03.596 --> 00:39:05.996 A:middle
the option initial to this

00:39:05.996 --> 00:39:06.956 A:middle
registration.

00:39:07.476 --> 00:39:08.706 A:middle
What this does is really cool.

00:39:08.836 --> 00:39:10.486 A:middle
It calls my change handler once

00:39:10.536 --> 00:39:12.406 A:middle
for free when I set it up, which

00:39:12.406 --> 00:39:13.396 A:middle
means that I don't have to have

00:39:13.396 --> 00:39:14.946 A:middle
this code duplicated anywhere

00:39:14.946 --> 00:39:15.356 A:middle
else.

00:39:15.696 --> 00:39:17.126 A:middle
I don't have to remember to call

00:39:17.126 --> 00:39:18.276 A:middle
one method when my view is

00:39:18.276 --> 00:39:19.876 A:middle
loaded and another when I

00:39:19.876 --> 00:39:20.856 A:middle
receive this update.

00:39:21.146 --> 00:39:22.456 A:middle
There's just one source of truth

00:39:22.456 --> 00:39:23.536 A:middle
for whether or not that's being

00:39:23.536 --> 00:39:24.166 A:middle
shown right now.

00:39:24.836 --> 00:39:26.036 A:middle
It's a really great way to make

00:39:26.036 --> 00:39:27.256 A:middle
sure that your app's interface

00:39:27.256 --> 00:39:27.926 A:middle
is consistent.

00:39:30.286 --> 00:39:31.636 A:middle
Now, everything looks great.

00:39:32.376 --> 00:39:36.136 A:middle
So we hope that those give you

00:39:36.136 --> 00:39:37.536 A:middle
some ideas about things to look

00:39:37.536 --> 00:39:38.606 A:middle
for in your applications.

00:39:39.906 --> 00:39:41.546 A:middle
If your application is already

00:39:41.546 --> 00:39:43.466 A:middle
using best practices, you might

00:39:43.466 --> 00:39:44.626 A:middle
already be doing some of these

00:39:44.626 --> 00:39:45.906 A:middle
and have nothing to change.

00:39:47.246 --> 00:39:48.686 A:middle
But speaking of best practices,

00:39:48.886 --> 00:39:50.316 A:middle
I want to talk about these new

00:39:50.316 --> 00:39:52.046 A:middle
deprecations on UIApplication.

00:39:52.736 --> 00:39:55.236 A:middle
As Steve mentioned, we've split

00:39:55.236 --> 00:39:56.556 A:middle
out the responsibilities for

00:39:56.556 --> 00:39:58.746 A:middle
user interface state and process

00:39:58.746 --> 00:39:59.606 A:middle
lifecycle from the

00:39:59.606 --> 00:40:00.866 A:middle
UIApplicationDelegate.

00:39:59.606 --> 00:40:00.866 A:middle
UIApplicationDelegate.

00:40:01.496 --> 00:40:02.876 A:middle
And to go along with that we've

00:40:02.876 --> 00:40:04.426 A:middle
also split them out of

00:40:04.426 --> 00:40:05.276 A:middle
UIApplication.

00:40:05.926 --> 00:40:07.916 A:middle
Now that you can have multiple

00:40:07.916 --> 00:40:09.236 A:middle
scenes of your application

00:40:09.236 --> 00:40:10.886 A:middle
visible at the same time, you

00:40:10.886 --> 00:40:11.996 A:middle
could have a one with a light

00:40:11.996 --> 00:40:13.906 A:middle
status bar content and one with

00:40:13.906 --> 00:40:15.096 A:middle
a dark status bar content.

00:40:15.456 --> 00:40:16.856 A:middle
And it doesn't make sense for us

00:40:16.856 --> 00:40:18.116 A:middle
to be able to return just one

00:40:18.116 --> 00:40:19.906 A:middle
value to you for this.

00:40:20.146 --> 00:40:21.476 A:middle
So because of that, we are

00:40:21.476 --> 00:40:22.746 A:middle
deprecating these properties on

00:40:22.746 --> 00:40:24.256 A:middle
UIApplication and giving you new

00:40:24.256 --> 00:40:25.636 A:middle
ones on the window scene.

00:40:27.056 --> 00:40:28.376 A:middle
We encourage you to adopt these

00:40:28.416 --> 00:40:29.916 A:middle
new properties even if you're

00:40:29.916 --> 00:40:31.356 A:middle
not planning to adopt support

00:40:31.356 --> 00:40:32.536 A:middle
for multiple windows this year

00:40:32.536 --> 00:40:33.556 A:middle
because it will put you in a

00:40:33.556 --> 00:40:34.576 A:middle
great place if you consider

00:40:34.576 --> 00:40:34.976 A:middle
doing it later.

00:40:38.426 --> 00:40:39.336 A:middle
We've covered a lot today.

00:40:39.546 --> 00:40:40.606 A:middle
So I just want to go over a

00:40:40.606 --> 00:40:41.186 A:middle
brief summary.

00:40:42.086 --> 00:40:44.076 A:middle
Earlier, Ken helped you envision

00:40:44.076 --> 00:40:46.026 A:middle
your applications using many of

00:40:46.026 --> 00:40:47.176 A:middle
the new powerful features that

00:40:47.176 --> 00:40:48.556 A:middle
we've added to multitasking this

00:40:48.556 --> 00:40:48.766 A:middle
year.

00:40:49.556 --> 00:40:51.226 A:middle
We think that users are really

00:40:51.226 --> 00:40:52.456 A:middle
going to come to expect these

00:40:52.456 --> 00:40:53.556 A:middle
out of apps because they're so

00:40:53.556 --> 00:40:54.566 A:middle
useful and convenient.

00:40:54.896 --> 00:40:56.426 A:middle
So we really want to encourage

00:40:56.426 --> 00:40:58.426 A:middle
you to adopt them.

00:40:59.106 --> 00:41:00.706 A:middle
We've made this API easy to

00:40:59.106 --> 00:41:00.706 A:middle
We've made this API easy to

00:41:00.706 --> 00:41:02.526 A:middle
adapt for existing applications.

00:41:02.746 --> 00:41:04.346 A:middle
And we're also pushing it as the

00:41:04.346 --> 00:41:05.776 A:middle
best practice for new

00:41:05.776 --> 00:41:06.476 A:middle
applications.

00:41:06.646 --> 00:41:07.796 A:middle
In fact, this is going to be the

00:41:07.796 --> 00:41:09.326 A:middle
default template for new Xcode

00:41:09.326 --> 00:41:10.766 A:middle
projects using this UI scene

00:41:10.766 --> 00:41:11.266 A:middle
lifecycle.

00:41:11.766 --> 00:41:14.956 A:middle
I also want to encourage you,

00:41:15.136 --> 00:41:16.836 A:middle
because while there might be

00:41:16.836 --> 00:41:18.506 A:middle
some issues when you adopt these

00:41:18.506 --> 00:41:19.826 A:middle
new lifecycle changes, they

00:41:19.826 --> 00:41:21.056 A:middle
usually have fairly simple

00:41:21.056 --> 00:41:22.826 A:middle
solutions, including just the

00:41:22.826 --> 00:41:24.096 A:middle
best practices that we've talked

00:41:24.096 --> 00:41:28.076 A:middle
about in previous WWDCs.

00:41:28.076 --> 00:41:29.646 A:middle
And lastly, I want to encourage

00:41:29.646 --> 00:41:30.886 A:middle
you to move off of the

00:41:30.886 --> 00:41:32.216 A:middle
deprecated UIApplication

00:41:32.216 --> 00:41:33.176 A:middle
properties and onto

00:41:33.176 --> 00:41:34.046 A:middle
UIWindowScene.

00:41:34.496 --> 00:41:35.656 A:middle
These are available to you

00:41:35.656 --> 00:41:37.556 A:middle
anytime you're running on iOS 13

00:41:37.556 --> 00:41:40.136 A:middle
or iPadOS, and you don't need to

00:41:40.136 --> 00:41:41.266 A:middle
adopt multiple windows to take

00:41:41.266 --> 00:41:41.926 A:middle
advantage of them.

00:41:42.616 --> 00:41:44.746 A:middle
We have a couple more talks

00:41:44.846 --> 00:41:46.326 A:middle
later in the week about advanced

00:41:46.326 --> 00:41:49.256 A:middle
topics in multitasking, and also

00:41:49.256 --> 00:41:51.466 A:middle
some labs this week, including

00:41:51.466 --> 00:41:52.686 A:middle
ones focused specifically on

00:41:52.686 --> 00:41:53.906 A:middle
multitasking on Thursday.

00:41:54.286 --> 00:41:56.816 A:middle
I want to thank everyone for

00:41:56.816 --> 00:41:57.946 A:middle
coming out today and hope you

00:41:57.946 --> 00:41:58.576 A:middle
have a great week.

00:41:59.508 --> 00:42:01.508 A:middle
[ Applause ]

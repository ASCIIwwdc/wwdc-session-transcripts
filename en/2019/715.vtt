WEBVTT

00:00:00.506 --> 00:00:04.500 A:middle
[ Music ]

00:00:10.516 --> 00:00:14.756 A:middle
[ Cheering and Applause ]

00:00:15.256 --> 00:00:16.806 A:middle
&gt;&gt; Hi. Welcome to Core NFC

00:00:16.806 --> 00:00:17.446 A:middle
Enhancements.

00:00:17.926 --> 00:00:19.526 A:middle
I hope everyone's had a great

00:00:19.526 --> 00:00:20.586 A:middle
WWDC this year.

00:00:20.586 --> 00:00:21.736 A:middle
And I hope everyone had a great

00:00:21.736 --> 00:00:22.856 A:middle
time at the bash yesterday.

00:00:23.696 --> 00:00:24.566 A:middle
My name is Gordon.

00:00:24.566 --> 00:00:25.876 A:middle
I'm a member of the NFC Software

00:00:25.876 --> 00:00:26.626 A:middle
team here at Apple.

00:00:26.716 --> 00:00:27.796 A:middle
A little bit later, we'll bring

00:00:27.796 --> 00:00:28.786 A:middle
up another team member,

00:00:28.786 --> 00:00:29.236 A:middle
Lawrence.

00:00:29.876 --> 00:00:30.976 A:middle
But let's talk NFC.

00:00:34.146 --> 00:00:35.966 A:middle
So two years ago, we introduced

00:00:35.966 --> 00:00:37.666 A:middle
the Core NFC framework to enable

00:00:37.756 --> 00:00:39.256 A:middle
NDEF Tag reading within your

00:00:39.256 --> 00:00:40.046 A:middle
applications.

00:00:40.086 --> 00:00:41.986 A:middle
And last year, we introduced

00:00:42.426 --> 00:00:43.796 A:middle
background tag scanning to

00:00:43.796 --> 00:00:45.276 A:middle
support the automatic discovery

00:00:45.276 --> 00:00:46.726 A:middle
of NDEF Tags and application

00:00:46.726 --> 00:00:47.046 A:middle
launching.

00:00:48.036 --> 00:00:49.356 A:middle
Now, however, since -- ever

00:00:49.356 --> 00:00:50.636 A:middle
since we've launched the Core

00:00:50.636 --> 00:00:52.266 A:middle
NFC Framework, developers have

00:00:52.266 --> 00:00:53.636 A:middle
been asking for one specific

00:00:53.636 --> 00:00:53.726 A:middle
thing.

00:00:53.726 --> 00:00:55.576 A:middle
And here at Apple, we've

00:00:55.576 --> 00:00:56.636 A:middle
listened to your requests.

00:00:56.636 --> 00:00:58.536 A:middle
And this year, we are super

00:00:58.536 --> 00:01:00.046 A:middle
excited to announce support for

00:00:58.536 --> 00:01:00.046 A:middle
excited to announce support for

00:01:00.046 --> 00:01:02.096 A:middle
both NDEF Tag writing and native

00:01:02.176 --> 00:01:02.846 A:middle
tag access.

00:01:03.016 --> 00:01:04.105 A:middle
[ Cheering and Applause ]

00:01:04.105 --> 00:01:04.936 A:middle
So yep, thank you.

00:01:04.936 --> 00:01:05.016 A:middle
[Chuckles]

00:01:05.516 --> 00:01:07.606 A:middle
[ Applause ]

00:01:08.106 --> 00:01:08.806 A:middle
So not only will your

00:01:08.806 --> 00:01:10.096 A:middle
applications be able to read and

00:01:10.096 --> 00:01:11.886 A:middle
write NDEF-formatted tags, but

00:01:11.886 --> 00:01:13.116 A:middle
you'll be able to interact with

00:01:13.176 --> 00:01:14.286 A:middle
tags using their native

00:01:14.386 --> 00:01:14.906 A:middle
protocols.

00:01:15.196 --> 00:01:17.076 A:middle
And this has a huge impact on

00:01:17.076 --> 00:01:18.196 A:middle
the kinds of things you can do

00:01:18.196 --> 00:01:19.176 A:middle
with NFC within your

00:01:19.176 --> 00:01:19.776 A:middle
applications.

00:01:20.826 --> 00:01:21.846 A:middle
For example, you can read

00:01:22.046 --> 00:01:23.956 A:middle
passports, contact with smart

00:01:23.956 --> 00:01:25.706 A:middle
cards, and interact with

00:01:25.706 --> 00:01:26.666 A:middle
NFC-enabled hardware.

00:01:26.836 --> 00:01:28.326 A:middle
And all this is available on

00:01:28.326 --> 00:01:28.976 A:middle
iPhone 7 and later phones.

00:01:32.116 --> 00:01:33.736 A:middle
So after we review the API

00:01:33.736 --> 00:01:34.956 A:middle
changes, we'll take a look at

00:01:34.956 --> 00:01:36.366 A:middle
how to write an NDEF tag within

00:01:36.366 --> 00:01:36.976 A:middle
your applications.

00:01:39.376 --> 00:01:40.586 A:middle
Then we'll dive into using

00:01:40.586 --> 00:01:40.976 A:middle
native tag access.

00:01:44.056 --> 00:01:45.166 A:middle
And finally, end up with a demo

00:01:45.256 --> 00:01:46.656 A:middle
showing all of this in action.

00:01:49.376 --> 00:01:50.546 A:middle
So let's take a look at the new

00:01:50.546 --> 00:01:50.976 A:middle
API changes.

00:01:54.176 --> 00:01:56.496 A:middle
As a quick review, the general

00:01:56.496 --> 00:01:57.786 A:middle
structure of the Core NFC

00:01:57.786 --> 00:01:59.306 A:middle
Framework remains the same as it

00:01:59.306 --> 00:01:59.846 A:middle
does today.

00:01:59.846 --> 00:02:01.586 A:middle
Your applications will retrieve

00:01:59.846 --> 00:02:01.586 A:middle
Your applications will retrieve

00:02:01.586 --> 00:02:02.916 A:middle
a reader session object from the

00:02:02.966 --> 00:02:03.316 A:middle
Framework.

00:02:03.316 --> 00:02:05.096 A:middle
And when that session becomes

00:02:05.096 --> 00:02:06.716 A:middle
active, you're free to go ahead

00:02:06.716 --> 00:02:07.976 A:middle
and perform NFC operations.

00:02:11.326 --> 00:02:12.456 A:middle
The tag-reading action sheet

00:02:12.456 --> 00:02:13.806 A:middle
will still be shown on-screen

00:02:13.806 --> 00:02:14.826 A:middle
anytime a reader session is

00:02:14.826 --> 00:02:14.976 A:middle
active.

00:02:18.346 --> 00:02:19.446 A:middle
And the new tag writing and

00:02:19.446 --> 00:02:20.786 A:middle
native tag access features are

00:02:20.786 --> 00:02:22.206 A:middle
available to your applications.

00:02:22.786 --> 00:02:23.866 A:middle
However, the background tag

00:02:23.926 --> 00:02:25.566 A:middle
scanning feature still requires

00:02:25.676 --> 00:02:26.676 A:middle
NDEF formatted tags and is

00:02:26.676 --> 00:02:26.976 A:middle
read-only.

00:02:31.056 --> 00:02:32.706 A:middle
Also, the existing 60-second

00:02:32.706 --> 00:02:34.446 A:middle
maximum scan time still exists

00:02:34.446 --> 00:02:34.976 A:middle
for each reader session.

00:02:38.046 --> 00:02:38.706 A:middle
So what is new?

00:02:39.656 --> 00:02:40.866 A:middle
So this year, there's a new NFC

00:02:40.916 --> 00:02:42.726 A:middle
tag-reader session which will

00:02:42.726 --> 00:02:44.336 A:middle
allow your applications to scan

00:02:44.386 --> 00:02:46.246 A:middle
for and connect to tags based on

00:02:46.246 --> 00:02:47.486 A:middle
their underlying technologies.

00:02:47.486 --> 00:02:50.406 A:middle
It will also allow you to stop

00:02:50.406 --> 00:02:51.946 A:middle
and restart the polling cycle to

00:02:51.946 --> 00:02:53.146 A:middle
discover new tags or to

00:02:53.146 --> 00:02:53.976 A:middle
reconnect if needed.

00:02:57.416 --> 00:02:59.896 A:middle
Also, the NFCNDEFReaderSession

00:02:59.896 --> 00:03:01.386 A:middle
has been modified to also

00:02:59.896 --> 00:03:01.386 A:middle
has been modified to also

00:03:01.386 --> 00:03:02.216 A:middle
support tag writing.

00:03:03.086 --> 00:03:04.426 A:middle
Now, both of these sessions will

00:03:04.426 --> 00:03:06.416 A:middle
provide your applications with

00:03:06.516 --> 00:03:08.596 A:middle
NFC tag objects, allowing you to

00:03:08.596 --> 00:03:10.256 A:middle
use a new tag-based interface

00:03:10.256 --> 00:03:10.976 A:middle
when interacting with tags.

00:03:14.196 --> 00:03:15.466 A:middle
So here's a quick look at the

00:03:15.466 --> 00:03:16.866 A:middle
new tag protocols in Core NFC.

00:03:17.446 --> 00:03:18.616 A:middle
As you can see, there are

00:03:18.616 --> 00:03:19.746 A:middle
protocols for all the major

00:03:19.746 --> 00:03:20.156 A:middle
types.

00:03:20.836 --> 00:03:26.136 A:middle
NDEF, ISO7816, MIFARE, ISO15693,

00:03:26.136 --> 00:03:26.566 A:middle
and FeliCa.

00:03:26.566 --> 00:03:28.386 A:middle
Now, if you're not familiar with

00:03:28.386 --> 00:03:29.346 A:middle
all the various NFC

00:03:29.346 --> 00:03:31.026 A:middle
technologies, I would suggest

00:03:31.026 --> 00:03:31.966 A:middle
focusing first on NDEF.

00:03:36.056 --> 00:03:36.886 A:middle
So let's go over the basic steps

00:03:36.886 --> 00:03:38.016 A:middle
of how to use these new features

00:03:38.016 --> 00:03:38.436 A:middle
in Core NFC.

00:03:39.776 --> 00:03:40.786 A:middle
First, you'll need to enable the

00:03:40.786 --> 00:03:42.216 A:middle
entitlement in Xcode, just as

00:03:42.216 --> 00:03:42.956 A:middle
you do today.

00:03:45.106 --> 00:03:46.456 A:middle
So here's an example of an

00:03:46.456 --> 00:03:47.776 A:middle
application enabling the NFC

00:03:47.806 --> 00:03:48.636 A:middle
capabilities.

00:03:48.946 --> 00:03:50.176 A:middle
There are no special permissions

00:03:50.176 --> 00:03:51.136 A:middle
required to do this.

00:03:51.136 --> 00:03:54.356 A:middle
And as you can see here, there

00:03:54.356 --> 00:03:55.706 A:middle
are two different capabilities,

00:03:55.876 --> 00:03:57.456 A:middle
one for NDEF, and one for native

00:03:57.456 --> 00:03:57.976 A:middle
tag access.

00:04:02.046 --> 00:04:04.046 A:middle
So next, you'll need to decide

00:04:04.166 --> 00:04:05.356 A:middle
what your application requires,

00:04:05.546 --> 00:04:07.066 A:middle
NDEF or native access, and use

00:04:07.066 --> 00:04:07.976 A:middle
the appropriate reader session.

00:04:10.296 --> 00:04:11.586 A:middle
You'll need to implement the new

00:04:11.586 --> 00:04:13.036 A:middle
protocol delegate callbacks to

00:04:13.036 --> 00:04:13.966 A:middle
receive the new tag objects.

00:04:17.266 --> 00:04:18.305 A:middle
Once you have the tag object,

00:04:18.305 --> 00:04:19.375 A:middle
you use the reader session to go

00:04:19.375 --> 00:04:19.976 A:middle
ahead and connect to the tag.

00:04:23.106 --> 00:04:24.556 A:middle
At that point, you're free to go

00:04:24.556 --> 00:04:25.606 A:middle
ahead and perform all your

00:04:25.606 --> 00:04:26.726 A:middle
interactions using the tag

00:04:26.726 --> 00:04:26.976 A:middle
object.

00:04:30.106 --> 00:04:31.976 A:middle
And finally, when you're done,

00:04:32.466 --> 00:04:33.726 A:middle
invalidate the session and

00:04:33.726 --> 00:04:34.976 A:middle
release your tag.

00:04:38.046 --> 00:04:38.316 A:middle
All right.

00:04:38.316 --> 00:04:39.706 A:middle
So as I mentioned, if you're new

00:04:40.026 --> 00:04:42.006 A:middle
to NFC, start first with the NFC

00:04:42.096 --> 00:04:44.066 A:middle
Data Exchange Format, or NDEF.

00:04:44.586 --> 00:04:46.356 A:middle
It is the easiest way to add NFC

00:04:46.386 --> 00:04:47.296 A:middle
capabilities to your

00:04:47.296 --> 00:04:47.966 A:middle
applications.

00:04:48.896 --> 00:04:50.056 A:middle
The new tag running support

00:04:50.056 --> 00:04:51.496 A:middle
allows for quick implementation

00:04:51.496 --> 00:04:52.896 A:middle
and prototyping using any --

00:04:52.986 --> 00:04:55.006 A:middle
NDEF-formatted tag regardless of

00:04:55.006 --> 00:04:55.376 A:middle
its type.

00:04:55.376 --> 00:04:58.166 A:middle
As an example, an NDEF tag can

00:04:58.166 --> 00:04:59.536 A:middle
be used in the same manner as a

00:04:59.536 --> 00:05:01.346 A:middle
QR code and can easily be

00:04:59.536 --> 00:05:01.346 A:middle
QR code and can easily be

00:05:01.346 --> 00:05:02.686 A:middle
integrated into many existing

00:05:02.686 --> 00:05:03.256 A:middle
use cases.

00:05:04.416 --> 00:05:05.686 A:middle
To extend that even further,

00:05:06.066 --> 00:05:07.196 A:middle
using the new tag-writing

00:05:07.326 --> 00:05:09.246 A:middle
support in NFC, you can create

00:05:09.246 --> 00:05:11.206 A:middle
NFC tags that are compatible

00:05:11.206 --> 00:05:12.396 A:middle
with background tag scanning

00:05:12.396 --> 00:05:13.386 A:middle
directly from iOS.

00:05:13.786 --> 00:05:14.946 A:middle
So let's take a look.

00:05:15.016 --> 00:05:16.146 A:middle
[ Applause ]

00:05:16.146 --> 00:05:16.796 A:middle
Yeah. Thank you.

00:05:17.241 --> 00:05:19.241 A:middle
[ Applause ]

00:05:19.466 --> 00:05:20.676 A:middle
Let's take a closer look at just

00:05:20.676 --> 00:05:21.776 A:middle
how simple it is to write an

00:05:21.816 --> 00:05:22.606 A:middle
NDEF tag within your

00:05:22.606 --> 00:05:23.146 A:middle
application.

00:05:24.596 --> 00:05:25.946 A:middle
So as I noted, you'll need to

00:05:25.946 --> 00:05:27.576 A:middle
use the NFCNDEFReaderSession for

00:05:27.576 --> 00:05:27.776 A:middle
this.

00:05:28.446 --> 00:05:29.456 A:middle
And you'll need to implement the

00:05:29.456 --> 00:05:31.196 A:middle
new didDetect tags callback

00:05:31.196 --> 00:05:32.846 A:middle
method to receive the NDEF tag

00:05:32.846 --> 00:05:33.326 A:middle
objects.

00:05:33.676 --> 00:05:35.486 A:middle
This will allow your application

00:05:35.486 --> 00:05:36.956 A:middle
to do various things, such as

00:05:36.986 --> 00:05:38.066 A:middle
query the NDEF-related

00:05:38.066 --> 00:05:39.206 A:middle
information about the tag,

00:05:39.826 --> 00:05:41.506 A:middle
including its maximum capacity,

00:05:42.466 --> 00:05:43.596 A:middle
and determine whether the tag is

00:05:43.596 --> 00:05:44.206 A:middle
writeable or not.

00:05:45.596 --> 00:05:46.636 A:middle
You'll be able to read the NDEF

00:05:46.636 --> 00:05:48.746 A:middle
message, write the NDEF message.

00:05:49.016 --> 00:05:50.696 A:middle
And if the tag supports it, even

00:05:50.696 --> 00:05:51.776 A:middle
lock the tag so that it can no

00:05:51.776 --> 00:05:52.766 A:middle
longer be rewritten.

00:05:53.926 --> 00:05:54.946 A:middle
So let's take a look at some

00:05:55.616 --> 00:05:55.726 A:middle
code.

00:05:56.816 --> 00:05:58.936 A:middle
To start writing an NDEF tag, we

00:05:58.936 --> 00:05:59.656 A:middle
instantiate our

00:05:59.936 --> 00:06:01.036 A:middle
NFCNDEFReaderSession.

00:05:59.936 --> 00:06:01.036 A:middle
NFCNDEFReaderSession.

00:06:01.736 --> 00:06:02.926 A:middle
We provided our new delegate.

00:06:02.926 --> 00:06:04.526 A:middle
And we set the

00:06:04.526 --> 00:06:05.436 A:middle
invalidateAfterFirstRead

00:06:05.436 --> 00:06:05.976 A:middle
parameter to false.

00:06:12.046 --> 00:06:12.996 A:middle
Next, when a tag is discovered,

00:06:13.126 --> 00:06:14.056 A:middle
we receive it in our new

00:06:14.056 --> 00:06:14.976 A:middle
Delegate callback method here.

00:06:19.466 --> 00:06:21.126 A:middle
Once we have a tag, we then send

00:06:21.126 --> 00:06:21.986 A:middle
it to the reader session's

00:06:22.026 --> 00:06:23.096 A:middle
Connect method to go ahead and

00:06:23.096 --> 00:06:23.846 A:middle
connect to the tag.

00:06:24.686 --> 00:06:25.886 A:middle
Now at this point, your tag will

00:06:25.886 --> 00:06:27.286 A:middle
remain connected until you

00:06:27.356 --> 00:06:28.316 A:middle
either connect to a different

00:06:28.316 --> 00:06:31.066 A:middle
tag, restart polling, or

00:06:31.066 --> 00:06:31.976 A:middle
invalidate your session.

00:06:37.076 --> 00:06:37.986 A:middle
So the next step here, after

00:06:37.986 --> 00:06:39.286 A:middle
we've connected to the tag, we

00:06:39.286 --> 00:06:40.616 A:middle
go ahead and query the NDEF

00:06:40.616 --> 00:06:41.256 A:middle
information.

00:06:42.116 --> 00:06:43.316 A:middle
If the tag returns a read-write

00:06:43.316 --> 00:06:44.786 A:middle
status, then we're free to go

00:06:44.786 --> 00:06:45.706 A:middle
ahead and write a new message to

00:06:45.706 --> 00:06:45.936 A:middle
the tag.

00:06:50.096 --> 00:06:51.336 A:middle
So the next step here.

00:06:51.336 --> 00:06:52.976 A:middle
We create an NFC NDEF message

00:06:52.976 --> 00:06:54.916 A:middle
with our payload and then send

00:06:54.916 --> 00:06:56.396 A:middle
it to the tag's writeNDEF method

00:06:56.396 --> 00:06:56.956 A:middle
to update the tag.

00:07:02.116 --> 00:07:03.516 A:middle
Finally, when we're all done, we

00:07:03.516 --> 00:07:04.636 A:middle
call the invalidate method.

00:07:05.256 --> 00:07:06.556 A:middle
This will terminate all NFC

00:07:06.556 --> 00:07:07.976 A:middle
operations and end our session.

00:07:07.976 --> 00:07:10.086 A:middle
And that's it.

00:07:10.156 --> 00:07:10.766 A:middle
Pretty simple, right?

00:07:10.766 --> 00:07:12.256 A:middle
This is all it takes to write an

00:07:12.286 --> 00:07:13.246 A:middle
NDEF tag within your app.

00:07:13.246 --> 00:07:15.596 A:middle
Now there might be some use

00:07:15.636 --> 00:07:16.756 A:middle
cases where you need to interact

00:07:16.756 --> 00:07:18.196 A:middle
with tags that are not NDEF

00:07:18.196 --> 00:07:18.586 A:middle
formatted.

00:07:18.586 --> 00:07:19.886 A:middle
And for that, we'll need to go

00:07:19.886 --> 00:07:21.116 A:middle
ahead and use native tag access.

00:07:21.116 --> 00:07:21.786 A:middle
So let's dive into that.

00:07:28.046 --> 00:07:30.046 A:middle
We'll start first with ISO7816.

00:07:30.516 --> 00:07:33.096 A:middle
The ISO7816 interface is used in

00:07:33.306 --> 00:07:35.086 A:middle
Type A and Type B NFC tags.

00:07:35.086 --> 00:07:37.636 A:middle
And it's used in a variety of

00:07:37.636 --> 00:07:39.616 A:middle
different use cases, including

00:07:39.616 --> 00:07:41.086 A:middle
electronic IDs such as

00:07:41.116 --> 00:07:43.936 A:middle
passports, access, contact with

00:07:43.936 --> 00:07:46.156 A:middle
smart cards, payments, and

00:07:46.156 --> 00:07:46.966 A:middle
transit systems.

00:07:47.996 --> 00:07:50.266 A:middle
Tags that support 7816 utilize

00:07:50.266 --> 00:07:51.976 A:middle
the Application Protocol Data

00:07:51.976 --> 00:07:52.916 A:middle
Unit interface.

00:07:53.596 --> 00:07:54.926 A:middle
This is commonly referred to as

00:07:54.926 --> 00:07:55.166 A:middle
APDU.

00:07:55.166 --> 00:07:57.156 A:middle
And your applications will be

00:07:57.156 --> 00:07:58.856 A:middle
able to send and receive APDU

00:07:58.856 --> 00:08:00.726 A:middle
commands using the 7816 tag

00:07:58.856 --> 00:08:00.726 A:middle
commands using the 7816 tag

00:08:00.726 --> 00:08:00.976 A:middle
objects.

00:08:04.046 --> 00:08:04.586 A:middle
Now there are a few special

00:08:04.586 --> 00:08:05.836 A:middle
requirements for interacting

00:08:05.836 --> 00:08:07.316 A:middle
with 7816 tags.

00:08:07.316 --> 00:08:07.986 A:middle
So let's go over those first

00:08:07.986 --> 00:08:08.966 A:middle
before we look at some code.

00:08:13.336 --> 00:08:15.136 A:middle
First, your application will

00:08:15.136 --> 00:08:16.356 A:middle
need to add an entry into its

00:08:16.356 --> 00:08:18.186 A:middle
info.plist file that declares

00:08:18.266 --> 00:08:19.946 A:middle
the specific application

00:08:19.976 --> 00:08:21.566 A:middle
identifiers, or AIDs, which your

00:08:21.896 --> 00:08:22.926 A:middle
application intends to use.

00:08:27.096 --> 00:08:27.976 A:middle
Next, once Core NFC has

00:08:27.976 --> 00:08:29.766 A:middle
discovered a tag, it will first

00:08:29.766 --> 00:08:30.816 A:middle
check to see if that tag

00:08:30.816 --> 00:08:32.576 A:middle
supports an AID listed in your

00:08:32.576 --> 00:08:34.046 A:middle
application's info.plist file.

00:08:34.946 --> 00:08:36.486 A:middle
It does this by trying to select

00:08:36.486 --> 00:08:38.506 A:middle
each AID in turn until it finds

00:08:38.506 --> 00:08:38.905 A:middle
a match.

00:08:39.976 --> 00:08:41.116 A:middle
At that point, the Delegate

00:08:41.116 --> 00:08:42.866 A:middle
callback will be invoked, and

00:08:42.866 --> 00:08:44.326 A:middle
you will receive the tag object

00:08:44.326 --> 00:08:46.006 A:middle
with that AID preselected.

00:08:46.986 --> 00:08:48.206 A:middle
However, at this point, you're

00:08:48.206 --> 00:08:49.536 A:middle
free to go ahead and select any

00:08:49.536 --> 00:08:50.546 A:middle
other AID listed in your

00:08:50.546 --> 00:08:50.966 A:middle
info.plist file.

00:08:59.046 --> 00:08:59.786 A:middle
Now, we're excited about these

00:08:59.786 --> 00:09:00.816 A:middle
new features in Core NFC.

00:08:59.786 --> 00:09:00.816 A:middle
new features in Core NFC.

00:09:00.816 --> 00:09:02.416 A:middle
However, for the time being,

00:09:02.416 --> 00:09:03.656 A:middle
reading payment cards will not

00:09:03.656 --> 00:09:03.976 A:middle
be supported.

00:09:07.356 --> 00:09:08.646 A:middle
So here's an example of an

00:09:08.646 --> 00:09:10.056 A:middle
application info.plist file

00:09:10.056 --> 00:09:10.886 A:middle
listing the AIDs it intends to

00:09:10.886 --> 00:09:10.976 A:middle
use.

00:09:14.046 --> 00:09:14.686 A:middle
Here, you can see the

00:09:14.686 --> 00:09:15.806 A:middle
application is listing the AID

00:09:15.806 --> 00:09:16.976 A:middle
for NDEF operations.

00:09:24.086 --> 00:09:24.786 A:middle
So now, we'll take a look at the

00:09:24.786 --> 00:09:26.666 A:middle
actual 7816 tag object.

00:09:27.676 --> 00:09:29.066 A:middle
The protocol has properties that

00:09:29.066 --> 00:09:31.016 A:middle
are specific to the 7816

00:09:31.016 --> 00:09:31.606 A:middle
technology.

00:09:32.826 --> 00:09:33.946 A:middle
You can see the attributes here

00:09:33.946 --> 00:09:35.336 A:middle
include the unique identifier

00:09:35.336 --> 00:09:36.606 A:middle
and the historical bytes.

00:09:37.846 --> 00:09:38.946 A:middle
So is anyone excited about the

00:09:38.946 --> 00:09:39.986 A:middle
unique ID here?

00:09:39.986 --> 00:09:41.266 A:middle
This is the second-most popular

00:09:41.576 --> 00:09:42.366 A:middle
request that we get.

00:09:43.356 --> 00:09:44.746 A:middle
There's also a sendCommand

00:09:44.746 --> 00:09:46.206 A:middle
method for transmitting any form

00:09:46.206 --> 00:09:47.706 A:middle
of APDU to the tag and receiving

00:09:47.706 --> 00:09:47.976 A:middle
the response.

00:09:52.336 --> 00:09:54.316 A:middle
So to start scanning the 7816

00:09:54.316 --> 00:09:55.626 A:middle
tags, as I mentioned, the first

00:09:55.626 --> 00:09:56.796 A:middle
thing that we'll need to do is

00:09:56.796 --> 00:09:58.016 A:middle
implement a Delegate object

00:09:58.096 --> 00:09:59.196 A:middle
which conforms to the

00:09:59.296 --> 00:10:00.646 A:middle
NFCTagReaderSession Delegate

00:09:59.296 --> 00:10:00.646 A:middle
NFCTagReaderSession Delegate

00:10:00.686 --> 00:10:01.276 A:middle
protocol.

00:10:01.276 --> 00:10:02.706 A:middle
There are only three required

00:10:02.706 --> 00:10:03.886 A:middle
methods, and you can see them up

00:10:03.886 --> 00:10:03.976 A:middle
here.

00:10:09.106 --> 00:10:11.106 A:middle
So to start scanning for 7816

00:10:11.106 --> 00:10:13.096 A:middle
tags, we instantiate our

00:10:13.336 --> 00:10:14.686 A:middle
NFCTagReaderSession object,

00:10:15.386 --> 00:10:17.136 A:middle
provide it our delegate, and set

00:10:17.136 --> 00:10:19.216 A:middle
the polling option to ISO14443.

00:10:19.216 --> 00:10:21.106 A:middle
This is the underlying NFC

00:10:21.106 --> 00:10:22.796 A:middle
technology for Type A and Type B

00:10:22.796 --> 00:10:22.936 A:middle
tags.

00:10:27.226 --> 00:10:29.046 A:middle
Next, when Core NFC discovers a

00:10:29.046 --> 00:10:30.596 A:middle
tag that has a matching AID, we

00:10:30.596 --> 00:10:31.766 A:middle
receive it in our Delegate

00:10:31.766 --> 00:10:31.976 A:middle
callback.

00:10:36.256 --> 00:10:37.806 A:middle
And once we're assured that we

00:10:37.806 --> 00:10:39.976 A:middle
have a 7816 tag, we use the

00:10:39.976 --> 00:10:41.146 A:middle
reader's session.connect method

00:10:41.146 --> 00:10:41.886 A:middle
to go ahead and connect to the

00:10:41.886 --> 00:10:41.976 A:middle
tag.

00:10:46.366 --> 00:10:47.376 A:middle
And finally, after we're

00:10:47.376 --> 00:10:49.236 A:middle
connected, we create an APDU

00:10:49.236 --> 00:10:51.026 A:middle
using the helper class and use

00:10:51.026 --> 00:10:52.176 A:middle
the same command method of the

00:10:52.176 --> 00:10:53.276 A:middle
tag to transmit the APDU and

00:10:53.276 --> 00:10:53.966 A:middle
receive its response.

00:10:58.516 --> 00:10:59.786 A:middle
Now during the transaction, we

00:10:59.786 --> 00:11:01.356 A:middle
may find an application-related

00:10:59.786 --> 00:11:01.356 A:middle
may find an application-related

00:11:01.356 --> 00:11:02.306 A:middle
error has occurred, and we

00:11:02.306 --> 00:11:03.126 A:middle
should not continue.

00:11:04.016 --> 00:11:05.246 A:middle
As an example, imagine we're

00:11:05.246 --> 00:11:06.276 A:middle
trying to read a passport.

00:11:06.276 --> 00:11:07.786 A:middle
And it turns out we don't have

00:11:07.786 --> 00:11:09.146 A:middle
the proper credentials, or we've

00:11:09.146 --> 00:11:11.106 A:middle
calculated the password

00:11:11.106 --> 00:11:11.636 A:middle
incorrectly.

00:11:11.996 --> 00:11:13.416 A:middle
In a scenario like this, we

00:11:13.416 --> 00:11:14.446 A:middle
would really like to indicate

00:11:14.446 --> 00:11:15.426 A:middle
this error to the user.

00:11:16.446 --> 00:11:17.706 A:middle
Calling the Invalidate method

00:11:17.856 --> 00:11:19.746 A:middle
with an error message will

00:11:19.746 --> 00:11:21.256 A:middle
invalidate the session, and an

00:11:21.256 --> 00:11:22.546 A:middle
error symbol, along with the

00:11:22.546 --> 00:11:23.676 A:middle
supplied error message, will be

00:11:23.676 --> 00:11:24.926 A:middle
shown on the action sheet UI

00:11:25.226 --> 00:11:25.976 A:middle
rather than a checkmark.

00:11:30.046 --> 00:11:30.746 A:middle
So here's an example of what

00:11:30.746 --> 00:11:31.766 A:middle
this error indication looks

00:11:31.766 --> 00:11:31.946 A:middle
like.

00:11:32.176 --> 00:11:33.066 A:middle
We'll see this later in the

00:11:33.066 --> 00:11:33.416 A:middle
demo.

00:11:34.426 --> 00:11:35.436 A:middle
But this is pretty great, right?

00:11:35.506 --> 00:11:36.996 A:middle
This is the third-most requested

00:11:36.996 --> 00:11:38.326 A:middle
feature we get.

00:11:39.516 --> 00:11:43.606 A:middle
[ Applause ]

00:11:44.106 --> 00:11:44.996 A:middle
And just for reference, here's

00:11:44.996 --> 00:11:45.926 A:middle
the existing success indication.

00:11:50.256 --> 00:11:51.866 A:middle
So that was 7816.

00:11:52.076 --> 00:11:53.026 A:middle
Let's move on to our second

00:11:53.026 --> 00:11:54.006 A:middle
technology, MIFARE.

00:11:54.926 --> 00:11:56.416 A:middle
MIFARE is the technology similar

00:11:56.416 --> 00:11:57.496 A:middle
to 7816.

00:11:57.496 --> 00:11:58.936 A:middle
And it's based on NFC Type A

00:11:58.936 --> 00:11:59.336 A:middle
tags.

00:12:00.726 --> 00:12:01.836 A:middle
MIFARE is a technology defined

00:12:01.836 --> 00:12:03.456 A:middle
by NXP and is used heavily in

00:12:03.456 --> 00:12:04.536 A:middle
ticketing and badging systems

00:12:04.536 --> 00:12:04.936 A:middle
throughout the world.

00:12:09.096 --> 00:12:10.776 A:middle
So the NFC MIFARE tag protocol

00:12:11.016 --> 00:12:12.236 A:middle
has properties similar to that

00:12:12.236 --> 00:12:13.426 A:middle
of 7816.

00:12:14.006 --> 00:12:15.426 A:middle
In addition, there's another

00:12:15.426 --> 00:12:16.746 A:middle
property of the MIFARE family.

00:12:17.266 --> 00:12:18.556 A:middle
This will indicate the specific

00:12:18.556 --> 00:12:20.166 A:middle
MIFARE tag type that has been

00:12:20.166 --> 00:12:20.646 A:middle
discovered.

00:12:21.436 --> 00:12:22.796 A:middle
It can be MIFARE Ultralight,

00:12:22.796 --> 00:12:24.586 A:middle
MIFARE Plus, or DESFire.

00:12:24.636 --> 00:12:26.566 A:middle
At this time, MIFARE Classic

00:12:26.566 --> 00:12:27.516 A:middle
tags are not supported.

00:12:28.836 --> 00:12:30.386 A:middle
There's also a method here for

00:12:30.456 --> 00:12:31.826 A:middle
sending any MIFARE command.

00:12:32.766 --> 00:12:33.556 A:middle
In addition, there's a

00:12:33.556 --> 00:12:34.966 A:middle
convenience method for sending

00:12:34.966 --> 00:12:37.806 A:middle
7816 APDUs for those tags, such

00:12:37.806 --> 00:12:38.606 A:middle
as DESFire and Plus, which will

00:12:38.606 --> 00:12:38.976 A:middle
support them.

00:12:42.046 --> 00:12:42.536 A:middle
So now, let's see this in

00:12:42.536 --> 00:12:42.836 A:middle
action.

00:12:45.126 --> 00:12:46.236 A:middle
Just start scanning for a MIFARE

00:12:46.236 --> 00:12:47.026 A:middle
tag.

00:12:47.026 --> 00:12:48.266 A:middle
We again instantiate our tag

00:12:48.266 --> 00:12:48.896 A:middle
reader session.

00:12:49.486 --> 00:12:51.006 A:middle
Again, we set our polling option

00:12:51.006 --> 00:12:52.266 A:middle
to ISO14443.

00:12:52.266 --> 00:12:55.686 A:middle
And we set the Delegate and Call

00:12:55.686 --> 00:12:55.976 A:middle
Begin.

00:12:59.266 --> 00:13:00.826 A:middle
Please note that a MIFARE tag

00:12:59.266 --> 00:13:00.826 A:middle
Please note that a MIFARE tag

00:13:00.826 --> 00:13:03.216 A:middle
that supports a 7816 interface

00:13:03.216 --> 00:13:04.756 A:middle
and contains an AID listing the

00:13:04.756 --> 00:13:06.206 A:middle
applications info.plist file

00:13:06.726 --> 00:13:07.876 A:middle
will instead be returned as a

00:13:07.926 --> 00:13:10.526 A:middle
7816 object and not a MIFARE

00:13:10.526 --> 00:13:10.916 A:middle
object.

00:13:14.046 --> 00:13:14.646 A:middle
So at this point, when our

00:13:14.646 --> 00:13:15.436 A:middle
callback gets invoked, we

00:13:15.436 --> 00:13:16.376 A:middle
specifically check to make sure

00:13:16.376 --> 00:13:17.776 A:middle
that we have a MIFARE tag object

00:13:17.776 --> 00:13:17.976 A:middle
returned.

00:13:22.156 --> 00:13:23.506 A:middle
Once we're sure we have one, we

00:13:23.506 --> 00:13:24.266 A:middle
send it to the reader's

00:13:24.266 --> 00:13:25.516 A:middle
session.connect method and

00:13:25.516 --> 00:13:26.206 A:middle
connect to the tag.

00:13:26.966 --> 00:13:30.486 A:middle
And then use the tag to send a

00:13:30.486 --> 00:13:30.976 A:middle
MIFARE command.

00:13:36.256 --> 00:13:37.396 A:middle
Okay, so that's two of the four

00:13:37.396 --> 00:13:37.966 A:middle
technologies.

00:13:38.126 --> 00:13:39.876 A:middle
So let's look at ISO15693.

00:13:39.916 --> 00:13:43.036 A:middle
This is also known as type five

00:13:43.036 --> 00:13:44.006 A:middle
or vicinity tags.

00:13:44.006 --> 00:13:45.486 A:middle
And these are commonly used in

00:13:45.486 --> 00:13:46.426 A:middle
retail, industrial, and even

00:13:46.426 --> 00:13:46.976 A:middle
medical applications.

00:13:51.046 --> 00:13:52.816 A:middle
So once again, this protocol has

00:13:52.816 --> 00:13:54.426 A:middle
properties specific to the

00:13:54.426 --> 00:13:56.056 A:middle
ISO15693 technology.

00:13:56.836 --> 00:13:57.966 A:middle
Here, we also have the unique

00:13:57.966 --> 00:13:59.516 A:middle
identifier, as well as the

00:13:59.516 --> 00:14:00.786 A:middle
manufacture code and the serial

00:13:59.516 --> 00:14:00.786 A:middle
manufacture code and the serial

00:14:00.786 --> 00:14:00.976 A:middle
number.

00:14:06.046 --> 00:14:08.096 A:middle
And the command set for 15693,

00:14:08.096 --> 00:14:09.006 A:middle
if you have not seen it, is

00:14:09.006 --> 00:14:09.576 A:middle
quite large.

00:14:10.296 --> 00:14:11.836 A:middle
And the protocol has convenience

00:14:11.836 --> 00:14:12.956 A:middle
methods for some of the common

00:14:12.956 --> 00:14:13.666 A:middle
operations.

00:14:13.666 --> 00:14:15.076 A:middle
You can see them listed up here.

00:14:15.826 --> 00:14:16.976 A:middle
They cover reading and writing

00:14:17.036 --> 00:14:18.466 A:middle
single or multiple blocks,

00:14:19.246 --> 00:14:21.746 A:middle
locking blocks, select, and

00:14:21.746 --> 00:14:22.346 A:middle
reset.

00:14:23.216 --> 00:14:24.606 A:middle
Again, there's also a method for

00:14:24.606 --> 00:14:26.186 A:middle
sending any custom command.

00:14:26.646 --> 00:14:27.876 A:middle
You can construct any command

00:14:27.876 --> 00:14:29.586 A:middle
according to the ISO15693

00:14:29.626 --> 00:14:31.426 A:middle
specification and use that

00:14:31.426 --> 00:14:32.666 A:middle
method to send it.

00:14:33.596 --> 00:14:34.846 A:middle
You can go ahead and refer to

00:14:34.846 --> 00:14:35.536 A:middle
the specification for more

00:14:35.536 --> 00:14:35.956 A:middle
details.

00:14:40.116 --> 00:14:41.186 A:middle
So to start scanning for

00:14:41.186 --> 00:14:43.106 A:middle
vicinity tags, which should now

00:14:43.106 --> 00:14:44.216 A:middle
be looking very familiar to

00:14:44.216 --> 00:14:46.606 A:middle
everyone, we create our

00:14:46.606 --> 00:14:48.806 A:middle
NFCTagReaderSession, provide it

00:14:48.806 --> 00:14:49.306 A:middle
our delegate.

00:14:49.306 --> 00:14:51.006 A:middle
But this time, we changed the

00:14:51.006 --> 00:14:52.926 A:middle
polling option to ISO15693.

00:14:58.046 --> 00:15:00.536 A:middle
When Core NFC discovers a 15693

00:14:58.046 --> 00:15:00.536 A:middle
When Core NFC discovers a 15693

00:15:00.536 --> 00:15:01.646 A:middle
tag, again, we receive the tag

00:15:01.646 --> 00:15:02.976 A:middle
in our callback.

00:15:06.206 --> 00:15:07.426 A:middle
We again verify that we have the

00:15:07.426 --> 00:15:08.856 A:middle
proper tag type and then connect

00:15:08.856 --> 00:15:09.786 A:middle
to it using the sessions.connect

00:15:09.786 --> 00:15:09.976 A:middle
method.

00:15:14.106 --> 00:15:15.766 A:middle
And once connected, we use the

00:15:15.766 --> 00:15:16.796 A:middle
tag to issue a readSingleBlock

00:15:16.796 --> 00:15:16.976 A:middle
command.

00:15:23.046 --> 00:15:23.576 A:middle
So finally, we're on to our

00:15:23.576 --> 00:15:25.006 A:middle
fourth and final technology,

00:15:25.006 --> 00:15:25.666 A:middle
FeliCa.

00:15:26.056 --> 00:15:27.496 A:middle
FeliCa is a format defined by

00:15:27.576 --> 00:15:28.816 A:middle
Sony, and it's used heavily in

00:15:28.816 --> 00:15:29.656 A:middle
transit and payment systems

00:15:29.656 --> 00:15:29.976 A:middle
around Japan.

00:15:33.116 --> 00:15:35.156 A:middle
Now the FeliCa usage also has

00:15:35.156 --> 00:15:36.326 A:middle
some additional requirements.

00:15:37.106 --> 00:15:40.526 A:middle
Similar to 7816, your

00:15:40.526 --> 00:15:41.726 A:middle
application will need to add an

00:15:41.726 --> 00:15:43.466 A:middle
entry into the info.plist file

00:15:44.036 --> 00:15:45.326 A:middle
that declares the specific

00:15:45.326 --> 00:15:46.496 A:middle
FeliCa system codes your

00:15:46.496 --> 00:15:47.976 A:middle
application intends to use.

00:15:48.766 --> 00:15:49.996 A:middle
And for security and privacy

00:15:49.996 --> 00:15:51.176 A:middle
reasons, we're asking that these

00:15:51.226 --> 00:15:52.816 A:middle
be discreet FeliCa system codes

00:15:52.816 --> 00:15:53.976 A:middle
and not wildcard entries.

00:15:57.046 --> 00:15:59.486 A:middle
Again, similar to 7816, when

00:15:59.486 --> 00:16:01.136 A:middle
Core NFC discovers a FeliCa tag,

00:15:59.486 --> 00:16:01.136 A:middle
Core NFC discovers a FeliCa tag,

00:16:01.716 --> 00:16:02.896 A:middle
we'll first validate -- detect

00:16:02.896 --> 00:16:04.546 A:middle
that that tag contains a system

00:16:04.546 --> 00:16:06.426 A:middle
code listed in your info.plist

00:16:06.426 --> 00:16:06.676 A:middle
file.

00:16:07.636 --> 00:16:08.636 A:middle
If it does, you'll receive the

00:16:08.636 --> 00:16:09.796 A:middle
tag and the Delegate callback.

00:16:09.826 --> 00:16:11.616 A:middle
If it does not, the callback

00:16:11.616 --> 00:16:12.646 A:middle
does not get invoked, and your

00:16:12.646 --> 00:16:13.796 A:middle
application does not get

00:16:13.796 --> 00:16:14.796 A:middle
notified about the presence of

00:16:14.796 --> 00:16:14.976 A:middle
the tag.

00:16:18.256 --> 00:16:19.626 A:middle
So here's an example of an

00:16:19.626 --> 00:16:21.406 A:middle
info.plist file registering for

00:16:21.476 --> 00:16:24.466 A:middle
FeliCa system code reserved for

00:16:24.466 --> 00:16:24.976 A:middle
NDEF operations.

00:16:32.376 --> 00:16:33.476 A:middle
Again, taking a look at the

00:16:33.476 --> 00:16:35.176 A:middle
FeliCa tag protocol here, we see

00:16:35.236 --> 00:16:36.866 A:middle
properties specific to FeliCa.

00:16:37.146 --> 00:16:38.826 A:middle
We have the manufacturer ID, or

00:16:38.826 --> 00:16:40.466 A:middle
IDM, and the current selected

00:16:40.466 --> 00:16:41.256 A:middle
system code.

00:16:42.096 --> 00:16:42.936 A:middle
Also, there's a

00:16:42.936 --> 00:16:44.206 A:middle
sendFeliCaCommand method for

00:16:44.206 --> 00:16:45.656 A:middle
sending any FeliCa command to

00:16:45.656 --> 00:16:45.976 A:middle
the tag.

00:16:49.046 --> 00:16:49.836 A:middle
And this protocol also has

00:16:49.906 --> 00:16:51.236 A:middle
convenience methods for some of

00:16:51.236 --> 00:16:52.846 A:middle
the common FeliCa operations.

00:16:52.846 --> 00:16:55.226 A:middle
You can go ahead and refer to

00:16:55.226 --> 00:16:56.316 A:middle
Sony's FeliCa command

00:16:56.316 --> 00:16:57.936 A:middle
specification for more details.

00:17:01.046 --> 00:17:02.646 A:middle
So continuing what should now be

00:17:02.646 --> 00:17:05.066 A:middle
a very familiar usage model, we

00:17:05.066 --> 00:17:05.806 A:middle
instantiated an

00:17:05.806 --> 00:17:07.886 A:middle
NFCTagReaderSession, provide it

00:17:07.886 --> 00:17:09.435 A:middle
our delegate, and this time,

00:17:09.435 --> 00:17:10.465 A:middle
changed the polling option to

00:17:10.465 --> 00:17:12.636 A:middle
ISO18092, which is the NFC

00:17:12.636 --> 00:17:13.976 A:middle
technology for FeliCa.

00:17:18.046 --> 00:17:19.096 A:middle
So once Core NFC has discovered

00:17:19.096 --> 00:17:20.165 A:middle
a tag and found a matching

00:17:20.165 --> 00:17:21.606 A:middle
system code, we again receive

00:17:21.606 --> 00:17:22.626 A:middle
the tag object in our same

00:17:22.626 --> 00:17:22.976 A:middle
delegate.

00:17:25.156 --> 00:17:26.316 A:middle
We ensure that we have the

00:17:26.316 --> 00:17:27.286 A:middle
proper tag type we were

00:17:27.286 --> 00:17:28.516 A:middle
expecting and then connect to

00:17:28.516 --> 00:17:28.976 A:middle
the tag.

00:17:34.066 --> 00:17:36.036 A:middle
And then finally, we use the tag

00:17:36.096 --> 00:17:37.196 A:middle
to send a requestResponse

00:17:37.196 --> 00:17:37.536 A:middle
command.

00:17:38.326 --> 00:17:39.976 A:middle
So we've now covered NDEF tag

00:17:39.976 --> 00:17:41.346 A:middle
writing and interacting with

00:17:41.346 --> 00:17:42.446 A:middle
tags using all four of the

00:17:42.446 --> 00:17:42.976 A:middle
native technologies.

00:17:46.096 --> 00:17:47.216 A:middle
So at this point, I'm going to

00:17:47.216 --> 00:17:48.616 A:middle
bring Lawrence onstage and show

00:17:48.616 --> 00:17:49.976 A:middle
us a demo of all of this in

00:17:49.976 --> 00:17:50.296 A:middle
action.

00:17:51.516 --> 00:17:56.596 A:middle
[ Applause ]

00:17:57.096 --> 00:17:58.976 A:middle
&gt;&gt; All right, thank you, Gordon.

00:17:59.516 --> 00:18:00.546 A:middle
Hello, everyone.

00:17:59.516 --> 00:18:00.546 A:middle
Hello, everyone.

00:18:01.486 --> 00:18:01.956 A:middle
Welcome.

00:18:04.666 --> 00:18:06.386 A:middle
To demonstrate how Core NFC

00:18:06.456 --> 00:18:07.706 A:middle
Framework can be used in a

00:18:07.706 --> 00:18:10.006 A:middle
real-life example, let me take

00:18:10.006 --> 00:18:12.136 A:middle
you through a quick journey of

00:18:12.186 --> 00:18:13.926 A:middle
my imaginary fishmonger.

00:18:16.216 --> 00:18:17.916 A:middle
As a tech savvy fishmonger, I

00:18:18.476 --> 00:18:20.536 A:middle
have heard that the NFC

00:18:20.536 --> 00:18:22.686 A:middle
technologies can improve

00:18:22.686 --> 00:18:24.876 A:middle
customer engagement and also be

00:18:24.876 --> 00:18:26.386 A:middle
used in inventory management.

00:18:27.526 --> 00:18:28.996 A:middle
After listening on this great

00:18:28.996 --> 00:18:31.116 A:middle
presentation, I have decided to

00:18:31.116 --> 00:18:33.676 A:middle
create two applications to help

00:18:33.676 --> 00:18:35.726 A:middle
my business, The Great Fish

00:18:35.726 --> 00:18:35.976 A:middle
Company.

00:18:38.066 --> 00:18:39.546 A:middle
I'm going to use NFC in two

00:18:39.546 --> 00:18:40.026 A:middle
ways.

00:18:41.356 --> 00:18:44.186 A:middle
First, I'm going to create NFC

00:18:44.186 --> 00:18:45.786 A:middle
NDEF tags to describe my

00:18:45.786 --> 00:18:46.186 A:middle
product.

00:18:47.376 --> 00:18:48.896 A:middle
And second, I'm going to create

00:18:48.896 --> 00:18:50.666 A:middle
coupon tags using MIFARE

00:18:50.666 --> 00:18:52.636 A:middle
Ultralight tags, which is also

00:18:52.636 --> 00:18:54.846 A:middle
known as NFC Type II tags.

00:19:01.046 --> 00:19:02.696 A:middle
Here is an overview of how we

00:19:02.696 --> 00:19:03.826 A:middle
deliver our products.

00:19:04.446 --> 00:19:06.656 A:middle
After we catch our fish, we

00:19:06.656 --> 00:19:09.776 A:middle
integrate NFC NDEF tag to

00:19:10.126 --> 00:19:11.016 A:middle
describe the catch.

00:19:12.186 --> 00:19:14.186 A:middle
The message contains the fish

00:19:14.446 --> 00:19:16.426 A:middle
they have catch, the fish name,

00:19:16.786 --> 00:19:17.396 A:middle
and the price.

00:19:18.466 --> 00:19:20.196 A:middle
The tag is then attached to the

00:19:20.196 --> 00:19:21.786 A:middle
product packaging and eventually

00:19:21.786 --> 00:19:23.466 A:middle
gets delivered to our customers.

00:19:24.386 --> 00:19:25.376 A:middle
The first application that I'm

00:19:25.376 --> 00:19:26.626 A:middle
going to create is called the

00:19:26.626 --> 00:19:28.086 A:middle
Fish Tag Creator.

00:19:28.086 --> 00:19:29.976 A:middle
This is what it looks like here.

00:19:33.046 --> 00:19:33.776 A:middle
Once I've entered all the

00:19:33.776 --> 00:19:36.266 A:middle
information into my app, I can

00:19:36.266 --> 00:19:37.896 A:middle
click on the Write to Tag button

00:19:38.766 --> 00:19:39.846 A:middle
to write to the NDEF tag.

00:19:41.006 --> 00:19:42.586 A:middle
The Fish Tag Creator application

00:19:42.766 --> 00:19:45.296 A:middle
also allows me to create NFC

00:19:45.296 --> 00:19:48.116 A:middle
coupon codes to promote my

00:19:48.696 --> 00:19:48.896 A:middle
business.

00:19:49.016 --> 00:19:51.086 A:middle
I use a MIFARE Ultralight tag to

00:19:51.086 --> 00:19:52.376 A:middle
store the special coupon code

00:19:52.696 --> 00:19:54.036 A:middle
and send it to my customers.

00:19:54.586 --> 00:19:57.316 A:middle
Here, I can select one of the

00:19:57.316 --> 00:19:59.196 A:middle
three possible coupon values to

00:19:59.196 --> 00:19:59.356 A:middle
write.

00:20:00.386 --> 00:20:01.336 A:middle
The second application that I

00:20:01.336 --> 00:20:03.226 A:middle
create is called a Fish Tag

00:20:03.336 --> 00:20:03.676 A:middle
Reader.

00:20:05.086 --> 00:20:05.966 A:middle
My customer will be able to

00:20:05.966 --> 00:20:07.186 A:middle
download this app from the App

00:20:07.186 --> 00:20:09.696 A:middle
Store to read the NDEF fish tag

00:20:09.776 --> 00:20:11.616 A:middle
that come with their purchase.

00:20:12.186 --> 00:20:15.426 A:middle
In the first panel, we have the

00:20:15.486 --> 00:20:18.076 A:middle
Click Scan button to scan the

00:20:18.076 --> 00:20:19.116 A:middle
fish tag that comes with the

00:20:19.116 --> 00:20:19.446 A:middle
fish.

00:20:20.056 --> 00:20:22.216 A:middle
The app would then display the

00:20:22.266 --> 00:20:23.626 A:middle
information stored it on the

00:20:23.626 --> 00:20:23.886 A:middle
tag.

00:20:24.596 --> 00:20:26.206 A:middle
In the second panel, we can

00:20:26.206 --> 00:20:27.776 A:middle
click on the Scan Coupon button

00:20:28.176 --> 00:20:29.586 A:middle
to read our MIFARE Ultralight

00:20:29.666 --> 00:20:31.066 A:middle
fish tag -- coupon tags.

00:20:32.246 --> 00:20:33.846 A:middle
Customer can redeem this coupon

00:20:33.906 --> 00:20:34.896 A:middle
in their future purchase.

00:20:35.366 --> 00:20:37.436 A:middle
Now let's take a look at both of

00:20:37.436 --> 00:20:37.976 A:middle
these apps in actions.

00:20:45.076 --> 00:20:45.346 A:middle
All right.

00:20:45.346 --> 00:20:48.296 A:middle
I have basically put the -- the

00:20:48.296 --> 00:20:50.426 A:middle
Fish Tag Reader app right --

00:20:50.426 --> 00:20:53.356 A:middle
creator app right now.

00:20:53.586 --> 00:20:56.016 A:middle
Today I brought with me a

00:20:56.016 --> 00:20:57.736 A:middle
creative rainbow salmon with me.

00:20:58.516 --> 00:21:01.546 A:middle
[ Chuckling ]

00:20:58.516 --> 00:21:01.546 A:middle
[ Chuckling ]

00:21:02.046 --> 00:21:03.426 A:middle
Let me first select today's

00:21:03.426 --> 00:21:05.906 A:middle
dates and the fish name, which

00:21:05.906 --> 00:21:06.556 A:middle
is Creative Salmon.

00:21:07.776 --> 00:21:09.166 A:middle
Okay, this one is definitely the

00:21:09.166 --> 00:21:09.926 A:middle
large size, right?

00:21:10.516 --> 00:21:12.616 A:middle
[ Multiple Voices ]

00:21:13.116 --> 00:21:14.926 A:middle
So now I click on the Write to

00:21:14.926 --> 00:21:16.146 A:middle
Tag button.

00:21:16.756 --> 00:21:18.296 A:middle
The action sheet will be shown.

00:21:18.386 --> 00:21:19.626 A:middle
And now, at this point, I can

00:21:19.676 --> 00:21:20.976 A:middle
hold my phone near the NDEF tag.

00:21:25.046 --> 00:21:25.606 A:middle
Bingo.

00:21:28.046 --> 00:21:30.266 A:middle
Now let me next then create a

00:21:30.266 --> 00:21:31.466 A:middle
coupon tag for your audience

00:21:31.466 --> 00:21:31.636 A:middle
here.

00:21:32.276 --> 00:21:34.556 A:middle
I'm going to select Create

00:21:34.556 --> 00:21:34.976 A:middle
Coupon button.

00:21:38.046 --> 00:21:39.326 A:middle
I'm going to choose a 50% off

00:21:39.746 --> 00:21:41.256 A:middle
since, you know, this is a

00:21:41.256 --> 00:21:42.836 A:middle
special WWDC promotion, right?

00:21:43.516 --> 00:21:45.546 A:middle
[ Cheering and Applause ]

00:21:46.046 --> 00:21:47.316 A:middle
All right, so let's click on the

00:21:47.316 --> 00:21:47.856 A:middle
button.

00:21:48.466 --> 00:21:49.606 A:middle
The action sheet again will be

00:21:49.606 --> 00:21:50.376 A:middle
shown on the screen.

00:21:50.686 --> 00:21:52.376 A:middle
And now, I can hold my iPhone

00:21:52.836 --> 00:21:53.886 A:middle
near the coupon tag.

00:21:56.276 --> 00:21:56.526 A:middle
Voila!

00:22:00.216 --> 00:22:01.876 A:middle
Okay, so now let's switch over

00:22:01.876 --> 00:22:05.406 A:middle
to the NFC Tag Readers app to

00:22:05.406 --> 00:22:05.976 A:middle
retest all my NFC tags.

00:22:10.076 --> 00:22:11.236 A:middle
Here, I have the app open.

00:22:12.626 --> 00:22:13.796 A:middle
I'm going to press on the Scan

00:22:13.796 --> 00:22:15.666 A:middle
Tag button and read my NDEF fish

00:22:15.666 --> 00:22:15.876 A:middle
tag.

00:22:22.046 --> 00:22:23.096 A:middle
The description of the product

00:22:23.096 --> 00:22:24.556 A:middle
is now displayed on the screen.

00:22:25.616 --> 00:22:26.636 A:middle
Wow, that's cool.

00:22:27.256 --> 00:22:29.936 A:middle
Alright. Now let me try to scan

00:22:30.536 --> 00:22:31.796 A:middle
the coupon tag.

00:22:32.536 --> 00:22:34.326 A:middle
This is done by selecting the

00:22:34.326 --> 00:22:36.266 A:middle
second panel and clicking on the

00:22:36.266 --> 00:22:36.976 A:middle
Scan Coupon button.

00:22:44.486 --> 00:22:45.256 A:middle
All right, yeah.

00:22:45.256 --> 00:22:47.016 A:middle
This is the fish 50% off coupon.

00:22:48.576 --> 00:22:50.236 A:middle
Okay, so now let me try to read

00:22:50.236 --> 00:22:50.976 A:middle
the second coupon again.

00:22:56.346 --> 00:22:57.636 A:middle
Okay, this is not a valid

00:22:57.636 --> 00:22:58.006 A:middle
coupon.

00:22:58.516 --> 00:23:00.726 A:middle
So after seeing both of these

00:22:58.516 --> 00:23:00.726 A:middle
So after seeing both of these

00:23:00.726 --> 00:23:02.606 A:middle
are running in actions, let me

00:23:02.606 --> 00:23:04.006 A:middle
switch over to the source code

00:23:04.006 --> 00:23:04.626 A:middle
and take a look at how this is

00:23:04.626 --> 00:23:04.976 A:middle
implemented.

00:23:12.106 --> 00:23:12.916 A:middle
All right, let's walk through

00:23:12.916 --> 00:23:14.976 A:middle
the Fish Tag Creative Offers.

00:23:21.046 --> 00:23:22.806 A:middle
Here, I'll set the NDEF and

00:23:22.866 --> 00:23:25.026 A:middle
native tag capabilities in my

00:23:25.026 --> 00:23:25.856 A:middle
entitlement file.

00:23:26.776 --> 00:23:27.776 A:middle
This is because I'm going to use

00:23:28.026 --> 00:23:29.796 A:middle
both the NDEF and tag readings

00:23:30.306 --> 00:23:31.436 A:middle
-- reader session in my

00:23:31.436 --> 00:23:31.976 A:middle
application.

00:23:38.176 --> 00:23:39.596 A:middle
Now let's take a look at the

00:23:40.506 --> 00:23:42.606 A:middle
Main View controller to see how

00:23:42.606 --> 00:23:43.246 A:middle
they NDEF writer is being

00:23:43.246 --> 00:23:43.966 A:middle
implemented.

00:23:54.396 --> 00:23:54.976 A:middle
In the --

00:23:58.066 --> 00:23:58.806 A:middle
Sorry, one second here.

00:24:04.046 --> 00:24:05.026 A:middle
In the Write Tag Action

00:24:05.026 --> 00:24:07.186 A:middle
function, we have to instantiate

00:24:07.186 --> 00:24:09.236 A:middle
an NFCNDEFReaderSession.

00:24:10.816 --> 00:24:13.636 A:middle
We set the alert message and

00:24:13.636 --> 00:24:14.826 A:middle
call the Begin Method to start a

00:24:14.826 --> 00:24:14.976 A:middle
session.

00:24:23.136 --> 00:24:25.566 A:middle
When an NDEF tag is found, it is

00:24:25.566 --> 00:24:27.006 A:middle
going to be sent to the Delegate

00:24:27.006 --> 00:24:27.386 A:middle
function.

00:24:28.056 --> 00:24:32.866 A:middle
We connect to the tag and call

00:24:33.666 --> 00:24:34.906 A:middle
queryNDEFStatus.

00:24:35.596 --> 00:24:39.306 A:middle
If the tag is writeable and has

00:24:39.306 --> 00:24:41.906 A:middle
sufficient storage, we call the

00:24:41.946 --> 00:24:44.036 A:middle
writeNDEF function to write to

00:24:44.896 --> 00:24:46.106 A:middle
the tag.

00:24:46.266 --> 00:24:47.666 A:middle
Finally, we call the

00:24:47.666 --> 00:24:48.506 A:middle
invalidateFunction to end the

00:24:48.506 --> 00:24:48.936 A:middle
session.

00:24:52.046 --> 00:24:52.756 A:middle
Now let's take a look how a

00:24:52.756 --> 00:24:53.806 A:middle
coupon is created.

00:25:01.046 --> 00:25:02.986 A:middle
Here, we have the createCoupon

00:25:02.986 --> 00:25:03.726 A:middle
action function.

00:25:05.006 --> 00:25:06.156 A:middle
We instantiate a

00:25:06.436 --> 00:25:07.726 A:middle
TagReaderSession object.

00:25:09.106 --> 00:25:12.316 A:middle
We call the setAlert message and

00:25:12.316 --> 00:25:13.826 A:middle
call beginFunction to start a

00:25:13.826 --> 00:25:13.976 A:middle
session.

00:25:23.136 --> 00:25:24.226 A:middle
Here, we are looking

00:25:24.226 --> 00:25:25.596 A:middle
specifically for a MIFARE

00:25:25.596 --> 00:25:27.166 A:middle
Ultralight coupon tag in the

00:25:27.166 --> 00:25:27.896 A:middle
Delegate function.

00:25:29.456 --> 00:25:31.776 A:middle
When a tag is actually found, we

00:25:31.776 --> 00:25:33.666 A:middle
connect to it and start the

00:25:33.666 --> 00:25:33.976 A:middle
write operation.

00:25:42.156 --> 00:25:44.376 A:middle
To write to the tag, we

00:25:44.756 --> 00:25:46.746 A:middle
basically create a coupon code

00:25:47.696 --> 00:25:49.846 A:middle
and then call sendMIFARE command

00:25:49.846 --> 00:25:52.566 A:middle
to start a write operation.

00:25:52.686 --> 00:25:54.076 A:middle
When all write operations are

00:25:54.076 --> 00:25:57.606 A:middle
completed, we invalidate the

00:25:57.606 --> 00:25:57.956 A:middle
session.

00:26:02.286 --> 00:26:03.626 A:middle
We have used both NDEF and

00:26:04.206 --> 00:26:05.526 A:middle
native tag reader session to

00:26:05.526 --> 00:26:06.956 A:middle
create NFC tags.

00:26:08.106 --> 00:26:09.676 A:middle
Now let's take a look together

00:26:09.676 --> 00:26:11.896 A:middle
with the Fish Tag Reader app.

00:26:21.076 --> 00:26:22.676 A:middle
The NFCTagReaderSession has

00:26:23.036 --> 00:26:24.446 A:middle
convenience methods to perform

00:26:24.446 --> 00:26:24.976 A:middle
NDEF operations.

00:26:27.256 --> 00:26:28.636 A:middle
This is what we use here.

00:26:29.826 --> 00:26:31.876 A:middle
However, it's required us to add

00:26:31.876 --> 00:26:36.316 A:middle
the 7816 AID and Type F system

00:26:36.316 --> 00:26:38.736 A:middle
code into the -- for the NDEF in

00:26:38.736 --> 00:26:40.046 A:middle
our info.plist file, which is

00:26:40.736 --> 00:26:40.976 A:middle
shown here.

00:26:50.416 --> 00:26:51.976 A:middle
Now in the Scan View controller

00:26:52.476 --> 00:26:57.696 A:middle
--

00:26:58.196 --> 00:27:01.866 A:middle
We have the scan tag action

00:26:58.196 --> 00:27:01.866 A:middle
We have the scan tag action

00:27:01.946 --> 00:27:02.346 A:middle
function.

00:27:02.346 --> 00:27:04.306 A:middle
Here, we create a

00:27:04.306 --> 00:27:07.406 A:middle
TagReaderSession, set the alert

00:27:07.406 --> 00:27:10.786 A:middle
message, and call begins to

00:27:10.786 --> 00:27:12.906 A:middle
start the -- write the Reader

00:27:12.906 --> 00:27:13.556 A:middle
action function.

00:27:21.196 --> 00:27:23.336 A:middle
When an NFC tag is found, it is

00:27:23.396 --> 00:27:24.426 A:middle
then delivered to our Delegate

00:27:24.426 --> 00:27:24.956 A:middle
callback.

00:27:28.386 --> 00:27:30.886 A:middle
We connect to the tag and

00:27:30.936 --> 00:27:31.976 A:middle
perform NDEF status query.

00:27:35.126 --> 00:27:37.746 A:middle
If the tag is readable, we call

00:27:37.746 --> 00:27:38.856 A:middle
readNDEF method.

00:27:47.076 --> 00:27:48.436 A:middle
Now let's -- finally, we

00:27:48.436 --> 00:27:49.946 A:middle
actually invalidate the session

00:27:49.946 --> 00:27:50.926 A:middle
by calling Invalidate.

00:27:57.336 --> 00:27:58.316 A:middle
Now let's take a look how we

00:27:58.316 --> 00:27:58.966 A:middle
read a coupon tag.

00:28:07.066 --> 00:28:08.616 A:middle
Here, we have a ScanCoupon

00:28:08.616 --> 00:28:09.336 A:middle
action function.

00:28:09.886 --> 00:28:11.436 A:middle
And just like before, we

00:28:11.436 --> 00:28:12.576 A:middle
instantiate a

00:28:13.146 --> 00:28:14.206 A:middle
NFCTagReaderSession object.

00:28:14.816 --> 00:28:17.116 A:middle
We set the alert message.

00:28:18.176 --> 00:28:19.166 A:middle
And we start a session by

00:28:19.166 --> 00:28:19.976 A:middle
calling the Begin.

00:28:27.066 --> 00:28:28.896 A:middle
When a tag is found, we check to

00:28:28.946 --> 00:28:30.516 A:middle
see if it's a MIFARE Ultralight

00:28:30.516 --> 00:28:30.816 A:middle
tag.

00:28:32.216 --> 00:28:34.896 A:middle
If it is, we connect to the tag.

00:28:43.046 --> 00:28:44.846 A:middle
To read from the tag, we call

00:28:44.846 --> 00:28:45.976 A:middle
the sendMIFARE command.

00:28:48.236 --> 00:28:49.726 A:middle
We then validate the queue

00:28:49.726 --> 00:28:49.956 A:middle
point.

00:28:52.176 --> 00:28:54.416 A:middle
At the end, we call the

00:28:54.416 --> 00:28:56.636 A:middle
Invalidate method to end the

00:28:56.636 --> 00:28:56.976 A:middle
session.

00:29:00.046 --> 00:29:02.336 A:middle
If the coupon is invalid, we

00:29:02.336 --> 00:29:03.656 A:middle
call invalidateErrorMessage

00:29:03.766 --> 00:29:03.976 A:middle
instead.

00:29:09.426 --> 00:29:10.726 A:middle
Now that's everything that you

00:29:10.726 --> 00:29:12.446 A:middle
need in order to create a great

00:29:12.446 --> 00:29:13.936 A:middle
app using the Core NFC

00:29:14.006 --> 00:29:14.336 A:middle
Framework.

00:29:14.986 --> 00:29:15.896 A:middle
Back to Gordon.

00:29:16.516 --> 00:29:20.500 A:middle
[ Applause ]

00:29:24.156 --> 00:29:24.786 A:middle
&gt;&gt; Thank you, Lawrence.

00:29:28.096 --> 00:29:29.536 A:middle
So we hope the new tag writing

00:29:29.536 --> 00:29:31.116 A:middle
and native access allows you to

00:29:31.116 --> 00:29:32.516 A:middle
add awesome new features to your

00:29:32.516 --> 00:29:33.186 A:middle
applications.

00:29:33.736 --> 00:29:34.786 A:middle
As we've seen, it's pretty

00:29:34.786 --> 00:29:35.836 A:middle
straightforward and pretty

00:29:35.836 --> 00:29:36.146 A:middle
simple.

00:29:36.716 --> 00:29:37.986 A:middle
Let's do a quick review of what

00:29:37.986 --> 00:29:38.906 A:middle
we've gone over today.

00:29:39.576 --> 00:29:41.126 A:middle
First, decide which type of

00:29:41.126 --> 00:29:42.186 A:middle
reader session your application

00:29:42.186 --> 00:29:42.786 A:middle
has required.

00:29:43.306 --> 00:29:44.826 A:middle
NDEF, native access, or even

00:29:44.826 --> 00:29:44.976 A:middle
both.

00:29:49.046 --> 00:29:49.996 A:middle
Implement the newDelegate

00:29:49.996 --> 00:29:50.766 A:middle
methods to receive the new tag

00:29:50.766 --> 00:29:50.976 A:middle
objects.

00:29:53.056 --> 00:29:54.716 A:middle
Once you have those tag objects,

00:29:54.836 --> 00:29:56.016 A:middle
go ahead and perform all your

00:29:56.016 --> 00:29:56.766 A:middle
reads and writes using those

00:29:56.766 --> 00:29:56.976 A:middle
objects.

00:29:59.076 --> 00:30:00.256 A:middle
And when you're all done,

00:29:59.076 --> 00:30:00.256 A:middle
And when you're all done,

00:30:00.256 --> 00:30:01.956 A:middle
indicate the proper success or

00:30:01.956 --> 00:30:02.986 A:middle
error indication using the

00:30:02.986 --> 00:30:03.976 A:middle
appropriate Invalidation call.

00:30:06.116 --> 00:30:06.826 A:middle
And that's it.

00:30:10.046 --> 00:30:11.486 A:middle
So all the sample code that we

00:30:11.486 --> 00:30:12.306 A:middle
have gone through today is

00:30:12.306 --> 00:30:13.686 A:middle
available to you online now,

00:30:14.576 --> 00:30:16.096 A:middle
along with other information.

00:30:16.686 --> 00:30:18.686 A:middle
iOS 13 is available now along

00:30:18.726 --> 00:30:19.526 A:middle
with Xcode 11.

00:30:19.856 --> 00:30:20.666 A:middle
Everybody should go ahead

00:30:20.666 --> 00:30:22.046 A:middle
download that and use Core NFC

00:30:22.096 --> 00:30:23.226 A:middle
to start doing awesome, new

00:30:23.226 --> 00:30:23.496 A:middle
things.

00:30:25.146 --> 00:30:26.316 A:middle
And if anybody has questions,

00:30:26.316 --> 00:30:27.706 A:middle
the Core NFC Lab is immediately

00:30:27.706 --> 00:30:29.106 A:middle
following this session over in

00:30:29.106 --> 00:30:29.466 A:middle
the labs.

00:30:29.466 --> 00:30:31.636 A:middle
So come talk to us and say

00:30:31.636 --> 00:30:31.966 A:middle
hello.

00:30:32.516 --> 00:30:36.500 A:middle
[ Cheering and Applause ]

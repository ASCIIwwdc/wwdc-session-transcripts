WEBVTT

00:00:26.516 --> 00:00:31.136 A:middle
[ Applause ]

00:00:31.636 --> 00:00:32.356 A:middle
&gt;&gt; All right.

00:00:32.356 --> 00:00:33.956 A:middle
Good evening, everyone.

00:00:34.196 --> 00:00:35.066 A:middle
My name is Eugene.

00:00:35.286 --> 00:00:37.206 A:middle
I'm an engineer on the Messages

00:00:37.206 --> 00:00:39.616 A:middle
team and I am super excited to

00:00:39.616 --> 00:00:40.986 A:middle
be here tonight to speak with

00:00:40.986 --> 00:00:43.496 A:middle
you about what's new in iMessage

00:00:43.496 --> 00:00:43.916 A:middle
apps.

00:00:45.016 --> 00:00:45.766 A:middle
Let's dive in here.

00:00:46.076 --> 00:00:47.776 A:middle
We've got a couple of things on

00:00:47.776 --> 00:00:48.726 A:middle
the agenda this evening.

00:00:49.216 --> 00:00:51.366 A:middle
First one, we want to show off a

00:00:51.366 --> 00:00:52.546 A:middle
little bit of what's new in the

00:00:52.646 --> 00:00:54.686 A:middle
iMessage app area in iOS 11.

00:00:54.726 --> 00:00:55.646 A:middle
Some of the stuff you saw in the

00:00:55.646 --> 00:00:56.826 A:middle
keynote plus a little bit more.

00:00:58.196 --> 00:00:59.556 A:middle
After that, we're going to be

00:00:59.556 --> 00:01:00.956 A:middle
introducing our awesome new

00:00:59.556 --> 00:01:00.956 A:middle
introducing our awesome new

00:01:00.956 --> 00:01:02.286 A:middle
Direct Send API.

00:01:03.176 --> 00:01:06.896 A:middle
After that, my colleagues Jay

00:01:06.896 --> 00:01:07.946 A:middle
and Stephen will be coming on

00:01:07.946 --> 00:01:09.846 A:middle
stage to talk to you about our

00:01:09.846 --> 00:01:11.246 A:middle
new Live Message Layouts.

00:01:12.226 --> 00:01:13.386 A:middle
And finally, we'll be wrapping

00:01:13.386 --> 00:01:15.246 A:middle
up the talk with a couple best

00:01:15.246 --> 00:01:17.276 A:middle
practices tips and tricks for

00:01:17.276 --> 00:01:17.966 A:middle
your iMessage apps.

00:01:21.136 --> 00:01:22.536 A:middle
So a lot of what we're talking

00:01:22.536 --> 00:01:24.336 A:middle
about this year builds off the

00:01:24.336 --> 00:01:26.036 A:middle
fundamentals that we established

00:01:26.036 --> 00:01:27.796 A:middle
last year with iOS 10 and the

00:01:27.796 --> 00:01:29.576 A:middle
introduction of the Messages

00:01:29.576 --> 00:01:29.996 A:middle
framework.

00:01:30.526 --> 00:01:31.806 A:middle
So if you need a refresher about

00:01:31.806 --> 00:01:32.966 A:middle
the Messages framework or

00:01:32.966 --> 00:01:34.246 A:middle
iMessage apps in general, we

00:01:34.246 --> 00:01:36.906 A:middle
highly recommend watching our

00:01:36.906 --> 00:01:39.026 A:middle
previous year session iMessage

00:01:39.106 --> 00:01:41.356 A:middle
Apps and Stickers Part 2, which

00:01:41.386 --> 00:01:43.516 A:middle
is available on the developer

00:01:43.516 --> 00:01:43.896 A:middle
portal.

00:01:44.286 --> 00:01:45.706 A:middle
So give that a look if you'd

00:01:45.706 --> 00:01:46.306 A:middle
like a refresher.

00:01:46.306 --> 00:01:49.816 A:middle
So let's get into the cool

00:01:49.816 --> 00:01:50.206 A:middle
stuff.

00:01:50.556 --> 00:01:52.176 A:middle
What's new in the Messages app

00:01:52.176 --> 00:01:52.556 A:middle
area.

00:01:52.746 --> 00:01:54.646 A:middle
So as you all saw on Monday,

00:01:54.816 --> 00:01:56.756 A:middle
we've updated a little bit of

00:01:57.006 --> 00:01:59.436 A:middle
the Messages app UI for iOS 11.

00:02:00.036 --> 00:02:01.986 A:middle
So I just saw on Monday when a

00:02:01.986 --> 00:02:03.636 A:middle
user enters the conversation now

00:02:04.206 --> 00:02:06.436 A:middle
we put all the app icons right

00:02:06.476 --> 00:02:07.766 A:middle
there at the bottom of the

00:02:07.766 --> 00:02:09.006 A:middle
screen which makes it really

00:02:09.006 --> 00:02:10.356 A:middle
easy for users to launch

00:02:10.356 --> 00:02:12.296 A:middle
applications right when entering

00:02:12.296 --> 00:02:13.056 A:middle
a conversation.

00:02:13.596 --> 00:02:18.166 A:middle
As with iOS 10, your application

00:02:18.166 --> 00:02:19.196 A:middle
still lives in kind of the

00:02:19.196 --> 00:02:21.246 A:middle
keyboard area but we still have

00:02:21.246 --> 00:02:22.596 A:middle
the application icons down at

00:02:22.596 --> 00:02:23.086 A:middle
the bottom.

00:02:24.336 --> 00:02:26.786 A:middle
Now users can scroll this

00:02:26.786 --> 00:02:28.736 A:middle
application list left and right

00:02:29.276 --> 00:02:30.666 A:middle
to quickly find the application

00:02:30.666 --> 00:02:31.266 A:middle
they want to launch.

00:02:32.526 --> 00:02:33.566 A:middle
We've also divided the strip

00:02:33.566 --> 00:02:34.766 A:middle
into two different sections, as

00:02:34.766 --> 00:02:35.426 A:middle
you can see up here.

00:02:36.146 --> 00:02:37.856 A:middle
The left-hand side we have the

00:02:37.856 --> 00:02:39.686 A:middle
users favorite section which is

00:02:39.766 --> 00:02:41.286 A:middle
ordered by the user, and on the

00:02:41.286 --> 00:02:43.466 A:middle
right-hand side we have the most

00:02:43.466 --> 00:02:45.076 A:middle
recently used applications.

00:02:46.276 --> 00:02:48.946 A:middle
So users can also rearrange

00:02:48.946 --> 00:02:50.186 A:middle
their applications out of the

00:02:50.186 --> 00:02:51.436 A:middle
recent section and into their

00:02:51.436 --> 00:02:53.616 A:middle
favorites for easy use and for

00:02:53.616 --> 00:02:55.286 A:middle
accessibility right when they

00:02:55.286 --> 00:02:56.346 A:middle
enter the conversation.

00:02:56.536 --> 00:02:57.746 A:middle
So we think this is a great way

00:02:58.016 --> 00:02:59.156 A:middle
for users to enter a

00:02:59.156 --> 00:03:00.726 A:middle
conversation, tap the app they

00:02:59.156 --> 00:03:00.726 A:middle
conversation, tap the app they

00:03:00.726 --> 00:03:02.926 A:middle
want and be able to use your

00:03:02.926 --> 00:03:04.226 A:middle
application immediately.

00:03:04.846 --> 00:03:07.956 A:middle
One really cool change their

00:03:07.956 --> 00:03:10.216 A:middle
making this year revolves around

00:03:10.216 --> 00:03:11.956 A:middle
how we handle app installations.

00:03:12.476 --> 00:03:14.676 A:middle
So now in iOS 11 if you download

00:03:14.676 --> 00:03:16.146 A:middle
an application from the iMessage

00:03:16.146 --> 00:03:18.366 A:middle
app store or you download from

00:03:18.366 --> 00:03:20.096 A:middle
our primary app store we will

00:03:20.096 --> 00:03:22.216 A:middle
enable your application by

00:03:22.216 --> 00:03:24.036 A:middle
default and the Messages app

00:03:24.036 --> 00:03:24.246 A:middle
drawer.

00:03:25.036 --> 00:03:25.696 A:middle
In addition --

00:03:26.516 --> 00:03:28.896 A:middle
[ Applause ]

00:03:29.396 --> 00:03:30.626 A:middle
So in addition, we will order

00:03:30.626 --> 00:03:32.396 A:middle
your applications icon to the

00:03:32.396 --> 00:03:34.186 A:middle
very first item in the most

00:03:34.186 --> 00:03:35.916 A:middle
recently used apps so users can

00:03:35.916 --> 00:03:37.876 A:middle
find it easily and launch the

00:03:37.876 --> 00:03:39.356 A:middle
application immediately.

00:03:39.596 --> 00:03:41.236 A:middle
So there's just a couple changes

00:03:41.286 --> 00:03:42.846 A:middle
that we have for the Messages

00:03:42.846 --> 00:03:43.296 A:middle
app UI.

00:03:43.406 --> 00:03:45.366 A:middle
A lot of it you guys have today.

00:03:45.696 --> 00:03:50.226 A:middle
Next up we have our brand new

00:03:50.226 --> 00:03:51.856 A:middle
Direct Send API.

00:03:51.976 --> 00:03:53.256 A:middle
We're super excited to share

00:03:53.256 --> 00:03:53.926 A:middle
this with all of you.

00:03:54.486 --> 00:03:58.656 A:middle
So in iOS 10, the only way to

00:03:58.656 --> 00:03:59.706 A:middle
share content out of your

00:03:59.706 --> 00:04:01.666 A:middle
Messages app would be to call an

00:03:59.706 --> 00:04:01.666 A:middle
Messages app would be to call an

00:04:01.666 --> 00:04:03.816 A:middle
insert API which puts your

00:04:03.816 --> 00:04:07.346 A:middle
message into the Messages entry

00:04:07.346 --> 00:04:08.066 A:middle
view.

00:04:08.846 --> 00:04:09.806 A:middle
And so while this works great

00:04:09.806 --> 00:04:11.466 A:middle
for many applications, for some

00:04:11.466 --> 00:04:12.956 A:middle
user experiences like this game

00:04:13.396 --> 00:04:14.656 A:middle
when the users say makes the

00:04:14.656 --> 00:04:16.856 A:middle
game move next logical step

00:04:16.995 --> 00:04:18.606 A:middle
would probably be the message

00:04:18.745 --> 00:04:19.896 A:middle
actually being sent and

00:04:19.966 --> 00:04:21.266 A:middle
inserting that message into the

00:04:21.266 --> 00:04:23.156 A:middle
entry view kind of adds an extra

00:04:23.156 --> 00:04:23.496 A:middle
tap.

00:04:23.616 --> 00:04:25.536 A:middle
So we thought this year how can

00:04:25.536 --> 00:04:26.776 A:middle
we make this easier, how can we

00:04:26.776 --> 00:04:28.386 A:middle
make this a better user

00:04:28.386 --> 00:04:29.096 A:middle
experience?

00:04:29.596 --> 00:04:32.656 A:middle
So in iOS 11 you can send any

00:04:32.656 --> 00:04:34.196 A:middle
content that you would have

00:04:34.326 --> 00:04:35.206 A:middle
normally inserted into the

00:04:35.206 --> 00:04:37.196 A:middle
Messages entry view directly

00:04:37.286 --> 00:04:38.066 A:middle
from your application.

00:04:39.106 --> 00:04:39.906 A:middle
So how does this work?

00:04:40.456 --> 00:04:44.076 A:middle
In iOS 10 we introduced MS

00:04:44.076 --> 00:04:46.006 A:middle
conversation which defined the

00:04:46.006 --> 00:04:47.336 A:middle
following insert APIs.

00:04:47.726 --> 00:04:49.966 A:middle
Insert message ,insert sticker,

00:04:50.506 --> 00:04:53.046 A:middle
insertText, and insertAttachment

00:04:53.086 --> 00:04:54.086 A:middle
which supports any of our

00:04:54.086 --> 00:04:55.316 A:middle
standard Messages attachment

00:04:55.316 --> 00:04:55.556 A:middle
types.

00:04:56.856 --> 00:04:58.876 A:middle
In iOS 11 we have a very simple

00:04:59.456 --> 00:05:01.836 A:middle
analogist API called Send

00:04:59.456 --> 00:05:01.836 A:middle
analogist API called Send

00:05:01.836 --> 00:05:04.076 A:middle
Message, Send Sticker, Send

00:05:04.076 --> 00:05:05.886 A:middle
Text, and Send Attachment.

00:05:06.416 --> 00:05:07.836 A:middle
So calling into anyone of these

00:05:07.836 --> 00:05:09.356 A:middle
will bypass the Messages entry

00:05:09.356 --> 00:05:11.686 A:middle
view and insert -- send you a

00:05:11.686 --> 00:05:13.136 A:middle
message immediately in the

00:05:13.136 --> 00:05:13.886 A:middle
conversation.

00:05:14.306 --> 00:05:16.806 A:middle
So really quick and easy API.

00:05:17.516 --> 00:05:22.076 A:middle
[ Applause ]

00:05:22.576 --> 00:05:24.986 A:middle
So you may ask which API --

00:05:25.176 --> 00:05:27.266 A:middle
which user experience is best

00:05:27.426 --> 00:05:29.596 A:middle
for my application, both Insert

00:05:29.596 --> 00:05:32.356 A:middle
Draft and Send Message APIs are

00:05:32.356 --> 00:05:34.496 A:middle
first party citizens in iOS 11,

00:05:34.816 --> 00:05:35.876 A:middle
and it's up to you to decide

00:05:35.876 --> 00:05:36.646 A:middle
which one is best for your

00:05:36.646 --> 00:05:37.186 A:middle
application.

00:05:37.826 --> 00:05:42.216 A:middle
So the Insert Draft API is still

00:05:42.316 --> 00:05:43.746 A:middle
the recommended API for most

00:05:43.746 --> 00:05:45.596 A:middle
applications as it allows for

00:05:45.596 --> 00:05:47.346 A:middle
richer composition experience.

00:05:47.446 --> 00:05:49.016 A:middle
For example, user can insert a

00:05:49.016 --> 00:05:50.776 A:middle
message and then say append a

00:05:50.776 --> 00:05:51.636 A:middle
comment to the end of the

00:05:51.636 --> 00:05:53.766 A:middle
message, or send with a screen

00:05:53.766 --> 00:05:55.336 A:middle
effect or a full screen moment.

00:05:55.906 --> 00:05:57.546 A:middle
So it's a really great way to

00:05:57.546 --> 00:05:58.946 A:middle
enrich the content that you

00:05:58.946 --> 00:05:59.936 A:middle
would already be sending.

00:06:00.146 --> 00:06:02.416 A:middle
In addition, it gives the user

00:06:02.416 --> 00:06:04.576 A:middle
an opportunity to verify the

00:06:04.576 --> 00:06:05.896 A:middle
content that will be sent which

00:06:05.896 --> 00:06:06.796 A:middle
is extremely important.

00:06:07.336 --> 00:06:10.816 A:middle
On the other hand, Direct Send

00:06:10.816 --> 00:06:13.216 A:middle
API offers a superfast quick and

00:06:13.216 --> 00:06:14.226 A:middle
easy user experience that's

00:06:14.286 --> 00:06:16.496 A:middle
great for, say, games and stuff

00:06:16.496 --> 00:06:17.186 A:middle
like we saw above.

00:06:18.186 --> 00:06:19.766 A:middle
So it's great for any

00:06:19.766 --> 00:06:22.676 A:middle
application where the insert

00:06:22.676 --> 00:06:25.076 A:middle
flow has tapping the entry view

00:06:25.076 --> 00:06:26.846 A:middle
button feel like an extra step

00:06:26.846 --> 00:06:27.766 A:middle
that you really don't need.

00:06:29.156 --> 00:06:31.396 A:middle
However, when using this API it

00:06:31.396 --> 00:06:32.746 A:middle
is extremely important to

00:06:32.746 --> 00:06:34.036 A:middle
maintain user trust in your

00:06:34.036 --> 00:06:34.716 A:middle
application.

00:06:35.016 --> 00:06:36.656 A:middle
So it's important to very

00:06:36.656 --> 00:06:38.126 A:middle
clearly indicate to the user

00:06:38.436 --> 00:06:39.956 A:middle
exactly what content is going to

00:06:39.956 --> 00:06:42.226 A:middle
be sent and also to clearly

00:06:42.226 --> 00:06:44.446 A:middle
denote to the user exactly what

00:06:44.636 --> 00:06:46.366 A:middle
user interaction or interface

00:06:46.366 --> 00:06:47.936 A:middle
element within your application

00:06:48.126 --> 00:06:49.236 A:middle
will trigger send.

00:06:49.236 --> 00:06:52.066 A:middle
So to help promote a great user

00:06:52.066 --> 00:06:53.116 A:middle
experience with a direct send

00:06:53.116 --> 00:06:55.396 A:middle
API Messages enforces a couple

00:06:55.396 --> 00:06:57.286 A:middle
requirements on this APIs use.

00:06:58.546 --> 00:07:00.596 A:middle
Firstly, your application must

00:06:58.546 --> 00:07:00.596 A:middle
Firstly, your application must

00:07:00.596 --> 00:07:02.476 A:middle
be the visible Messages app on

00:07:02.516 --> 00:07:03.016 A:middle
screen.

00:07:03.016 --> 00:07:05.116 A:middle
As you may know, your Messages

00:07:05.116 --> 00:07:06.776 A:middle
app extension may be running in

00:07:06.776 --> 00:07:08.396 A:middle
the background within Messages

00:07:08.396 --> 00:07:10.296 A:middle
and not actually be the current

00:07:10.346 --> 00:07:11.336 A:middle
foreground application.

00:07:11.386 --> 00:07:13.266 A:middle
So first requirement is your

00:07:13.266 --> 00:07:14.476 A:middle
application must be visible.

00:07:15.776 --> 00:07:19.186 A:middle
In addition, our target user

00:07:19.186 --> 00:07:20.776 A:middle
experience for this is to have

00:07:20.776 --> 00:07:22.956 A:middle
the user tap the screen or

00:07:22.956 --> 00:07:24.206 A:middle
interact with your application

00:07:24.566 --> 00:07:25.536 A:middle
and then to have a send be

00:07:25.536 --> 00:07:25.996 A:middle
triggered.

00:07:26.566 --> 00:07:28.696 A:middle
So to facilitate this, Messages

00:07:28.696 --> 00:07:30.706 A:middle
will detect user interaction on

00:07:30.706 --> 00:07:32.436 A:middle
your app and allow for a direct

00:07:32.526 --> 00:07:34.656 A:middle
send API call to be made upon

00:07:34.656 --> 00:07:36.156 A:middle
detection of that user

00:07:36.156 --> 00:07:36.786 A:middle
interaction.

00:07:37.556 --> 00:07:39.116 A:middle
Subsequent direct send calls

00:07:39.116 --> 00:07:40.836 A:middle
will fail until we detect

00:07:40.916 --> 00:07:42.636 A:middle
another user interaction, so

00:07:42.806 --> 00:07:44.956 A:middle
kind of keeping with one-to-one

00:07:45.046 --> 00:07:46.186 A:middle
the user press something on your

00:07:46.186 --> 00:07:47.966 A:middle
screen and a send is allowed.

00:07:48.896 --> 00:07:51.406 A:middle
So to help you as developers

00:07:51.406 --> 00:07:52.776 A:middle
understand what's happening with

00:07:52.776 --> 00:07:54.806 A:middle
the send API, we are introducing

00:07:55.016 --> 00:07:57.976 A:middle
two new air codes, MSMessage air

00:07:57.976 --> 00:07:58.346 A:middle
codes.

00:07:58.346 --> 00:07:58.696 A:middle
We have

00:07:58.786 --> 00:08:00.606 A:middle
sendwithoutRecentInteraction and

00:07:58.786 --> 00:08:00.606 A:middle
sendwithoutRecentInteraction and

00:08:00.666 --> 00:08:02.286 A:middle
sendwhileNotVisible.

00:08:02.566 --> 00:08:04.226 A:middle
So as always, use great air

00:08:04.226 --> 00:08:06.666 A:middle
handling so your application can

00:08:06.666 --> 00:08:07.596 A:middle
catch these dates.

00:08:10.046 --> 00:08:10.916 A:middle
And that's Direct Send.

00:08:11.266 --> 00:08:12.036 A:middle
It's very simple.

00:08:12.036 --> 00:08:13.186 A:middle
I think it's going to be a great

00:08:13.186 --> 00:08:14.626 A:middle
user experience for the apps

00:08:14.716 --> 00:08:15.626 A:middle
where it makes sense for.

00:08:15.626 --> 00:08:17.146 A:middle
Definitely consider whether

00:08:17.146 --> 00:08:20.376 A:middle
Insert Draft or Send makes the

00:08:20.376 --> 00:08:21.436 A:middle
most sense for your application,

00:08:21.436 --> 00:08:22.566 A:middle
and we're very excited to see

00:08:22.566 --> 00:08:26.416 A:middle
what you-guys can build with it.

00:08:26.676 --> 00:08:27.246 A:middle
All right.

00:08:27.386 --> 00:08:28.846 A:middle
So next I'd like to invite

00:08:28.846 --> 00:08:31.656 A:middle
Stephen up stage to introduce

00:08:31.656 --> 00:08:32.926 A:middle
you to Live Message Layouts.

00:08:34.515 --> 00:08:38.916 A:middle
[ Applause ]

00:08:39.416 --> 00:08:40.306 A:middle
&gt;&gt; Hi everyone.

00:08:41.086 --> 00:08:44.285 A:middle
So today I'm excited to return

00:08:44.285 --> 00:08:45.436 A:middle
to the stage to you to talk to

00:08:45.436 --> 00:08:46.816 A:middle
you about Live Message Layouts.

00:08:47.566 --> 00:08:50.346 A:middle
Now in iOS 10 we introduced

00:08:50.346 --> 00:08:51.346 A:middle
Messages framework and the

00:08:51.346 --> 00:08:53.046 A:middle
ability for you to bring your

00:08:53.046 --> 00:08:54.166 A:middle
app experience right into

00:08:54.166 --> 00:08:54.616 A:middle
Messages.

00:08:55.306 --> 00:08:58.556 A:middle
When you would build your

00:08:58.556 --> 00:09:01.166 A:middle
iMessage app, your app could be

00:08:58.556 --> 00:09:01.166 A:middle
iMessage app, your app could be

00:09:01.166 --> 00:09:02.936 A:middle
shown here in the keyboard area

00:09:02.996 --> 00:09:04.616 A:middle
in Messages or in a full screen

00:09:04.616 --> 00:09:05.646 A:middle
presentation, and these would be

00:09:05.646 --> 00:09:06.856 A:middle
the compact and expanded

00:09:06.856 --> 00:09:07.886 A:middle
presentation styles that you

00:09:07.886 --> 00:09:08.236 A:middle
could use.

00:09:09.296 --> 00:09:10.226 A:middle
And then when you would send the

00:09:10.226 --> 00:09:12.016 A:middle
message your app would use a

00:09:12.016 --> 00:09:13.856 A:middle
template driven -- or we would

00:09:13.856 --> 00:09:15.016 A:middle
use a template driven layout

00:09:15.016 --> 00:09:16.376 A:middle
approach for your app message.

00:09:16.926 --> 00:09:18.056 A:middle
Now this template layout had

00:09:18.056 --> 00:09:20.546 A:middle
customization objects or options

00:09:21.116 --> 00:09:23.296 A:middle
such as image and the text

00:09:23.296 --> 00:09:25.736 A:middle
properties here, and it allowed

00:09:25.736 --> 00:09:27.116 A:middle
you to provide some pretty good

00:09:27.116 --> 00:09:29.586 A:middle
rich app messages, however, it's

00:09:29.586 --> 00:09:30.546 A:middle
still limited by what the

00:09:30.546 --> 00:09:31.276 A:middle
template provides.

00:09:32.736 --> 00:09:33.996 A:middle
In iOS 11, I'm excited to

00:09:33.996 --> 00:09:35.316 A:middle
announce that you can now

00:09:35.586 --> 00:09:37.486 A:middle
completely customize what your

00:09:37.486 --> 00:09:39.256 A:middle
app messages look like using

00:09:39.686 --> 00:09:40.566 A:middle
these liveLayouts.

00:09:41.276 --> 00:09:43.896 A:middle
So this is actually a view

00:09:43.896 --> 00:09:45.166 A:middle
provided by the application

00:09:45.166 --> 00:09:46.586 A:middle
itself here in the Messages

00:09:46.586 --> 00:09:47.086 A:middle
transcript.

00:09:47.536 --> 00:09:50.156 A:middle
The app could also drive a view

00:09:50.356 --> 00:09:53.326 A:middle
as a draft message, and in fact

00:09:53.326 --> 00:09:55.106 A:middle
can provide custom views to

00:09:55.186 --> 00:09:56.426 A:middle
represent many messages

00:09:56.546 --> 00:09:57.456 A:middle
simultaneously in the

00:09:57.456 --> 00:09:57.936 A:middle
transcript.

00:09:58.446 --> 00:10:01.156 A:middle
Of course we support the world

00:09:58.446 --> 00:10:01.156 A:middle
Of course we support the world

00:10:01.156 --> 00:10:02.456 A:middle
where maybe your app isn't the

00:10:02.456 --> 00:10:05.126 A:middle
only one on screen, but really

00:10:05.126 --> 00:10:06.106 A:middle
we only care about your app.

00:10:06.546 --> 00:10:07.336 A:middle
We're here to talk to you about

00:10:07.336 --> 00:10:07.706 A:middle
that today.

00:10:10.516 --> 00:10:12.136 A:middle
So I'd like to give you a quick

00:10:12.136 --> 00:10:14.536 A:middle
demo of what that looks like in

00:10:14.536 --> 00:10:14.916 A:middle
action.

00:10:15.966 --> 00:10:18.126 A:middle
So here I have a simple iMessage

00:10:18.126 --> 00:10:20.196 A:middle
app that I've built called Event

00:10:20.196 --> 00:10:22.196 A:middle
Countdown, and this is just a

00:10:22.196 --> 00:10:23.716 A:middle
simple list of upcoming events

00:10:23.716 --> 00:10:25.586 A:middle
that I'm excited about and want

00:10:25.586 --> 00:10:26.686 A:middle
to share with my friends via

00:10:26.686 --> 00:10:27.146 A:middle
Messages.

00:10:27.846 --> 00:10:30.026 A:middle
So for example, if I tap the

00:10:30.026 --> 00:10:32.836 A:middle
batch here you'll see a

00:10:32.836 --> 00:10:34.176 A:middle
completely custom message is

00:10:34.296 --> 00:10:35.316 A:middle
presented here as a draft

00:10:35.316 --> 00:10:35.796 A:middle
message.

00:10:36.396 --> 00:10:37.666 A:middle
It's live updating, it has this

00:10:37.666 --> 00:10:38.896 A:middle
great countdown that's building

00:10:38.896 --> 00:10:40.226 A:middle
anticipation for the upcoming

00:10:40.226 --> 00:10:40.566 A:middle
event.

00:10:40.666 --> 00:10:42.916 A:middle
And when I send it, that same

00:10:42.916 --> 00:10:44.486 A:middle
view is put in the transcript

00:10:45.176 --> 00:10:46.066 A:middle
that would be seen on the other

00:10:46.066 --> 00:10:46.386 A:middle
side.

00:10:46.846 --> 00:10:49.206 A:middle
In fact, if we go into the

00:10:49.206 --> 00:10:51.616 A:middle
recipient side or to see what a

00:10:51.616 --> 00:10:53.316 A:middle
recipient might have sent or the

00:10:53.356 --> 00:10:56.656 A:middle
other side might have sent, here

00:10:56.656 --> 00:10:58.046 A:middle
I have an invitation from

00:10:58.046 --> 00:10:58.476 A:middle
Eugene.

00:10:59.766 --> 00:11:00.976 A:middle
This is a similar app message,

00:10:59.766 --> 00:11:00.976 A:middle
This is a similar app message,

00:11:00.976 --> 00:11:02.746 A:middle
but my iMessage app has chosen

00:11:03.176 --> 00:11:04.626 A:middle
to render a completely different

00:11:04.626 --> 00:11:05.916 A:middle
view on the receiver side.

00:11:06.746 --> 00:11:08.296 A:middle
I'm representing an unaccepted

00:11:08.296 --> 00:11:09.416 A:middle
invitation at this point.

00:11:10.696 --> 00:11:12.396 A:middle
If I tap this app message bubble

00:11:12.396 --> 00:11:15.286 A:middle
here, I mark the event as

00:11:15.286 --> 00:11:17.536 A:middle
accepted and now it switches to

00:11:17.536 --> 00:11:19.106 A:middle
that live countdown mode.

00:11:19.686 --> 00:11:21.596 A:middle
I was able to do all that

00:11:21.596 --> 00:11:23.406 A:middle
without even having to launch my

00:11:23.406 --> 00:11:24.946 A:middle
iMessage app in this context.

00:11:24.946 --> 00:11:28.556 A:middle
Now here in the top right I have

00:11:28.556 --> 00:11:29.556 A:middle
a little infoButton.

00:11:30.426 --> 00:11:31.796 A:middle
Not all experiences are

00:11:31.796 --> 00:11:33.136 A:middle
appropriate to try to shove into

00:11:33.136 --> 00:11:33.836 A:middle
an app message.

00:11:35.276 --> 00:11:37.156 A:middle
By tapping this infoButton, I

00:11:37.156 --> 00:11:39.136 A:middle
can actually request that my app

00:11:39.136 --> 00:11:40.196 A:middle
be presented in a different

00:11:40.196 --> 00:11:42.326 A:middle
presentation style to see more

00:11:42.326 --> 00:11:44.126 A:middle
information about my event.

00:11:46.676 --> 00:11:48.396 A:middle
So I hope you can see that here

00:11:48.446 --> 00:11:49.666 A:middle
with Live Message Layouts you

00:11:49.666 --> 00:11:51.526 A:middle
can build a really rich user

00:11:51.526 --> 00:11:53.166 A:middle
experience, complete with

00:11:53.166 --> 00:11:54.616 A:middle
interactions and live updating

00:11:54.616 --> 00:11:56.536 A:middle
content, and it's really easy to

00:11:56.876 --> 00:11:56.946 A:middle
do.

00:12:02.176 --> 00:12:03.116 A:middle
So let's talk about how this

00:12:03.116 --> 00:12:03.386 A:middle
works.

00:12:04.116 --> 00:12:07.366 A:middle
So here when the iMessage app is

00:12:07.366 --> 00:12:08.726 A:middle
being shown in the compact

00:12:08.776 --> 00:12:10.526 A:middle
presentation style, we have

00:12:10.526 --> 00:12:12.726 A:middle
instantiated an instance of the

00:12:12.766 --> 00:12:14.086 A:middle
MSMessages app view controller

00:12:14.166 --> 00:12:15.926 A:middle
subclass and configured it in

00:12:15.926 --> 00:12:17.376 A:middle
the compact presentation style.

00:12:17.376 --> 00:12:20.456 A:middle
When an app message with a

00:12:20.456 --> 00:12:22.106 A:middle
liveLayout is shown on screen,

00:12:22.816 --> 00:12:24.716 A:middle
we'll instantiate another

00:12:24.716 --> 00:12:26.746 A:middle
instance of that same base class

00:12:27.536 --> 00:12:28.286 A:middle
and configure it with a

00:12:28.286 --> 00:12:29.736 A:middle
transcript presentation style.

00:12:30.316 --> 00:12:33.736 A:middle
In fact, for each message

00:12:33.736 --> 00:12:35.156 A:middle
displayed in the transcript we

00:12:36.036 --> 00:12:37.696 A:middle
will instantiate a new instance

00:12:37.966 --> 00:12:40.026 A:middle
of this class configured again

00:12:40.026 --> 00:12:41.256 A:middle
in that transcript presentation

00:12:41.256 --> 00:12:41.566 A:middle
style.

00:12:42.536 --> 00:12:44.006 A:middle
There is a strict one-to-one

00:12:44.526 --> 00:12:46.196 A:middle
relationship between these

00:12:46.196 --> 00:12:48.066 A:middle
instances and an app message

00:12:48.066 --> 00:12:51.346 A:middle
that they represent on screen.

00:12:51.586 --> 00:12:53.316 A:middle
So that's a quick overview of

00:12:53.316 --> 00:12:54.246 A:middle
Live Message Layouts.

00:12:55.036 --> 00:12:56.326 A:middle
Now to walk you through more of

00:12:56.326 --> 00:12:57.726 A:middle
the API and how to get started,

00:12:57.726 --> 00:12:59.096 A:middle
I'd like to invite Jay on stage.

00:13:00.516 --> 00:13:04.500 A:middle
[ Applause ]

00:13:11.316 --> 00:13:12.316 A:middle
&gt;&gt; Well thanks, Stephen, for the

00:13:12.316 --> 00:13:12.956 A:middle
introduction.

00:13:13.356 --> 00:13:15.216 A:middle
My name is Jay and I'm here to

00:13:15.216 --> 00:13:16.546 A:middle
introduce to you some of the new

00:13:16.546 --> 00:13:18.506 A:middle
APIs we've added for Live

00:13:18.506 --> 00:13:19.156 A:middle
Message Layout.

00:13:19.216 --> 00:13:21.706 A:middle
So let's get started.

00:13:26.046 --> 00:13:27.266 A:middle
As some of you may be familiar,

00:13:27.826 --> 00:13:29.116 A:middle
you were able to customize your

00:13:29.116 --> 00:13:30.196 A:middle
app bubble using

00:13:30.256 --> 00:13:31.246 A:middle
MSMessageLayout.

00:13:32.296 --> 00:13:34.416 A:middle
With existing MSMessage template

00:13:34.416 --> 00:13:35.916 A:middle
layout you're only able to

00:13:35.916 --> 00:13:37.296 A:middle
customize a limited set of

00:13:37.296 --> 00:13:39.896 A:middle
appearances such as captions and

00:13:39.896 --> 00:13:40.366 A:middle
images.

00:13:40.936 --> 00:13:44.716 A:middle
In iOS 11, to support a fully

00:13:44.716 --> 00:13:47.056 A:middle
customizable bubble we're adding

00:13:47.236 --> 00:13:48.166 A:middle
a new subclass

00:13:49.996 --> 00:13:51.876 A:middle
MSMessageLiveLayout.

00:13:51.876 --> 00:13:54.676 A:middle
So let's take look at this real

00:13:54.676 --> 00:13:54.876 A:middle
quick.

00:13:58.756 --> 00:14:00.676 A:middle
As you can see, there aren't

00:13:58.756 --> 00:14:00.676 A:middle
As you can see, there aren't

00:14:00.676 --> 00:14:02.486 A:middle
that many things to fill out as

00:14:02.486 --> 00:14:03.676 A:middle
you have to do for the template

00:14:03.676 --> 00:14:04.056 A:middle
layout.

00:14:05.546 --> 00:14:08.546 A:middle
Well that's because now you have

00:14:08.576 --> 00:14:10.536 A:middle
the opportunity to fully express

00:14:10.766 --> 00:14:11.846 A:middle
how these app bubbles should

00:14:11.846 --> 00:14:12.906 A:middle
look like.

00:14:13.716 --> 00:14:15.606 A:middle
Though you may have noticed that

00:14:15.676 --> 00:14:17.076 A:middle
there is one property called

00:14:17.076 --> 00:14:20.866 A:middle
Alternate Layout and so what is

00:14:22.996 --> 00:14:23.096 A:middle
this?

00:14:23.306 --> 00:14:24.266 A:middle
Now there will be a few

00:14:24.266 --> 00:14:26.826 A:middle
instances where your app bubble

00:14:26.826 --> 00:14:28.086 A:middle
won't be supported by the

00:14:28.086 --> 00:14:29.056 A:middle
receiving devices.

00:14:30.026 --> 00:14:32.336 A:middle
In cases such as they don't have

00:14:32.336 --> 00:14:34.666 A:middle
your extension installed or

00:14:34.666 --> 00:14:35.796 A:middle
they're just running on older

00:14:35.866 --> 00:14:39.566 A:middle
Apple iOS versions, iOS, macOS,

00:14:39.566 --> 00:14:40.406 A:middle
or watchOS.

00:14:41.636 --> 00:14:45.156 A:middle
So in these scenarios, they'll

00:14:45.216 --> 00:14:48.366 A:middle
be seeing this template layout

00:14:48.626 --> 00:14:51.166 A:middle
as a fallback representation by

00:14:51.356 --> 00:14:52.456 A:middle
if they can actually support

00:14:52.456 --> 00:14:54.856 A:middle
their extension then they'll be

00:14:54.856 --> 00:14:56.866 A:middle
seeing the bubble on the right.

00:14:57.576 --> 00:15:01.716 A:middle
So how do we use this API?

00:14:57.576 --> 00:15:01.716 A:middle
So how do we use this API?

00:15:01.946 --> 00:15:04.016 A:middle
It's very similar to how you did

00:15:04.016 --> 00:15:04.836 A:middle
in iOS 10.

00:15:05.716 --> 00:15:07.696 A:middle
First, create the template

00:15:07.696 --> 00:15:08.096 A:middle
layout.

00:15:09.316 --> 00:15:10.336 A:middle
And with a template layout

00:15:10.776 --> 00:15:11.486 A:middle
you're going to create

00:15:11.606 --> 00:15:12.216 A:middle
liveLayout.

00:15:12.806 --> 00:15:17.496 A:middle
And with a liveLayout say it's a

00:15:17.756 --> 00:15:19.576 A:middle
message and send.

00:15:19.736 --> 00:15:21.616 A:middle
So really similar to what we did

00:15:21.616 --> 00:15:25.706 A:middle
in iOS 10.

00:15:25.896 --> 00:15:28.216 A:middle
So that was it for the

00:15:28.396 --> 00:15:29.556 A:middle
MSMessageLiveLayout.

00:15:30.466 --> 00:15:31.796 A:middle
We have some new additions in

00:15:31.916 --> 00:15:33.446 A:middle
MSMessagesAppViewController.

00:15:33.446 --> 00:15:36.806 A:middle
Now as some of you may be

00:15:36.806 --> 00:15:42.236 A:middle
familiar, this was the principle

00:15:42.276 --> 00:15:43.406 A:middle
class through extension point.

00:15:44.386 --> 00:15:45.726 A:middle
So by configuring this view

00:15:45.726 --> 00:15:47.486 A:middle
controller you're able to

00:15:47.486 --> 00:15:49.436 A:middle
customize the appearance in your

00:15:49.916 --> 00:15:51.696 A:middle
app in the keyboard area, in the

00:15:51.696 --> 00:15:52.356 A:middle
compact mode.

00:15:52.896 --> 00:15:56.056 A:middle
So the bubbles in the transcript

00:15:56.056 --> 00:15:57.016 A:middle
are also backed by View

00:15:57.016 --> 00:16:00.516 A:middle
Controller, and in fact they

00:15:57.016 --> 00:16:00.516 A:middle
Controller, and in fact they

00:16:00.746 --> 00:16:03.026 A:middle
have the same class.

00:16:03.216 --> 00:16:04.746 A:middle
Okay. So what does this mean?

00:16:06.026 --> 00:16:08.716 A:middle
That means that this view right

00:16:08.716 --> 00:16:12.386 A:middle
here in the bottom and that view

00:16:12.386 --> 00:16:14.186 A:middle
on the top are coming from the

00:16:14.186 --> 00:16:14.766 A:middle
same class.

00:16:16.186 --> 00:16:18.306 A:middle
So to distinguish these two

00:16:18.306 --> 00:16:19.896 A:middle
cases we've added a new

00:16:19.896 --> 00:16:23.366 A:middle
presentation style transcript.

00:16:24.756 --> 00:16:26.836 A:middle
So when it comes time to

00:16:26.836 --> 00:16:27.676 A:middle
configuring these view

00:16:27.676 --> 00:16:30.476 A:middle
controllers, you can use a

00:16:30.476 --> 00:16:32.716 A:middle
combination of presentationStyle

00:16:33.626 --> 00:16:35.946 A:middle
and selectedMessage to determine

00:16:36.246 --> 00:16:37.506 A:middle
what you want to show in your

00:16:37.506 --> 00:16:38.116 A:middle
view controller.

00:16:39.656 --> 00:16:41.696 A:middle
And one really simple pattern

00:16:41.696 --> 00:16:43.636 A:middle
you can follow is something

00:16:43.636 --> 00:16:45.016 A:middle
along the line of path factory

00:16:45.016 --> 00:16:49.386 A:middle
pattern where you can return

00:16:49.476 --> 00:16:50.266 A:middle
appropriate child view

00:16:50.266 --> 00:16:52.586 A:middle
controller depending on the

00:16:52.586 --> 00:16:53.546 A:middle
state of these properties.

00:16:53.546 --> 00:16:54.856 A:middle
So you're going to have one for

00:16:54.856 --> 00:16:58.916 A:middle
transcript and one for compact.

00:17:00.066 --> 00:17:01.486 A:middle
So if you're already following a

00:17:01.486 --> 00:17:05.156 A:middle
similar pattern and code it will

00:17:05.156 --> 00:17:05.955 A:middle
look something like this.

00:17:07.165 --> 00:17:10.016 A:middle
So for the compact case we have

00:17:10.016 --> 00:17:10.806 A:middle
a helper method

00:17:11.806 --> 00:17:14.106 A:middle
presentSummaryViewController and

00:17:14.106 --> 00:17:16.106 A:middle
this helper method you will

00:17:16.106 --> 00:17:16.986 A:middle
create the right child view

00:17:16.986 --> 00:17:18.965 A:middle
controller and configure a view

00:17:18.965 --> 00:17:20.136 A:middle
controller appropriately.

00:17:20.726 --> 00:17:24.126 A:middle
For the case of expanded, you'll

00:17:24.126 --> 00:17:25.646 A:middle
have another helper method

00:17:26.596 --> 00:17:28.226 A:middle
presentDetailViewController and

00:17:28.465 --> 00:17:29.796 A:middle
will do something very similar

00:17:29.796 --> 00:17:31.666 A:middle
to what you did for the compact

00:17:31.666 --> 00:17:31.986 A:middle
case.

00:17:33.126 --> 00:17:34.886 A:middle
So to handle another case for

00:17:34.886 --> 00:17:36.256 A:middle
the transcript, we can just have

00:17:37.676 --> 00:17:39.536 A:middle
another helper method something

00:17:39.536 --> 00:17:40.286 A:middle
along the line of

00:17:40.686 --> 00:17:42.016 A:middle
presentTranscriptViewController.

00:17:47.096 --> 00:17:47.956 A:middle
So that was it for the

00:17:47.956 --> 00:17:50.596 A:middle
presentation style, but we

00:17:50.596 --> 00:17:51.716 A:middle
actually have one more thing to

00:17:51.716 --> 00:17:53.406 A:middle
go over before you get this live

00:17:53.406 --> 00:17:53.966 A:middle
bubble started.

00:17:54.506 --> 00:17:56.616 A:middle
And that is sizing.

00:17:58.066 --> 00:17:59.376 A:middle
Now, the view controllers are

00:17:59.376 --> 00:18:01.556 A:middle
intended to use for transcript

00:17:59.376 --> 00:18:01.556 A:middle
intended to use for transcript

00:18:02.046 --> 00:18:04.006 A:middle
will conform to the new protocol

00:18:04.006 --> 00:18:07.076 A:middle
called MSMessagesAppTranscript

00:18:07.076 --> 00:18:07.846 A:middle
Presentation.

00:18:08.806 --> 00:18:10.436 A:middle
It has one method called

00:18:11.146 --> 00:18:12.226 A:middle
ContentSizeThatFits.

00:18:12.766 --> 00:18:16.796 A:middle
In this function, return a size

00:18:17.366 --> 00:18:19.096 A:middle
that best represents your view

00:18:19.096 --> 00:18:19.796 A:middle
in the transcript.

00:18:21.096 --> 00:18:24.276 A:middle
So to illustrate, here's an

00:18:25.216 --> 00:18:25.536 A:middle
example.

00:18:25.536 --> 00:18:30.206 A:middle
Now, we want our size to always

00:18:30.286 --> 00:18:32.066 A:middle
fit all the sub views nicely

00:18:32.286 --> 00:18:34.236 A:middle
without getting clipped or any

00:18:34.236 --> 00:18:35.586 A:middle
extras base or anything like

00:18:36.266 --> 00:18:36.366 A:middle
that.

00:18:37.126 --> 00:18:39.746 A:middle
For this particular example, we

00:18:39.746 --> 00:18:42.936 A:middle
have the map view timer and the

00:18:43.516 --> 00:18:43.676 A:middle
button.

00:18:43.836 --> 00:18:45.246 A:middle
And we decided that we'd only

00:18:45.246 --> 00:18:47.676 A:middle
care about the size of the map

00:18:47.706 --> 00:18:49.986 A:middle
view or the timer changing, but

00:18:50.146 --> 00:18:52.956 A:middle
we want the button to adjust

00:18:52.956 --> 00:18:55.006 A:middle
accordingly based on the system

00:18:55.006 --> 00:18:55.416 A:middle
font.

00:18:56.586 --> 00:18:57.976 A:middle
So let's give it a static

00:18:57.976 --> 00:19:02.556 A:middle
number, 217, for the map view

00:18:57.976 --> 00:19:02.556 A:middle
number, 217, for the map view

00:19:02.556 --> 00:19:04.626 A:middle
and the timer, and then the line

00:19:04.626 --> 00:19:08.156 A:middle
hide right here will be the size

00:19:08.216 --> 00:19:09.936 A:middle
of the button that takes the

00:19:09.936 --> 00:19:11.906 A:middle
system font into consideration.

00:19:12.476 --> 00:19:15.246 A:middle
So by adding these two numbers

00:19:15.296 --> 00:19:17.726 A:middle
we'll get the right size or the

00:19:17.726 --> 00:19:19.436 A:middle
right height that encompasses

00:19:19.496 --> 00:19:23.136 A:middle
all the sub views in our view.

00:19:23.356 --> 00:19:26.426 A:middle
So with this configuration, I

00:19:26.426 --> 00:19:29.016 A:middle
think the height is about 235

00:19:29.056 --> 00:19:29.456 A:middle
points.

00:19:30.046 --> 00:19:33.786 A:middle
Now keep in mind that this

00:19:33.786 --> 00:19:34.846 A:middle
function will be called again

00:19:35.386 --> 00:19:37.386 A:middle
when there is a change in

00:19:37.756 --> 00:19:39.996 A:middle
transcript size, change in

00:19:39.996 --> 00:19:42.386 A:middle
locale or change in system font.

00:19:43.416 --> 00:19:45.216 A:middle
In these events, these functions

00:19:45.216 --> 00:19:47.026 A:middle
will be called again for a new

00:19:48.006 --> 00:19:48.146 A:middle
size.

00:19:48.936 --> 00:19:51.176 A:middle
So here's an example of change

00:19:51.176 --> 00:19:52.176 A:middle
in system font.

00:19:52.226 --> 00:19:54.046 A:middle
As you can see, the fonts are

00:19:54.046 --> 00:19:54.876 A:middle
slightly bigger.

00:19:55.546 --> 00:19:59.136 A:middle
In this case, we just said that

00:19:59.136 --> 00:20:00.656 A:middle
we didn't care about the map

00:19:59.136 --> 00:20:00.656 A:middle
we didn't care about the map

00:20:00.656 --> 00:20:02.236 A:middle
view or the timer growing or

00:20:02.236 --> 00:20:03.666 A:middle
shrinking so let's look at the

00:20:03.666 --> 00:20:04.746 A:middle
same 217.

00:20:06.036 --> 00:20:07.226 A:middle
But because we're using a

00:20:07.226 --> 00:20:09.636 A:middle
dynamic font for the button, it

00:20:09.636 --> 00:20:11.196 A:middle
automatically picked up a size.

00:20:12.306 --> 00:20:14.756 A:middle
And with this configuration, you

00:20:14.756 --> 00:20:16.866 A:middle
can appropriately return 244.

00:20:18.476 --> 00:20:20.726 A:middle
We'll take this value and resize

00:20:20.726 --> 00:20:21.586 A:middle
your view accordingly.

00:20:25.616 --> 00:20:27.906 A:middle
So that was a lot of talking.

00:20:28.416 --> 00:20:30.416 A:middle
To summarize everything I just

00:20:30.416 --> 00:20:32.196 A:middle
talked about I'd like to show a

00:20:32.196 --> 00:20:33.056 A:middle
quick code demo.

00:20:33.826 --> 00:20:35.246 A:middle
And I know a lot of you-guys are

00:20:35.246 --> 00:20:37.626 A:middle
very eager to be at the bash so

00:20:37.756 --> 00:20:40.226 A:middle
we'll work on a sample app that

00:20:40.226 --> 00:20:42.736 A:middle
shows you a countdown timer to

00:20:42.736 --> 00:20:43.766 A:middle
the bash.

00:20:53.046 --> 00:20:53.556 A:middle
Okay. Cool.

00:20:54.176 --> 00:20:58.216 A:middle
So we have our nice X Code here

00:20:58.396 --> 00:21:01.226 A:middle
and this is the device I have on

00:20:58.396 --> 00:21:01.226 A:middle
and this is the device I have on

00:21:01.226 --> 00:21:02.416 A:middle
the table right now.

00:21:03.836 --> 00:21:05.786 A:middle
So in this demo I'd like to show

00:21:05.786 --> 00:21:07.796 A:middle
how you can extend an existing

00:21:07.876 --> 00:21:10.136 A:middle
iMessage app and start using our

00:21:10.136 --> 00:21:11.256 A:middle
LiveMessageLayout.

00:21:12.606 --> 00:21:14.226 A:middle
So if you remain on iMessage app

00:21:14.386 --> 00:21:15.386 A:middle
it will look something like

00:21:15.426 --> 00:21:15.896 A:middle
this.

00:21:17.166 --> 00:21:18.156 A:middle
So you have an app in the

00:21:18.156 --> 00:21:20.616 A:middle
compact mode and when you're

00:21:20.616 --> 00:21:22.736 A:middle
trying to send it will show a

00:21:22.736 --> 00:21:24.066 A:middle
template layout.

00:21:24.956 --> 00:21:26.726 A:middle
So how about we start using

00:21:26.896 --> 00:21:27.836 A:middle
LiveLayout instead

00:21:27.836 --> 00:21:29.436 A:middle
templateLayout as showing on the

00:21:29.436 --> 00:21:29.936 A:middle
shelf?

00:21:29.936 --> 00:21:33.226 A:middle
So let's get to the code.

00:21:33.866 --> 00:21:36.916 A:middle
And here I'm in

00:21:36.916 --> 00:21:40.166 A:middle
MSMessagesAppViewController sub

00:21:41.836 --> 00:21:41.966 A:middle
class.

00:21:42.156 --> 00:21:43.816 A:middle
And somewhere in this code were

00:21:43.816 --> 00:21:45.106 A:middle
probably creating a template

00:21:45.106 --> 00:21:45.536 A:middle
layout.

00:21:45.576 --> 00:21:51.786 A:middle
So let's look for that.

00:21:52.006 --> 00:21:55.416 A:middle
Found it. So we have this helper

00:21:55.416 --> 00:21:56.796 A:middle
function called sendMessage and

00:21:57.256 --> 00:21:58.386 A:middle
it seems like we are creating

00:21:58.386 --> 00:22:01.686 A:middle
the message, configuring it,

00:21:58.386 --> 00:22:01.686 A:middle
the message, configuring it,

00:22:01.816 --> 00:22:04.536 A:middle
create a templateLayout and then

00:22:04.536 --> 00:22:06.196 A:middle
set that layout to the message

00:22:06.686 --> 00:22:08.096 A:middle
and we're inserting it into the

00:22:08.096 --> 00:22:08.696 A:middle
conversation.

00:22:10.066 --> 00:22:11.866 A:middle
So I think this is a great place

00:22:11.906 --> 00:22:13.696 A:middle
to start using our liveLayout

00:22:13.906 --> 00:22:14.526 A:middle
objects.

00:22:15.666 --> 00:22:17.776 A:middle
So here I'm going to go ahead

00:22:24.476 --> 00:22:25.496 A:middle
and create a liveLayout.

00:22:25.496 --> 00:22:27.496 A:middle
There's the template layout.

00:22:27.496 --> 00:22:31.016 A:middle
And then we can set that as

00:22:31.016 --> 00:22:33.006 A:middle
Messages layout property.

00:22:34.526 --> 00:22:37.296 A:middle
And let's see -- okay.

00:22:38.016 --> 00:22:41.646 A:middle
So with this change you should

00:22:41.646 --> 00:22:42.496 A:middle
be seeing a liveLayout.

00:22:42.496 --> 00:22:44.746 A:middle
And this is definitely a

00:22:44.746 --> 00:22:47.486 A:middle
liveLayout, but this doesn't

00:22:47.486 --> 00:22:48.596 A:middle
look right.

00:22:48.966 --> 00:22:50.086 A:middle
This actually looks exactly like

00:22:50.086 --> 00:22:52.466 A:middle
what you just saw in the compact

00:22:52.466 --> 00:22:52.736 A:middle
mode.

00:22:53.696 --> 00:22:54.386 A:middle
So what went wrong?

00:22:55.846 --> 00:22:56.906 A:middle
Let's get back to the code and

00:22:58.406 --> 00:22:59.806 A:middle
let's try to find out where

00:22:59.806 --> 00:23:02.176 A:middle
we're actually creating this

00:22:59.806 --> 00:23:02.176 A:middle
we're actually creating this

00:23:02.176 --> 00:23:03.906 A:middle
table view controller that you

00:23:03.906 --> 00:23:04.916 A:middle
see in the compact mode.

00:23:06.286 --> 00:23:08.816 A:middle
And a good place to check that

00:23:08.816 --> 00:23:10.936 A:middle
right now, I'm going to go into

00:23:10.936 --> 00:23:13.426 A:middle
willBecomeActive, okay, I see

00:23:13.606 --> 00:23:15.516 A:middle
updatePresentation.

00:23:15.866 --> 00:23:16.916 A:middle
See what this does.

00:23:18.476 --> 00:23:19.236 A:middle
Oh and I see

00:23:19.296 --> 00:23:20.236 A:middle
presentViewController.

00:23:20.826 --> 00:23:26.776 A:middle
Now this seems like a problem

00:23:26.776 --> 00:23:27.246 A:middle
right here.

00:23:28.256 --> 00:23:30.226 A:middle
For anything that is not

00:23:30.226 --> 00:23:31.886 A:middle
expanded we're always creating a

00:23:31.886 --> 00:23:33.866 A:middle
table view controller and, as

00:23:33.866 --> 00:23:36.256 A:middle
mentioned before, the same view

00:23:36.256 --> 00:23:37.466 A:middle
controller class is used for

00:23:37.466 --> 00:23:39.256 A:middle
both transcript, compact and

00:23:39.256 --> 00:23:41.396 A:middle
expanded so we need to handle

00:23:41.396 --> 00:23:43.826 A:middle
case for transcript which is not

00:23:43.826 --> 00:23:44.936 A:middle
supporting this code right now.

00:23:45.556 --> 00:23:47.556 A:middle
I'm going to leave this code as

00:23:47.556 --> 00:23:48.076 A:middle
it is now.

00:23:48.076 --> 00:23:49.166 A:middle
I'm going to create a new

00:23:49.266 --> 00:23:51.726 A:middle
function so they can start

00:23:51.726 --> 00:23:53.626 A:middle
handling this case.

00:23:53.666 --> 00:23:55.056 A:middle
So I have this

00:23:57.756 --> 00:24:03.426 A:middle
presentTranscriptView and I have

00:23:57.756 --> 00:24:03.426 A:middle
presentTranscriptView and I have

00:24:03.426 --> 00:24:04.956 A:middle
this [inaudible], I have to know

00:24:05.096 --> 00:24:07.046 A:middle
if it's for me or if it's

00:24:07.126 --> 00:24:09.076 A:middle
pending because I want to decide

00:24:09.136 --> 00:24:10.576 A:middle
if I need to show the invitation

00:24:10.576 --> 00:24:11.086 A:middle
button or not.

00:24:12.496 --> 00:24:13.456 A:middle
So now that I have this

00:24:13.456 --> 00:24:18.006 A:middle
transcriptView I can go ahead

00:24:18.006 --> 00:24:20.356 A:middle
and add it to a sub view with

00:24:20.746 --> 00:24:21.616 A:middle
the Auto Layout Magic.

00:24:22.196 --> 00:24:25.766 A:middle
Then I have to call this method

00:24:25.766 --> 00:24:26.746 A:middle
somewhere so I'm going to go

00:24:26.746 --> 00:24:27.926 A:middle
back to updatePresentation.

00:24:28.766 --> 00:24:29.266 A:middle
It's right here.

00:24:29.916 --> 00:24:37.206 A:middle
And here I can start configuring

00:24:37.206 --> 00:24:38.926 A:middle
this viewController for

00:24:38.926 --> 00:24:39.496 A:middle
transcript.

00:24:41.576 --> 00:24:43.936 A:middle
TranscriptView, event,

00:24:45.416 --> 00:24:48.016 A:middle
conversation, and for everything

00:24:48.016 --> 00:24:50.456 A:middle
else I'm just going to do what

00:24:50.456 --> 00:24:52.596 A:middle
we've always been doing for

00:24:52.596 --> 00:24:54.426 A:middle
compact and expanded.

00:24:55.176 --> 00:24:57.666 A:middle
Cool. So let's see how this

00:24:57.666 --> 00:24:59.386 A:middle
change will look like.

00:25:00.086 --> 00:25:01.556 A:middle
So with this change you should

00:25:01.556 --> 00:25:03.076 A:middle
always see the event detail in

00:25:03.076 --> 00:25:03.636 A:middle
app bubble.

00:25:04.226 --> 00:25:07.676 A:middle
So it's succeeded.

00:25:07.976 --> 00:25:13.216 A:middle
So I'm going back to our device.

00:25:13.376 --> 00:25:14.846 A:middle
Right. Shut up.

00:25:21.226 --> 00:25:22.866 A:middle
Cool. So I see something now,

00:25:23.606 --> 00:25:27.306 A:middle
but it is kind of big and I

00:25:27.306 --> 00:25:28.196 A:middle
don't know where the map view

00:25:28.786 --> 00:25:31.376 A:middle
went but we're getting there.

00:25:38.486 --> 00:25:39.936 A:middle
As you can see there's like an

00:25:39.936 --> 00:25:41.936 A:middle
awkward wide blue space.

00:25:42.346 --> 00:25:43.976 A:middle
It is definitely bigger than I

00:25:43.976 --> 00:25:44.566 A:middle
expected.

00:25:44.776 --> 00:25:47.696 A:middle
So what went wrong is seems like

00:25:47.696 --> 00:25:49.706 A:middle
we didn't implement content size

00:25:49.706 --> 00:25:52.516 A:middle
that fits the last part of this

00:25:52.516 --> 00:25:53.766 A:middle
liveLayout adoption.

00:25:54.866 --> 00:25:56.206 A:middle
So I'm going to go ahead and

00:25:57.286 --> 00:25:58.286 A:middle
implement that real quick.

00:26:02.596 --> 00:26:04.836 A:middle
And then from the demo, from the

00:26:04.836 --> 00:26:07.606 A:middle
slides, you wanted to height to

00:26:07.606 --> 00:26:14.666 A:middle
be about 217, and then for the

00:26:14.666 --> 00:26:16.326 A:middle
title button you want it to by

00:26:16.326 --> 00:26:18.346 A:middle
dynamic and it was fetched from

00:26:21.456 --> 00:26:26.216 A:middle
transcriptView.titleFont and

00:26:26.216 --> 00:26:26.996 A:middle
then lineHeight.

00:26:31.956 --> 00:26:33.456 A:middle
We want our width to be the

00:26:33.456 --> 00:26:35.426 A:middle
maximum width possible which is

00:26:35.426 --> 00:26:37.796 A:middle
the path and size parameter so

00:26:37.796 --> 00:26:39.466 A:middle
we can just return the exact

00:26:39.466 --> 00:26:39.886 A:middle
value.

00:26:40.366 --> 00:26:45.866 A:middle
And then for the height, we can

00:26:46.566 --> 00:26:47.636 A:middle
add these two values.

00:26:48.306 --> 00:26:53.286 A:middle
And this would be a good size to

00:26:53.286 --> 00:26:54.346 A:middle
return two messages.

00:26:55.496 --> 00:26:56.376 A:middle
So let's see how that looks

00:26:56.376 --> 00:26:56.566 A:middle
like.

00:27:03.156 --> 00:27:03.396 A:middle
Okay.

00:27:13.556 --> 00:27:14.496 A:middle
So it's loaded.

00:27:14.496 --> 00:27:15.476 A:middle
Much better.

00:27:17.296 --> 00:27:20.286 A:middle
This is what we saw in the demo.

00:27:20.776 --> 00:27:22.816 A:middle
Nice little size with the events

00:27:23.396 --> 00:27:24.756 A:middle
and the timer ticking.

00:27:24.846 --> 00:27:26.426 A:middle
We only have like an hour and

00:27:26.426 --> 00:27:27.616 A:middle
twenty minutes until bash, so

00:27:28.106 --> 00:27:28.646 A:middle
hang in there.

00:27:29.266 --> 00:27:33.276 A:middle
So I'm going to send this.

00:27:33.496 --> 00:27:34.066 A:middle
There we go.

00:27:34.306 --> 00:27:36.666 A:middle
It's in a transcript live and

00:27:36.666 --> 00:27:37.386 A:middle
the timer's ticking.

00:27:38.436 --> 00:27:40.356 A:middle
So this was a quick demo to how

00:27:40.356 --> 00:27:42.696 A:middle
to adopt Live Message Layout.

00:27:43.256 --> 00:27:44.656 A:middle
So let's talk more about some of

00:27:44.656 --> 00:27:45.806 A:middle
the interactions in

00:27:45.806 --> 00:27:46.876 A:middle
viewControlLifecycle.

00:27:47.606 --> 00:27:48.686 A:middle
I would actually like to bring

00:27:48.686 --> 00:27:50.596 A:middle
Stephen back on stage to talk

00:27:50.596 --> 00:27:51.046 A:middle
more about it.

00:27:52.516 --> 00:27:56.500 A:middle
[ Applause ]

00:28:03.216 --> 00:28:04.736 A:middle
Thank you Jay.

00:28:08.476 --> 00:28:09.336 A:middle
All right.

00:28:10.536 --> 00:28:14.786 A:middle
So, now we've seen a little bit

00:28:14.786 --> 00:28:15.976 A:middle
of an introduction of what it

00:28:15.976 --> 00:28:17.686 A:middle
looks like to use the new API,

00:28:17.846 --> 00:28:19.166 A:middle
to use Live Message Layouts in

00:28:19.166 --> 00:28:19.906 A:middle
your iMessage app.

00:28:20.846 --> 00:28:22.266 A:middle
If you'll think back to the demo

00:28:22.266 --> 00:28:23.186 A:middle
I did at the beginning of the

00:28:23.186 --> 00:28:25.106 A:middle
session, we had some interactive

00:28:25.546 --> 00:28:26.926 A:middle
elements to our iMessage app

00:28:27.036 --> 00:28:27.466 A:middle
bubbles.

00:28:28.956 --> 00:28:30.196 A:middle
And so I'd actually like to

00:28:30.196 --> 00:28:32.226 A:middle
return to Xcode now to do just

00:28:32.946 --> 00:28:33.046 A:middle
that.

00:28:34.196 --> 00:28:35.656 A:middle
So return to my device here.

00:28:37.256 --> 00:28:38.436 A:middle
We're going to go back to Xcode

00:28:38.436 --> 00:28:39.286 A:middle
just where we left off.

00:28:39.956 --> 00:28:42.186 A:middle
And I'm going to get my device

00:28:42.186 --> 00:28:45.276 A:middle
ready for this demo.

00:28:45.276 --> 00:28:45.796 A:middle
Excellent.

00:28:46.416 --> 00:28:49.056 A:middle
Okay. So the first thing we want

00:28:49.056 --> 00:28:50.656 A:middle
to do is here we have this

00:28:50.696 --> 00:28:52.576 A:middle
EventCountdownTranscriptView and

00:28:52.576 --> 00:28:53.416 A:middle
that's the view that gets

00:28:53.416 --> 00:28:55.686 A:middle
imbedded in that app message in

00:28:55.686 --> 00:28:57.926 A:middle
the transcript and so we want to

00:28:57.926 --> 00:28:59.126 A:middle
configure that with some inner

00:28:59.126 --> 00:28:59.636 A:middle
activity.

00:28:59.726 --> 00:29:01.986 A:middle
So I'm going to go ahead and

00:28:59.726 --> 00:29:01.986 A:middle
So I'm going to go ahead and

00:29:01.986 --> 00:29:03.086 A:middle
jump into that class and you'll

00:29:03.166 --> 00:29:04.176 A:middle
see that I have a number of

00:29:04.176 --> 00:29:05.586 A:middle
properties here that are

00:29:05.586 --> 00:29:08.046 A:middle
configured, and here in

00:29:08.046 --> 00:29:09.806 A:middle
setupSubviews I have a tap

00:29:09.806 --> 00:29:11.596 A:middle
adjuster recognizer that's set

00:29:11.596 --> 00:29:13.306 A:middle
up so that when the user taps my

00:29:13.306 --> 00:29:15.346 A:middle
view this method user to tap

00:29:15.346 --> 00:29:15.786 A:middle
gets called.

00:29:15.786 --> 00:29:19.286 A:middle
If I jump to the implementation,

00:29:19.786 --> 00:29:21.476 A:middle
of course the implementation

00:29:21.476 --> 00:29:22.526 A:middle
right now is empty and it's

00:29:22.526 --> 00:29:23.726 A:middle
ready for us to add something.

00:29:24.276 --> 00:29:27.496 A:middle
So the inner activity we'll want

00:29:27.496 --> 00:29:29.236 A:middle
to add first is specifically

00:29:29.236 --> 00:29:31.126 A:middle
when the app message represents

00:29:31.156 --> 00:29:32.726 A:middle
an unaccepted invitation.

00:29:33.836 --> 00:29:36.996 A:middle
So if the event is not for me or

00:29:36.996 --> 00:29:38.316 A:middle
if the app message is not for me

00:29:38.316 --> 00:29:40.316 A:middle
and it's not been accepted then

00:29:40.316 --> 00:29:41.436 A:middle
we want to have that interactive

00:29:41.686 --> 00:29:42.306 A:middle
element to it.

00:29:42.306 --> 00:29:44.446 A:middle
So the first thing we'll do is

00:29:44.446 --> 00:29:48.876 A:middle
say if is not accepted and it's

00:29:48.876 --> 00:29:51.196 A:middle
not from me then we'll change

00:29:51.196 --> 00:29:52.656 A:middle
our view flag to have is

00:29:52.656 --> 00:29:54.716 A:middle
accepted equals true.

00:29:55.016 --> 00:29:57.706 A:middle
And the other thing I want to do

00:29:57.706 --> 00:29:58.986 A:middle
is update the model that I have

00:29:58.986 --> 00:29:59.646 A:middle
here.

00:29:59.926 --> 00:30:02.536 A:middle
Normally I would use correct MVC

00:29:59.926 --> 00:30:02.536 A:middle
Normally I would use correct MVC

00:30:02.536 --> 00:30:04.506 A:middle
and also update maybe my service

00:30:04.506 --> 00:30:05.696 A:middle
to indicate that the event has

00:30:05.696 --> 00:30:06.606 A:middle
been updated, but for the

00:30:06.606 --> 00:30:07.746 A:middle
purposes of this demo I'm just

00:30:07.746 --> 00:30:08.446 A:middle
going to mark this in the

00:30:08.446 --> 00:30:08.876 A:middle
defaults.

00:30:12.956 --> 00:30:14.476 A:middle
Great. So I've updated some

00:30:14.476 --> 00:30:16.726 A:middle
state now I need to update my

00:30:16.726 --> 00:30:19.276 A:middle
view state, so I'll just use a

00:30:19.276 --> 00:30:22.336 A:middle
quick animation block here to

00:30:22.566 --> 00:30:25.186 A:middle
call into my updated view state

00:30:25.186 --> 00:30:27.306 A:middle
and then I'll trigger a layout

00:30:27.306 --> 00:30:27.626 A:middle
pass.

00:30:28.516 --> 00:30:30.186 A:middle
Now this updateViewState, it

00:30:30.186 --> 00:30:31.086 A:middle
just looks at the different

00:30:31.086 --> 00:30:32.566 A:middle
flags and properties on my view

00:30:32.566 --> 00:30:33.316 A:middle
and configures the view

00:30:33.316 --> 00:30:33.806 A:middle
correctly.

00:30:34.376 --> 00:30:37.716 A:middle
So wait for our demo device to

00:30:37.716 --> 00:30:39.166 A:middle
come back up and I'll show you

00:30:39.166 --> 00:30:39.786 A:middle
what that looks like in

00:30:39.786 --> 00:30:40.156 A:middle
practice.

00:30:40.806 --> 00:30:44.036 A:middle
Great. So here we have our

00:30:44.036 --> 00:30:45.226 A:middle
unaccepted invitation being

00:30:45.226 --> 00:30:47.556 A:middle
shown in our demo and it's ready

00:30:47.556 --> 00:30:48.976 A:middle
for us to test out that

00:30:48.976 --> 00:30:50.046 A:middle
interaction that we just added.

00:30:50.046 --> 00:30:51.756 A:middle
So if you see that when I tap

00:30:51.756 --> 00:30:53.986 A:middle
that message that state gets

00:30:53.986 --> 00:30:55.216 A:middle
updated and we see that live

00:30:55.216 --> 00:30:56.716 A:middle
countdown, and you can tell that

00:30:56.716 --> 00:30:58.626 A:middle
I have very little time left so

00:30:58.626 --> 00:31:00.466 A:middle
I better keep going.

00:30:58.626 --> 00:31:00.466 A:middle
I better keep going.

00:31:00.636 --> 00:31:01.486 A:middle
Now the one thing that we're

00:31:01.486 --> 00:31:03.526 A:middle
missing here is that nice

00:31:03.526 --> 00:31:04.686 A:middle
infoButton on the top right that

00:31:04.686 --> 00:31:06.166 A:middle
really gave me that rich detail

00:31:06.166 --> 00:31:07.256 A:middle
about the event that I don't

00:31:07.256 --> 00:31:08.646 A:middle
want to necessarily put here in

00:31:08.646 --> 00:31:09.416 A:middle
my app message.

00:31:10.806 --> 00:31:12.096 A:middle
So if I go back to the code here

00:31:13.096 --> 00:31:14.396 A:middle
you'll see that this infoButton

00:31:14.666 --> 00:31:15.936 A:middle
is just waiting to be

00:31:15.936 --> 00:31:16.526 A:middle
implemented.

00:31:17.276 --> 00:31:18.356 A:middle
But before we do that, we need

00:31:18.356 --> 00:31:19.376 A:middle
to add the infoButton to the

00:31:19.376 --> 00:31:19.996 A:middle
view hierarchy.

00:31:20.576 --> 00:31:25.956 A:middle
So here in setupSubViews you can

00:31:25.996 --> 00:31:27.466 A:middle
see that I have this infoButton

00:31:27.516 --> 00:31:28.786 A:middle
that's already been configured,

00:31:29.486 --> 00:31:30.396 A:middle
including with that target

00:31:30.396 --> 00:31:32.346 A:middle
action I just need to add it as

00:31:32.346 --> 00:31:37.396 A:middle
a sub view.

00:31:37.576 --> 00:31:38.436 A:middle
I also want to add some

00:31:38.436 --> 00:31:39.936 A:middle
constraints like it's laid out

00:31:40.656 --> 00:31:41.026 A:middle
properly.

00:31:45.316 --> 00:31:47.956 A:middle
And then we'll go and jump into

00:31:47.956 --> 00:31:49.076 A:middle
the implementation for

00:31:49.076 --> 00:31:52.026 A:middle
infoButtonTapped and call into

00:31:52.026 --> 00:31:52.646 A:middle
our delegate.

00:31:53.256 --> 00:31:58.446 A:middle
Now the delegate of this view is

00:31:58.446 --> 00:32:00.036 A:middle
our app view controller, and the

00:31:58.446 --> 00:32:00.036 A:middle
our app view controller, and the

00:32:00.036 --> 00:32:00.946 A:middle
app view controller is the

00:32:00.946 --> 00:32:02.366 A:middle
object that knows how to change

00:32:02.366 --> 00:32:03.756 A:middle
presentation styles, so I need

00:32:03.756 --> 00:32:04.466 A:middle
to call out to it.

00:32:05.176 --> 00:32:06.196 A:middle
You'll see that this method

00:32:06.196 --> 00:32:07.486 A:middle
hasn't been implemented yet in

00:32:07.486 --> 00:32:07.966 A:middle
my delegate.

00:32:07.966 --> 00:32:10.066 A:middle
So we're going to jump over to

00:32:10.066 --> 00:32:11.036 A:middle
that delegate really quick.

00:32:11.036 --> 00:32:14.996 A:middle
Here is a delegate protocol

00:32:14.996 --> 00:32:17.116 A:middle
declaration where we see that

00:32:17.116 --> 00:32:18.136 A:middle
method hasn't been defined.

00:32:18.766 --> 00:32:19.536 A:middle
So go ahead and add it.

00:32:20.026 --> 00:32:22.476 A:middle
And then we'll jump over to

00:32:22.476 --> 00:32:23.346 A:middle
where this protocol is

00:32:23.346 --> 00:32:26.966 A:middle
implemented and add our new

00:32:26.966 --> 00:32:30.736 A:middle
method that we just added.

00:32:30.946 --> 00:32:33.406 A:middle
Now all we need to do is request

00:32:33.406 --> 00:32:35.766 A:middle
that new presentation style and

00:32:35.766 --> 00:32:36.236 A:middle
that's it.

00:32:37.256 --> 00:32:38.466 A:middle
When I do that, the app view

00:32:38.466 --> 00:32:39.746 A:middle
controller requests that new

00:32:39.746 --> 00:32:41.936 A:middle
presentation style and Messages

00:32:41.936 --> 00:32:43.506 A:middle
will instantiate the new view

00:32:43.506 --> 00:32:45.306 A:middle
controller in that expanded

00:32:45.346 --> 00:32:45.986 A:middle
presentation.

00:32:47.376 --> 00:32:49.636 A:middle
So this is the same thing that

00:32:49.636 --> 00:32:50.916 A:middle
was just implemented here in the

00:32:51.276 --> 00:32:51.386 A:middle
code.

00:32:51.566 --> 00:32:52.616 A:middle
We have the infoButton in the

00:32:52.616 --> 00:32:54.646 A:middle
top right, and when you tap it

00:32:54.716 --> 00:32:56.716 A:middle
we get that nice expanded

00:32:56.716 --> 00:32:58.566 A:middle
presentation with the additional

00:32:59.106 --> 00:32:59.326 A:middle
content.

00:33:03.206 --> 00:33:03.626 A:middle
So that's it.

00:33:03.626 --> 00:33:04.806 A:middle
We have a completed demo that's

00:33:04.806 --> 00:33:05.616 A:middle
showing you -- thank you.

00:33:06.516 --> 00:33:10.196 A:middle
[ Applause ]

00:33:10.696 --> 00:33:11.696 A:middle
So with the completed demo you

00:33:11.786 --> 00:33:13.236 A:middle
see that we can add completely

00:33:13.236 --> 00:33:14.956 A:middle
custom layouts that really add

00:33:14.996 --> 00:33:16.416 A:middle
some richness to that experience

00:33:16.416 --> 00:33:17.866 A:middle
in the transcript, including

00:33:17.866 --> 00:33:19.646 A:middle
inner activity and live updating

00:33:19.646 --> 00:33:20.126 A:middle
content.

00:33:24.056 --> 00:33:25.366 A:middle
So when we think about

00:33:25.366 --> 00:33:28.066 A:middle
interaction with these live

00:33:28.066 --> 00:33:29.656 A:middle
message layouts, we really want

00:33:29.656 --> 00:33:30.366 A:middle
to keep it simple.

00:33:30.656 --> 00:33:32.996 A:middle
Stick to simple button taps and

00:33:32.996 --> 00:33:34.966 A:middle
tap gestures, and let me use the

00:33:35.006 --> 00:33:35.546 A:middle
scroll views.

00:33:36.426 --> 00:33:37.616 A:middle
This app message is being

00:33:37.616 --> 00:33:39.136 A:middle
imbedded in a fairly complicated

00:33:39.136 --> 00:33:41.546 A:middle
UI, the Messages transcript, and

00:33:41.546 --> 00:33:42.836 A:middle
the user's used to interactions

00:33:42.836 --> 00:33:44.626 A:middle
like vertically scrolling the

00:33:44.626 --> 00:33:45.706 A:middle
transcript, horizontally

00:33:45.706 --> 00:33:46.786 A:middle
scrolling the transcript, and

00:33:47.176 --> 00:33:48.736 A:middle
other gestures that take place.

00:33:49.386 --> 00:33:50.366 A:middle
And so if you add too many

00:33:50.366 --> 00:33:51.956 A:middle
complicated things here it can

00:33:51.956 --> 00:33:53.236 A:middle
be disorienting to the user.

00:33:54.606 --> 00:33:55.346 A:middle
The other thing to remember is

00:33:55.346 --> 00:33:56.326 A:middle
that there's no keyboard input

00:33:56.326 --> 00:33:57.856 A:middle
allowed for these app message

00:33:57.856 --> 00:33:59.576 A:middle
views, and so if you want

00:33:59.576 --> 00:34:01.066 A:middle
keyboard input you should

00:33:59.576 --> 00:34:01.066 A:middle
keyboard input you should

00:34:01.066 --> 00:34:02.346 A:middle
request an expanded presentation

00:34:02.346 --> 00:34:04.036 A:middle
style where your app can use the

00:34:04.036 --> 00:34:04.406 A:middle
keyboard.

00:34:04.916 --> 00:34:07.576 A:middle
Now these views are really light

00:34:07.576 --> 00:34:08.396 A:middle
weight for a reason.

00:34:08.396 --> 00:34:09.606 A:middle
When you think about their

00:34:09.606 --> 00:34:11.536 A:middle
lifecycle, they're only

00:34:11.536 --> 00:34:13.096 A:middle
instantiated when the user comes

00:34:13.096 --> 00:34:14.505 A:middle
into the conversation to look at

00:34:15.186 --> 00:34:15.295 A:middle
it.

00:34:15.295 --> 00:34:16.235 A:middle
As soon as the user leaves the

00:34:16.235 --> 00:34:17.686 A:middle
conversation or leaves the app,

00:34:18.396 --> 00:34:20.045 A:middle
your iMessage app will be torn

00:34:20.045 --> 00:34:20.376 A:middle
down.

00:34:20.656 --> 00:34:21.656 A:middle
So it's not an appropriate place

00:34:21.656 --> 00:34:22.946 A:middle
to put something like a 3D game

00:34:22.946 --> 00:34:23.235 A:middle
engine.

00:34:23.815 --> 00:34:27.856 A:middle
If you do want to do that, you

00:34:27.856 --> 00:34:29.226 A:middle
should request that expanded

00:34:29.226 --> 00:34:30.956 A:middle
presentation style for the user

00:34:30.956 --> 00:34:32.616 A:middle
to take part in your extended

00:34:32.616 --> 00:34:33.146 A:middle
interaction.

00:34:33.696 --> 00:34:36.585 A:middle
Now I want to cover this again

00:34:36.585 --> 00:34:37.176 A:middle
because I think this is

00:34:37.176 --> 00:34:38.306 A:middle
important.

00:34:38.956 --> 00:34:40.616 A:middle
When requesting the expanded

00:34:40.616 --> 00:34:41.786 A:middle
presentation style, your

00:34:41.786 --> 00:34:43.196 A:middle
transcript app view controller

00:34:43.196 --> 00:34:44.626 A:middle
is not reconfigured with new

00:34:44.626 --> 00:34:46.286 A:middle
presentation style -- it's left

00:34:46.286 --> 00:34:47.426 A:middle
in place in the transcript.

00:34:48.636 --> 00:34:50.906 A:middle
If no view controller exist in

00:34:50.906 --> 00:34:52.126 A:middle
the compact or expanded

00:34:52.126 --> 00:34:54.016 A:middle
presentation style, Messages

00:34:54.016 --> 00:34:55.335 A:middle
will instantiate a new object,

00:34:55.656 --> 00:34:56.835 A:middle
configure it accordingly, and

00:34:57.136 --> 00:34:58.426 A:middle
then add it and show it here.

00:34:59.286 --> 00:35:01.176 A:middle
If one does exist then it will

00:34:59.286 --> 00:35:01.176 A:middle
If one does exist then it will

00:35:01.176 --> 00:35:02.276 A:middle
reconfigure it to the new

00:35:02.276 --> 00:35:03.236 A:middle
presentation style.

00:35:03.996 --> 00:35:05.186 A:middle
And this is specifically if it

00:35:05.186 --> 00:35:06.576 A:middle
already has one that is compact

00:35:06.576 --> 00:35:07.166 A:middle
or expanded.

00:35:07.166 --> 00:35:09.526 A:middle
It will then change the selected

00:35:09.526 --> 00:35:11.006 A:middle
message on that view controller

00:35:11.256 --> 00:35:12.226 A:middle
and you will get the didn't

00:35:12.226 --> 00:35:13.886 A:middle
select message callback on that

00:35:13.886 --> 00:35:14.456 A:middle
view controller.

00:35:14.996 --> 00:35:17.016 A:middle
Now the transcript app view

00:35:17.016 --> 00:35:18.016 A:middle
controller that's left in place

00:35:18.016 --> 00:35:20.156 A:middle
as is or the static selected

00:35:20.156 --> 00:35:21.466 A:middle
message because it always

00:35:21.466 --> 00:35:23.006 A:middle
represents that message in the

00:35:23.006 --> 00:35:23.516 A:middle
transcript.

00:35:23.936 --> 00:35:29.016 A:middle
Now when we talk about lifecycle

00:35:29.016 --> 00:35:31.976 A:middle
a little more of your iMessage

00:35:31.976 --> 00:35:34.166 A:middle
app, in iOS 10 these methods on

00:35:34.226 --> 00:35:35.546 A:middle
MSMessagesAppViewController

00:35:35.546 --> 00:35:38.596 A:middle
applied specifically to your

00:35:38.596 --> 00:35:40.426 A:middle
extension lifecycle because

00:35:40.426 --> 00:35:41.936 A:middle
there was only one instance of

00:35:41.936 --> 00:35:43.136 A:middle
the view controller created and

00:35:43.276 --> 00:35:45.016 A:middle
it was closely coupled with the

00:35:45.016 --> 00:35:46.306 A:middle
lifecycle of your iMessage app,

00:35:46.306 --> 00:35:47.396 A:middle
so you could rely on it for

00:35:47.396 --> 00:35:48.526 A:middle
extension lifecycle

00:35:48.926 --> 00:35:49.816 A:middle
notification.

00:35:51.046 --> 00:35:52.846 A:middle
However, in iOS 11, we can

00:35:52.846 --> 00:35:55.006 A:middle
instantiate many instances of

00:35:55.006 --> 00:35:55.906 A:middle
your principle class.

00:35:56.676 --> 00:35:58.336 A:middle
So these methods really pertain

00:35:58.336 --> 00:35:59.886 A:middle
more to the view controller

00:35:59.886 --> 00:36:01.116 A:middle
lifecycle and you need to think

00:35:59.886 --> 00:36:01.116 A:middle
lifecycle and you need to think

00:36:01.116 --> 00:36:02.136 A:middle
of it from that perspective.

00:36:03.536 --> 00:36:04.816 A:middle
If you do need to pay attention

00:36:04.816 --> 00:36:07.046 A:middle
to extension lifecycle events of

00:36:07.046 --> 00:36:08.416 A:middle
your iMessage app, you should

00:36:08.416 --> 00:36:10.786 A:middle
observe the NS extension related

00:36:10.786 --> 00:36:11.476 A:middle
notifications.

00:36:14.866 --> 00:36:16.586 A:middle
Now in a particular instance of

00:36:16.586 --> 00:36:17.616 A:middle
your transcript app view

00:36:17.616 --> 00:36:19.636 A:middle
controller is created, the

00:36:19.636 --> 00:36:21.026 A:middle
lifecycle methods proceed like

00:36:21.026 --> 00:36:21.226 A:middle
this.

00:36:22.106 --> 00:36:23.266 A:middle
First, we'll initialize the view

00:36:23.266 --> 00:36:25.346 A:middle
controller and call viewDidLoad.

00:36:25.346 --> 00:36:29.166 A:middle
Then we'll call willBecomeActive

00:36:29.166 --> 00:36:30.046 A:middle
and didBecomeActive with

00:36:30.046 --> 00:36:31.446 A:middle
conversation as part of the

00:36:31.446 --> 00:36:32.866 A:middle
Messages API contract.

00:36:33.366 --> 00:36:35.886 A:middle
Then the view appearance methods

00:36:35.886 --> 00:36:37.886 A:middle
will be called as your view

00:36:37.886 --> 00:36:38.936 A:middle
controller is inserted into the

00:36:38.936 --> 00:36:42.036 A:middle
view hierarchy for display.

00:36:42.166 --> 00:36:43.816 A:middle
Lastly, contentSizeThatFits will

00:36:43.816 --> 00:36:44.286 A:middle
be called.

00:36:44.906 --> 00:36:47.716 A:middle
Now when willBecomeActive and

00:36:47.716 --> 00:36:48.516 A:middle
didBecomeActive with

00:36:48.516 --> 00:36:49.986 A:middle
conversation are called, you

00:36:49.986 --> 00:36:51.246 A:middle
have all the information you

00:36:51.246 --> 00:36:52.516 A:middle
need to correctly configure your

00:36:52.516 --> 00:36:53.936 A:middle
view controller by looking at

00:36:53.936 --> 00:36:55.276 A:middle
that presentation style and

00:36:55.326 --> 00:36:56.296 A:middle
selected message on the view

00:36:56.296 --> 00:36:56.616 A:middle
controller.

00:36:59.156 --> 00:37:00.096 A:middle
Now when thinking about

00:36:59.156 --> 00:37:00.096 A:middle
Now when thinking about

00:37:00.096 --> 00:37:01.326 A:middle
contentSizeThatFits getting

00:37:01.326 --> 00:37:03.656 A:middle
called last, this is because it

00:37:03.656 --> 00:37:05.066 A:middle
may be called multiple times.

00:37:05.816 --> 00:37:06.686 A:middle
Think about the Messages

00:37:06.686 --> 00:37:08.416 A:middle
application on an iPad in split

00:37:08.416 --> 00:37:08.826 A:middle
view mode.

00:37:08.826 --> 00:37:11.616 A:middle
As the user changes the size of

00:37:11.616 --> 00:37:13.626 A:middle
the Messages app, the metrics of

00:37:13.626 --> 00:37:15.076 A:middle
the Messages application, and

00:37:15.076 --> 00:37:16.006 A:middle
therefore the transcript,

00:37:16.006 --> 00:37:16.506 A:middle
change.

00:37:17.406 --> 00:37:18.486 A:middle
We'll then call into your

00:37:18.486 --> 00:37:20.306 A:middle
contentSizeThatFits method with

00:37:20.306 --> 00:37:22.566 A:middle
an updated size or maximum size,

00:37:23.486 --> 00:37:25.286 A:middle
and you should update your app

00:37:25.336 --> 00:37:26.086 A:middle
size accordingly.

00:37:29.136 --> 00:37:29.986 A:middle
It can also be, of course,

00:37:29.986 --> 00:37:31.566 A:middle
updated for dynamic text size

00:37:31.566 --> 00:37:32.646 A:middle
changes and locale changes.

00:37:32.726 --> 00:37:36.976 A:middle
The last thing I want to cover

00:37:36.976 --> 00:37:37.896 A:middle
is pending messages.

00:37:38.596 --> 00:37:41.406 A:middle
Now remember, your view

00:37:41.406 --> 00:37:42.766 A:middle
controller can be configured to

00:37:42.766 --> 00:37:44.546 A:middle
represent app messages in a

00:37:44.546 --> 00:37:46.136 A:middle
transcript presentation style

00:37:46.656 --> 00:37:48.306 A:middle
both for an unsent message and

00:37:48.306 --> 00:37:50.106 A:middle
the message that has been sent

00:37:50.106 --> 00:37:50.716 A:middle
in the transcript.

00:37:50.716 --> 00:37:54.486 A:middle
Now most of the time you should

00:37:54.486 --> 00:37:56.186 A:middle
keep the same application view

00:37:56.186 --> 00:37:57.906 A:middle
in both states because the user

00:37:57.906 --> 00:37:59.206 A:middle
is really previewing the content

00:37:59.206 --> 00:38:00.096 A:middle
that's going to be sent here.

00:37:59.206 --> 00:38:00.096 A:middle
that's going to be sent here.

00:38:00.496 --> 00:38:01.206 A:middle
But if you do need to

00:38:01.206 --> 00:38:02.596 A:middle
differentiate between the two,

00:38:03.936 --> 00:38:05.636 A:middle
you can check the isPending flag

00:38:05.846 --> 00:38:06.826 A:middle
which is a new property on

00:38:06.966 --> 00:38:09.156 A:middle
MSMessage that will let you know

00:38:09.156 --> 00:38:10.336 A:middle
the difference between these two

00:38:11.076 --> 00:38:11.226 A:middle
states.

00:38:13.336 --> 00:38:14.796 A:middle
So that's all we have for you

00:38:14.796 --> 00:38:16.336 A:middle
today to introduce Live Message

00:38:16.336 --> 00:38:16.706 A:middle
Layouts.

00:38:18.156 --> 00:38:19.276 A:middle
Remember, this is interactive

00:38:19.356 --> 00:38:20.956 A:middle
iMessage apps in the transcript,

00:38:20.956 --> 00:38:22.306 A:middle
which I think is incredibly cool

00:38:22.306 --> 00:38:23.086 A:middle
and I can't wait to see what you

00:38:23.086 --> 00:38:23.546 A:middle
build with it.

00:38:24.226 --> 00:38:25.896 A:middle
We're using the same MSMessage

00:38:25.896 --> 00:38:27.066 A:middle
app view controller sub class,

00:38:28.346 --> 00:38:29.656 A:middle
and the new layout, the

00:38:29.656 --> 00:38:31.466 A:middle
MSMessagesLiveLayout with a new

00:38:31.466 --> 00:38:35.076 A:middle
presentation style for you to

00:38:35.076 --> 00:38:36.466 A:middle
use as a tool to build these

00:38:36.466 --> 00:38:37.476 A:middle
rich new experiences.

00:38:38.826 --> 00:38:39.916 A:middle
I'm really looking forward to

00:38:39.916 --> 00:38:41.296 A:middle
what you build with this and I

00:38:41.296 --> 00:38:42.026 A:middle
think you're going to come up

00:38:42.026 --> 00:38:42.836 A:middle
with things that we haven't even

00:38:42.836 --> 00:38:43.286 A:middle
thought of yet.

00:38:43.836 --> 00:38:44.986 A:middle
And with that, I'd like to bring

00:38:44.986 --> 00:38:46.726 A:middle
up Eugene to introduce some best

00:38:46.726 --> 00:38:47.776 A:middle
practices when using the

00:38:47.776 --> 00:38:48.846 A:middle
Messages framework.

00:38:49.516 --> 00:38:53.500 A:middle
[ Applause ]

00:39:02.126 --> 00:39:02.926 A:middle
&gt;&gt; All right.

00:39:03.016 --> 00:39:04.166 A:middle
Thank you, Stephen.

00:39:04.466 --> 00:39:06.226 A:middle
Live Message Layouts, super

00:39:06.226 --> 00:39:06.656 A:middle
exciting.

00:39:07.676 --> 00:39:08.856 A:middle
So we want to wrap up our talk

00:39:08.856 --> 00:39:11.156 A:middle
today with just a couple best

00:39:11.156 --> 00:39:12.966 A:middle
practices tips and tricks for

00:39:12.966 --> 00:39:14.616 A:middle
your iMessage apps just to give

00:39:14.616 --> 00:39:15.686 A:middle
your apps that little extra

00:39:15.686 --> 00:39:17.166 A:middle
shine and polish that we think

00:39:17.166 --> 00:39:18.026 A:middle
will make them look really

00:39:18.026 --> 00:39:18.346 A:middle
great.

00:39:18.446 --> 00:39:19.826 A:middle
So, we have a couple of tips for

00:39:19.826 --> 00:39:20.616 A:middle
you guys today.

00:39:21.366 --> 00:39:23.046 A:middle
Let's get into it.

00:39:23.456 --> 00:39:24.276 A:middle
So the first thing we'd like to

00:39:24.276 --> 00:39:26.376 A:middle
talk about is the iMessage app

00:39:26.376 --> 00:39:27.416 A:middle
area insets.

00:39:27.416 --> 00:39:29.086 A:middle
So this is the area at the

00:39:29.086 --> 00:39:32.126 A:middle
bottom of the screen underneath

00:39:32.216 --> 00:39:35.856 A:middle
the app strip as well as at the

00:39:35.856 --> 00:39:37.786 A:middle
bottom of the screen in expanded

00:39:37.786 --> 00:39:38.116 A:middle
mode.

00:39:38.496 --> 00:39:40.936 A:middle
So similar to like navigation

00:39:40.936 --> 00:39:43.476 A:middle
controllers, Messages UI can

00:39:43.546 --> 00:39:45.776 A:middle
include the area displayed by

00:39:45.776 --> 00:39:47.106 A:middle
your application so you can have

00:39:47.106 --> 00:39:48.876 A:middle
that nice blurred effect when

00:39:48.876 --> 00:39:50.406 A:middle
scrolling scroll views.

00:39:50.436 --> 00:39:52.986 A:middle
So to determine your app area

00:39:52.986 --> 00:39:54.906 A:middle
insets, you can look at the

00:39:54.906 --> 00:39:56.436 A:middle
UIViewController top and bottom

00:39:56.436 --> 00:39:58.866 A:middle
layout guides, or new in iOS 11

00:39:59.266 --> 00:40:02.036 A:middle
check out UIViewsafeAreaInsets.

00:39:59.266 --> 00:40:02.036 A:middle
check out UIViewsafeAreaInsets.

00:40:02.156 --> 00:40:04.096 A:middle
These will define all the areas

00:40:04.096 --> 00:40:05.676 A:middle
of your application's view that

00:40:05.676 --> 00:40:07.076 A:middle
are un occluded by Messages UI.

00:40:07.886 --> 00:40:09.116 A:middle
Of course, you can always use

00:40:09.116 --> 00:40:11.696 A:middle
Autolayout to add constraints to

00:40:11.696 --> 00:40:12.876 A:middle
the UIViewController's top and

00:40:12.876 --> 00:40:13.746 A:middle
bottom layout guides.

00:40:14.596 --> 00:40:16.906 A:middle
So for applications linked on

00:40:17.126 --> 00:40:19.266 A:middle
iOS 10, we will continue to use

00:40:19.266 --> 00:40:20.246 A:middle
old legacy insets.

00:40:20.406 --> 00:40:22.106 A:middle
But a great way to keep up with

00:40:22.106 --> 00:40:23.766 A:middle
the change in UI Messages and

00:40:23.766 --> 00:40:25.356 A:middle
have your application adapt

00:40:25.356 --> 00:40:27.146 A:middle
appropriately is to properly

00:40:27.146 --> 00:40:28.366 A:middle
adopt either the

00:40:28.366 --> 00:40:30.496 A:middle
UIViewsafeAreaInsets or

00:40:30.496 --> 00:40:32.706 A:middle
UIViewController top and bottom

00:40:32.706 --> 00:40:33.486 A:middle
layout guides.

00:40:34.086 --> 00:40:37.756 A:middle
Next up we have message summary

00:40:37.756 --> 00:40:38.316 A:middle
text.

00:40:38.516 --> 00:40:41.086 A:middle
So iOS 10 introduced MSMessage

00:40:41.256 --> 00:40:42.466 A:middle
and a property on it called

00:40:42.466 --> 00:40:43.156 A:middle
summaryText.

00:40:43.856 --> 00:40:45.956 A:middle
In iOS 10, summaryText was used

00:40:45.956 --> 00:40:49.166 A:middle
for Messages with an MS Session

00:40:49.166 --> 00:40:50.076 A:middle
attached to it, so kind of

00:40:50.076 --> 00:40:51.866 A:middle
session based messaging and we'd

00:40:51.866 --> 00:40:54.286 A:middle
insert a very small succinct

00:40:54.286 --> 00:40:56.226 A:middle
summary inline the transcript of

00:40:56.226 --> 00:40:56.686 A:middle
that message.

00:40:56.686 --> 00:40:59.636 A:middle
In iOS 11, we are expanding the

00:40:59.636 --> 00:41:01.366 A:middle
use of the summaryText property

00:40:59.636 --> 00:41:01.366 A:middle
use of the summaryText property

00:41:01.626 --> 00:41:03.466 A:middle
to all MSMessages sent.

00:41:03.846 --> 00:41:04.876 A:middle
So where do you see the

00:41:04.876 --> 00:41:05.636 A:middle
summaryText?

00:41:07.166 --> 00:41:08.926 A:middle
MSMessage summaryText will now

00:41:08.926 --> 00:41:10.606 A:middle
be used in the conversation list

00:41:10.606 --> 00:41:12.446 A:middle
preview as well as places like

00:41:12.626 --> 00:41:14.156 A:middle
notification center so you can

00:41:14.156 --> 00:41:15.726 A:middle
give context to your

00:41:15.726 --> 00:41:16.996 A:middle
application's message

00:41:16.996 --> 00:41:17.746 A:middle
notifications.

00:41:17.956 --> 00:41:19.186 A:middle
So this is a really great way

00:41:19.336 --> 00:41:20.926 A:middle
for users at a quick glance to

00:41:20.926 --> 00:41:22.556 A:middle
see the content that you send in

00:41:22.556 --> 00:41:23.306 A:middle
your app message.

00:41:23.786 --> 00:41:26.416 A:middle
So iOS 11 summaryText and every

00:41:26.446 --> 00:41:27.846 A:middle
single one here, MSMessages.

00:41:28.386 --> 00:41:32.876 A:middle
Next up we have stickers.

00:41:32.876 --> 00:41:34.016 A:middle
So the introduction of sticker

00:41:34.016 --> 00:41:36.346 A:middle
packs in iOS 10 we're seeing

00:41:36.466 --> 00:41:37.426 A:middle
tons of them released.

00:41:37.426 --> 00:41:38.656 A:middle
I absolutely love them, download

00:41:38.656 --> 00:41:39.466 A:middle
new ones every week.

00:41:39.876 --> 00:41:41.496 A:middle
Keep up the awesome work on the

00:41:41.496 --> 00:41:42.106 A:middle
sticker packs.

00:41:42.106 --> 00:41:42.486 A:middle
We love it.

00:41:43.556 --> 00:41:44.876 A:middle
We do want to give a couple tips

00:41:44.956 --> 00:41:46.516 A:middle
about making your sticker packs

00:41:46.626 --> 00:41:48.446 A:middle
faster and send quicker.

00:41:49.056 --> 00:41:50.996 A:middle
Overall, sticker pack

00:41:50.996 --> 00:41:52.176 A:middle
performance is a function of

00:41:52.176 --> 00:41:53.336 A:middle
your sticker's file size.

00:41:53.846 --> 00:41:55.326 A:middle
This function of the sticker's

00:41:55.326 --> 00:41:57.486 A:middle
file size is a function of your

00:41:57.486 --> 00:41:59.366 A:middle
sticker's pixel size as well as

00:41:59.366 --> 00:42:00.106 A:middle
its frame rate.

00:41:59.366 --> 00:42:00.106 A:middle
its frame rate.

00:42:00.616 --> 00:42:01.716 A:middle
A really great resource for you

00:42:01.716 --> 00:42:03.436 A:middle
to look at is the Messages Human

00:42:03.436 --> 00:42:04.696 A:middle
Interface Guidelines which is

00:42:04.696 --> 00:42:05.606 A:middle
available in the developer

00:42:05.606 --> 00:42:07.346 A:middle
portal which will tell you the

00:42:07.346 --> 00:42:08.926 A:middle
target sticker sizes for either

00:42:08.926 --> 00:42:11.246 A:middle
the small, medium or large

00:42:11.246 --> 00:42:12.506 A:middle
stickers that we support.

00:42:13.226 --> 00:42:15.156 A:middle
In addition, consider the frame

00:42:15.156 --> 00:42:15.956 A:middle
rate of your sticker.

00:42:16.566 --> 00:42:18.616 A:middle
Stickers with higher frame rates

00:42:18.766 --> 00:42:20.726 A:middle
or longer loop times have a

00:42:20.726 --> 00:42:22.556 A:middle
higher memory overhead and will

00:42:22.556 --> 00:42:23.566 A:middle
negatively impact the

00:42:23.566 --> 00:42:24.636 A:middle
performance of your sticker

00:42:24.636 --> 00:42:26.016 A:middle
application as well as

00:42:26.016 --> 00:42:27.916 A:middle
negatively impact send times.

00:42:28.426 --> 00:42:30.106 A:middle
So for quick fast sending

00:42:30.106 --> 00:42:31.506 A:middle
stickers and quick launching

00:42:31.506 --> 00:42:33.056 A:middle
sticker apps, make sure your

00:42:33.056 --> 00:42:35.476 A:middle
stickers are sized correctly and

00:42:35.606 --> 00:42:37.346 A:middle
either use short loops or lower

00:42:37.416 --> 00:42:37.866 A:middle
frame rates.

00:42:38.426 --> 00:42:40.066 A:middle
So looking forward to seeing all

00:42:40.066 --> 00:42:40.966 A:middle
the new sticker packs you guys

00:42:40.966 --> 00:42:45.626 A:middle
make in iOS 11 as well.

00:42:45.736 --> 00:42:47.956 A:middle
And last up on our list is

00:42:47.996 --> 00:42:49.926 A:middle
MFMessageComposeViewController.

00:42:50.286 --> 00:42:52.116 A:middle
MSMessageComposeViewController

00:42:52.436 --> 00:42:54.216 A:middle
is the Messages share sheet that

00:42:54.216 --> 00:42:55.646 A:middle
can be invoked from your parent

00:42:55.646 --> 00:42:56.376 A:middle
application.

00:42:57.426 --> 00:42:58.906 A:middle
So in iOS 10 we introduced a new

00:42:58.906 --> 00:43:00.256 A:middle
property on the share sheet

00:42:58.906 --> 00:43:00.256 A:middle
property on the share sheet

00:43:00.546 --> 00:43:01.956 A:middle
called Message, which

00:43:02.146 --> 00:43:04.036 A:middle
predictably takes an MSMessage

00:43:04.086 --> 00:43:04.636 A:middle
instance.

00:43:05.366 --> 00:43:06.806 A:middle
So if you already have an

00:43:06.986 --> 00:43:09.036 A:middle
iMessage app, your parent

00:43:09.036 --> 00:43:10.746 A:middle
companion app can actually send

00:43:10.746 --> 00:43:12.486 A:middle
the same application balloons

00:43:12.816 --> 00:43:14.206 A:middle
either a template layout or a

00:43:14.206 --> 00:43:16.126 A:middle
live Layout that you can send in

00:43:16.126 --> 00:43:17.246 A:middle
the Messages app itself.

00:43:17.246 --> 00:43:18.376 A:middle
So you get a very nice

00:43:18.376 --> 00:43:19.916 A:middle
consistent sharing experience

00:43:20.326 --> 00:43:21.756 A:middle
between your parent application

00:43:21.946 --> 00:43:22.996 A:middle
and your iMessage app.

00:43:24.856 --> 00:43:26.676 A:middle
App balloons that are received,

00:43:26.996 --> 00:43:28.646 A:middle
can either then be opened within

00:43:28.646 --> 00:43:30.766 A:middle
your iMessage app or can bounce

00:43:30.806 --> 00:43:32.146 A:middle
the user out to their parent

00:43:32.146 --> 00:43:34.666 A:middle
application via the open URL

00:43:34.666 --> 00:43:35.126 A:middle
command.

00:43:35.406 --> 00:43:37.496 A:middle
So definitely take a look at

00:43:37.496 --> 00:43:39.096 A:middle
Message property on

00:43:39.346 --> 00:43:41.106 A:middle
MFMessageComposeViewController.

00:43:41.696 --> 00:43:44.286 A:middle
And with that we've wrapped up

00:43:44.286 --> 00:43:44.736 A:middle
our tips!

00:43:44.736 --> 00:43:46.036 A:middle
Just a couple things for

00:43:46.036 --> 00:43:46.936 A:middle
everyone to keep in mind.

00:43:47.846 --> 00:43:48.916 A:middle
Look at your layout margins.

00:43:49.466 --> 00:43:50.906 A:middle
Set summaryText on all

00:43:50.906 --> 00:43:52.356 A:middle
MSMessages in iOS 11.

00:43:53.016 --> 00:43:55.116 A:middle
Consider sticker sizes and frame

00:43:55.116 --> 00:43:56.666 A:middle
rate for faster sticker packs.

00:43:56.666 --> 00:43:57.716 A:middle
And also keep on making awesome

00:43:57.716 --> 00:43:58.226 A:middle
stickers.

00:43:58.996 --> 00:44:01.556 A:middle
And finally, you can now send

00:43:58.996 --> 00:44:01.556 A:middle
And finally, you can now send

00:44:01.806 --> 00:44:03.246 A:middle
app balloons from

00:44:03.246 --> 00:44:04.756 A:middle
MFMessageComposeViewController.

00:44:04.756 --> 00:44:06.186 A:middle
So certainly check that out for

00:44:06.186 --> 00:44:07.646 A:middle
consistent user experience.

00:44:07.736 --> 00:44:11.286 A:middle
So what did we learn today?

00:44:11.646 --> 00:44:13.076 A:middle
We went over a couple new things

00:44:13.076 --> 00:44:14.206 A:middle
with MSMessages app UI.

00:44:15.016 --> 00:44:16.966 A:middle
We saw the direct send API for

00:44:16.966 --> 00:44:17.866 A:middle
an awesome new setting

00:44:17.866 --> 00:44:18.936 A:middle
experience in your iMessage

00:44:20.176 --> 00:44:20.546 A:middle
apps.

00:44:20.546 --> 00:44:22.216 A:middle
Stephen and Jay led you through

00:44:22.456 --> 00:44:23.516 A:middle
Live Message Layouts.

00:44:23.516 --> 00:44:25.126 A:middle
I cannot wait to see what all of

00:44:25.126 --> 00:44:25.786 A:middle
you build with that.

00:44:26.566 --> 00:44:28.446 A:middle
And finally, a couple best

00:44:28.486 --> 00:44:32.126 A:middle
practices tips and tricks.

00:44:32.256 --> 00:44:33.326 A:middle
If you'd like more information

00:44:33.706 --> 00:44:36.106 A:middle
check out our session webpage

00:44:36.106 --> 00:44:36.896 A:middle
right here.

00:44:38.236 --> 00:44:39.526 A:middle
In addition, we also have a

00:44:39.526 --> 00:44:40.556 A:middle
couple related sessions

00:44:40.556 --> 00:44:41.316 A:middle
happening tomorrow.

00:44:41.596 --> 00:44:44.426 A:middle
We have, at 10:00 a.m. in this

00:44:44.426 --> 00:44:46.136 A:middle
hall, Introducing Business Chat,

00:44:46.136 --> 00:44:47.116 A:middle
which I know all of you are

00:44:47.286 --> 00:44:48.666 A:middle
probably really excited to hear

00:44:49.236 --> 00:44:49.626 A:middle
about.

00:44:49.626 --> 00:44:50.936 A:middle
In addition, we are very lucky

00:44:50.936 --> 00:44:52.076 A:middle
this year to have one of our

00:44:52.076 --> 00:44:53.756 A:middle
Messages HI designers who will

00:44:53.756 --> 00:44:56.016 A:middle
be doing a design short tomorrow

00:44:56.016 --> 00:44:57.876 A:middle
at 11:00 a.m. in the Executive

00:44:57.876 --> 00:44:58.256 A:middle
Ballroom.

00:44:58.996 --> 00:45:00.076 A:middle
Thank you for being here tonight

00:44:58.996 --> 00:45:00.076 A:middle
Thank you for being here tonight

00:45:00.346 --> 00:45:01.626 A:middle
and enjoy the bash!

00:45:02.156 --> 00:45:02.436 A:middle
Thank you!

00:45:03.016 --> 00:45:05.000 A:middle
[ Applause ]

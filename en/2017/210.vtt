WEBVTT

00:00:07.516 --> 00:00:16.500 A:middle
[ Cheers ]

00:00:23.516 --> 00:00:25.636 A:middle
[ Applause ]

00:00:26.136 --> 00:00:28.046 A:middle
&gt;&gt; Hello, welcome to Session

00:00:28.046 --> 00:00:29.726 A:middle
2010, What's New in Core Data.

00:00:30.396 --> 00:00:31.336 A:middle
I'm Melissa.

00:00:31.436 --> 00:00:32.176 A:middle
I'm one of the Core Data

00:00:32.176 --> 00:00:32.976 A:middle
engineers.

00:00:33.056 --> 00:00:34.476 A:middle
And I will be joined on stage

00:00:34.476 --> 00:00:35.816 A:middle
later by Rishi, one of my

00:00:35.816 --> 00:00:36.436 A:middle
co-workers.

00:00:37.136 --> 00:00:39.006 A:middle
And we're here to talk about all

00:00:39.006 --> 00:00:40.196 A:middle
of the stuff that we've been

00:00:40.196 --> 00:00:41.486 A:middle
working on for the last year

00:00:41.616 --> 00:00:43.056 A:middle
because it's been fun for us.

00:00:43.056 --> 00:00:44.056 A:middle
And we're hoping that you'll

00:00:44.056 --> 00:00:46.076 A:middle
find it fun and useful to work

00:00:46.076 --> 00:00:47.346 A:middle
with in your applications.

00:00:48.166 --> 00:00:49.256 A:middle
And we will hope all of the

00:00:49.256 --> 00:00:50.286 A:middle
technical problems for this

00:00:50.286 --> 00:00:51.256 A:middle
presentation have already

00:00:51.256 --> 00:00:51.676 A:middle
happened.

00:00:52.946 --> 00:00:56.126 A:middle
So what have we been up to?

00:00:56.126 --> 00:00:57.046 A:middle
We've been doing some Core

00:00:57.046 --> 00:00:58.026 A:middle
Spotlight Integration.

00:00:58.336 --> 00:00:59.886 A:middle
We've added a bunch of new

00:00:59.886 --> 00:01:00.966 A:middle
indexing APIs.

00:00:59.886 --> 00:01:00.966 A:middle
indexing APIs.

00:01:00.966 --> 00:01:02.176 A:middle
And we've added a big new

00:01:02.176 --> 00:01:03.186 A:middle
feature called Persistent

00:01:03.186 --> 00:01:03.886 A:middle
history tracking.

00:01:03.886 --> 00:01:04.936 A:middle
That is what Rishi's going to

00:01:04.936 --> 00:01:05.446 A:middle
talk about.

00:01:05.936 --> 00:01:07.256 A:middle
And it's really cool and I'm

00:01:07.256 --> 00:01:08.226 A:middle
really excited to see it

00:01:08.226 --> 00:01:08.836 A:middle
presented here.

00:01:09.896 --> 00:01:11.046 A:middle
But first Alphonse says "Hi".

00:01:11.206 --> 00:01:11.946 A:middle
He's my mascot.

00:01:11.946 --> 00:01:14.316 A:middle
I couldn't do this without him.

00:01:14.536 --> 00:01:15.356 A:middle
So Core Spotlight.

00:01:16.346 --> 00:01:17.486 A:middle
What is Core Spotlight?

00:01:17.636 --> 00:01:19.236 A:middle
Before I talk about Core

00:01:19.236 --> 00:01:20.096 A:middle
Spotlight I want to talk a

00:01:20.096 --> 00:01:21.236 A:middle
little bit about Spotlight.

00:01:21.496 --> 00:01:22.866 A:middle
Spotlight was the original

00:01:22.866 --> 00:01:23.986 A:middle
search API, and search

00:01:23.986 --> 00:01:25.446 A:middle
technology on Mac OS 10.

00:01:25.446 --> 00:01:26.966 A:middle
It was very document centric,

00:01:27.496 --> 00:01:29.046 A:middle
which meant that the search

00:01:29.046 --> 00:01:30.166 A:middle
results that you would get back

00:01:30.496 --> 00:01:33.486 A:middle
from a customer doing a search

00:01:33.486 --> 00:01:34.916 A:middle
in the Spotlight menu would

00:01:34.916 --> 00:01:37.256 A:middle
identify the document that had

00:01:37.256 --> 00:01:38.586 A:middle
been retrieved by Spotlight, but

00:01:38.586 --> 00:01:39.816 A:middle
wouldn't actually tell you where

00:01:39.816 --> 00:01:40.976 A:middle
in the document that hit came

00:01:40.976 --> 00:01:41.226 A:middle
from.

00:01:42.056 --> 00:01:43.316 A:middle
And it was not really ideal for

00:01:43.316 --> 00:01:44.596 A:middle
databases, which as we know can

00:01:44.596 --> 00:01:45.966 A:middle
have lots and lots of records in

00:01:46.576 --> 00:01:46.666 A:middle
them.

00:01:47.596 --> 00:01:48.386 A:middle
Which brings us to Core

00:01:48.386 --> 00:01:48.876 A:middle
Spotlight.

00:01:49.396 --> 00:01:50.786 A:middle
Core Spotlight was the original

00:01:50.786 --> 00:01:52.116 A:middle
search technology on iOS.

00:01:52.516 --> 00:01:53.666 A:middle
And it was much more

00:01:53.666 --> 00:01:54.366 A:middle
database-friendly.

00:01:54.836 --> 00:01:56.486 A:middle
It would return not only the

00:01:56.486 --> 00:01:58.746 A:middle
application and the document

00:01:58.996 --> 00:02:00.566 A:middle
that the user had selected, but

00:01:58.996 --> 00:02:00.566 A:middle
that the user had selected, but

00:02:00.816 --> 00:02:02.016 A:middle
it would also tell you where in

00:02:02.016 --> 00:02:02.676 A:middle
that document.

00:02:03.176 --> 00:02:04.406 A:middle
It allowed for deep linking into

00:02:04.446 --> 00:02:05.596 A:middle
your application so you could

00:02:05.596 --> 00:02:07.266 A:middle
bring up exactly the results

00:02:07.516 --> 00:02:09.246 A:middle
that your user was interested in

00:02:09.246 --> 00:02:09.515 A:middle
seeing.

00:02:09.746 --> 00:02:11.506 A:middle
Now it ships on Mac OS, as well

00:02:11.506 --> 00:02:11.996 A:middle
as on iOS.

00:02:11.996 --> 00:02:13.286 A:middle
And we thought this is a great

00:02:13.286 --> 00:02:14.606 A:middle
time to integrate with it in

00:02:14.606 --> 00:02:14.976 A:middle
Core Data.

00:02:16.536 --> 00:02:17.846 A:middle
So how does Core Spotlight work?

00:02:18.076 --> 00:02:19.196 A:middle
Well it's a lot like Spotlight.

00:02:19.606 --> 00:02:20.636 A:middle
You've got an application.

00:02:20.876 --> 00:02:21.856 A:middle
It has a bunch of data in it.

00:02:22.636 --> 00:02:24.246 A:middle
The user goes into the Spotlight

00:02:24.246 --> 00:02:25.596 A:middle
menu and looks for something

00:02:25.596 --> 00:02:26.316 A:middle
that's going to be in your

00:02:26.316 --> 00:02:26.996 A:middle
application.

00:02:27.206 --> 00:02:29.106 A:middle
For example, you know, photo

00:02:29.206 --> 00:02:29.656 A:middle
from India.

00:02:30.466 --> 00:02:33.546 A:middle
And Spotlight launch services

00:02:33.546 --> 00:02:35.006 A:middle
launches your application and

00:02:35.006 --> 00:02:36.446 A:middle
you're given a user activity

00:02:36.626 --> 00:02:39.846 A:middle
that you can use to retrieve the

00:02:39.846 --> 00:02:41.666 A:middle
information about what the user

00:02:41.666 --> 00:02:42.316 A:middle
was searching for.

00:02:43.046 --> 00:02:44.516 A:middle
Popup, you know, that specific

00:02:44.516 --> 00:02:47.256 A:middle
view so your user could see it.

00:02:47.876 --> 00:02:49.226 A:middle
As I said, it's now shipping on

00:02:49.226 --> 00:02:51.396 A:middle
Mac OS as well as iOS.

00:02:51.516 --> 00:02:52.596 A:middle
And at this point the Core

00:02:52.596 --> 00:02:53.856 A:middle
Spotlight team wants me to tell

00:02:53.856 --> 00:02:55.356 A:middle
you that you can also use the

00:02:55.356 --> 00:02:56.856 A:middle
Core Spotlight API's to access

00:02:56.856 --> 00:02:58.146 A:middle
the Spotlight search indexes

00:02:58.226 --> 00:02:59.886 A:middle
from your application, which is

00:02:59.886 --> 00:03:00.146 A:middle
cool.

00:02:59.886 --> 00:03:00.146 A:middle
cool.

00:03:00.996 --> 00:03:02.666 A:middle
And it does all of this without

00:03:02.666 --> 00:03:03.976 A:middle
scattering zero-length files all

00:03:03.976 --> 00:03:04.716 A:middle
over the file system.

00:03:05.126 --> 00:03:06.086 A:middle
And I'm really hoping that at

00:03:06.086 --> 00:03:07.216 A:middle
least some of you are mentally

00:03:07.216 --> 00:03:08.536 A:middle
cheering about this because I

00:03:08.536 --> 00:03:09.016 A:middle
sure was.

00:03:09.726 --> 00:03:12.546 A:middle
So how does it work?

00:03:12.546 --> 00:03:13.986 A:middle
There's three basic components

00:03:13.986 --> 00:03:14.726 A:middle
to the Core Spotlight

00:03:14.726 --> 00:03:15.226 A:middle
integration.

00:03:15.226 --> 00:03:17.486 A:middle
First there's -- we've

00:03:17.486 --> 00:03:18.756 A:middle
repurposed the index by

00:03:18.756 --> 00:03:20.056 A:middle
Spotlight property on NS

00:03:20.056 --> 00:03:21.576 A:middle
Property Description to indicate

00:03:21.576 --> 00:03:22.786 A:middle
that a property should be pushed

00:03:22.786 --> 00:03:23.936 A:middle
into Core Spotlight.

00:03:24.046 --> 00:03:26.506 A:middle
But we need a way to specify

00:03:26.506 --> 00:03:27.626 A:middle
what should be showing up in the

00:03:27.626 --> 00:03:28.756 A:middle
Spotlight results menu.

00:03:29.016 --> 00:03:30.416 A:middle
And that is NS Entity

00:03:30.416 --> 00:03:31.606 A:middle
Description Core Spotlight

00:03:31.606 --> 00:03:32.606 A:middle
Display Name Expression.

00:03:33.016 --> 00:03:34.156 A:middle
And of course there's an

00:03:34.206 --> 00:03:34.726 A:middle
Exporter.

00:03:34.726 --> 00:03:35.876 A:middle
That whenever you do save in

00:03:35.876 --> 00:03:37.826 A:middle
your application pushes whatever

00:03:37.826 --> 00:03:39.266 A:middle
change the user has made into

00:03:39.336 --> 00:03:41.106 A:middle
the Core Spotlight Index.

00:03:41.656 --> 00:03:43.146 A:middle
Core Spotlight Display Name

00:03:43.146 --> 00:03:45.006 A:middle
Expression is kind of the

00:03:45.006 --> 00:03:45.876 A:middle
trickiest piece of this to

00:03:45.876 --> 00:03:46.486 A:middle
understand.

00:03:46.486 --> 00:03:47.676 A:middle
It's actually an instance of NS

00:03:47.676 --> 00:03:49.256 A:middle
Expression that you set as a

00:03:49.256 --> 00:03:50.936 A:middle
property on NS Entity

00:03:50.936 --> 00:03:51.426 A:middle
Description.

00:03:52.006 --> 00:03:53.956 A:middle
And it's evaluated during the

00:03:53.956 --> 00:03:55.366 A:middle
Core Spotlight index update.

00:03:55.996 --> 00:03:57.476 A:middle
With the object -- the managed

00:03:57.476 --> 00:03:59.106 A:middle
object that's being updated as

00:03:59.106 --> 00:04:00.416 A:middle
the evaluated object parameter.

00:03:59.106 --> 00:04:00.416 A:middle
the evaluated object parameter.

00:04:00.946 --> 00:04:01.966 A:middle
And this allows you to return

00:04:01.966 --> 00:04:03.436 A:middle
anything that can be pushed in

00:04:03.436 --> 00:04:04.216 A:middle
to Core Spotlight.

00:04:04.216 --> 00:04:05.346 A:middle
Even something that's not one of

00:04:05.346 --> 00:04:06.396 A:middle
the base Core Data types.

00:04:06.526 --> 00:04:08.126 A:middle
Like for example an instance of

00:04:08.166 --> 00:04:09.046 A:middle
CS Localized String.

00:04:09.726 --> 00:04:11.216 A:middle
By and large, these expressions

00:04:11.216 --> 00:04:12.566 A:middle
are going to evaluate Keypaths

00:04:12.566 --> 00:04:13.516 A:middle
but they could be, you know,

00:04:13.516 --> 00:04:14.436 A:middle
much more interesting.

00:04:14.436 --> 00:04:15.276 A:middle
They could be built in

00:04:15.276 --> 00:04:17.216 A:middle
functions, lowercase, uppercase,

00:04:17.216 --> 00:04:17.976 A:middle
stuff like that.

00:04:18.406 --> 00:04:19.935 A:middle
Or if you're somebody like me

00:04:19.935 --> 00:04:21.146 A:middle
they could be completely random

00:04:21.146 --> 00:04:23.196 A:middle
functions that go often dig

00:04:23.196 --> 00:04:24.576 A:middle
around in your runtime to find

00:04:24.686 --> 00:04:26.516 A:middle
instances of classes and call

00:04:26.516 --> 00:04:27.976 A:middle
just random methods on them to

00:04:27.976 --> 00:04:28.606 A:middle
get their stuff back.

00:04:28.816 --> 00:04:30.536 A:middle
I think that's cool too.

00:04:31.326 --> 00:04:33.536 A:middle
And of course, there's the NS

00:04:33.536 --> 00:04:34.566 A:middle
Core Data Spotlight Delegate,

00:04:34.566 --> 00:04:35.676 A:middle
which is like the big and

00:04:35.676 --> 00:04:36.906 A:middle
complicated piece that we wrote

00:04:36.906 --> 00:04:37.716 A:middle
that does all the work.

00:04:38.086 --> 00:04:40.636 A:middle
It implements CS Searchable

00:04:40.636 --> 00:04:41.326 A:middle
Index Delegate.

00:04:41.416 --> 00:04:42.386 A:middle
It provides default

00:04:42.386 --> 00:04:44.086 A:middle
implementation of all methods,

00:04:44.086 --> 00:04:45.086 A:middle
so you can use it straight out

00:04:45.086 --> 00:04:46.626 A:middle
of the box.

00:04:46.626 --> 00:04:47.806 A:middle
It uses separate store on a

00:04:47.806 --> 00:04:48.936 A:middle
background thread so you don't

00:04:48.936 --> 00:04:49.926 A:middle
need to worry about any of the

00:04:49.926 --> 00:04:51.226 A:middle
work that's being done by the

00:04:51.226 --> 00:04:52.976 A:middle
Spotlight Exporter blocking your

00:04:52.976 --> 00:04:54.926 A:middle
main view context from getting

00:04:54.926 --> 00:04:55.596 A:middle
its work done.

00:04:56.516 --> 00:04:57.686 A:middle
You initialize it with a NS

00:04:57.686 --> 00:04:59.406 A:middle
Persistent Store Description and

00:04:59.406 --> 00:05:00.676 A:middle
a model since it needs to know

00:04:59.406 --> 00:05:00.676 A:middle
a model since it needs to know

00:05:00.676 --> 00:05:02.976 A:middle
what it's working with.

00:05:02.976 --> 00:05:04.336 A:middle
And basically you tell a

00:05:04.336 --> 00:05:05.956 A:middle
Persistent Store that it should

00:05:05.956 --> 00:05:08.606 A:middle
be exporting its data to Core

00:05:08.606 --> 00:05:10.586 A:middle
Spotlight by setting the

00:05:10.586 --> 00:05:12.826 A:middle
exporter as an option when in

00:05:12.826 --> 00:05:13.616 A:middle
when you're calling NS

00:05:13.616 --> 00:05:15.656 A:middle
Persistent Store with type on

00:05:15.656 --> 00:05:16.246 A:middle
the Persistent Store

00:05:16.246 --> 00:05:16.706 A:middle
Coordinator.

00:05:17.516 --> 00:05:19.256 A:middle
The override point on the

00:05:19.256 --> 00:05:20.246 A:middle
delegate if you don't like the

00:05:20.246 --> 00:05:22.956 A:middle
default behavior is NS Data Core

00:05:22.956 --> 00:05:25.236 A:middle
Spotlight delegate attribute set

00:05:25.236 --> 00:05:25.826 A:middle
for object.

00:05:26.236 --> 00:05:27.676 A:middle
And an override might look

00:05:27.676 --> 00:05:28.936 A:middle
something like this.

00:05:28.966 --> 00:05:30.146 A:middle
Here we've got a basic method

00:05:30.146 --> 00:05:31.816 A:middle
that goes through and gets the

00:05:31.816 --> 00:05:32.806 A:middle
attribute set return by the

00:05:32.806 --> 00:05:33.546 A:middle
super class.

00:05:34.686 --> 00:05:36.096 A:middle
It looks at the object, realizes

00:05:36.096 --> 00:05:37.006 A:middle
that this is an instance of a

00:05:37.006 --> 00:05:38.446 A:middle
photo because I've got like the

00:05:38.446 --> 00:05:40.046 A:middle
photo app and those photos have

00:05:40.046 --> 00:05:40.716 A:middle
tags.

00:05:40.796 --> 00:05:42.316 A:middle
And when somebody searches for

00:05:42.316 --> 00:05:44.366 A:middle
something-- when the user

00:05:44.366 --> 00:05:45.306 A:middle
searches for something, that

00:05:45.306 --> 00:05:46.606 A:middle
returns a hit on one of those

00:05:46.606 --> 00:05:47.896 A:middle
tags, I actually want to return

00:05:47.896 --> 00:05:49.186 A:middle
the photo that has that tag

00:05:49.186 --> 00:05:50.676 A:middle
because the tag itself is not

00:05:50.676 --> 00:05:51.396 A:middle
terribly interesting.

00:05:51.516 --> 00:05:53.206 A:middle
So I go and collapse all of the

00:05:53.206 --> 00:05:54.746 A:middle
tag information on to the photo

00:05:54.746 --> 00:05:56.516 A:middle
objects itself so that the photo

00:05:56.516 --> 00:05:58.186 A:middle
will be returned when there's a

00:05:58.186 --> 00:05:59.236 A:middle
match in Spotlight.

00:05:59.236 --> 00:06:01.446 A:middle
And then I just return the

00:05:59.236 --> 00:06:01.446 A:middle
And then I just return the

00:06:01.446 --> 00:06:01.956 A:middle
attribute set.

00:06:01.956 --> 00:06:04.016 A:middle
And that's as much code as we

00:06:04.016 --> 00:06:05.166 A:middle
expect most of you to ever have

00:06:05.166 --> 00:06:05.926 A:middle
to write for this.

00:06:06.396 --> 00:06:08.986 A:middle
So now I'm going to do a demo.

00:06:16.446 --> 00:06:17.206 A:middle
And I've got a little

00:06:17.206 --> 00:06:17.926 A:middle
application here.

00:06:19.116 --> 00:06:21.326 A:middle
Please ignore the x Code in the

00:06:21.326 --> 00:06:23.156 A:middle
background, we'll get there.

00:06:23.956 --> 00:06:25.446 A:middle
It displays photos.

00:06:26.206 --> 00:06:28.326 A:middle
If you scroll around, look at

00:06:29.256 --> 00:06:31.976 A:middle
stuff, click on things to see,

00:06:32.226 --> 00:06:32.436 A:middle
you know?

00:06:33.816 --> 00:06:34.736 A:middle
Photos of people enjoying

00:06:34.736 --> 00:06:35.636 A:middle
themselves with a little bit of

00:06:35.636 --> 00:06:36.666 A:middle
meta data information.

00:06:37.086 --> 00:06:38.246 A:middle
But here's the interesting part.

00:06:38.856 --> 00:06:40.026 A:middle
I can now come up to Spotlight

00:06:40.966 --> 00:06:44.916 A:middle
and type in for example,

00:06:45.476 --> 00:06:47.336 A:middle
something that I know is in

00:06:48.246 --> 00:06:50.386 A:middle
Spotlight and it automatically

00:06:50.456 --> 00:06:52.166 A:middle
activates my application and

00:06:52.546 --> 00:06:54.166 A:middle
calls the application continue

00:06:54.166 --> 00:06:56.126 A:middle
user activity method with an NS

00:06:56.126 --> 00:06:56.826 A:middle
user activity.

00:06:57.386 --> 00:06:59.006 A:middle
And here I've broken in that

00:06:59.006 --> 00:07:00.366 A:middle
method so let's see what's going

00:06:59.006 --> 00:07:00.366 A:middle
method so let's see what's going

00:07:00.366 --> 00:07:00.606 A:middle
on.

00:07:00.766 --> 00:07:03.536 A:middle
Well, somebody opened something

00:07:03.746 --> 00:07:04.756 A:middle
and I'm going to go dig around

00:07:04.756 --> 00:07:07.106 A:middle
in that user activities user

00:07:07.106 --> 00:07:08.086 A:middle
info because that's where all

00:07:08.086 --> 00:07:10.916 A:middle
the interesting stuff is and dig

00:07:10.916 --> 00:07:11.686 A:middle
out the identifier.

00:07:11.686 --> 00:07:13.746 A:middle
And if I print that identifier

00:07:13.746 --> 00:07:15.206 A:middle
we can see that well, the

00:07:15.206 --> 00:07:16.826 A:middle
identifier and the user info is

00:07:16.826 --> 00:07:18.416 A:middle
something that looks an awful

00:07:18.416 --> 00:07:19.796 A:middle
lot like a managed object ID

00:07:19.796 --> 00:07:21.076 A:middle
string representation.

00:07:21.546 --> 00:07:23.156 A:middle
So I'm going to turn that into a

00:07:23.516 --> 00:07:25.766 A:middle
URI and ask the persistent store

00:07:25.766 --> 00:07:27.386 A:middle
coordinator to turn that into a

00:07:27.386 --> 00:07:28.316 A:middle
managed object ID.

00:07:28.866 --> 00:07:31.606 A:middle
And then I'm just going to

00:07:31.606 --> 00:07:36.856 A:middle
continue and hey wow, I've

00:07:36.856 --> 00:07:39.726 A:middle
opened the photo that my user

00:07:39.766 --> 00:07:41.236 A:middle
requested.

00:07:42.636 --> 00:07:43.836 A:middle
Lovely, relaxing view.

00:07:44.516 --> 00:07:48.346 A:middle
And that sort of how the Core

00:07:48.346 --> 00:07:49.846 A:middle
Spotlight Integration works.

00:07:49.936 --> 00:07:51.326 A:middle
We do most of the work, you need

00:07:51.326 --> 00:07:54.936 A:middle
to implement a method that does

00:07:55.146 --> 00:07:56.196 A:middle
stuff.

00:07:57.046 --> 00:07:57.766 A:middle
So that's the Core Spotlight

00:07:57.766 --> 00:07:58.276 A:middle
Integration.

00:07:59.026 --> 00:08:02.696 A:middle
Some totally non-sharp corners,

00:07:59.026 --> 00:08:02.696 A:middle
Some totally non-sharp corners,

00:08:02.696 --> 00:08:03.986 A:middle
stuff we've made easy for you.

00:08:03.986 --> 00:08:05.516 A:middle
If you decide that you want to

00:08:05.516 --> 00:08:06.356 A:middle
enable the Core Spotlight

00:08:06.356 --> 00:08:08.726 A:middle
Integration and pass an exporter

00:08:08.766 --> 00:08:10.316 A:middle
to as one of the options when

00:08:10.316 --> 00:08:11.316 A:middle
you add your store to the

00:08:11.316 --> 00:08:12.266 A:middle
persistent store coordinator.

00:08:12.266 --> 00:08:14.046 A:middle
We will automatically start

00:08:14.046 --> 00:08:15.326 A:middle
exporting to Core Spotlight on

00:08:15.326 --> 00:08:16.636 A:middle
your application's first launch.

00:08:16.846 --> 00:08:18.116 A:middle
And we will continue exporting

00:08:18.116 --> 00:08:19.486 A:middle
until we have exported all of

00:08:19.486 --> 00:08:20.516 A:middle
the data even if your

00:08:20.516 --> 00:08:22.216 A:middle
application is exited, if the

00:08:22.216 --> 00:08:23.346 A:middle
user exits your application in

00:08:23.346 --> 00:08:23.836 A:middle
the meantime.

00:08:24.276 --> 00:08:25.296 A:middle
We use the Persistent History

00:08:25.296 --> 00:08:26.456 A:middle
Tracking feature to ensure that

00:08:26.456 --> 00:08:27.576 A:middle
all of the data is pushed.

00:08:28.116 --> 00:08:28.946 A:middle
Even if your application

00:08:28.946 --> 00:08:31.256 A:middle
crashes, exits, whatever that

00:08:31.316 --> 00:08:32.206 A:middle
doesn't quite work in the seed

00:08:32.206 --> 00:08:33.106 A:middle
but it will eventually.

00:08:33.816 --> 00:08:37.885 A:middle
Some slightly sharper corners,

00:08:37.946 --> 00:08:39.226 A:middle
the Core Spotlight and Spotlight

00:08:39.226 --> 00:08:40.446 A:middle
integration aren't mutually

00:08:40.446 --> 00:08:41.866 A:middle
exclusive, you can't do both.

00:08:41.866 --> 00:08:43.226 A:middle
If you try setting both entities

00:08:43.226 --> 00:08:44.956 A:middle
to Core Spotlight, Display Name

00:08:44.956 --> 00:08:47.266 A:middle
Expression, and the property is

00:08:47.266 --> 00:08:49.776 A:middle
stored in External Record, the

00:08:49.776 --> 00:08:50.736 A:middle
model compiler is going to

00:08:50.736 --> 00:08:51.586 A:middle
complain at you.

00:08:52.156 --> 00:08:53.436 A:middle
And we don't currently track the

00:08:53.436 --> 00:08:54.626 A:middle
results of batch operations.

00:08:56.496 --> 00:08:58.106 A:middle
Some slightly sharp corners.

00:08:58.346 --> 00:08:59.406 A:middle
This first one is something I

00:08:59.406 --> 00:09:00.446 A:middle
discovered while debugging

00:08:59.406 --> 00:09:00.446 A:middle
discovered while debugging

00:09:00.446 --> 00:09:02.086 A:middle
because I built all of my unit

00:09:02.086 --> 00:09:03.326 A:middle
tests in a separate framework,

00:09:03.396 --> 00:09:05.676 A:middle
which is run by XCTest, which

00:09:05.676 --> 00:09:06.876 A:middle
doesn't have this entitlement,

00:09:06.876 --> 00:09:08.356 A:middle
which made it very confusing as

00:09:08.356 --> 00:09:09.056 A:middle
to why I couldn't talk to

00:09:09.056 --> 00:09:09.486 A:middle
Spotlight.

00:09:10.346 --> 00:09:12.136 A:middle
Whatever application is trying

00:09:12.136 --> 00:09:13.156 A:middle
to talk to Spotlight, needs to

00:09:13.156 --> 00:09:13.486 A:middle
have the

00:09:13.486 --> 00:09:15.686 A:middle
com.apple.application-identifier

00:09:16.246 --> 00:09:16.776 A:middle
entitlement.

00:09:16.776 --> 00:09:17.896 A:middle
Most of you are going to get

00:09:17.896 --> 00:09:19.096 A:middle
this by default, but if you're

00:09:19.096 --> 00:09:20.486 A:middle
writing your unit tests, which

00:09:20.516 --> 00:09:22.826 A:middle
are run by XCTtest be aware of

00:09:22.826 --> 00:09:23.416 A:middle
this.

00:09:23.526 --> 00:09:24.486 A:middle
And of course you're going to

00:09:24.486 --> 00:09:25.316 A:middle
need to handle the search

00:09:25.316 --> 00:09:26.696 A:middle
result.

00:09:26.996 --> 00:09:27.986 A:middle
You need to implement

00:09:27.986 --> 00:09:30.926 A:middle
Application, Continue User

00:09:30.926 --> 00:09:32.216 A:middle
Activity on your application

00:09:32.216 --> 00:09:33.796 A:middle
delegate and you know, put

00:09:33.796 --> 00:09:35.406 A:middle
whatever you'd like in there.

00:09:35.406 --> 00:09:37.736 A:middle
We saw this on screen or the

00:09:37.736 --> 00:09:38.976 A:middle
demo, but I'm just walk through

00:09:38.976 --> 00:09:39.436 A:middle
it here.

00:09:39.916 --> 00:09:40.786 A:middle
This is the method you'd be

00:09:40.786 --> 00:09:41.406 A:middle
implementing.

00:09:41.756 --> 00:09:43.266 A:middle
Pretty simple, grab the User

00:09:43.266 --> 00:09:44.496 A:middle
Activity user info.

00:09:45.366 --> 00:09:47.766 A:middle
The identifier manage object ID

00:09:47.766 --> 00:09:49.486 A:middle
is stashed in there under KCS

00:09:49.486 --> 00:09:50.636 A:middle
Searchable Item Activity

00:09:50.636 --> 00:09:51.266 A:middle
Identifier.

00:09:51.266 --> 00:09:53.296 A:middle
Just turn that into a managed

00:09:53.296 --> 00:09:55.246 A:middle
object ID and then you can do

00:09:55.246 --> 00:09:56.036 A:middle
whatever you'd like.

00:09:57.046 --> 00:09:59.516 A:middle
Watch a new window, zoom to the

00:09:59.516 --> 00:10:00.696 A:middle
correct view, whatever.

00:09:59.516 --> 00:10:00.696 A:middle
correct view, whatever.

00:10:01.996 --> 00:10:03.956 A:middle
There are however some really

00:10:03.956 --> 00:10:04.896 A:middle
sharp corners involved.

00:10:05.186 --> 00:10:06.276 A:middle
Which is that if you were using

00:10:06.276 --> 00:10:07.666 A:middle
the old Spotlight integration,

00:10:07.666 --> 00:10:09.646 A:middle
it's going to be up to you to

00:10:09.646 --> 00:10:12.136 A:middle
delete your old reference files

00:10:12.136 --> 00:10:13.236 A:middle
if you had them on disc, because

00:10:13.236 --> 00:10:14.056 A:middle
we can't know if there was

00:10:14.056 --> 00:10:15.206 A:middle
semantic meaning to those.

00:10:15.206 --> 00:10:18.506 A:middle
And the Core Spotlight API's are

00:10:18.676 --> 00:10:20.156 A:middle
x86 only, which means that this

00:10:20.156 --> 00:10:21.886 A:middle
feature is x86 only.

00:10:21.886 --> 00:10:22.976 A:middle
So it's time to upgrade your

00:10:22.976 --> 00:10:23.706 A:middle
applications people.

00:10:25.276 --> 00:10:27.966 A:middle
And that's Core Spotlight.

00:10:28.296 --> 00:10:30.626 A:middle
We've also added a New Indexing

00:10:30.626 --> 00:10:30.866 A:middle
API.

00:10:32.886 --> 00:10:33.786 A:middle
So what is indexing?

00:10:34.036 --> 00:10:35.266 A:middle
Indexing is a way that allows

00:10:35.266 --> 00:10:36.516 A:middle
you to configure your database

00:10:36.516 --> 00:10:37.426 A:middle
to do faster searching.

00:10:38.456 --> 00:10:40.276 A:middle
You can have multiple indexes,

00:10:40.676 --> 00:10:41.706 A:middle
each of which can have multiple

00:10:41.706 --> 00:10:42.776 A:middle
columns, and a column can

00:10:42.776 --> 00:10:43.856 A:middle
actually belong to multiple

00:10:43.856 --> 00:10:44.426 A:middle
indexes.

00:10:44.426 --> 00:10:45.726 A:middle
So this allows you to set up a

00:10:45.726 --> 00:10:47.506 A:middle
lot of indexes that the database

00:10:47.506 --> 00:10:49.116 A:middle
can use to choose the most

00:10:49.116 --> 00:10:50.636 A:middle
efficient index for whatever

00:10:50.636 --> 00:10:52.346 A:middle
query it's trying to execute.

00:10:52.346 --> 00:10:53.336 A:middle
It will basically look at the

00:10:53.336 --> 00:10:54.716 A:middle
aware clause and say, oh I'm

00:10:54.716 --> 00:10:55.706 A:middle
trying to use these columns I'll

00:10:55.706 --> 00:10:56.896 A:middle
use this index.

00:10:56.896 --> 00:11:00.066 A:middle
And now I'm going to do a little

00:10:56.896 --> 00:11:00.066 A:middle
And now I'm going to do a little

00:11:00.066 --> 00:11:01.366 A:middle
bit of a digression on indexing

00:11:01.366 --> 00:11:02.416 A:middle
for those of you, you know,

00:11:02.416 --> 00:11:03.256 A:middle
aren't database heads.

00:11:04.136 --> 00:11:05.826 A:middle
The basic form of indexing that

00:11:05.826 --> 00:11:06.766 A:middle
supported everywhere by

00:11:06.766 --> 00:11:08.986 A:middle
everything is a Binary Index.

00:11:09.046 --> 00:11:11.176 A:middle
But these are very strict

00:11:11.176 --> 00:11:11.926 A:middle
comparison only.

00:11:11.926 --> 00:11:13.046 A:middle
They basically look at the bits

00:11:13.046 --> 00:11:14.126 A:middle
and say are these bits the same?

00:11:14.126 --> 00:11:16.116 A:middle
And if not, you know, it's not

00:11:16.116 --> 00:11:17.996 A:middle
an index head.

00:11:18.196 --> 00:11:20.596 A:middle
But over time more types of

00:11:20.596 --> 00:11:22.186 A:middle
indexes have become popular and

00:11:22.186 --> 00:11:22.966 A:middle
something that's really

00:11:22.966 --> 00:11:25.206 A:middle
especially nowadays is super

00:11:25.206 --> 00:11:27.226 A:middle
useful is an RTree Index, which

00:11:27.226 --> 00:11:28.736 A:middle
is a type of index that's

00:11:28.736 --> 00:11:30.216 A:middle
optimized for doing range base

00:11:30.216 --> 00:11:30.596 A:middle
searching.

00:11:30.776 --> 00:11:32.626 A:middle
So a binary index sort of looks

00:11:32.626 --> 00:11:33.046 A:middle
like this.

00:11:33.046 --> 00:11:33.886 A:middle
This is the kind of data you

00:11:33.886 --> 00:11:34.976 A:middle
might have, a bunch of -- you

00:11:34.976 --> 00:11:36.886 A:middle
know, unit dimensional stuff.

00:11:36.886 --> 00:11:38.166 A:middle
And if you build a BTree on it

00:11:38.166 --> 00:11:39.046 A:middle
you end up with something that

00:11:39.046 --> 00:11:40.696 A:middle
looks a lot like this.

00:11:41.526 --> 00:11:43.266 A:middle
You know for every node that all

00:11:43.266 --> 00:11:44.656 A:middle
of the nodes -- child nodes to

00:11:44.656 --> 00:11:47.496 A:middle
the left are smaller valued than

00:11:47.686 --> 00:11:49.556 A:middle
the parent node and all the

00:11:49.856 --> 00:11:51.056 A:middle
nodes to the right are larger

00:11:51.056 --> 00:11:52.346 A:middle
valued and you just navigate

00:11:52.346 --> 00:11:53.286 A:middle
down very, very simply.

00:11:54.056 --> 00:11:55.456 A:middle
But RTree Data often looks a lot

00:11:55.456 --> 00:11:56.326 A:middle
more like this.

00:11:56.326 --> 00:11:57.686 A:middle
You end up having lots of, you

00:11:57.686 --> 00:11:59.366 A:middle
know, odd shapes,

00:11:59.366 --> 00:12:00.696 A:middle
multidimensional things.

00:11:59.366 --> 00:12:00.696 A:middle
multidimensional things.

00:12:00.906 --> 00:12:02.546 A:middle
They're often overlapping in

00:12:02.546 --> 00:12:03.706 A:middle
weird and odd ways.

00:12:04.096 --> 00:12:05.736 A:middle
And there's no really great way

00:12:05.736 --> 00:12:07.756 A:middle
to organize those in a unit

00:12:07.756 --> 00:12:09.296 A:middle
directional linear Binary tree.

00:12:09.776 --> 00:12:11.716 A:middle
And RTree Data often is stored

00:12:11.716 --> 00:12:12.406 A:middle
more like this.

00:12:12.406 --> 00:12:14.016 A:middle
You have a range zero, which is

00:12:14.016 --> 00:12:15.216 A:middle
the minimum bounding blocks

00:12:15.216 --> 00:12:17.376 A:middle
around all of its subcomponents

00:12:17.456 --> 00:12:19.066 A:middle
or its set elements.

00:12:19.396 --> 00:12:21.106 A:middle
For example range element fully

00:12:21.106 --> 00:12:23.596 A:middle
contains the ranges R6 and R10.

00:12:23.796 --> 00:12:26.506 A:middle
And R6 in turn has a single

00:12:26.506 --> 00:12:28.346 A:middle
child R7, which has more

00:12:28.346 --> 00:12:28.706 A:middle
children.

00:12:28.706 --> 00:12:30.056 A:middle
This is actually a slightly

00:12:30.056 --> 00:12:31.516 A:middle
unbalanced RTree but oh well,

00:12:31.546 --> 00:12:33.676 A:middle
we'll live with it.

00:12:34.516 --> 00:12:36.616 A:middle
The current indexing APIs, well

00:12:36.616 --> 00:12:37.416 A:middle
we have two of them.

00:12:38.046 --> 00:12:40.236 A:middle
You can create a single property

00:12:40.236 --> 00:12:42.486 A:middle
index by calling an NS Attribute

00:12:42.486 --> 00:12:44.016 A:middle
Description is Indexed.

00:12:44.266 --> 00:12:45.646 A:middle
Set that property and we'll

00:12:45.676 --> 00:12:46.606 A:middle
create an index on it.

00:12:46.706 --> 00:12:48.136 A:middle
If you want to do a multi column

00:12:48.136 --> 00:12:49.846 A:middle
index you'll call NS Entity

00:12:49.846 --> 00:12:51.196 A:middle
Description compound Indexes.

00:12:51.566 --> 00:12:52.726 A:middle
And that allows you to create an

00:12:52.726 --> 00:12:53.826 A:middle
index that has, you know, three,

00:12:53.826 --> 00:12:55.016 A:middle
four, five columns in it.

00:12:55.576 --> 00:12:56.786 A:middle
But both of these API's

00:12:56.816 --> 00:12:58.886 A:middle
automatically and only create a

00:12:58.886 --> 00:13:01.536 A:middle
Binary Index in ascending order.

00:12:58.886 --> 00:13:01.536 A:middle
Binary Index in ascending order.

00:13:02.106 --> 00:13:04.376 A:middle
And we kind of wanted to evolve

00:13:04.506 --> 00:13:05.696 A:middle
the Core Data APIs, make them

00:13:05.696 --> 00:13:07.236 A:middle
ore powerful, a lot of them

00:13:07.236 --> 00:13:08.406 A:middle
specifying new and interesting

00:13:08.406 --> 00:13:10.376 A:middle
things, more configurable.

00:13:10.666 --> 00:13:12.396 A:middle
So we've added a bunch of new

00:13:12.396 --> 00:13:13.306 A:middle
model classes.

00:13:14.296 --> 00:13:15.856 A:middle
First is NS Fetch Index

00:13:15.856 --> 00:13:17.916 A:middle
Description, NS Fetch Element

00:13:17.916 --> 00:13:19.516 A:middle
Description, and we've added a

00:13:19.516 --> 00:13:20.756 A:middle
new method on NS Entity

00:13:20.756 --> 00:13:22.646 A:middle
Description indexes which takes

00:13:22.806 --> 00:13:24.386 A:middle
a Fetch Index Description as

00:13:24.386 --> 00:13:26.726 A:middle
it's -- an array of Fetch index

00:13:26.726 --> 00:13:27.916 A:middle
descriptions as its parameter.

00:13:28.766 --> 00:13:29.876 A:middle
And we've added some functions

00:13:29.876 --> 00:13:31.396 A:middle
to control whether the database

00:13:31.396 --> 00:13:32.566 A:middle
should or should not use a

00:13:32.566 --> 00:13:34.316 A:middle
specific index when its

00:13:34.316 --> 00:13:35.576 A:middle
evaluating a given query.

00:13:35.616 --> 00:13:37.766 A:middle
And we've added index by, which

00:13:37.766 --> 00:13:39.086 A:middle
allows you to say, hey really

00:13:39.086 --> 00:13:39.946 A:middle
use this index.

00:13:40.526 --> 00:13:42.406 A:middle
And no index has existed for

00:13:42.406 --> 00:13:43.416 A:middle
awhile and it's a way of saying

00:13:43.916 --> 00:13:45.016 A:middle
I know better than you and I

00:13:45.016 --> 00:13:45.846 A:middle
know better than your query

00:13:45.846 --> 00:13:47.146 A:middle
optimizer, don't use an index

00:13:47.146 --> 00:13:49.346 A:middle
for this specific component of

00:13:49.346 --> 00:13:50.076 A:middle
the where clause.

00:13:50.656 --> 00:13:54.056 A:middle
NS Fetch Index Element

00:13:54.056 --> 00:13:55.456 A:middle
Description is sort of the basic

00:13:55.456 --> 00:13:55.956 A:middle
component.

00:13:55.956 --> 00:13:57.576 A:middle
It allows you to specify an

00:13:58.136 --> 00:13:59.406 A:middle
Index Element, basically a

00:13:59.406 --> 00:14:00.096 A:middle
single property.

00:13:59.406 --> 00:14:00.096 A:middle
single property.

00:14:01.006 --> 00:14:02.236 A:middle
You can specify the type of

00:14:02.236 --> 00:14:03.396 A:middle
index that should be created on

00:14:03.396 --> 00:14:04.296 A:middle
that property, whether it's

00:14:04.296 --> 00:14:06.406 A:middle
going to be Binary or an RTree.

00:14:07.066 --> 00:14:08.426 A:middle
And if it's Binary index it also

00:14:08.426 --> 00:14:09.626 A:middle
has you specify a direction,

00:14:09.776 --> 00:14:10.746 A:middle
ascending or descending.

00:14:10.746 --> 00:14:12.656 A:middle
And this can be important if

00:14:12.656 --> 00:14:13.526 A:middle
you're doing certain types of

00:14:13.526 --> 00:14:13.996 A:middle
searches.

00:14:13.996 --> 00:14:14.866 A:middle
For example if you're doing a

00:14:14.866 --> 00:14:16.336 A:middle
male search you want to start

00:14:16.336 --> 00:14:17.716 A:middle
with the most recent data first,

00:14:17.996 --> 00:14:19.146 A:middle
instead of the oldest data

00:14:19.146 --> 00:14:19.596 A:middle
first.

00:14:19.596 --> 00:14:21.636 A:middle
So direction changes the order

00:14:21.636 --> 00:14:24.616 A:middle
in which the database will look

00:14:24.616 --> 00:14:25.866 A:middle
at the contents of the index.

00:14:26.446 --> 00:14:30.436 A:middle
A Fetch Index Description allows

00:14:30.436 --> 00:14:32.066 A:middle
you to combine a bunch of Fetch

00:14:32.066 --> 00:14:33.786 A:middle
Index Elements into a single

00:14:33.786 --> 00:14:35.516 A:middle
index, which you'll give a name

00:14:36.346 --> 00:14:37.956 A:middle
and optionally you can set a

00:14:37.956 --> 00:14:40.486 A:middle
predicate that says only put

00:14:40.486 --> 00:14:41.846 A:middle
rows matching this predicate

00:14:41.846 --> 00:14:42.506 A:middle
into the index.

00:14:43.646 --> 00:14:44.826 A:middle
It also does some validation of

00:14:44.826 --> 00:14:45.956 A:middle
the index composition to make

00:14:45.956 --> 00:14:48.266 A:middle
sure the index you've created is

00:14:48.576 --> 00:14:49.106 A:middle
reasonable.

00:14:49.566 --> 00:14:52.046 A:middle
Some Sharp Corners here, you

00:14:52.046 --> 00:14:53.176 A:middle
can't mix and match element

00:14:53.176 --> 00:14:54.776 A:middle
types right now.

00:14:55.146 --> 00:14:56.376 A:middle
It's either going to be an RTree

00:14:56.556 --> 00:14:57.766 A:middle
or a Binary index.

00:14:58.496 --> 00:15:00.146 A:middle
Range indexes can only be

00:14:58.496 --> 00:15:00.146 A:middle
Range indexes can only be

00:15:00.146 --> 00:15:01.866 A:middle
created on numeric properties

00:15:01.866 --> 00:15:03.406 A:middle
less than or equal to 32 bit.

00:15:03.406 --> 00:15:04.666 A:middle
That's a restriction of the

00:15:04.666 --> 00:15:06.646 A:middle
underlying SQLite database.

00:15:06.866 --> 00:15:08.306 A:middle
If you're creating your own

00:15:08.306 --> 00:15:10.606 A:middle
incremental store and that's a

00:15:10.606 --> 00:15:12.026 A:middle
restriction -- that's a problem

00:15:12.026 --> 00:15:13.006 A:middle
for you, let us know and we'll

00:15:13.006 --> 00:15:13.926 A:middle
see what we can do about it.

00:15:14.416 --> 00:15:17.126 A:middle
But Range -- properties that are

00:15:17.126 --> 00:15:19.306 A:middle
being put in a Ranged Index also

00:15:19.306 --> 00:15:20.026 A:middle
can't be optional.

00:15:20.656 --> 00:15:21.666 A:middle
Range of null is a little bit

00:15:21.666 --> 00:15:23.146 A:middle
undefined right now.

00:15:23.706 --> 00:15:24.676 A:middle
And if you're building your

00:15:24.676 --> 00:15:26.596 A:middle
model in code and we know some

00:15:26.596 --> 00:15:27.496 A:middle
of you do it, and I've helped

00:15:27.496 --> 00:15:29.086 A:middle
some of you at previous WWDC's.

00:15:29.086 --> 00:15:31.636 A:middle
If you change your entities

00:15:31.636 --> 00:15:33.106 A:middle
structurally after you've set

00:15:33.106 --> 00:15:35.136 A:middle
indexes, then we're just going

00:15:35.136 --> 00:15:35.916 A:middle
to drop the index.

00:15:36.126 --> 00:15:37.236 A:middle
And that actually applies for

00:15:37.236 --> 00:15:38.296 A:middle
the entire entity hierarchy.

00:15:38.376 --> 00:15:40.076 A:middle
If you add or remove an entity

00:15:40.076 --> 00:15:41.466 A:middle
in the hierarchy or add or

00:15:41.466 --> 00:15:42.636 A:middle
remove properties on any of

00:15:42.636 --> 00:15:44.276 A:middle
those entities, we can no longer

00:15:44.276 --> 00:15:45.556 A:middle
be sure the index is valid so

00:15:45.556 --> 00:15:46.926 A:middle
we're just going to drop it.

00:15:46.956 --> 00:15:47.526 A:middle
Do it last.

00:15:50.856 --> 00:15:52.536 A:middle
As you may know from previous

00:15:52.666 --> 00:15:55.126 A:middle
versions, changing the indexes

00:15:55.176 --> 00:15:57.406 A:middle
on an entity doesn't actually

00:15:57.406 --> 00:15:58.386 A:middle
change the entities version

00:15:58.386 --> 00:16:00.206 A:middle
Hash, which means that there's

00:15:58.386 --> 00:16:00.206 A:middle
Hash, which means that there's

00:16:00.206 --> 00:16:01.986 A:middle
not going to be migration when

00:16:02.606 --> 00:16:05.456 A:middle
the user first launches your new

00:16:05.456 --> 00:16:06.936 A:middle
version of your application with

00:16:07.106 --> 00:16:07.946 A:middle
the new indexes.

00:16:08.436 --> 00:16:09.116 A:middle
So there's not going to be a

00:16:09.116 --> 00:16:09.676 A:middle
performance head.

00:16:09.766 --> 00:16:11.216 A:middle
On the other side it's not going

00:16:11.216 --> 00:16:12.896 A:middle
to cause a migration so they're

00:16:12.896 --> 00:16:13.656 A:middle
not going to get updated

00:16:13.656 --> 00:16:14.076 A:middle
indexes.

00:16:14.076 --> 00:16:16.126 A:middle
If you want to cause the index

00:16:16.186 --> 00:16:17.406 A:middle
of migration to happen and for

00:16:17.406 --> 00:16:18.486 A:middle
the indexes to be updated,

00:16:18.486 --> 00:16:19.726 A:middle
you'll need to call the --

00:16:19.826 --> 00:16:21.236 A:middle
Update the model's version Hash

00:16:21.236 --> 00:16:22.836 A:middle
Identifier and that will trigger

00:16:22.836 --> 00:16:23.406 A:middle
a migration.

00:16:23.446 --> 00:16:25.926 A:middle
The SQL store is going to ignore

00:16:25.926 --> 00:16:26.926 A:middle
any indexes it doesn't

00:16:26.926 --> 00:16:27.506 A:middle
understand.

00:16:27.596 --> 00:16:29.686 A:middle
So what that means is that if

00:16:29.686 --> 00:16:31.006 A:middle
you open your database after you

00:16:31.006 --> 00:16:32.486 A:middle
think you've added indexes and

00:16:32.486 --> 00:16:34.006 A:middle
don't see them, go look at the

00:16:34.006 --> 00:16:35.496 A:middle
application console, it probably

00:16:35.496 --> 00:16:36.486 A:middle
told you why you're not seeing

00:16:36.486 --> 00:16:36.626 A:middle
them.

00:16:37.156 --> 00:16:39.706 A:middle
And I'm going to do another demo

00:16:39.706 --> 00:16:39.956 A:middle
here.

00:16:41.086 --> 00:16:42.036 A:middle
I have a model here.

00:16:42.866 --> 00:16:43.826 A:middle
And I'm actually not going to

00:16:43.826 --> 00:16:46.316 A:middle
work with my live model because

00:16:46.316 --> 00:16:48.126 A:middle
this is a demo and I will

00:16:48.476 --> 00:16:51.306 A:middle
inevitably typo something, but

00:16:51.586 --> 00:16:54.456 A:middle
adding a new index in the new

00:16:54.666 --> 00:16:55.616 A:middle
modeling tools is actually

00:16:55.616 --> 00:16:56.126 A:middle
pretty simple.

00:16:56.246 --> 00:16:57.776 A:middle
You select the entity that you

00:16:57.776 --> 00:16:59.976 A:middle
want to add an index to and just

00:16:59.976 --> 00:17:01.946 A:middle
come down here to add entity and

00:16:59.976 --> 00:17:01.946 A:middle
come down here to add entity and

00:17:01.946 --> 00:17:03.786 A:middle
you can now see that it has an

00:17:03.846 --> 00:17:05.786 A:middle
Add Fetch Index option.

00:17:06.306 --> 00:17:07.836 A:middle
And you just add one, call it by

00:17:07.836 --> 00:17:11.856 A:middle
Location, and I can add a couple

00:17:11.856 --> 00:17:14.336 A:middle
of properties to it here -- the

00:17:14.576 --> 00:17:16.406 A:middle
latitude and longitude

00:17:16.406 --> 00:17:17.006 A:middle
properties.

00:17:18.116 --> 00:17:19.566 A:middle
And if come over here and select

00:17:19.606 --> 00:17:22.286 A:middle
the photo, you'd come in here

00:17:22.286 --> 00:17:23.435 A:middle
and change the Version Hash

00:17:23.556 --> 00:17:24.046 A:middle
Modifier.

00:17:27.046 --> 00:17:29.686 A:middle
And now the next time a user

00:17:29.686 --> 00:17:30.776 A:middle
launches an application that

00:17:30.776 --> 00:17:32.256 A:middle
uses this version of the model,

00:17:32.766 --> 00:17:34.786 A:middle
they're going to be using the

00:17:34.786 --> 00:17:35.696 A:middle
new RTree index.

00:17:35.826 --> 00:17:37.636 A:middle
Of course I am going to just

00:17:37.636 --> 00:17:39.426 A:middle
going to run my demo application

00:17:39.736 --> 00:17:42.726 A:middle
which already had that built in.

00:17:44.616 --> 00:17:44.716 A:middle
And --

00:17:48.586 --> 00:17:49.966 A:middle
-- I'm going to come down here

00:17:50.706 --> 00:17:52.606 A:middle
and grab the Predicate that I

00:17:52.606 --> 00:17:56.956 A:middle
have carefully set aside -- oh I

00:17:56.956 --> 00:17:57.656 A:middle
forgot one thing.

00:17:58.106 --> 00:18:01.556 A:middle
I'm going to come up here and

00:17:58.106 --> 00:18:01.556 A:middle
I'm going to come up here and

00:18:01.556 --> 00:18:03.186 A:middle
edit the scheme, because we want

00:18:03.186 --> 00:18:04.616 A:middle
to see what Core Data is sending

00:18:04.616 --> 00:18:05.916 A:middle
to the database.

00:18:06.126 --> 00:18:07.836 A:middle
And I've got the Com Apple SQL

00:18:07.836 --> 00:18:10.066 A:middle
Debug Argument Set.

00:18:10.066 --> 00:18:10.946 A:middle
And you'll notice -- for those

00:18:10.946 --> 00:18:12.486 A:middle
of you who are familiar with SQL

00:18:12.486 --> 00:18:14.796 A:middle
Debug as a feature in Core Data,

00:18:15.446 --> 00:18:16.406 A:middle
you're probably most familiar

00:18:16.406 --> 00:18:19.076 A:middle
with 1 and 2 as the numbers --

00:18:19.176 --> 00:18:20.206 A:middle
the levels you're going to be

00:18:20.206 --> 00:18:20.536 A:middle
setting.

00:18:20.966 --> 00:18:23.066 A:middle
We've added a new level 4, which

00:18:23.066 --> 00:18:24.376 A:middle
will actually print the query

00:18:24.376 --> 00:18:26.536 A:middle
plan that SQLite is using as

00:18:26.536 --> 00:18:27.886 A:middle
well as all of the statements

00:18:28.666 --> 00:18:30.226 A:middle
that Core Data is sending to the

00:18:30.226 --> 00:18:30.816 A:middle
database.

00:18:30.936 --> 00:18:31.886 A:middle
So I'm going to run my

00:18:31.886 --> 00:18:35.206 A:middle
application with that version

00:18:35.206 --> 00:18:35.696 A:middle
set to 4.

00:18:36.956 --> 00:18:42.676 A:middle
Come back, reset that predicate,

00:18:44.416 --> 00:18:45.596 A:middle
and run the search.

00:18:46.216 --> 00:18:49.646 A:middle
And now we can come and we see

00:18:49.736 --> 00:18:50.656 A:middle
the last search.

00:18:51.036 --> 00:18:54.296 A:middle
It's actually kind of more

00:18:54.296 --> 00:18:55.086 A:middle
interesting and I'm going to

00:18:55.086 --> 00:18:57.236 A:middle
come over here and I've actually

00:18:57.366 --> 00:18:58.516 A:middle
copied and pasted an earlier

00:18:58.516 --> 00:19:00.626 A:middle
version into Text Edit, because

00:18:58.516 --> 00:19:00.626 A:middle
version into Text Edit, because

00:19:00.626 --> 00:19:01.746 A:middle
I could enlarge the text there.

00:19:03.836 --> 00:19:05.386 A:middle
But you can see I'm now doing a

00:19:05.386 --> 00:19:07.226 A:middle
sub Select against a separate

00:19:07.226 --> 00:19:10.156 A:middle
table, Z Photo by Location.

00:19:10.996 --> 00:19:12.836 A:middle
And if I look down in the query

00:19:12.836 --> 00:19:14.226 A:middle
plan, you can see that this is a

00:19:14.226 --> 00:19:15.406 A:middle
virtual table index.

00:19:15.846 --> 00:19:17.426 A:middle
So that's basically routing the

00:19:17.426 --> 00:19:19.666 A:middle
location query, the latitude

00:19:19.666 --> 00:19:21.586 A:middle
query down onto a separate RTree

00:19:21.586 --> 00:19:21.926 A:middle
table.

00:19:22.926 --> 00:19:24.276 A:middle
And well, we can see up here

00:19:24.276 --> 00:19:26.426 A:middle
that it says it took 0.056

00:19:26.426 --> 00:19:27.836 A:middle
seconds for 16 rows.

00:19:27.916 --> 00:19:29.476 A:middle
And if I go compare this to the

00:19:29.476 --> 00:19:31.866 A:middle
version without the RTree, well

00:19:31.866 --> 00:19:33.546 A:middle
there's the query we were

00:19:33.546 --> 00:19:34.926 A:middle
originally doing, Z Longitude

00:19:34.926 --> 00:19:36.276 A:middle
between this and this.

00:19:37.196 --> 00:19:38.766 A:middle
And we can see that it took

00:19:38.956 --> 00:19:41.906 A:middle
0.062 seconds for 16 rows.

00:19:41.906 --> 00:19:42.926 A:middle
So you got to do about a 10

00:19:42.926 --> 00:19:44.176 A:middle
percent performance improvement

00:19:44.216 --> 00:19:47.096 A:middle
on a laptop with an SSD Fast

00:19:47.096 --> 00:19:48.606 A:middle
Cash, all that kind of stuff.

00:19:48.606 --> 00:19:49.386 A:middle
So it's about a 10 percent

00:19:49.386 --> 00:19:50.706 A:middle
improvement your devices are

00:19:50.706 --> 00:19:51.756 A:middle
actually going to -- and it's

00:19:51.756 --> 00:19:52.926 A:middle
also a very small data set.

00:19:53.206 --> 00:19:54.486 A:middle
Your devices with a larger data

00:19:54.486 --> 00:19:55.356 A:middle
set are really going to

00:19:55.356 --> 00:19:57.296 A:middle
appreciate having RTree's to

00:19:57.296 --> 00:19:58.566 A:middle
search against instead of

00:19:58.726 --> 00:19:59.976 A:middle
regular Binary Indexes.

00:20:01.096 --> 00:20:01.756 A:middle
And --

00:20:04.116 --> 00:20:05.326 A:middle
I think I'm done here.

00:20:06.786 --> 00:20:11.696 A:middle
So that is RTree searching.

00:20:12.816 --> 00:20:14.236 A:middle
I have one more slide before I

00:20:14.236 --> 00:20:15.296 A:middle
hand you over to Rishi.

00:20:15.886 --> 00:20:16.656 A:middle
We've also added some

00:20:16.656 --> 00:20:17.856 A:middle
miscellaneous new stuff.

00:20:19.756 --> 00:20:21.536 A:middle
Basically new attribute types.

00:20:21.536 --> 00:20:23.816 A:middle
We've added NSUUIDA Attribute

00:20:23.816 --> 00:20:25.806 A:middle
Type and a NSURL Attribute type

00:20:25.806 --> 00:20:28.096 A:middle
backed by the UUID and URL value

00:20:28.096 --> 00:20:28.976 A:middle
classes respectively.

00:20:29.516 --> 00:20:33.546 A:middle
[ Applause ]

00:20:34.046 --> 00:20:35.086 A:middle
You appreciate the work we do.

00:20:35.546 --> 00:20:36.196 A:middle
That makes us feel good.

00:20:36.196 --> 00:20:37.836 A:middle
And now I'm going to hand you

00:20:37.836 --> 00:20:38.126 A:middle
over --

00:20:41.226 --> 00:20:41.836 A:middle
&gt;&gt; Thank you.

00:20:42.516 --> 00:20:47.036 A:middle
[ Applause ]

00:20:47.536 --> 00:20:49.046 A:middle
&gt;&gt; Hi everybody I'm Rishi Verma

00:20:49.046 --> 00:20:49.856 A:middle
and I'll be showing you

00:20:49.896 --> 00:20:51.026 A:middle
Persistent History Tracking.

00:20:52.626 --> 00:20:53.936 A:middle
So let's talk a little bit about

00:20:53.936 --> 00:20:54.316 A:middle
your app.

00:20:54.946 --> 00:20:55.776 A:middle
So you've developed these

00:20:55.776 --> 00:20:57.336 A:middle
amazing apps and hopefully

00:20:57.336 --> 00:20:58.706 A:middle
you've adopted the NS Persistent

00:20:58.706 --> 00:20:59.996 A:middle
Container we introduced last

00:20:59.996 --> 00:21:00.306 A:middle
release.

00:20:59.996 --> 00:21:00.306 A:middle
release.

00:21:00.526 --> 00:21:01.826 A:middle
So you've got a View Context set

00:21:01.826 --> 00:21:03.446 A:middle
up and a Background Context.

00:21:04.236 --> 00:21:05.756 A:middle
And you've got a Shared

00:21:05.756 --> 00:21:07.136 A:middle
Container where you've set up

00:21:07.136 --> 00:21:07.906 A:middle
your Persistent Store.

00:21:09.116 --> 00:21:10.416 A:middle
Now your view context is one

00:21:10.416 --> 00:21:11.696 A:middle
connection and your background

00:21:11.696 --> 00:21:12.636 A:middle
context is another.

00:21:13.146 --> 00:21:14.336 A:middle
And maybe you've got your

00:21:14.336 --> 00:21:16.556 A:middle
background context downloading

00:21:16.556 --> 00:21:18.336 A:middle
contend from the remote site

00:21:18.336 --> 00:21:19.096 A:middle
that you have set up.

00:21:20.636 --> 00:21:22.046 A:middle
Now you're a very diligent

00:21:22.046 --> 00:21:23.316 A:middle
developer and you've gone out

00:21:23.316 --> 00:21:24.716 A:middle
and created a Document

00:21:24.716 --> 00:21:26.686 A:middle
Extension, a Shared Extension,

00:21:27.086 --> 00:21:28.366 A:middle
and a Photo Editing Extension.

00:21:28.716 --> 00:21:30.026 A:middle
Now all of these connections to

00:21:30.026 --> 00:21:31.596 A:middle
your persistent store could be

00:21:31.596 --> 00:21:34.066 A:middle
running in any process since

00:21:34.066 --> 00:21:35.456 A:middle
they're extensions, or they

00:21:35.456 --> 00:21:36.506 A:middle
could be coming from our app

00:21:36.506 --> 00:21:37.526 A:middle
from various context.

00:21:37.916 --> 00:21:39.146 A:middle
And you may not know exactly

00:21:39.146 --> 00:21:40.396 A:middle
where this data is coming from.

00:21:40.576 --> 00:21:42.306 A:middle
Well, let's break it down a

00:21:42.306 --> 00:21:44.626 A:middle
little bit and see what happens.

00:21:45.866 --> 00:21:49.956 A:middle
So sorry, so here we are in your

00:21:49.956 --> 00:21:53.426 A:middle
app and the user is looking at

00:21:53.426 --> 00:21:55.096 A:middle
your view context and in the

00:21:55.096 --> 00:21:56.576 A:middle
meantime your background context

00:21:56.576 --> 00:21:58.416 A:middle
is downloading info from some

00:21:58.416 --> 00:21:59.056 A:middle
remote source.

00:21:59.676 --> 00:22:01.406 A:middle
Unfortunately a common thing

00:21:59.676 --> 00:22:01.406 A:middle
Unfortunately a common thing

00:22:01.406 --> 00:22:02.406 A:middle
that we've seen is that your

00:22:02.406 --> 00:22:03.616 A:middle
Background Context may be

00:22:03.616 --> 00:22:05.686 A:middle
ingesting and your View Context

00:22:06.066 --> 00:22:07.046 A:middle
may not know about these

00:22:07.046 --> 00:22:09.136 A:middle
objects, or it may not even care

00:22:09.136 --> 00:22:09.936 A:middle
about these objects.

00:22:10.416 --> 00:22:11.766 A:middle
But as your Save Notifications

00:22:11.766 --> 00:22:13.266 A:middle
come in, you're ingesting them

00:22:13.266 --> 00:22:13.716 A:middle
anyways.

00:22:14.496 --> 00:22:16.756 A:middle
And so you're going to be

00:22:16.756 --> 00:22:18.086 A:middle
missing some changes, if you

00:22:18.086 --> 00:22:19.316 A:middle
missed out new Background

00:22:19.316 --> 00:22:20.666 A:middle
Context, because they're really

00:22:20.666 --> 00:22:21.736 A:middle
easy to generate at this time

00:22:22.146 --> 00:22:23.516 A:middle
but you may miss out on Batch

00:22:23.516 --> 00:22:25.296 A:middle
Updates, Batch Deletes, which

00:22:25.296 --> 00:22:26.176 A:middle
don't generate a Save

00:22:26.176 --> 00:22:26.826 A:middle
notification.

00:22:27.636 --> 00:22:30.626 A:middle
Now the user's gone into Safari

00:22:31.086 --> 00:22:32.426 A:middle
and decided to share something.

00:22:33.146 --> 00:22:35.356 A:middle
This writes to the database and

00:22:35.356 --> 00:22:36.596 A:middle
when you're developer comes back

00:22:36.596 --> 00:22:38.306 A:middle
to the app -- or when you're

00:22:38.306 --> 00:22:39.556 A:middle
user comes back to the app, you

00:22:39.556 --> 00:22:41.076 A:middle
don't know what's changed.

00:22:41.646 --> 00:22:42.786 A:middle
You know something's changed,

00:22:42.786 --> 00:22:44.726 A:middle
but what exactly you don't know.

00:22:45.116 --> 00:22:46.266 A:middle
And so you have to rescan the

00:22:46.266 --> 00:22:48.016 A:middle
entire database and see what has

00:22:48.106 --> 00:22:49.126 A:middle
changed since you last were

00:22:49.126 --> 00:22:49.306 A:middle
there.

00:22:50.646 --> 00:22:52.426 A:middle
And unfortunately sometimes our

00:22:52.426 --> 00:22:52.986 A:middle
apps crash.

00:22:53.126 --> 00:22:55.506 A:middle
It may be due to the user

00:22:56.116 --> 00:22:57.516 A:middle
quitting your app while a

00:22:57.516 --> 00:22:58.886 A:middle
Background Contact was going.

00:22:59.306 --> 00:23:00.536 A:middle
And when your app comes back up,

00:22:59.306 --> 00:23:00.536 A:middle
And when your app comes back up,

00:23:00.986 --> 00:23:02.466 A:middle
your Background Context doesn't

00:23:02.466 --> 00:23:03.776 A:middle
know necessarily where it left

00:23:03.776 --> 00:23:05.176 A:middle
off, scanning your local

00:23:05.176 --> 00:23:05.616 A:middle
database.

00:23:05.786 --> 00:23:07.126 A:middle
So it'll have to check with

00:23:07.126 --> 00:23:08.696 A:middle
remote content and rescan the

00:23:08.696 --> 00:23:10.476 A:middle
entire local database to see

00:23:10.476 --> 00:23:11.696 A:middle
where it needs to be picked up

00:23:11.696 --> 00:23:12.046 A:middle
again.

00:23:12.586 --> 00:23:15.166 A:middle
Let's break this example down

00:23:15.166 --> 00:23:15.916 A:middle
just a little bit more.

00:23:16.646 --> 00:23:18.316 A:middle
So we have an app, and it

00:23:18.316 --> 00:23:19.546 A:middle
decides to load some data.

00:23:19.986 --> 00:23:21.236 A:middle
So the Background Context loads

00:23:21.236 --> 00:23:23.056 A:middle
some data and the View Context

00:23:23.586 --> 00:23:24.206 A:middle
gets updated.

00:23:24.966 --> 00:23:26.176 A:middle
Now when the user suspends the

00:23:26.176 --> 00:23:28.206 A:middle
app, and the document extension

00:23:28.206 --> 00:23:30.506 A:middle
comes up, we'll see that data

00:23:30.506 --> 00:23:31.816 A:middle
inserts two new objects.

00:23:33.066 --> 00:23:34.456 A:middle
And then my Share Extension

00:23:34.456 --> 00:23:36.606 A:middle
comes along, updates an object

00:23:36.606 --> 00:23:37.556 A:middle
and inserts another one.

00:23:38.096 --> 00:23:39.836 A:middle
And so does my Photos Extension.

00:23:41.046 --> 00:23:43.466 A:middle
Once all of these are done I'll

00:23:43.466 --> 00:23:45.606 A:middle
come back to my app and notice

00:23:45.716 --> 00:23:49.566 A:middle
that some of the data is stale.

00:23:50.446 --> 00:23:53.866 A:middle
So our app here only knows about

00:23:53.866 --> 00:23:55.026 A:middle
these original six objects.

00:23:55.476 --> 00:23:56.636 A:middle
The rest of the database is

00:23:56.636 --> 00:23:58.926 A:middle
actually modified or it actually

00:23:58.926 --> 00:23:59.656 A:middle
doesn't know about these

00:23:59.656 --> 00:24:00.106 A:middle
objects.

00:23:59.656 --> 00:24:00.106 A:middle
objects.

00:24:00.936 --> 00:24:02.516 A:middle
So it has to go through and scan

00:24:02.516 --> 00:24:03.556 A:middle
everything and see what's

00:24:03.556 --> 00:24:05.786 A:middle
relevant to that View Context or

00:24:05.786 --> 00:24:07.656 A:middle
that Background Context.

00:24:09.676 --> 00:24:11.086 A:middle
Now we've introduced NS

00:24:11.196 --> 00:24:12.046 A:middle
Persistent History.

00:24:12.046 --> 00:24:13.476 A:middle
It's rather simple.

00:24:14.846 --> 00:24:16.996 A:middle
Grab your Container, grab your

00:24:16.996 --> 00:24:21.196 A:middle
Store Description and voila.

00:24:22.856 --> 00:24:24.336 A:middle
Set the option NS Persistent

00:24:24.336 --> 00:24:26.476 A:middle
History Tracking to true and we

00:24:26.476 --> 00:24:28.036 A:middle
will now track all of your

00:24:28.036 --> 00:24:28.946 A:middle
changes to your database.

00:24:29.036 --> 00:24:32.036 A:middle
So let's go back to that

00:24:32.036 --> 00:24:32.936 A:middle
previous-- thank you.

00:24:33.516 --> 00:24:36.856 A:middle
[ Applause ]

00:24:37.356 --> 00:24:38.276 A:middle
So we'll go back to that

00:24:38.276 --> 00:24:39.036 A:middle
previous example.

00:24:39.336 --> 00:24:41.036 A:middle
And now in my View Context and

00:24:41.036 --> 00:24:42.536 A:middle
Background Context load data,

00:24:43.426 --> 00:24:44.976 A:middle
we'll see that it happens within

00:24:45.106 --> 00:24:46.376 A:middle
a transaction.

00:24:46.856 --> 00:24:48.116 A:middle
And this transaction's written

00:24:48.116 --> 00:24:48.776 A:middle
to my database.

00:24:49.216 --> 00:24:50.326 A:middle
And I can see that it was done

00:24:50.326 --> 00:24:52.616 A:middle
by the Background Context and in

00:24:52.616 --> 00:24:52.986 A:middle
my app.

00:24:54.196 --> 00:24:55.916 A:middle
Now when I hop out of my app and

00:24:55.916 --> 00:24:57.446 A:middle
the user goes into a Document

00:24:57.446 --> 00:24:57.926 A:middle
Extension --

00:25:02.036 --> 00:25:03.126 A:middle
We'll see that this also

00:25:03.156 --> 00:25:06.906 A:middle
generates a transaction and so

00:25:06.906 --> 00:25:08.136 A:middle
on with my share extension.

00:25:08.706 --> 00:25:12.876 A:middle
And also the Share Extension

00:25:12.876 --> 00:25:13.906 A:middle
will note that there was a

00:25:13.906 --> 00:25:17.426 A:middle
modification and not an insert

00:25:17.426 --> 00:25:17.616 A:middle
here.

00:25:18.546 --> 00:25:20.266 A:middle
And now with a Photos Extension

00:25:20.366 --> 00:25:21.436 A:middle
we'll also see the fourth

00:25:21.436 --> 00:25:24.106 A:middle
transaction come in and we'll

00:25:24.106 --> 00:25:25.326 A:middle
see that it was done in photos.

00:25:25.326 --> 00:25:28.506 A:middle
So now when my app is being

00:25:28.506 --> 00:25:29.736 A:middle
brought back to the foreground,

00:25:30.356 --> 00:25:31.876 A:middle
I do still have still data, but

00:25:31.876 --> 00:25:33.366 A:middle
now I know where I am in the

00:25:33.366 --> 00:25:35.426 A:middle
history table and can simply go

00:25:35.426 --> 00:25:37.216 A:middle
from transaction 1 to 4.

00:25:37.836 --> 00:25:39.306 A:middle
And voila I've updated.

00:25:42.616 --> 00:25:45.326 A:middle
So we've introduced a new Store

00:25:45.326 --> 00:25:46.506 A:middle
Request for you to fetch your

00:25:46.506 --> 00:25:46.876 A:middle
history.

00:25:47.436 --> 00:25:48.626 A:middle
It's called NS Persistent

00:25:48.686 --> 00:25:49.726 A:middle
History Change Request.

00:25:50.426 --> 00:25:52.226 A:middle
You can simply start it up with

00:25:52.226 --> 00:25:54.796 A:middle
either a date, a token, or a

00:25:54.796 --> 00:25:55.426 A:middle
transaction.

00:25:56.016 --> 00:25:59.036 A:middle
And you can simply set the

00:25:59.036 --> 00:25:59.986 A:middle
result type as well.

00:26:00.516 --> 00:26:02.736 A:middle
As simple as a status, the count

00:26:02.736 --> 00:26:04.016 A:middle
of change is available.

00:26:04.066 --> 00:26:05.616 A:middle
Or you can get nitty-gritty and

00:26:05.616 --> 00:26:07.306 A:middle
get all the transactions and all

00:26:07.306 --> 00:26:07.836 A:middle
the changes.

00:26:09.676 --> 00:26:11.376 A:middle
Also with a change request we

00:26:11.376 --> 00:26:12.936 A:middle
allow you to purge your history.

00:26:13.486 --> 00:26:15.776 A:middle
So we want you to start this off

00:26:15.826 --> 00:26:17.296 A:middle
and you can delete the history

00:26:17.296 --> 00:26:19.716 A:middle
prior to date, a token, or a

00:26:19.716 --> 00:26:20.396 A:middle
transaction.

00:26:21.126 --> 00:26:23.036 A:middle
Now your Persistent History is

00:26:23.036 --> 00:26:25.176 A:middle
linear so this way it will keep

00:26:25.176 --> 00:26:25.636 A:middle
it short.

00:26:26.366 --> 00:26:29.086 A:middle
One of the caveats we want you

00:26:29.086 --> 00:26:30.386 A:middle
to keep in mind when pruning

00:26:30.386 --> 00:26:31.996 A:middle
your history is that you should

00:26:31.996 --> 00:26:33.246 A:middle
have a gatekeeper.

00:26:34.366 --> 00:26:36.036 A:middle
Single place where this should

00:26:36.036 --> 00:26:37.636 A:middle
be done so that it knows that

00:26:37.636 --> 00:26:38.876 A:middle
you've consumed the history you

00:26:38.876 --> 00:26:40.776 A:middle
need, your clients have consumed

00:26:40.776 --> 00:26:43.076 A:middle
it, and you no longer are

00:26:43.076 --> 00:26:44.156 A:middle
removing anything that is

00:26:44.156 --> 00:26:46.036 A:middle
relevant to someone else in your

00:26:46.116 --> 00:26:47.416 A:middle
app, all right?

00:26:47.416 --> 00:26:48.316 A:middle
And then now we have NS

00:26:48.316 --> 00:26:50.026 A:middle
Persistent History Transaction.

00:26:50.766 --> 00:26:52.716 A:middle
This is a large data blob that

00:26:52.796 --> 00:26:55.516 A:middle
covers who did the transaction

00:26:55.516 --> 00:26:56.106 A:middle
to your database.

00:26:56.536 --> 00:26:57.376 A:middle
So as you can see we have a

00:26:57.376 --> 00:27:00.316 A:middle
Store ID, a Bundle ID, a Process

00:26:57.376 --> 00:27:00.316 A:middle
Store ID, a Bundle ID, a Process

00:27:00.316 --> 00:27:02.206 A:middle
ID, but we also have a Token.

00:27:02.576 --> 00:27:05.606 A:middle
Since your history is linear, we

00:27:05.606 --> 00:27:07.306 A:middle
provide you a Token that you can

00:27:07.306 --> 00:27:08.916 A:middle
encode to disc, so that when

00:27:08.916 --> 00:27:10.576 A:middle
your app exits you can keep

00:27:10.576 --> 00:27:12.276 A:middle
track of where your app was in

00:27:12.276 --> 00:27:12.786 A:middle
the history.

00:27:13.406 --> 00:27:15.056 A:middle
Simply re-launch your app, pull

00:27:15.056 --> 00:27:16.366 A:middle
your token, and fetch your

00:27:16.366 --> 00:27:17.646 A:middle
history based on that and you're

00:27:17.646 --> 00:27:18.146 A:middle
good to go.

00:27:19.516 --> 00:27:21.616 A:middle
Now, also in the transaction we

00:27:21.616 --> 00:27:24.356 A:middle
allow you -- the author, we want

00:27:24.356 --> 00:27:25.676 A:middle
you to go onto your Manage

00:27:25.676 --> 00:27:28.246 A:middle
Object Context and tell us who

00:27:28.246 --> 00:27:30.296 A:middle
is the author of this context

00:27:30.296 --> 00:27:32.456 A:middle
and this Save Batch Update or

00:27:32.456 --> 00:27:33.116 A:middle
Batch Delete.

00:27:34.056 --> 00:27:36.266 A:middle
And so we also allow you to go

00:27:36.266 --> 00:27:37.916 A:middle
onto the Manage Object Context

00:27:38.226 --> 00:27:39.586 A:middle
and set the Transaction Author.

00:27:40.676 --> 00:27:41.966 A:middle
Do this before your save or

00:27:41.966 --> 00:27:43.596 A:middle
executing a request and we'll

00:27:43.596 --> 00:27:45.136 A:middle
take this string, put in a

00:27:45.136 --> 00:27:46.956 A:middle
transaction, so you can identify

00:27:47.366 --> 00:27:48.926 A:middle
who did what to your database at

00:27:48.926 --> 00:27:50.236 A:middle
a later time.

00:27:51.926 --> 00:27:53.516 A:middle
And as part of every transaction

00:27:53.516 --> 00:27:54.586 A:middle
there is a set of changes.

00:27:55.246 --> 00:27:57.006 A:middle
A change represents a single

00:27:57.076 --> 00:27:58.126 A:middle
thing that was done to one

00:27:58.126 --> 00:27:58.636 A:middle
object.

00:27:58.686 --> 00:27:59.976 A:middle
So they'll be many changes for

00:27:59.976 --> 00:28:03.166 A:middle
every transaction and here we'll

00:27:59.976 --> 00:28:03.166 A:middle
every transaction and here we'll

00:28:03.166 --> 00:28:05.056 A:middle
have inserts, and updates, and

00:28:05.056 --> 00:28:05.366 A:middle
deletes.

00:28:05.906 --> 00:28:07.366 A:middle
In the case of an update, we'll

00:28:07.406 --> 00:28:08.946 A:middle
tell you which properties were

00:28:08.946 --> 00:28:11.366 A:middle
updated -- either attributes or

00:28:11.366 --> 00:28:13.516 A:middle
relationships, and then in the

00:28:13.516 --> 00:28:17.726 A:middle
case of a delete we'll tell you

00:28:17.726 --> 00:28:18.746 A:middle
what the tombstone is.

00:28:19.276 --> 00:28:20.376 A:middle
It's a set of attributes that

00:28:20.376 --> 00:28:21.876 A:middle
you can set in the model editor

00:28:22.206 --> 00:28:23.466 A:middle
that allow you to identify the

00:28:23.466 --> 00:28:24.606 A:middle
object post mortem.

00:28:25.226 --> 00:28:26.316 A:middle
It's no longer in your database

00:28:26.406 --> 00:28:27.996 A:middle
so the object ID isn't as

00:28:28.056 --> 00:28:30.106 A:middle
relevant anymore, but with a

00:28:30.106 --> 00:28:31.646 A:middle
tombstone you can still identify

00:28:31.646 --> 00:28:34.206 A:middle
that object and be able to

00:28:34.206 --> 00:28:35.376 A:middle
process it later.

00:28:36.526 --> 00:28:38.126 A:middle
Now here we are in the model

00:28:38.126 --> 00:28:38.566 A:middle
editor.

00:28:42.446 --> 00:28:44.086 A:middle
And I have a unique identifier

00:28:44.086 --> 00:28:44.656 A:middle
for this entity.

00:28:44.656 --> 00:28:45.896 A:middle
And it would be great if I could

00:28:45.896 --> 00:28:46.436 A:middle
tombstone it.

00:28:46.706 --> 00:28:49.236 A:middle
So we simply go in and mark it

00:28:49.366 --> 00:28:50.486 A:middle
Preserve After Deletion.

00:28:51.366 --> 00:28:52.396 A:middle
And it's that simple and it will

00:28:52.396 --> 00:28:53.346 A:middle
show up in my tombstone.

00:28:55.896 --> 00:28:56.916 A:middle
And so with that I'd like to

00:28:56.916 --> 00:28:57.816 A:middle
show you a quick Demo.

00:28:58.666 --> 00:28:59.786 A:middle
So I have a simple app here.

00:29:00.196 --> 00:29:02.846 A:middle
It takes a post I have and puts

00:29:02.846 --> 00:29:03.976 A:middle
it on my social media feeds.

00:29:04.626 --> 00:29:06.136 A:middle
I've set it up with a few

00:29:06.136 --> 00:29:06.696 A:middle
buttons here.

00:29:06.886 --> 00:29:09.486 A:middle
A download button that will go

00:29:09.486 --> 00:29:10.796 A:middle
on a background context and

00:29:11.186 --> 00:29:12.986 A:middle
ingest from the Cloud.

00:29:13.546 --> 00:29:15.186 A:middle
And a background task that will

00:29:15.186 --> 00:29:17.086 A:middle
go out and post all of my stuff.

00:29:17.216 --> 00:29:18.746 A:middle
And I've also got a tab where I

00:29:18.746 --> 00:29:19.986 A:middle
can go and see the history.

00:29:21.486 --> 00:29:23.576 A:middle
Currently in my code I have Use

00:29:23.576 --> 00:29:24.986 A:middle
Persistent History set to False,

00:29:24.986 --> 00:29:26.906 A:middle
but I've enabled it for my store

00:29:26.906 --> 00:29:27.816 A:middle
so that we can see what's

00:29:27.816 --> 00:29:28.286 A:middle
changed.

00:29:30.016 --> 00:29:31.926 A:middle
So here I am and I'll have a

00:29:31.926 --> 00:29:32.636 A:middle
user post.

00:29:33.096 --> 00:29:34.306 A:middle
And this user said, "This demo

00:29:34.306 --> 00:29:34.736 A:middle
is amazing!"

00:29:34.736 --> 00:29:36.606 A:middle
Awesome. And I can also go and

00:29:36.606 --> 00:29:37.746 A:middle
download one from the

00:29:37.746 --> 00:29:38.366 A:middle
background.

00:29:38.366 --> 00:29:40.846 A:middle
And we can see that I've labeled

00:29:40.846 --> 00:29:42.046 A:middle
where the post came from.

00:29:42.046 --> 00:29:43.046 A:middle
The first one comes from the

00:29:43.046 --> 00:29:44.216 A:middle
user, the next one comes from

00:29:44.216 --> 00:29:44.816 A:middle
the background.

00:29:45.716 --> 00:29:48.196 A:middle
But now let's hop out and go to

00:29:48.196 --> 00:29:49.146 A:middle
the Share Extension.

00:29:49.876 --> 00:29:52.116 A:middle
And let's share about Apple here

00:29:52.116 --> 00:29:52.636 A:middle
real quick.

00:29:58.036 --> 00:30:00.146 A:middle
So I can post about this and see

00:29:58.036 --> 00:30:00.146 A:middle
So I can post about this and see

00:30:00.146 --> 00:30:00.696 A:middle
in my app.

00:30:00.846 --> 00:30:02.846 A:middle
And now when we get back to my

00:30:03.016 --> 00:30:05.736 A:middle
app -- oh wait, I lost some

00:30:05.736 --> 00:30:06.686 A:middle
data, this is really odd.

00:30:07.366 --> 00:30:08.626 A:middle
It must have something wrong.

00:30:08.626 --> 00:30:10.256 A:middle
But if I go back to the history

00:30:10.746 --> 00:30:12.526 A:middle
I can see that I had a post

00:30:12.526 --> 00:30:14.276 A:middle
within the app and I had remote

00:30:14.276 --> 00:30:15.906 A:middle
content and I even can see the

00:30:15.906 --> 00:30:16.716 A:middle
Share Extension.

00:30:17.716 --> 00:30:19.366 A:middle
However I'm not seeing that

00:30:19.366 --> 00:30:21.816 A:middle
here, like the user I start

00:30:21.816 --> 00:30:23.146 A:middle
adding data and trying to figure

00:30:23.146 --> 00:30:24.196 A:middle
out what's wrong with this UI.

00:30:25.036 --> 00:30:27.296 A:middle
And my Persistent History once

00:30:27.296 --> 00:30:28.396 A:middle
again is showing everything.

00:30:28.716 --> 00:30:29.866 A:middle
Oh wait, that's weird.

00:30:30.326 --> 00:30:32.656 A:middle
All of a sudden my app has hit

00:30:32.716 --> 00:30:33.826 A:middle
some refresh that I've

00:30:33.826 --> 00:30:35.866 A:middle
downloaded into it based on some

00:30:35.866 --> 00:30:37.816 A:middle
view where I finally go and hit

00:30:37.816 --> 00:30:39.356 A:middle
the database and re-fetch

00:30:39.756 --> 00:30:40.306 A:middle
everything.

00:30:40.956 --> 00:30:41.766 A:middle
Because that's the only way I

00:30:41.766 --> 00:30:43.346 A:middle
can solve this problem sometimes

00:30:43.936 --> 00:30:45.056 A:middle
and that's frustrating to our

00:30:45.056 --> 00:30:45.526 A:middle
users.

00:30:46.466 --> 00:30:48.336 A:middle
But what happens if we turn on

00:30:48.336 --> 00:30:50.036 A:middle
Persistent History and no longer

00:30:50.036 --> 00:30:51.306 A:middle
have to track things like that?

00:30:52.116 --> 00:30:53.736 A:middle
So I'll simply turn this on.

00:30:53.956 --> 00:30:55.196 A:middle
So as you can see here real

00:30:55.196 --> 00:30:59.006 A:middle
quick, I have my Background

00:30:59.006 --> 00:31:01.086 A:middle
Context set up and my View

00:30:59.006 --> 00:31:01.086 A:middle
Context set up and my View

00:31:01.086 --> 00:31:02.776 A:middle
Context set up and I've also got

00:31:02.776 --> 00:31:03.806 A:middle
them listening to each other.

00:31:04.326 --> 00:31:08.466 A:middle
But I also have some Transaction

00:31:08.466 --> 00:31:08.996 A:middle
Author set.

00:31:09.056 --> 00:31:09.986 A:middle
And I just want to show you how

00:31:10.046 --> 00:31:11.316 A:middle
simple that is so that we can

00:31:11.316 --> 00:31:12.226 A:middle
see this going forward.

00:31:13.516 --> 00:31:14.986 A:middle
OK, so let's stop the app real

00:31:14.986 --> 00:31:16.866 A:middle
quick and re-launch.

00:31:24.066 --> 00:31:25.826 A:middle
And here we are with our app

00:31:25.826 --> 00:31:26.766 A:middle
using History at this time.

00:31:26.766 --> 00:31:28.916 A:middle
And let's go to that troublesome

00:31:28.916 --> 00:31:30.606 A:middle
case of sharing a post.

00:31:31.436 --> 00:31:33.036 A:middle
Well, High Sierra looks pretty

00:31:33.036 --> 00:31:36.666 A:middle
cool, so let's share about that

00:31:37.296 --> 00:31:37.686 A:middle
real quick.

00:31:39.076 --> 00:31:40.756 A:middle
All right, shared about that.

00:31:40.936 --> 00:31:42.086 A:middle
Real quick let's just share

00:31:42.086 --> 00:31:43.076 A:middle
about one more thing.

00:31:44.046 --> 00:31:45.556 A:middle
The cool new watchOS.

00:31:55.106 --> 00:31:56.616 A:middle
And now when we get back to the

00:31:56.616 --> 00:31:56.906 A:middle
app,

00:32:01.116 --> 00:32:02.326 A:middle
voila. There they are.

00:32:02.616 --> 00:32:03.956 A:middle
All I've done is absorb the

00:32:03.956 --> 00:32:05.926 A:middle
history, when my view reloaded,

00:32:06.856 --> 00:32:08.256 A:middle
and we can jump to that code

00:32:08.256 --> 00:32:09.546 A:middle
real quick.

00:32:18.326 --> 00:32:19.616 A:middle
So previously if I was using

00:32:19.646 --> 00:32:21.356 A:middle
Fetch Hit -- not using

00:32:21.356 --> 00:32:22.256 A:middle
Persistent History, I was

00:32:22.286 --> 00:32:23.796 A:middle
fetching everything, but now

00:32:23.796 --> 00:32:25.516 A:middle
that I am all I'm doing is

00:32:25.516 --> 00:32:26.386 A:middle
fetching the history and

00:32:26.746 --> 00:32:28.306 A:middle
absorbing the merged context

00:32:28.486 --> 00:32:29.546 A:middle
from the History.

00:32:29.546 --> 00:32:31.106 A:middle
And it gives me a much smaller

00:32:31.106 --> 00:32:32.386 A:middle
subset and I no longer have to

00:32:32.386 --> 00:32:34.006 A:middle
scan the entire database to see

00:32:34.006 --> 00:32:34.646 A:middle
what was different.

00:32:36.516 --> 00:32:39.636 A:middle
[ Applause ]

00:32:40.136 --> 00:32:42.576 A:middle
And so to recap it's rather

00:32:42.576 --> 00:32:42.896 A:middle
easy.

00:32:43.336 --> 00:32:44.596 A:middle
Simple to enable Persistent

00:32:44.596 --> 00:32:44.916 A:middle
History.

00:32:44.986 --> 00:32:46.066 A:middle
It's just one option on your

00:32:46.066 --> 00:32:46.386 A:middle
store.

00:32:47.876 --> 00:32:49.096 A:middle
It really uncovers all those

00:32:49.096 --> 00:32:49.746 A:middle
missing changes.

00:32:50.196 --> 00:32:51.636 A:middle
And you may have been generating

00:32:51.636 --> 00:32:53.336 A:middle
background context, you may just

00:32:53.336 --> 00:32:54.396 A:middle
not realize that you're missing

00:32:54.396 --> 00:32:56.116 A:middle
a notification, you've harnessed

00:32:56.156 --> 00:32:57.796 A:middle
Batch Updates, Batch Deletes,

00:32:58.096 --> 00:32:58.816 A:middle
which don't generate

00:32:58.816 --> 00:32:59.646 A:middle
notifications.

00:33:00.186 --> 00:33:01.476 A:middle
So they uncover all of that.

00:33:01.886 --> 00:33:03.106 A:middle
And you'll never be in the dark

00:33:03.106 --> 00:33:04.196 A:middle
again about changes to your

00:33:04.196 --> 00:33:04.586 A:middle
database.

00:33:07.826 --> 00:33:09.436 A:middle
Two caveats to mention about

00:33:09.436 --> 00:33:11.246 A:middle
using persistent history -- the

00:33:11.246 --> 00:33:12.436 A:middle
first one is about Migration.

00:33:12.606 --> 00:33:14.396 A:middle
We will preserve as much of your

00:33:14.396 --> 00:33:16.136 A:middle
history as possible on migration

00:33:18.006 --> 00:33:18.936 A:middle
except for two cases.

00:33:19.536 --> 00:33:21.096 A:middle
One is if you remove entities

00:33:21.096 --> 00:33:22.466 A:middle
from your model and we already

00:33:22.466 --> 00:33:24.556 A:middle
have history on these entities,

00:33:25.146 --> 00:33:26.076 A:middle
we'll have to remove that

00:33:26.076 --> 00:33:27.496 A:middle
history for those entities and

00:33:27.606 --> 00:33:28.346 A:middle
that creates a gap.

00:33:29.386 --> 00:33:31.216 A:middle
The other one is for tombstones.

00:33:31.356 --> 00:33:34.396 A:middle
For tombstones you don't want to

00:33:34.506 --> 00:33:35.916 A:middle
have certain data there after

00:33:35.916 --> 00:33:37.146 A:middle
awhile to identify the object.

00:33:37.216 --> 00:33:38.246 A:middle
Maybe it's become a security

00:33:38.246 --> 00:33:39.106 A:middle
concern for you.

00:33:39.106 --> 00:33:41.126 A:middle
So you've called the tombstone.

00:33:41.386 --> 00:33:42.566 A:middle
So we'll do the same and we'll

00:33:42.566 --> 00:33:44.106 A:middle
remove that tombstone value out

00:33:44.396 --> 00:33:45.176 A:middle
from the model.

00:33:45.176 --> 00:33:46.836 A:middle
But if that removes anything

00:33:46.836 --> 00:33:49.026 A:middle
that will leave a gap in your

00:33:49.026 --> 00:33:50.856 A:middle
history, we'll also then only

00:33:50.856 --> 00:33:51.816 A:middle
preserve your history to the

00:33:51.816 --> 00:33:53.296 A:middle
last complete transaction.

00:33:53.716 --> 00:33:56.546 A:middle
This way you can go and follow

00:33:56.546 --> 00:33:58.366 A:middle
the history without falling into

00:33:58.366 --> 00:33:59.886 A:middle
a trap where I am missing

00:33:59.886 --> 00:34:01.696 A:middle
changes once again because of a

00:33:59.886 --> 00:34:01.696 A:middle
changes once again because of a

00:34:01.876 --> 00:34:01.976 A:middle
gap.

00:34:03.316 --> 00:34:06.406 A:middle
As far as performance there's a

00:34:06.406 --> 00:34:08.516 A:middle
slight impact on every save and

00:34:08.516 --> 00:34:10.166 A:middle
every batch-operation you do.

00:34:11.235 --> 00:34:12.255 A:middle
According to the size of your

00:34:12.255 --> 00:34:13.585 A:middle
save and your batch operation

00:34:13.585 --> 00:34:15.126 A:middle
we'll do a slight calculation of

00:34:15.126 --> 00:34:16.565 A:middle
what changed and write that to

00:34:16.565 --> 00:34:17.065 A:middle
the database.

00:34:17.676 --> 00:34:19.956 A:middle
However, once your operation is

00:34:19.956 --> 00:34:21.606 A:middle
complete all of that memory that

00:34:21.606 --> 00:34:23.146 A:middle
we used is returned back to you.

00:34:23.326 --> 00:34:24.716 A:middle
There's also small storage

00:34:24.716 --> 00:34:26.476 A:middle
overhead, but your history can

00:34:26.476 --> 00:34:27.806 A:middle
be purged, so this makes it

00:34:27.806 --> 00:34:29.065 A:middle
really easy for you to reclaim

00:34:29.065 --> 00:34:30.476 A:middle
that space once you've consumed

00:34:30.476 --> 00:34:30.906 A:middle
the history.

00:34:31.426 --> 00:34:34.766 A:middle
And that's Persistent History

00:34:34.766 --> 00:34:35.056 A:middle
Tracking.

00:34:36.516 --> 00:34:43.016 A:middle
[ Applause ]

00:34:43.516 --> 00:34:44.716 A:middle
Now just to summarize what we've

00:34:44.716 --> 00:34:45.436 A:middle
gone over today.

00:34:45.876 --> 00:34:46.786 A:middle
Melissa went over Core

00:34:46.786 --> 00:34:47.286 A:middle
Spotlight.

00:34:47.496 --> 00:34:49.556 A:middle
It's really easy to adopt, easy

00:34:49.556 --> 00:34:50.585 A:middle
to share your data with

00:34:50.585 --> 00:34:52.346 A:middle
Spotlight, and it gives you deep

00:34:52.346 --> 00:34:52.746 A:middle
linking.

00:34:53.036 --> 00:34:54.295 A:middle
So your users can find their

00:34:54.295 --> 00:34:56.255 A:middle
data in your app anywhere on the

00:34:56.255 --> 00:34:56.505 A:middle
phone.

00:34:57.416 --> 00:34:59.806 A:middle
And the New Indexing API makes

00:34:59.806 --> 00:35:01.566 A:middle
your searches faster and just

00:34:59.806 --> 00:35:01.566 A:middle
your searches faster and just

00:35:01.566 --> 00:35:02.856 A:middle
makes your app that much faster.

00:35:03.596 --> 00:35:05.606 A:middle
And lastly, Persistent History

00:35:06.106 --> 00:35:07.306 A:middle
allows you to know who's always

00:35:07.306 --> 00:35:09.426 A:middle
done it, never be lost, always

00:35:09.426 --> 00:35:10.316 A:middle
know who's done what to your

00:35:10.316 --> 00:35:10.746 A:middle
database.

00:35:13.026 --> 00:35:14.676 A:middle
One PSA before we go.

00:35:14.916 --> 00:35:15.696 A:middle
Please file bugs.

00:35:16.166 --> 00:35:17.176 A:middle
Let us know if you run into an

00:35:17.176 --> 00:35:17.496 A:middle
issue.

00:35:17.656 --> 00:35:18.466 A:middle
Let us know if you want

00:35:18.466 --> 00:35:18.906 A:middle
something.

00:35:19.986 --> 00:35:21.526 A:middle
Go to bugreport.apple.com.

00:35:21.696 --> 00:35:22.406 A:middle
We are listening.

00:35:23.066 --> 00:35:24.136 A:middle
So please go and visit.

00:35:25.106 --> 00:35:27.186 A:middle
For more information check out

00:35:27.186 --> 00:35:28.796 A:middle
the www.DC website.

00:35:29.556 --> 00:35:31.686 A:middle
And for some related sessions we

00:35:31.686 --> 00:35:32.626 A:middle
had "What's New in Cocoa"

00:35:32.626 --> 00:35:33.986 A:middle
earlier today, so go check out

00:35:33.986 --> 00:35:34.466 A:middle
that video.

00:35:34.986 --> 00:35:35.836 A:middle
We also have "What's New in

00:35:35.836 --> 00:35:36.956 A:middle
Foundation" coming up next.

00:35:37.676 --> 00:35:39.936 A:middle
And we have some cool stuff on

00:35:39.936 --> 00:35:41.246 A:middle
"What's New in Core Spotlight"

00:35:41.246 --> 00:35:42.366 A:middle
later on Thursday.

00:35:42.866 --> 00:35:44.016 A:middle
And check out the "Cocoa

00:35:44.016 --> 00:35:45.356 A:middle
Development Tips" early on

00:35:45.356 --> 00:35:45.956 A:middle
Friday morning.

00:35:46.576 --> 00:35:47.276 A:middle
Thank you very much.

00:35:48.508 --> 00:35:50.508 A:middle
[ Applause ]
